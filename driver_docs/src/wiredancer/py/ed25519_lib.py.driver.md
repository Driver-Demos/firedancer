# Purpose
This Python code file is a complex script designed to perform cryptographic operations, specifically focusing on the ed25519 signature verification process. The core functionality is encapsulated within the `Expr` class, which is responsible for generating a sequence of machine instructions to compute the ed25519 verification procedure. The class tracks Python expressions during code evaluation, applying optimizations such as constant propagation, dead code elimination, and minimal register allocation. The script does not support traditional if-statements, instead using a ternary operator to ensure all data paths are executed, reflecting a hardware-like execution model where data is multiplexed.

The script includes several functions for modular arithmetic operations, such as [`mul_modp`](#mul_modp), [`add_modp`](#add_modp), and [`sub_modp`](#sub_modp), which are essential for cryptographic computations. It also defines functions for specific operations like [`kpow_ed255192`](#kpow_ed255192) and [`kpow_ed2551938`](#kpow_ed2551938), which are used for exponentiation in the context of the ed25519 curve. The script is structured to be executed as a standalone program, as indicated by the `if __name__ == '__main__':` block, which tests the modular multiplication functions with random inputs. The code is not designed as a library for importation but rather as a script for direct execution, likely for testing or demonstration purposes of the ed25519 signature verification process.
# Imports and Dependencies

---
- `random`
- `numbers`
- `ref_ed25519`
- `ref_ed25519.p`


# Classes

---
### Expr<!-- {{#class:firedancer/src/wiredancer/py/ed25519_lib.Expr}} -->
- **Members**:
    - `trace_q`: A class variable that holds the sequence of expression traces.
    - `op_hist`: A class variable that records the histogram of operations.
    - `op_args`: A class variable that stores arguments for each operation.
    - `func_const_prop`: A class variable indicating if function constant propagation is enabled.
    - `v`: An instance variable representing the evaluated value of the expression.
    - `t`: An instance variable used internally for tracking.
    - `c`: An instance variable indicating if the expression is a constant.
    - `func`: An instance variable representing the function to be applied in the expression.
    - `op`: An instance variable representing the operation to be performed.
    - `args`: An instance variable holding the arguments for the function or operation.
    - `addr`: An instance variable representing the memory address of the expression.
    - `out`: An instance variable indicating if the expression is an output.
- **Description**: The Expr class is designed to generate machine instructions for computing the ed25519 verification procedure using a specific processor. It tracks the sequence of Python expressions executed during the evaluation of arbitrary Python code, optimizing through constant propagation, dead code elimination, and minimal register allocation. The class does not support if statements, instead using ternary operators to track both branches of the data path, ensuring all paths are executed and the correct data is multiplexed. The class provides methods to reset the expression tracker, evaluate expressions, and output the results, facilitating the conversion of high-level Python code into a sequence of low-level machine instructions.
- **Methods**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.reset`](#Exprreset)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.outputs`](#Exproutputs)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__init__`](#Expr__init__)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.copy`](#Exprcopy)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.eval`](#Expreval)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__add__`](#Expr__add__)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__sub__`](#Expr__sub__)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__rshift__`](#Expr__rshift__)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__lshift__`](#Expr__lshift__)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__and__`](#Expr__and__)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__eq__`](#Expr__eq__)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__ne__`](#Expr__ne__)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__ge__`](#Expr__ge__)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__int__`](#Expr__int__)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__repr__`](#Expr__repr__)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__hash__`](#Expr__hash__)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.mem`](#Exprmem)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.opt_trace`](#Expropt_trace)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.dump_const_hex`](#Exprdump_const_hex)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.dump_instr_hex`](#Exprdump_instr_hex)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.eval_hex`](#Expreval_hex)

**Methods**

---
#### Expr\.reset<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.reset}} -->
The `reset` method reinitializes the static attributes of the `Expr` class to their default states, effectively clearing any previously stored expression tracking data.
- **Inputs**: None
- **Control Flow**:
    - Set `Expr.func_const_prop` to `False` to disable constant propagation.
    - Reset `Expr.maddr` and `Expr.caddr` to `0`, initializing memory and constant addresses.
    - Reinitialize `Expr.trace_q` as an empty list to clear the expression trace queue.
    - Reinitialize `Expr.op_hist` as an empty dictionary to clear the operation history.
    - Reinitialize `Expr.op_args` as an empty dictionary to clear the operation arguments.
    - Reinitialize `Expr.outs` as an empty list to clear the outputs.
- **Output**: The method does not return any value; it modifies class-level attributes of `Expr`.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)  (Base Class)


---
#### Expr\.outputs<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.outputs}} -->
The `outputs` method sets the output expressions for the `Expr` class and marks them as outputs, then optimizes the trace of expressions.
- **Inputs**:
    - `outs`: An expression or a list of expressions that are intended to be the outputs of the expression tracking.
- **Control Flow**:
    - Check if `outs` is an instance of `Expr`; if so, convert it to a list containing `outs`.
    - Assign the list of outputs to `Expr.outputs`.
    - Iterate over each expression in `Expr.outputs`, set its `out` attribute to `True`, and append it to `Expr.outs`.
    - Call `Expr.opt_trace()` to optimize the trace of expressions.
- **Output**: The method does not return any value; it modifies the class-level attributes of `Expr` to track output expressions and optimize the expression trace.
- **Functions called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.opt_trace`](#Expropt_trace)
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)  (Base Class)


---
#### Expr\.\_\_init\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__init__}} -->
The `__init__` method initializes an `Expr` object, setting up its attributes based on the provided arguments and determining its function, operation, and arguments for expression evaluation.
- **Inputs**:
    - `left`: The left operand of the expression, defaulting to None.
    - `op`: The operation to be performed, defaulting to None.
    - `right`: The right operand of the expression, defaulting to None.
    - `cond`: The condition for ternary operations, defaulting to None.
    - `func`: The function to be applied, defaulting to None.
    - `args`: The arguments for the function, defaulting to None.
    - `var`: A boolean indicating if the expression is a variable input, defaulting to False.
    - `out`: A boolean indicating if the expression is an output, defaulting to False.
- **Control Flow**:
    - Initialize instance variables `v`, `t`, `c`, `func`, `op`, `args`, `addr`, and `out` to default values.
    - If `func` is not None, set `func`, `args`, and `c` based on constant propagation, converting `args` to `Expr` objects if necessary.
    - If `op` is None and `var` is True, set `func` to 'input' and `args` to an empty list.
    - If `op` is None and `var` is False, check if `left` is an integer and set `c` and `args` accordingly, otherwise print the type of `left`.
    - If `op` is 'if', evaluate `cond` and copy either `left` or `right` based on the condition, or set `func` to 'ternary' and `args` to include `left`, `right`, and `cond`.
    - For other operations, set `func` to 'op', `op` to the provided operation, and `args` to include `left` and `right`, performing constant propagation if both are constants.
    - If the expression is not constant (`c` is False), append the expression to `Expr.trace_q`.
    - Call `eval()` to evaluate the expression.
- **Output**: The method does not return a value; it initializes the state of the `Expr` object.
- **Functions called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.eval`](#Expreval)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.copy`](#Exprcopy)
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)  (Base Class)


---
#### Expr\.copy<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.copy}} -->
The `copy` method copies the attributes of another `Expr` instance to the current instance.
- **Inputs**:
    - `r`: An instance of the `Expr` class whose attributes are to be copied.
- **Control Flow**:
    - The method assigns the value of `r.v` to `self.v`.
    - The method assigns the value of `r.t` to `self.t`.
    - The method assigns the value of `r.c` to `self.c`.
    - The method assigns the value of `r.op` to `self.op`.
    - The method assigns the value of `r.func` to `self.func`.
    - The method assigns the value of `r.args` to `self.args`.
    - The method assigns the value of `r.addr` to `self.addr`.
- **Output**: The method does not return any value; it modifies the current instance in place.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)  (Base Class)


---
#### Expr\.eval<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.eval}} -->
The `eval` method evaluates an expression represented by the `Expr` class, computing its value based on its function type and arguments.
- **Inputs**: None
- **Control Flow**:
    - Check if the value `v` is `None`, indicating the expression has not been evaluated yet.
    - If `c` is `True`, set `v` to the first argument in `args`.
    - If `func` is 'input', set `v` to 0.
    - If `func` is 'if', evaluate the ternary operation using the first three arguments and set `v` to the result.
    - If `func` is 'op', evaluate the operation using the first two arguments and the operator `op`, then set `v` to the result.
    - If `func` is not `None`, evaluate the function call with the arguments and set `v` to the result.
    - Convert `v` to an integer.
    - Return the evaluated value `v`.
- **Output**: The method returns the evaluated integer value of the expression.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)  (Base Class)


---
#### Expr\.\_\_add\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__add__}} -->
The `__add__` method creates a new `Expr` object representing the addition operation between the current `Expr` instance and another value.
- **Inputs**:
    - `v`: The value to be added to the current `Expr` instance, which can be another `Expr` object or a compatible type.
- **Control Flow**:
    - The method takes a single argument `v`.
    - It returns a new `Expr` object initialized with the current instance (`self`) as the left operand, the '+' operator, and `v` as the right operand.
- **Output**: A new `Expr` object representing the addition operation between the current instance and the provided value `v`.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)  (Base Class)


---
#### Expr\.\_\_sub\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__sub__}} -->
The `__sub__` method creates a new `Expr` object representing the subtraction operation between the current `Expr` instance and another value.
- **Inputs**:
    - `v`: The value to be subtracted from the current `Expr` instance, which can be another `Expr` object or a compatible type.
- **Control Flow**:
    - The method takes a single argument `v`.
    - It returns a new `Expr` object initialized with the current instance (`self`) as the left operand, '-' as the operator, and `v` as the right operand.
- **Output**: A new `Expr` object representing the subtraction operation.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)  (Base Class)


---
#### Expr\.\_\_rshift\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__rshift__}} -->
The `__rshift__` method creates a new `Expr` object representing a right shift operation between the current `Expr` instance and another value.
- **Inputs**:
    - `v`: The value to be right-shifted with the current `Expr` instance.
- **Control Flow**:
    - The method takes the current `Expr` instance (`self`) and the input value `v`.
    - It creates a new `Expr` object with the current instance as the left operand, the right shift operator ('>>') as the operation, and `v` as the right operand.
    - The new `Expr` object is returned, representing the right shift operation.
- **Output**: A new `Expr` object representing the right shift operation between the current instance and the input value `v`.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)  (Base Class)


---
#### Expr\.\_\_lshift\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__lshift__}} -->
The `__lshift__` method creates a new `Expr` object representing a left shift operation between the current `Expr` instance and another value.
- **Inputs**:
    - `v`: The value to be left-shifted with the current `Expr` instance.
- **Control Flow**:
    - The method takes a single argument `v`.
    - It returns a new `Expr` object initialized with the current instance (`self`), the left shift operator `'<<'`, and the value `v`.
- **Output**: A new `Expr` object representing the left shift operation between the current instance and the provided value.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)  (Base Class)


---
#### Expr\.\_\_and\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__and__}} -->
The `__and__` method creates a new `Expr` object representing a bitwise AND operation between the current expression and another value.
- **Inputs**:
    - `v`: The value to be combined with the current expression using a bitwise AND operation.
- **Control Flow**:
    - The method takes a single argument `v`.
    - It returns a new `Expr` object initialized with the current expression as the left operand, the '&' operator, and `v` as the right operand.
- **Output**: A new `Expr` object representing the bitwise AND operation between the current expression and the input value `v`.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)  (Base Class)


---
#### Expr\.\_\_eq\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__eq__}} -->
The `__eq__` method creates an `Expr` object representing an equality operation between the current object and another value.
- **Inputs**:
    - `v`: The value to compare with the current object for equality.
- **Control Flow**:
    - The method takes a single argument `v`.
    - It returns a new `Expr` object initialized with the current object (`self`), the equality operator `'=='`, and the value `v`.
- **Output**: An `Expr` object representing the equality operation between the current object and the provided value.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)  (Base Class)


---
#### Expr\.\_\_ne\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__ne__}} -->
The `__ne__` method creates an `Expr` object representing the 'not equal to' operation between the current object and another value.
- **Inputs**:
    - `v`: The value to compare with the current object for inequality.
- **Control Flow**:
    - The method takes a single argument `v`.
    - It returns a new `Expr` object initialized with the current object (`self`), the '!=' operator, and the value `v`.
- **Output**: An `Expr` object representing the inequality operation between the current object and the provided value.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)  (Base Class)


---
#### Expr\.\_\_ge\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__ge__}} -->
The `__ge__` method creates an `Expr` object representing a greater-than-or-equal-to comparison between the current `Expr` instance and another value.
- **Inputs**:
    - `v`: The value to compare with the current `Expr` instance using the '>=' operator.
- **Control Flow**:
    - The method takes a single argument `v`.
    - It returns a new `Expr` object initialized with the current instance (`self`), the '>=' operator, and the value `v`.
- **Output**: An `Expr` object representing the '>=' operation between the current instance and the provided value `v`.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)  (Base Class)


---
#### Expr\.\_\_int\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__int__}} -->
The `__int__` method converts an `Expr` object to an integer by evaluating its expression.
- **Inputs**: None
- **Control Flow**:
    - The method calls the [`eval`](#Expreval) method on the current instance of `Expr`.
- **Output**: The method returns the integer result of evaluating the expression represented by the `Expr` object.
- **Functions called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.eval`](#Expreval)
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)  (Base Class)


---
#### Expr\.\_\_repr\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__repr__}} -->
The `__repr__` method provides a string representation of an `Expr` object, detailing its function, operation, argument addresses, constant status, and address.
- **Inputs**: None
- **Control Flow**:
    - The method constructs a string using the `format` method.
    - It accesses the `func`, `op`, `args`, `c`, and `addr` attributes of the `Expr` instance.
    - For `args`, it iterates over each argument to extract their `addr` attribute.
    - The constructed string is returned.
- **Output**: A string representation of the `Expr` object, formatted as '[func op args c addr]'.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)  (Base Class)


---
#### Expr\.\_\_hash\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__hash__}} -->
The `__hash__` method returns the unique identifier of the `Expr` instance using the built-in `id` function.
- **Inputs**: None
- **Control Flow**:
    - The method directly returns the result of the `id(self)` function call, which provides the memory address of the instance as a unique identifier.
- **Output**: The output is an integer representing the unique identifier of the `Expr` instance, which is the memory address of the object.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)  (Base Class)


---
#### Expr\.mem<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.mem}} -->
The `mem` method returns a formatted string representation of the memory address or constant address of an expression based on its attributes.
- **Inputs**: None
- **Control Flow**:
    - Checks if `self.addr` is `None`, if so, it raises an error and returns a formatted string of the first element in `self.expr`.
    - If `self.c` is `True`, it returns a formatted string with the constant address `self.caddr`.
    - Otherwise, it returns a formatted string with the memory address `self.addr`.
- **Output**: A string representing the memory or constant address of the expression.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)  (Base Class)


---
#### Expr\.opt\_trace<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.opt_trace}} -->
The `opt_trace` function optimizes the execution trace of expressions by allocating memory for inputs, outputs, and constants, and by managing memory usage and dead code elimination.
- **Inputs**: None
- **Control Flow**:
    - Initialize lists and dictionaries for managing free memory, memory mapping, and constant mapping.
    - Reset various class-level attributes in the `Expr` class to prepare for a new trace optimization.
    - Define a helper function `tmap` to map expressions to memory addresses, either as constants or variables, updating the respective mappings and lists.
    - Define a helper function `tfree` to free memory associated with expressions, marking them as dead if they are not in the memory map.
    - Iterate over the expression trace queue (`Expr.trace_q`) to allocate memory for inputs and constants, updating the maximum input index (`Expr.max_i`).
    - Iterate over the outputs to allocate memory addresses for them.
    - Process the expression trace queue in reverse order to handle each expression, determining its operation and arguments, and freeing its destination memory if it's not an input.
    - Allocate memory for the arguments of each expression using `tmap`.
    - Update operation and argument histograms to track the frequency of operations and argument combinations.
    - Print the operation histogram and argument details for each operation.
    - Calculate and print the total memory usage, including inputs, constants, and variables, and the number of dead expressions.
- **Output**: The function outputs diagnostic information about the operation histogram, argument details, total memory usage, and the number of dead expressions, printed to the console.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)  (Base Class)


---
#### Expr\.dump\_const\_hex<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.dump_const_hex}} -->
The `dump_const_hex` function generates a hexadecimal or COE formatted string representation of constants stored in the `Expr` class, repeated for a specified number of copies.
- **Inputs**:
    - `n`: The number of copies to generate.
    - `r`: The number of rows per copy (not directly used in the function).
    - `format`: The format of the output string, either 'hex' or 'coe', with 'hex' as the default.
- **Control Flow**:
    - Initialize an empty string `hex_st` and a counter `h_i` to zero.
    - Iterate `n` times to generate the specified number of copies.
    - For each iteration, check the `format` parameter.
    - If `format` is 'hex', append a formatted string with a fixed address to `hex_st`.
    - If `format` is 'coe', append COE initialization headers to `hex_st`.
    - Iterate over the constants in `Expr.consts`.
    - For each constant, format it as a 64-character hexadecimal string and append it to `hex_st`.
    - If `format` is 'coe', append a comma before each constant after the first one and increment `h_i`.
    - After processing all constants, if `format` is 'coe', append a semicolon to `hex_st`.
- **Output**: A string containing the formatted hexadecimal or COE representation of the constants.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)  (Base Class)


---
#### Expr\.dump\_instr\_hex<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.dump_instr_hex}} -->
The `dump_instr_hex` function generates a hexadecimal representation of machine instructions based on the format specified and the expression trace from the `Expr` class.
- **Inputs**:
    - `format`: A string specifying the output format, which can be 'hex', 'coe', or 'mif'. The default value is 'hex'.
- **Control Flow**:
    - Initialize the `hex_st` string based on the specified format ('hex', 'coe', or 'mif').
    - Create a memory map (`mmap`) for registers and constants using the `Expr` class's maximum constants and memory values.
    - Iterate over each trace in `Expr.trace_q` to determine the operation and its arguments, mapping them to their respective memory addresses using `mmap`.
    - Determine the operation code (`op`) based on the function and operator of the trace.
    - Calculate the instruction (`h`) by combining the operation code and the mapped addresses of the arguments and destination.
    - Append the formatted instruction to `hex_st` based on the specified format ('mif', 'hex', or 'coe').
    - Iterate over `Expr.outputs` to generate and append output instructions to `hex_st`.
    - If the format is 'coe', append a semicolon to `hex_st` to complete the initialization vector.
    - Return the constructed `hex_st` string.
- **Output**: A string containing the hexadecimal representation of the machine instructions formatted according to the specified format ('hex', 'coe', or 'mif').
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)  (Base Class)


---
#### Expr\.eval\_hex<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.eval_hex}} -->
The `eval_hex` function processes hexadecimal strings representing memory and instruction data, executes the instructions, and returns the results of specific operations.
- **Inputs**:
    - `const_hex`: A string containing hexadecimal data for memory initialization.
    - `instr_hex`: A string containing hexadecimal data for instructions to be executed.
    - `inputs`: A list of input values to be loaded into memory.
- **Control Flow**:
    - Initialize an empty dictionary `mem` and an empty list `rs` to store memory values and results, respectively.
    - Load input values into the `mem` dictionary, using their index as the key.
    - Parse the `const_hex` string line by line to initialize memory values, skipping empty lines and specific initialization lines, and setting memory addresses based on the parsed hexadecimal values.
    - Parse the `instr_hex` string line by line, skipping the first line and specific initialization lines, and convert each line to an integer representing an instruction.
    - For each instruction, extract the operation code and operand addresses using the [`bits`](#bits) function, and retrieve the operand values from memory.
    - Execute the operation specified by the operation code, performing bitwise, arithmetic, or modular arithmetic operations, and store the result in the appropriate memory address.
    - If the operation code corresponds to an output operation, append the result to the `rs` list.
    - Return the `rs` list as a tuple.
- **Output**: A tuple containing the results of the executed instructions that correspond to output operations.
- **Functions called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.bits`](#bits)
    - [`firedancer/src/wiredancer/py/ed25519_lib.add_modp`](#add_modp)
    - [`firedancer/src/wiredancer/py/ed25519_lib.sub_modp`](#sub_modp)
    - [`firedancer/src/wiredancer/py/ed25519_lib.mul_modp3`](#mul_modp3)
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)  (Base Class)



# Functions

---
### bits<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.bits}} -->
The `bits` function extracts a specified number of bits from an integer after right-shifting it by a given number of positions.
- **Inputs**:
    - `n`: The integer from which bits are to be extracted.
    - `b`: The number of bits to extract.
    - `s`: The number of positions to right-shift the integer before extracting bits.
- **Control Flow**:
    - The function right-shifts the integer `n` by `s` positions.
    - It then creates a bitmask by left-shifting 1 by `b` positions and subtracting 1 to get a mask with `b` bits set to 1.
    - The function applies the bitmask to the right-shifted integer using a bitwise AND operation to extract the desired bits.
- **Output**: An integer representing the extracted bits from the input integer `n`.


---
### rand\_int<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.rand_int}} -->
The `rand_int` function generates a random integer with a specified number of bits, defaulting to 256 bits.
- **Inputs**:
    - `w`: An integer representing the number of bits for the random integer, defaulting to 256.
- **Control Flow**:
    - Initialize a variable `n` to 0.
    - Iterate over a range of `w` (default 256) to generate each bit of the random integer.
    - In each iteration, generate a random bit (0 or 1) and shift it left by the current index `i`, then combine it with `n` using a bitwise OR operation.
    - Return the final value of `n` after the loop completes.
- **Output**: Returns an integer composed of `w` random bits.


---
### ternary<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.ternary}} -->
The `ternary` function creates an [`Expr`](#Expr) object representing a ternary operation based on a condition.
- **Inputs**:
    - `c`: A condition that determines which of the two values, `x` or `y`, is selected.
    - `x`: The value to be selected if the condition `c` is true.
    - `y`: The value to be selected if the condition `c` is false.
- **Control Flow**:
    - The function evaluates the condition `c` to determine which value, `x` or `y`, should be selected.
    - It creates an [`Expr`](#Expr) object with the operation 'if', using `x`, `y`, and `c` as arguments.
- **Output**: An [`Expr`](#Expr) object representing the ternary operation with the given condition and values.
- **Functions called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)


---
### ternary\_p<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.ternary_p}} -->
The `ternary_p` function returns one of two values based on a given condition.
- **Inputs**:
    - `c`: A condition that determines which of the two values, `x` or `y`, will be returned.
    - `x`: The value to be returned if the condition `c` is true.
    - `y`: The value to be returned if the condition `c` is false.
- **Control Flow**:
    - The function evaluates the condition `c` to determine which value to return.
    - If `c` is true, the function assigns `x` to `r`.
    - If `c` is false, the function assigns `y` to `r`.
    - The function returns the value stored in `r`.
- **Output**: The function returns the value `x` if the condition `c` is true, otherwise it returns the value `y`.


---
### mul\_modp<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.mul_modp}} -->
The `mul_modp` function performs modular multiplication of two integers `x` and `y` under a modulus `p` using a specific algorithm to handle large numbers.
- **Inputs**:
    - `x`: The first integer operand for the multiplication.
    - `y`: The second integer operand for the multiplication.
    - `p`: The modulus under which the multiplication is performed.
- **Control Flow**:
    - Calculate `p2` as twice the modulus `p`.
    - Compute the product `xy` of `x` and `y`.
    - Extract the lower 256 bits `l` and the higher 256 bits `h` from `xy`.
    - Initialize `m` with `l` and iteratively adjust `m` using a ternary operation to ensure it is less than `p2`.
    - Calculate `mm` as a scaled version of `h` and iteratively adjust `mm` using a ternary operation to ensure it is less than `p2`.
    - Add `mm` to `m` and iteratively adjust `m` using a ternary operation to ensure it is less than `p`.
- **Output**: The function returns the result of the modular multiplication of `x` and `y` under modulus `p`.
- **Functions called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.bits`](#bits)
    - [`firedancer/src/wiredancer/py/ed25519_lib.ternary_p`](#ternary_p)


---
### mul\_modp2<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.mul_modp2}} -->
The `mul_modp2` function performs modular multiplication of two large integers, `x` and `y`, under a modulus `p`, using a specific bit manipulation technique.
- **Inputs**:
    - `x`: The first integer operand for the multiplication, expected to be a large integer.
    - `y`: The second integer operand for the multiplication, also expected to be a large integer.
    - `p`: The modulus under which the multiplication result is computed.
- **Control Flow**:
    - Split the integer `x` into two parts: `x0` (lower 128 bits) and `x1` (upper 127 bits).
    - Split the integer `y` into two parts: `y0` (lower 128 bits) and `y1` (upper 127 bits).
    - Compute the products `x0y0` and `x1y1`.
    - Compute the sums `x0x1` and `y0y1`, and then their product `xy`.
    - Extract bits from `x0y0`, `xy`, and `x1y1` to form `C0`, `C1`, and `C2` respectively.
    - Calculate `C0C2` as the sum of `C0` and `C2`.
    - Initialize `C` with `C0` and add a weighted sum of `C2` to it.
    - Adjust `C` by adding a shifted difference between `C1` and `C0C2`.
    - Extract lower and higher parts of `C` into `Cl` and `Ch`.
    - Compute `Ch19` as a weighted sum of `Ch` and add it to `Cl` to form `Cp`.
    - If `Cp` is greater than or equal to `p`, subtract `p` from `Cp`.
- **Output**: The function returns the result of the modular multiplication of `x` and `y` under modulus `p`, as an integer.
- **Functions called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.bits`](#bits)


---
### mul\_modp3<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.mul_modp3}} -->
The `mul_modp3` function performs modular multiplication of two large integers under a given modulus using a specific bit manipulation technique.
- **Inputs**:
    - `x`: The first integer operand for the multiplication, expected to be a large integer.
    - `y`: The second integer operand for the multiplication, also expected to be a large integer.
    - `p`: The modulus under which the multiplication result is to be reduced.
- **Control Flow**:
    - Extracts the lower 128 bits and the next 127 bits of both x and y using the [`bits`](#bits) function.
    - Calculates intermediate products A, B, C, and D using the extracted bits and the [`bits`](#bits) function to ensure the results fit within specified bit lengths.
    - Combines these intermediate products into a single value E using bit shifts and additions.
    - Splits E into two parts, El and Eh, using the [`bits`](#bits) function.
    - Combines El and Eh into a new value F using bit shifts and additions.
    - Reduces F modulo p by subtracting p if F is greater than or equal to p, resulting in G.
    - Returns the final result G.
- **Output**: The function returns the result of the modular multiplication of x and y under modulus p, reduced to fit within the modulus.
- **Functions called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.bits`](#bits)


---
### flip<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.flip}} -->
The `flip` function reverses the bits of a given integer `n` up to a specified number of bits `b`.
- **Inputs**:
    - `n`: The integer whose bits are to be flipped.
    - `b`: The number of bits to consider for flipping.
- **Control Flow**:
    - Initialize `nn` to 0 to store the result of the flipped bits.
    - Iterate over a range of `b`, which is the number of bits to flip.
    - In each iteration, check if the least significant bit of `n` is 1 or 0.
    - If the least significant bit of `n` is 1, set `_` to 0; otherwise, set `_` to 1.
    - Shift `_` left by `i` positions and perform a bitwise OR with `nn` to set the corresponding bit in `nn`.
    - Right shift `n` by 1 to process the next bit in the next iteration.
    - Return the final value of `nn` after all bits have been processed.
- **Output**: The function returns an integer `nn` which is the result of flipping the bits of `n` up to `b` bits.


---
### mul\_modp4<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.mul_modp4}} -->
The `mul_modp4` function performs modular multiplication of two large integers under a given modulus using a specific algorithm that involves bit manipulation and arithmetic operations.
- **Inputs**:
    - `x`: The first integer operand for the multiplication, expected to be a large integer.
    - `y`: The second integer operand for the multiplication, expected to be a large integer.
    - `p`: The modulus under which the multiplication result is to be reduced.
- **Control Flow**:
    - Split the input integers `x` and `y` into two parts each: `x0`, `x1` and `y0`, `y1` using the [`bits`](#bits) function.
    - Compute intermediate values `A` and `B` as the sum of the parts of `x` and `y`, respectively, and reduce them to 129 bits.
    - Calculate `C` as the product of `x0` and `y0`, and `D` as the product of `x1` and `y1`, reducing them to 256 and 254 bits, respectively.
    - Compute `M` as the product of `A` and `B`, reduced to 258 bits, and `N` as a bit-shifted and combined version of `D`, reduced to 260 bits.
    - Print intermediate values `A`, `B`, `C`, `D`, `M`, and `N` for debugging purposes.
    - Calculate `E` using a combination of `C`, `N`, `M`, and bit-shifted versions of `C` and `D`.
    - Print the intermediate value `E` for debugging purposes.
    - Split `E` into `El` and `Eh` using the [`bits`](#bits) function, reducing them to 255 and 132 bits, respectively.
    - Compute `F` as a combination of `El` and bit-shifted versions of `Eh`.
    - Calculate `G` as `F` reduced by `p` if `F` is greater than or equal to `p`.
    - Return the final result `G`.
- **Output**: The function returns the result of the modular multiplication of `x` and `y` under modulus `p`, represented as an integer.
- **Functions called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.bits`](#bits)


---
### kpow\_2k<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.kpow_2k}} -->
The `kpow_2k` function computes the result of raising a number to the power of 2^y modulo p using repeated squaring.
- **Inputs**:
    - `x`: The base number to be exponentiated.
    - `y`: The exponent, which determines how many times the base is squared.
    - `p`: The modulus used for the operation.
- **Control Flow**:
    - The function iterates `y` times, each time squaring the current value of `x` and taking the result modulo `p`.
    - In each iteration, the [`Expr`](#Expr) class is used to create an expression that represents the operation `x * x % p`.
    - The result of the expression is assigned back to `x`, effectively updating `x` to `x^2 % p` in each iteration.
- **Output**: The function returns the final value of `x` after it has been squared `y` times, each time taking the result modulo `p`.
- **Functions called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)


---
### kpow\_ed250<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.kpow_ed250}} -->
The `kpow_ed250` function computes a series of modular exponentiations and multiplications to return three specific intermediate results of the computation.
- **Inputs**:
    - `x`: The base integer for the modular exponentiation.
    - `p`: The modulus used for the modular arithmetic operations.
- **Control Flow**:
    - Initialize t0 as the square of x modulo p.
    - Compute t00 as the square of t0 modulo p.
    - Compute t1 as the square of t00 modulo p.
    - Compute t2 as x multiplied by t1 modulo p, representing x^(2^(1001)).
    - Compute t3 as t0 multiplied by t2 modulo p.
    - Compute t4 as the square of t3 modulo p.
    - Compute t5 as t2 multiplied by t4 modulo p.
    - Compute t6 by raising t5 to the power of 2^5 modulo p using kpow_2k.
    - Compute t7 as t6 multiplied by t5 modulo p.
    - Compute t8 by raising t7 to the power of 2^10 modulo p using kpow_2k.
    - Compute t9 as t8 multiplied by t7 modulo p.
    - Compute t10 by raising t9 to the power of 2^20 modulo p using kpow_2k.
    - Compute t11 as t10 multiplied by t9 modulo p.
    - Compute t12 by raising t11 to the power of 2^10 modulo p using kpow_2k.
    - Compute t13 as t12 multiplied by t7 modulo p.
    - Compute t14 by raising t13 to the power of 2^50 modulo p using kpow_2k.
    - Compute t15 as t14 multiplied by t13 modulo p.
    - Compute t16 by raising t15 to the power of 2^100 modulo p using kpow_2k.
    - Compute t17 as t16 multiplied by t15 modulo p.
    - Compute t18 by raising t17 to the power of 2^50 modulo p using kpow_2k.
    - Compute t19 as t18 multiplied by t13 modulo p.
    - Return the values of t0, t3, and t19.
- **Output**: A tuple containing three Expr objects: t0, t3, and t19, representing specific intermediate results of the computation.
- **Functions called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)
    - [`firedancer/src/wiredancer/py/ed25519_lib.kpow_2k`](#kpow_2k)


---
### kpow\_ed255192<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.kpow_ed255192}} -->
The function `kpow_ed255192` computes a specific power of an input number modulo a prime using a sequence of modular multiplications and squarings.
- **Inputs**:
    - `x`: The base number to be exponentiated.
    - `p`: The modulus, typically a prime number, used for the modular arithmetic.
- **Control Flow**:
    - Call [`kpow_ed250`](#kpow_ed250) with inputs `x` and `p` to compute intermediate results `t0`, `t3`, and `t19`.
    - Compute `t20` by raising `t19` to the power of 2^5 modulo `p` using the [`kpow_2k`](#kpow_2k) function.
    - Compute `t21` by multiplying `t20` and `t3` modulo `p` using the [`Expr`](#Expr) class with `mul_modp` function.
    - Return the result `t21`.
- **Output**: The function returns an [`Expr`](#Expr) object representing the result of the modular exponentiation operation.
- **Functions called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.kpow_ed250`](#kpow_ed250)
    - [`firedancer/src/wiredancer/py/ed25519_lib.kpow_2k`](#kpow_2k)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)


---
### kpow\_ed2551938<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.kpow_ed2551938}} -->
The function `kpow_ed2551938` computes a specific power of a number modulo a prime using a sequence of modular multiplications and squarings.
- **Inputs**:
    - `x`: The base integer to be exponentiated.
    - `p`: The modulus, typically a prime number, used for the modular arithmetic operations.
- **Control Flow**:
    - Calls the function [`kpow_ed250`](#kpow_ed250) with inputs `x` and `p` to compute intermediate results `t0`, `t3`, and `t19`.
    - Uses the function [`kpow_2k`](#kpow_2k) to square `t19` twice modulo `p`, resulting in `t20`.
    - Creates an [`Expr`](#Expr) object to compute the modular multiplication of `t20` and `t0` modulo `p`, resulting in `t21`.
    - Returns the result `t21`.
- **Output**: The function returns an [`Expr`](#Expr) object representing the result of the modular exponentiation operation.
- **Functions called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.kpow_ed250`](#kpow_ed250)
    - [`firedancer/src/wiredancer/py/ed25519_lib.kpow_2k`](#kpow_2k)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)


---
### kpow<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.kpow}} -->
The `kpow` function computes the modular exponentiation of a base `x` raised to the power `y` modulo `p` using a binary exponentiation method.
- **Inputs**:
    - `x`: The base number to be exponentiated, represented as an [`Expr`](#Expr) object.
    - `y`: The exponent to which the base `x` is raised, initially converted to an [`Expr`](#Expr) object.
    - `p`: The modulus used for the modular exponentiation, represented as an [`Expr`](#Expr) object.
- **Control Flow**:
    - Initialize `a` as an [`Expr`](#Expr) object with value 1, which will hold the result of the exponentiation.
    - Convert `y` to an [`Expr`](#Expr) object and determine its bit length `wy`.
    - Iterate over each bit of `y` from least significant to most significant (total `wy` iterations).
    - In each iteration, use a ternary operation to determine if the current bit of `y` is set, and accordingly multiply `a` by `x` or 1 using modular multiplication (`mul_modp`).
    - Square `x` using modular multiplication (`mul_modp`) to prepare for the next bit.
    - Right shift `y` by one bit to process the next bit in the subsequent iteration.
    - Return the final result stored in `a`.
- **Output**: The function returns an [`Expr`](#Expr) object representing the result of `x` raised to the power `y` modulo `p`.
- **Functions called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](#Expr)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.eval`](#Expreval)
    - [`firedancer/src/wiredancer/py/ed25519_lib.ternary`](#ternary)


---
### add\_modp<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.add_modp}} -->
The `add_modp` function computes the sum of two integers modulo a third integer.
- **Inputs**:
    - `a`: The first integer to be added.
    - `b`: The second integer to be added.
    - `p`: The modulus for the addition operation.
- **Control Flow**:
    - The function takes three arguments: `a`, `b`, and `p`.
    - It calculates the sum of `a` and `b`.
    - The result is then taken modulo `p`.
    - The final result is returned.
- **Output**: The function returns the result of `(a + b) % p`, which is an integer.


---
### sub\_modp<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.sub_modp}} -->
The `sub_modp` function computes the subtraction of two numbers modulo a given prime, ensuring the result is non-negative.
- **Inputs**:
    - `a`: The first integer operand in the subtraction.
    - `b`: The second integer operand in the subtraction.
    - `p`: The modulus, a prime number, used to adjust the result if it is negative.
- **Control Flow**:
    - Check if 'a' is greater than or equal to 'b'.
    - If true, return the result of 'a - b'.
    - If false, return the result of 'a - b + p' to ensure the result is non-negative.
- **Output**: An integer representing the result of the subtraction of 'a' and 'b', adjusted by 'p' if necessary to ensure non-negativity.


---
### dsdp\_sel<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.dsdp_sel}} -->
The `dsdp_sel` function determines a selection value based on the bitwise AND operation of specific bits from two input integers.
- **Inputs**:
    - `sh2`: An integer from which a specific bit (bit 255) is extracted for comparison.
    - `h`: An integer from which a specific bit (bit 255) is extracted for comparison.
- **Control Flow**:
    - Extracts the 255th bit from the integer `sh2` and assigns it to `b0`.
    - Extracts the 255th bit from the integer `h` and assigns it to `b1`.
    - Performs a bitwise AND operation on `b0` and `b1`, storing the result in `b0b1`.
    - If `b0b1` is non-zero, returns 3.
    - If `b1` is non-zero, returns 2.
    - If `b0` is non-zero, returns 1.
    - If none of the above conditions are met, returns 0.
- **Output**: An integer value (0, 1, 2, or 3) indicating the result of the bitwise operations and conditions.
- **Functions called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.bits`](#bits)


---
### ternary\_dsdp\_x<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.ternary_dsdp_x}} -->
The function `ternary_dsdp_x` selects and returns a value based on the input selector `sel` from a set of predefined options.
- **Inputs**:
    - `sel`: An integer selector that determines which value to return.
    - `A`: A value to be returned if `sel` equals 2.
    - `T`: A value to be returned if `sel` does not match any specific case.
- **Control Flow**:
    - Check if `sel` is 0, and return 0 if true.
    - Check if `sel` is 1, and return `ref_ed25519.G[0]` if true.
    - Check if `sel` is 2, and return `A` if true.
    - If none of the above conditions are met, return `T`.
- **Output**: The function returns an integer or a value from the inputs based on the selector `sel`.


---
### ternary\_dsdp\_y<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.ternary_dsdp_y}} -->
The function `ternary_dsdp_y` returns a specific value based on the input selection parameter `sel`, choosing between constants, a reference value, or the provided arguments `A` and `T`.
- **Inputs**:
    - `sel`: An integer that determines which value to return; it acts as a selector.
    - `A`: A value to be returned if `sel` equals 2.
    - `T`: A value to be returned if `sel` does not match any of the predefined cases (0, 1, or 2).
- **Control Flow**:
    - Check if `sel` is equal to 0; if true, return 1.
    - Check if `sel` is equal to 1; if true, return the second element of `ref_ed25519.G`.
    - Check if `sel` is equal to 2; if true, return `A`.
    - If none of the above conditions are met, return `T`.
- **Output**: The function returns an integer or a value from the inputs `A` or `T`, depending on the value of `sel`.


---
### ternary\_dsdp\_z<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.ternary_dsdp_z}} -->
The function `ternary_dsdp_z` returns a value based on the selection parameter `sel`, choosing between constants, a reference value, or input parameters `A` and `T`.
- **Inputs**:
    - `sel`: An integer that determines which value to return; it acts as a selector.
    - `A`: A value that is returned if `sel` equals 2.
    - `T`: A value that is returned if `sel` is not 0, 1, or 2.
- **Control Flow**:
    - Check if `sel` is 0; if true, return 1.
    - Check if `sel` is 1; if true, return `ref_ed25519.G[2]`.
    - Check if `sel` is 2; if true, return `A`.
    - If none of the above conditions are met, return `T`.
- **Output**: The function returns an integer or a value from the inputs `A` or `T`, depending on the value of `sel`.


---
### ternary\_dsdp\_t<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.ternary_dsdp_t}} -->
The function `ternary_dsdp_t` returns a specific value based on the selection parameter `sel` from a set of predefined options.
- **Inputs**:
    - `sel`: An integer that determines which value to return; it acts as a selector.
    - `A`: A value that is returned if `sel` equals 2.
    - `T`: A value that is returned if `sel` does not match any of the predefined cases (0, 1, or 2).
- **Control Flow**:
    - Check if `sel` is 0; if true, return 0.
    - Check if `sel` is 1; if true, return the fourth element of `ref_ed25519.G`.
    - Check if `sel` is 2; if true, return `A`.
    - If none of the above conditions are met, return `T`.
- **Output**: The function returns an integer or a value from the inputs `A` or `T`, depending on the value of `sel`.


---
### ed25519\_dsdp\_mul<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.ed25519_dsdp_mul}} -->
The `ed25519_dsdp_mul` function performs a double-scalar multiplication on elliptic curve points using the Ed25519 curve.
- **Inputs**:
    - `A`: A tuple representing a point on the Ed25519 curve.
    - `As`: An integer representing a scalar multiplier for point A.
    - `Gs`: An integer representing a scalar multiplier for the base point G.
    - `W_S`: An integer representing the number of iterations, defaulting to 256.
- **Control Flow**:
    - Initialize Z as a point (0, 1, 1, 0) and double it using `ref_ed25519.point_add`.
    - Set G to the base point of the Ed25519 curve and T to the sum of A and G.
    - Iterate W_S times (default 256), performing bitwise operations to determine the least significant bits of As and Gs.
    - Shift As and Gs left by one bit each iteration.
    - Select coordinates for a new point Q based on the least significant bits of As and Gs, using ternary logic to choose between G, A, and T.
    - Double the point Z and add Q to it using `ref_ed25519.point_add`.
- **Output**: Returns a tuple representing the resulting point on the Ed25519 curve after the double-scalar multiplication.
- **Functions called**:
    - [`firedancer/src/wiredancer/py/ref_ed25519.point_add`](ref_ed25519.py.driver.md#point_add)


