# Purpose
The provided C source code is an implementation of arithmetic operations for the finite field defined by the prime \(2^{255} - 19\), commonly associated with the Curve25519 elliptic curve used in cryptographic applications. This code is part of the Fiat Cryptography project, which aims to generate formally verified cryptographic arithmetic code. The file includes functions for various field operations such as addition, subtraction, multiplication, squaring, and conversion between different representations (e.g., to and from byte arrays). These operations are crucial for implementing elliptic curve cryptography, particularly for key exchange protocols like Diffie-Hellman.

The code defines two types of field elements: `fiat_25519_loose_field_element` and `fiat_25519_tight_field_element`, which represent field elements with different bounds. The functions are implemented with inline assembly optimizations for specific compilers (GCC and Clang) and are designed to be used in environments that support two's complement arithmetic. The operations are performed using a combination of 25-bit and 26-bit limbs to efficiently handle the 255-bit field size. The file does not define a main function, indicating that it is intended to be used as a library or module within a larger cryptographic system. The functions are static and inline, suggesting they are meant for internal use within a single compilation unit, optimizing for performance by reducing function call overhead.
# Imports and Dependencies

---
- `stdint.h`


# Functions

---
### fiat\_25519\_value\_barrier\_u32<!-- {{#callable:fiat_25519_value_barrier_u32}} -->
The function `fiat_25519_value_barrier_u32` acts as a compiler barrier for a 32-bit unsigned integer, preventing certain compiler optimizations.
- **Inputs**:
    - `a`: A 32-bit unsigned integer input.
- **Control Flow**:
    - The function uses an inline assembly statement with an empty string to act as a compiler barrier.
    - The input variable 'a' is marked as a read-write operand, ensuring that the compiler does not optimize away the variable or reorder operations around it.
    - The function returns the input value 'a' unchanged.
- **Output**: The function returns the same 32-bit unsigned integer that was passed as input.


---
### fiat\_25519\_addcarryx\_u26<!-- {{#callable:fiat_25519_addcarryx_u26}} -->
The function `fiat_25519_addcarryx_u26` performs addition of three numbers with a carry, and outputs the result modulo 2^26 and the carry.
- **Inputs**:
    - `out1`: A pointer to a uint32_t where the result of the addition modulo 2^26 will be stored.
    - `out2`: A pointer to a fiat_25519_uint1 where the carry resulting from the addition will be stored.
    - `arg1`: A fiat_25519_uint1 representing the carry-in for the addition.
    - `arg2`: A uint32_t representing the first operand for the addition.
    - `arg3`: A uint32_t representing the second operand for the addition.
- **Control Flow**:
    - Calculate the sum of arg1, arg2, and arg3, storing it in x1.
    - Compute x2 as x1 modulo 2^26, which is the lower 26 bits of x1.
    - Compute x3 as the carry by right-shifting x1 by 26 bits.
    - Store x2 in the location pointed to by out1.
    - Store x3 in the location pointed to by out2.
- **Output**: The function outputs the result of the addition modulo 2^26 in out1 and the carry in out2.


---
### fiat\_25519\_subborrowx\_u26<!-- {{#callable:fiat_25519_subborrowx_u26}} -->
The function `fiat_25519_subborrowx_u26` performs a subtraction with borrow on two 26-bit integers and a borrow bit, producing a result and a borrow out.
- **Inputs**:
    - `out1`: A pointer to a `uint32_t` where the result of the subtraction will be stored.
    - `out2`: A pointer to a `fiat_25519_uint1` where the borrow out will be stored.
    - `arg1`: A `fiat_25519_uint1` representing the initial borrow bit, which is either 0 or 1.
    - `arg2`: A `uint32_t` representing the first 26-bit integer operand.
    - `arg3`: A `uint32_t` representing the second 26-bit integer operand to be subtracted from the first.
- **Control Flow**:
    - Calculate the intermediate subtraction result `x1` as `arg2 - arg1 - arg3` cast to `int32_t` to handle potential negative values.
    - Compute the borrow `x2` by right-shifting `x1` by 26 bits, effectively extracting the sign bit as a borrow indicator.
    - Mask `x1` with `0x3ffffff` to ensure the result fits within 26 bits, storing it in `x3`.
    - Store `x3` in the location pointed to by `out1`.
    - Store the negated borrow `x2` in the location pointed to by `out2`, ensuring it is cast to `fiat_25519_uint1`.
- **Output**: The function outputs the result of the subtraction in `out1` and the borrow out in `out2`.


---
### fiat\_25519\_addcarryx\_u25<!-- {{#callable:fiat_25519_addcarryx_u25}} -->
The function `fiat_25519_addcarryx_u25` performs an addition of three numbers with a carry, reducing the result modulo 2^25 and providing the carry for the next higher bit.
- **Inputs**:
    - `out1`: A pointer to a uint32_t where the result of the addition modulo 2^25 will be stored.
    - `out2`: A pointer to a fiat_25519_uint1 where the carry resulting from the addition will be stored.
    - `arg1`: A fiat_25519_uint1 representing the carry-in for the addition.
    - `arg2`: A uint32_t representing the first operand of the addition.
    - `arg3`: A uint32_t representing the second operand of the addition.
- **Control Flow**:
    - Compute the sum of arg1, arg2, and arg3, storing the result in x1.
    - Calculate x2 as x1 modulo 2^25, which is the lower 25 bits of x1.
    - Calculate x3 as the carry, which is the upper bits of x1 shifted right by 25.
    - Store x2 in the location pointed to by out1.
    - Store x3 in the location pointed to by out2.
- **Output**: The function outputs the result of the addition modulo 2^25 in *out1 and the carry in *out2.


---
### fiat\_25519\_subborrowx\_u25<!-- {{#callable:fiat_25519_subborrowx_u25}} -->
The function `fiat_25519_subborrowx_u25` performs a subtraction with borrow on three inputs, producing a result modulo 2^25 and a borrow indicator.
- **Inputs**:
    - `out1`: A pointer to a uint32_t where the result of the subtraction will be stored.
    - `out2`: A pointer to a fiat_25519_uint1 where the borrow indicator will be stored.
    - `arg1`: A fiat_25519_uint1 representing the first operand, which is subtracted from the second operand.
    - `arg2`: A uint32_t representing the second operand, from which the first operand and the third operand are subtracted.
    - `arg3`: A uint32_t representing the third operand, which is subtracted from the second operand.
- **Control Flow**:
    - Calculate the intermediate result x1 by subtracting arg1 and arg3 from arg2, casting the result to int32_t.
    - Compute the borrow x2 by right-shifting x1 by 25 bits and casting to fiat_25519_int1.
    - Compute the result x3 by masking x1 with 0x1ffffff to get the lower 25 bits.
    - Store x3 in the location pointed to by out1.
    - Store the negation of x2 in the location pointed to by out2.
- **Output**: The function outputs the result of the subtraction modulo 2^25 in out1 and a borrow indicator in out2.


---
### fiat\_25519\_cmovznz\_u32<!-- {{#callable:fiat_25519_cmovznz_u32}} -->
The function `fiat_25519_cmovznz_u32` performs a conditional move operation on two 32-bit unsigned integers based on a single-bit condition.
- **Inputs**:
    - `out1`: A pointer to a 32-bit unsigned integer where the result will be stored.
    - `arg1`: A single-bit unsigned integer (0 or 1) that acts as the condition for the move operation.
    - `arg2`: A 32-bit unsigned integer that will be selected if `arg1` is 0.
    - `arg3`: A 32-bit unsigned integer that will be selected if `arg1` is 1.
- **Control Flow**:
    - The function first negates `arg1` twice to ensure it is either 0 or 1, storing the result in `x1`.
    - It calculates `x2` as the bitwise AND of the negated `x1` and the maximum 32-bit unsigned integer value, effectively creating a mask of either all 0s or all 1s.
    - The function then uses [`fiat_25519_value_barrier_u32`](#fiat_25519_value_barrier_u32) to apply a value barrier to `x2` and its bitwise NOT, ensuring no unintended optimizations occur.
    - It computes `x3` by conditionally selecting between `arg2` and `arg3` using the masked values, effectively performing the conditional move.
    - Finally, the result `x3` is stored in the location pointed to by `out1`.
- **Output**: The function outputs the selected 32-bit unsigned integer, either `arg2` or `arg3`, based on the value of `arg1`, stored in the location pointed to by `out1`.
- **Functions called**:
    - [`fiat_25519_value_barrier_u32`](#fiat_25519_value_barrier_u32)


---
### fiat\_25519\_carry\_mul<!-- {{#callable:fiat_25519_carry_mul}} -->
The function `fiat_25519_carry_mul` multiplies two field elements and reduces the result modulo 2^255 - 19.
- **Inputs**:
    - `out1`: A `fiat_25519_tight_field_element` array of size 10 to store the result of the multiplication.
    - `arg1`: A `fiat_25519_loose_field_element` array of size 10 representing the first operand.
    - `arg2`: A `fiat_25519_loose_field_element` array of size 10 representing the second operand.
- **Control Flow**:
    - Initialize 147 local variables to store intermediate results of the multiplication and reduction process.
    - Perform a series of multiplications between elements of `arg1` and `arg2`, applying specific scaling factors (0x13 and 0x26) to certain terms to account for the field's structure.
    - Accumulate the results of these multiplications into several intermediate variables, each representing a partial sum of the product.
    - Perform a series of right shifts and bitwise operations to reduce the accumulated results, ensuring each element fits within the bounds of the field representation.
    - Apply a final reduction step to ensure the result is within the field's bounds, using a carry chain to propagate any overflow.
    - Store the reduced result into the `out1` array.
- **Output**: The function outputs the reduced product of `arg1` and `arg2` in the `out1` array, which is a `fiat_25519_tight_field_element`.


---
### fiat\_25519\_carry\_square<!-- {{#callable:fiat_25519_carry_square}} -->
The function `fiat_25519_carry_square` squares a field element and reduces the result modulo 2^255 - 19.
- **Inputs**:
    - `out1`: A fiat_25519_tight_field_element array of size 10 to store the result.
    - `arg1`: A fiat_25519_loose_field_element array of size 10 representing the input field element to be squared.
- **Control Flow**:
    - Initialize multiple uint32_t and uint64_t variables for intermediate calculations.
    - Compute the product of each element in `arg1` with itself and other elements, applying specific multipliers and shifts to maintain the field's properties.
    - Accumulate the results of these multiplications into several uint64_t variables, representing the intermediate sums of the squared terms.
    - Perform a series of carry operations to ensure that each element of the result fits within the specified bounds of the field element representation.
    - Store the final reduced and carried results into the `out1` array.
- **Output**: The function outputs the squared and reduced field element in the `out1` array, which is a fiat_25519_tight_field_element.


---
### fiat\_25519\_carry<!-- {{#callable:fiat_25519_carry}} -->
The function `fiat_25519_carry` reduces a loose field element to a tight field element by performing a series of carry operations to ensure each limb is within its respective bound.
- **Inputs**:
    - `out1`: A pointer to a `fiat_25519_tight_field_element` array where the result will be stored.
    - `arg1`: A `fiat_25519_loose_field_element` array representing the input field element to be reduced.
- **Control Flow**:
    - Extracts the first element of `arg1` into `x1` and performs a right shift by 26 bits, adding the result to the second element of `arg1` to get `x2`.
    - Continues the carry chain by right shifting `x2` by 25 bits and adding it to the third element of `arg1` to get `x3`, and so on, alternating between 26 and 25 bit shifts.
    - After processing all elements, the function performs a final carry operation on `x10`, the last element, and adjusts `x1` by adding a multiple of 19 if necessary.
    - The results are stored in `out1`, ensuring each element is within its respective bound by applying bitwise AND operations with constants `0x3ffffff` or `0x1ffffff`.
- **Output**: The function outputs a `fiat_25519_tight_field_element` array `out1` with each element reduced to fit within its respective bound.


---
### fiat\_25519\_add<!-- {{#callable:fiat_25519_add}} -->
The function `fiat_25519_add` performs element-wise addition of two 25519 field elements and stores the result in a loose field element.
- **Inputs**:
    - `out1`: A fiat_25519_loose_field_element array of size 10 where the result of the addition will be stored.
    - `arg1`: A fiat_25519_tight_field_element array of size 10 representing the first operand in the addition.
    - `arg2`: A fiat_25519_tight_field_element array of size 10 representing the second operand in the addition.
- **Control Flow**:
    - Initialize ten uint32_t variables (x1 to x10) to store intermediate results of the addition.
    - For each index from 0 to 9, add the corresponding elements of arg1 and arg2, and store the result in the corresponding x variable.
    - Assign the results stored in x1 to x10 to the corresponding indices of the out1 array.
- **Output**: The function outputs the sum of the two input field elements in the out1 array, which is a loose field element.


---
### fiat\_25519\_sub<!-- {{#callable:fiat_25519_sub}} -->
The function `fiat_25519_sub` performs subtraction of two field elements in the context of the 25519 curve, with specific adjustments to ensure the result remains within valid bounds.
- **Inputs**:
    - `out1`: A `fiat_25519_loose_field_element` array of size 10 that will store the result of the subtraction.
    - `arg1`: A `fiat_25519_tight_field_element` array of size 10 representing the first operand in the subtraction.
    - `arg2`: A `fiat_25519_tight_field_element` array of size 10 representing the second operand in the subtraction.
- **Control Flow**:
    - Initialize ten 32-bit unsigned integers (x1 to x10) to store intermediate subtraction results.
    - For each element index from 0 to 9, compute the subtraction of the corresponding elements in `arg1` and `arg2`, adding a constant to ensure the result is non-negative and within bounds.
    - Store each computed result in the corresponding index of the `out1` array.
- **Output**: The function outputs the result of the subtraction in the `out1` array, which is a `fiat_25519_loose_field_element` with adjusted bounds to accommodate the subtraction.


---
### fiat\_25519\_opp<!-- {{#callable:fiat_25519_opp}} -->
The function `fiat_25519_opp` computes the negation of a field element in the 25519 curve context.
- **Inputs**:
    - `out1`: A `fiat_25519_loose_field_element` array of size 10 where the result will be stored.
    - `arg1`: A `fiat_25519_tight_field_element` array of size 10 representing the field element to be negated.
- **Control Flow**:
    - Initialize ten uint32_t variables x1 to x10.
    - Compute the negation of each element in `arg1` by subtracting it from a constant specific to its position, storing the result in x1 to x10.
    - Assign the computed negated values x1 to x10 to the corresponding positions in the `out1` array.
- **Output**: The function outputs the negated field element in the `out1` array, which is a `fiat_25519_loose_field_element`.


---
### fiat\_25519\_selectznz<!-- {{#callable:fiat_25519_selectznz}} -->
The function `fiat_25519_selectznz` performs a conditional selection between two arrays of 10 unsigned 32-bit integers based on a single-bit flag.
- **Inputs**:
    - `out1`: An array of 10 unsigned 32-bit integers where the result of the selection will be stored.
    - `arg1`: A single-bit flag (0 or 1) that determines which of the two input arrays will be selected.
    - `arg2`: An array of 10 unsigned 32-bit integers representing the first option for selection.
    - `arg3`: An array of 10 unsigned 32-bit integers representing the second option for selection.
- **Control Flow**:
    - The function iterates over each index from 0 to 9.
    - For each index, it calls [`fiat_25519_cmovznz_u32`](#fiat_25519_cmovznz_u32) to perform a conditional move based on `arg1`.
    - If `arg1` is 0, the corresponding element from `arg2` is selected; otherwise, the element from `arg3` is selected.
    - The selected element is stored in the corresponding index of `out1`.
- **Output**: The function outputs the selected array in `out1`, which contains elements from either `arg2` or `arg3` based on the value of `arg1`.
- **Functions called**:
    - [`fiat_25519_cmovznz_u32`](#fiat_25519_cmovznz_u32)


---
### fiat\_25519\_to\_bytes<!-- {{#callable:fiat_25519_to_bytes}} -->
The function `fiat_25519_to_bytes` serializes a field element into a 32-byte array in little-endian order.
- **Inputs**:
    - `out1`: A 32-byte array where the serialized field element will be stored.
    - `arg1`: A `fiat_25519_tight_field_element`, which is an array of 10 unsigned 32-bit integers representing the field element to be serialized.
- **Control Flow**:
    - Initialize several temporary variables for intermediate calculations.
    - Perform a series of subtraction operations with borrow to adjust the field element values, ensuring they fit within the required bounds.
    - Use conditional move operations to handle potential underflow from the subtraction operations.
    - Perform a series of addition operations with carry to finalize the adjusted field element values.
    - Shift and mask the adjusted values to extract individual bytes, storing them in the output array `out1` in little-endian order.
- **Output**: The function outputs a 32-byte array `out1` containing the serialized representation of the input field element `arg1`.
- **Functions called**:
    - [`fiat_25519_subborrowx_u26`](#fiat_25519_subborrowx_u26)
    - [`fiat_25519_subborrowx_u25`](#fiat_25519_subborrowx_u25)
    - [`fiat_25519_cmovznz_u32`](#fiat_25519_cmovznz_u32)
    - [`fiat_25519_addcarryx_u26`](#fiat_25519_addcarryx_u26)
    - [`fiat_25519_addcarryx_u25`](#fiat_25519_addcarryx_u25)


---
### fiat\_25519\_from\_bytes<!-- {{#callable:fiat_25519_from_bytes}} -->
The function `fiat_25519_from_bytes` deserializes a 32-byte array into a 10-element field element representation in the context of the 25519 curve.
- **Inputs**:
    - `out1`: A `fiat_25519_tight_field_element` array of size 10 that will store the deserialized field element.
    - `arg1`: A 32-byte array of type `uint8_t` representing the serialized field element in little-endian order.
- **Control Flow**:
    - Extracts and shifts bits from the input byte array `arg1` to form 32-bit integers, each representing a part of the field element.
    - Combines these integers using bitwise operations and addition to form the 10-element field element representation.
    - Applies bitwise AND operations with constants to ensure each element fits within the required bit bounds (either 25 or 26 bits).
    - Stores the resulting field element parts into the `out1` array.
- **Output**: The function outputs a 10-element array `out1` representing the deserialized field element, with each element fitting within specific bit bounds.


---
### fiat\_25519\_relax<!-- {{#callable:fiat_25519_relax}} -->
The function `fiat_25519_relax` converts a tight field element into a loose field element by copying its values.
- **Inputs**:
    - `out1`: A `fiat_25519_loose_field_element` array of size 10 that will store the output loose field element.
    - `arg1`: A `fiat_25519_tight_field_element` array of size 10 representing the input tight field element to be converted.
- **Control Flow**:
    - The function initializes ten local variables (x1 to x10) to store each element of the input array `arg1`.
    - Each element of `arg1` is assigned to the corresponding element in the output array `out1`.
- **Output**: The function outputs a loose field element in `out1` that is identical to the input tight field element `arg1`.


---
### fiat\_25519\_carry\_scmul\_121666<!-- {{#callable:fiat_25519_carry_scmul_121666}} -->
The function `fiat_25519_carry_scmul_121666` multiplies a field element by the constant 121666 and reduces the result modulo the prime 2^255 - 19.
- **Inputs**:
    - `out1`: A fiat_25519_tight_field_element array of size 10 to store the result.
    - `arg1`: A fiat_25519_loose_field_element array of size 10 representing the input field element to be multiplied.
- **Control Flow**:
    - Initialize 10 uint64_t variables (x1 to x10) to store the product of each element of arg1 with 121666.
    - Perform a series of additions and bitwise operations to handle carry propagation across the elements, ensuring each element fits within its respective bit bounds.
    - Use a loop-like structure to propagate carries from lower to higher indices, adjusting each element to fit within its bounds.
    - Apply a final carry adjustment to ensure the result is reduced modulo 2^255 - 19.
    - Store the final reduced values into the out1 array.
- **Output**: The function outputs the result of the multiplication and reduction in the out1 array, which is a fiat_25519_tight_field_element.


