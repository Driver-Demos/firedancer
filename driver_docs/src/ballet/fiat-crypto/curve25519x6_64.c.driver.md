# Purpose
The provided C source code is an implementation of arithmetic operations for the 25519 elliptic curve, specifically using a representation known as "unsaturated Solinas" with a 25519x6 configuration. This code is part of the Fiat Cryptography library, which is designed to generate efficient and formally verified cryptographic arithmetic code. The primary purpose of this file is to define functions that perform arithmetic operations such as addition, subtraction, multiplication, squaring, and scalar multiplication on field elements of the curve, as well as conversion functions to and from byte arrays. These operations are crucial for cryptographic algorithms that rely on elliptic curve arithmetic, such as the Elliptic Curve Diffie-Hellman (ECDH) key exchange and the Edwards-curve Digital Signature Algorithm (EdDSA).

The code defines several types and functions to handle field elements with both loose and tight bounds, ensuring that operations remain within the constraints of the field defined by the prime \(2^{255} - 19\). Key functions include [`fiat_25519x6_addcarryx_u42`](#fiat_25519x6_addcarryx_u42) and [`fiat_25519x6_subborrowx_u42`](#fiat_25519x6_subborrowx_u42) for addition and subtraction with carry and borrow, respectively, and [`fiat_25519x6_carry_mul`](#fiat_25519x6_carry_mul) and [`fiat_25519x6_carry_square`](#fiat_25519x6_carry_square) for multiplication and squaring with reduction. The file also includes functions for conditional moves and conversions between field elements and byte arrays, which are essential for interoperability with other cryptographic components. This code is intended to be used as a library, providing a set of operations that can be integrated into larger cryptographic systems.
# Imports and Dependencies

---
- `stdint.h`


# Global Variables

---
### fiat\_25519x6\_int128
- **Type**: `signed __int128`
- **Description**: The `fiat_25519x6_int128` is a typedef for a signed 128-bit integer type, which is an extension provided by compilers like GCC or Clang. This type allows for operations on 128-bit signed integers, which are larger than the standard integer types available in C.
- **Use**: This variable is used to perform arithmetic operations that require 128-bit signed integer precision, particularly in cryptographic computations involving the 25519x6 curve.


---
### fiat\_25519x6\_uint128
- **Type**: `unsigned __int128`
- **Description**: The `fiat_25519x6_uint128` is a typedef for an unsigned 128-bit integer type, which is an extension provided by some compilers like GCC and Clang. This type allows for operations on 128-bit wide integers, which are not natively supported by all C compilers.
- **Use**: This variable is used to perform arithmetic operations on large integers, particularly in the context of cryptographic computations involving the 25519 curve.


# Functions

---
### fiat\_25519x6\_addcarryx\_u42<!-- {{#callable:fiat_25519x6_addcarryx_u42}} -->
The function `fiat_25519x6_addcarryx_u42` performs an addition of three numbers with a carry, reducing the result modulo 2^42 and providing the carry as a separate output.
- **Inputs**:
    - `out1`: A pointer to a uint64_t where the result of the addition modulo 2^42 will be stored.
    - `out2`: A pointer to a fiat_25519x6_uint1 where the carry resulting from the addition will be stored.
    - `arg1`: A fiat_25519x6_uint1 representing a small integer, typically used as a carry-in.
    - `arg2`: A uint64_t representing the first operand of the addition.
    - `arg3`: A uint64_t representing the second operand of the addition.
- **Control Flow**:
    - Compute the sum of arg1, arg2, and arg3, storing the result in x1.
    - Calculate x2 as x1 modulo 2^42, which is done by bitwise AND with 0x3ffffffffff.
    - Calculate x3 as the carry by right-shifting x1 by 42 bits.
    - Store x2 in the location pointed to by out1.
    - Store x3 in the location pointed to by out2.
- **Output**: The function outputs the result of the addition modulo 2^42 in *out1 and the carry in *out2.


---
### fiat\_25519x6\_subborrowx\_u42<!-- {{#callable:fiat_25519x6_subborrowx_u42}} -->
The function `fiat_25519x6_subborrowx_u42` performs a subtraction with borrow on two 42-bit integers and a borrow bit, producing a result modulo 2^42 and a borrow out.
- **Inputs**:
    - `out1`: A pointer to a uint64_t where the result of the subtraction will be stored.
    - `out2`: A pointer to a fiat_25519x6_uint1 where the borrow out will be stored.
    - `arg1`: A fiat_25519x6_uint1 representing the initial borrow bit.
    - `arg2`: A uint64_t representing the first operand of the subtraction.
    - `arg3`: A uint64_t representing the second operand of the subtraction.
- **Control Flow**:
    - Convert `arg2`, `arg1`, and `arg3` to int64_t and perform the subtraction: `x1 = ((int64_t)arg2 - (int64_t)arg1) - (int64_t)arg3`.
    - Calculate the borrow by right-shifting `x1` by 42 bits: `x2 = (fiat_25519x6_int1)(x1 >> 42)`.
    - Mask `x1` with `0x3ffffffffff` to get the result modulo 2^42: `x3 = ((uint64_t)x1 & UINT64_C(0x3ffffffffff))`.
    - Store the result in `out1`: `*out1 = x3`.
    - Calculate the borrow out by negating `x2` and store it in `out2`: `*out2 = (fiat_25519x6_uint1)(0x0 - x2)`.
- **Output**: The function outputs the result of the subtraction modulo 2^42 in `out1` and the borrow out in `out2`.


---
### fiat\_25519x6\_addcarryx\_u43<!-- {{#callable:fiat_25519x6_addcarryx_u43}} -->
The function `fiat_25519x6_addcarryx_u43` performs an addition of three numbers with a carry, reducing the result modulo 2^43 and providing the carry as a separate output.
- **Inputs**:
    - `out1`: A pointer to a uint64_t where the result of the addition modulo 2^43 will be stored.
    - `out2`: A pointer to a fiat_25519x6_uint1 where the carry resulting from the addition will be stored.
    - `arg1`: A fiat_25519x6_uint1 representing the first addend, which is a carry bit (0 or 1).
    - `arg2`: A uint64_t representing the second addend, which is a 43-bit number.
    - `arg3`: A uint64_t representing the third addend, which is a 43-bit number.
- **Control Flow**:
    - Compute the sum of arg1, arg2, and arg3, storing the result in x1.
    - Calculate x2 as x1 modulo 2^43, which is done by bitwise AND with 0x7ffffffffff.
    - Calculate x3 as the carry by right-shifting x1 by 43 bits.
    - Store x2 in the location pointed to by out1.
    - Store x3 in the location pointed to by out2.
- **Output**: The function outputs the result of the addition modulo 2^43 in *out1 and the carry bit in *out2.


---
### fiat\_25519x6\_subborrowx\_u43<!-- {{#callable:fiat_25519x6_subborrowx_u43}} -->
The function `fiat_25519x6_subborrowx_u43` performs a subtraction with borrow on three inputs, producing a result modulo 2^43 and a borrow indicator.
- **Inputs**:
    - `out1`: A pointer to a uint64_t where the result of the subtraction will be stored.
    - `out2`: A pointer to a fiat_25519x6_uint1 where the borrow indicator will be stored.
    - `arg1`: A fiat_25519x6_uint1 representing the first input value, which is subtracted from the second input.
    - `arg2`: A uint64_t representing the second input value, from which the first input is subtracted.
    - `arg3`: A uint64_t representing the third input value, which is also subtracted from the second input.
- **Control Flow**:
    - Convert `arg2`, `arg1`, and `arg3` to int64_t and perform the subtraction: `x1 = ((int64_t)arg2 - (int64_t)arg1) - (int64_t)arg3`.
    - Calculate the borrow by right-shifting `x1` by 43 bits and store it in `x2`: `x2 = (fiat_25519x6_int1)(x1 >> 43)`.
    - Mask `x1` with `0x7ffffffffff` to get the result modulo 2^43 and store it in `x3`: `x3 = ((uint64_t)x1 & UINT64_C(0x7ffffffffff))`.
    - Store the result `x3` in the location pointed to by `out1`.
    - Calculate the borrow indicator by negating `x2` and store it in the location pointed to by `out2`.
- **Output**: The function outputs the result of the subtraction modulo 2^43 in `out1` and a borrow indicator in `out2`.


---
### fiat\_25519x6\_cmovznz\_u64<!-- {{#callable:fiat_25519x6_cmovznz_u64}} -->
The function `fiat_25519x6_cmovznz_u64` performs a conditional move operation on two 64-bit unsigned integers based on a single-bit condition.
- **Inputs**:
    - `out1`: A pointer to a 64-bit unsigned integer where the result will be stored.
    - `arg1`: A single-bit unsigned integer (fiat_25519x6_uint1) that acts as the condition for the move operation.
    - `arg2`: A 64-bit unsigned integer that is selected if the condition (arg1) is zero.
    - `arg3`: A 64-bit unsigned integer that is selected if the condition (arg1) is non-zero.
- **Control Flow**:
    - The function first negates the condition `arg1` twice to ensure it is either 0 or 1, storing the result in `x1`.
    - It calculates `x2` as the bitwise AND of the negated `x1` (converted to a signed integer and subtracted from zero) with the maximum 64-bit unsigned integer value, effectively creating a mask of all 1s if `arg1` is non-zero, or all 0s if `arg1` is zero.
    - The function then computes `x3` by using `x2` to select between `arg3` and `arg2`: `x3` is `arg3` if `x2` is all 1s, or `arg2` if `x2` is all 0s.
    - Finally, the result `x3` is stored in the location pointed to by `out1`.
- **Output**: The function outputs the selected 64-bit unsigned integer, either `arg2` or `arg3`, based on the condition `arg1`, and stores it in the location pointed to by `out1`.


---
### fiat\_25519x6\_carry\_mul<!-- {{#callable:fiat_25519x6_carry_mul}} -->
The function `fiat_25519x6_carry_mul` multiplies two field elements and reduces the result modulo a prime specific to the 25519 curve, ensuring the result fits within the field's bounds.
- **Inputs**:
    - `out1`: A pointer to a `fiat_25519x6_tight_field_element` where the result of the multiplication will be stored.
    - `arg1`: A `fiat_25519x6_loose_field_element` representing the first operand of the multiplication.
    - `arg2`: A `fiat_25519x6_loose_field_element` representing the second operand of the multiplication.
- **Control Flow**:
    - Initialize multiple `fiat_25519x6_uint128` variables to store intermediate multiplication results.
    - Perform pairwise multiplications of elements from `arg1` and `arg2`, applying specific constants (0x26 and 0x13) to certain terms to account for the field's structure.
    - Accumulate the results of these multiplications into several `fiat_25519x6_uint128` variables, representing different parts of the final result.
    - Reduce the accumulated results by shifting and masking to fit within the field's bounds, using constants like `0x7ffffffffff` and `0x3ffffffffff` for masking.
    - Apply a final reduction step to ensure the result is within the field's bounds, using a constant multiplication by 0x13 and further shifting and masking.
    - Store the reduced results into the `out1` array, representing the final field element.
- **Output**: The function outputs a `fiat_25519x6_tight_field_element` in `out1`, which is the reduced product of `arg1` and `arg2` modulo the field's prime.


---
### fiat\_25519x6\_carry\_square<!-- {{#callable:fiat_25519x6_carry_square}} -->
The function `fiat_25519x6_carry_square` computes the square of a field element and reduces the result modulo a prime.
- **Inputs**:
    - `out1`: A `fiat_25519x6_tight_field_element` array of size 6 that will store the result of the operation.
    - `arg1`: A `fiat_25519x6_loose_field_element` array of size 6 representing the field element to be squared.
- **Control Flow**:
    - Initialize temporary variables for intermediate calculations.
    - Compute products of elements from `arg1` with specific constants and other elements, storing results in 128-bit integers.
    - Perform a series of additions to accumulate the results of these products into larger sums.
    - Apply bitwise shifts and masks to reduce these sums, ensuring they fit within the specified bounds of the field element representation.
    - Store the final reduced values into the `out1` array.
- **Output**: The function outputs the squared and reduced field element in the `out1` array.


---
### fiat\_25519x6\_carry\_scmul\_121666<!-- {{#callable:fiat_25519x6_carry_scmul_121666}} -->
The function `fiat_25519x6_carry_scmul_121666` multiplies a 6-element field element by the constant 121666 and reduces the result modulo 2^255-19.
- **Inputs**:
    - `out1`: A 6-element array of type `fiat_25519x6_tight_field_element` where the result will be stored.
    - `arg1`: A 6-element array of type `fiat_25519x6_loose_field_element` representing the field element to be multiplied by 121666.
- **Control Flow**:
    - Multiply each element of `arg1` by 121666, storing the results in temporary variables `x1` to `x6`.
    - Perform a series of right shifts and bitwise AND operations to handle carry propagation and reduction, storing intermediate results in variables `x7` to `x31`.
    - Add the carry from the last element to the first element, applying a modular reduction with a constant factor of 0x13.
    - Store the final reduced results in the `out1` array.
- **Output**: The function outputs a 6-element array `out1` containing the reduced result of the multiplication.


---
### fiat\_25519x6\_carry<!-- {{#callable:fiat_25519x6_carry}} -->
The function `fiat_25519x6_carry` reduces a loose field element to a tight field element by performing a series of bitwise operations and modular reductions.
- **Inputs**:
    - `out1`: A pointer to a `fiat_25519x6_tight_field_element` array where the result will be stored.
    - `arg1`: A constant `fiat_25519x6_loose_field_element` array representing the input field element to be reduced.
- **Control Flow**:
    - Initialize variables x1 to x14 to store intermediate results.
    - Assign the first element of `arg1` to x1.
    - Perform a series of right shifts and additions to propagate carries through the elements of `arg1`, storing results in x2 to x6.
    - Calculate x7 by masking x1 and adding a scaled carry from x6.
    - Propagate the carry from x7 to x8 and mask the result to get x9 and x10.
    - Continue propagating carries through x11 to x14, masking each result appropriately.
    - Store the final reduced values in the `out1` array.
- **Output**: The function outputs a reduced field element stored in the `out1` array, which is a `fiat_25519x6_tight_field_element`.


---
### fiat\_25519x6\_add<!-- {{#callable:fiat_25519x6_add}} -->
The function `fiat_25519x6_add` performs element-wise addition of two 6-element arrays representing field elements and stores the result in a third array.
- **Inputs**:
    - `out1`: A `fiat_25519x6_loose_field_element` array where the result of the addition will be stored.
    - `arg1`: A `fiat_25519x6_tight_field_element` array representing the first operand in the addition.
    - `arg2`: A `fiat_25519x6_tight_field_element` array representing the second operand in the addition.
- **Control Flow**:
    - Initialize six 64-bit unsigned integers x1 to x6.
    - Compute the sum of corresponding elements from `arg1` and `arg2` and store them in x1 to x6.
    - Assign the computed sums to the corresponding elements of `out1`.
- **Output**: The function does not return a value; it modifies the `out1` array in place to contain the result of the addition.


---
### fiat\_25519x6\_sub<!-- {{#callable:fiat_25519x6_sub}} -->
The function `fiat_25519x6_sub` performs subtraction of two field elements represented as arrays of 64-bit unsigned integers, with specific constants added to each element to ensure non-negative results.
- **Inputs**:
    - `out1`: A `fiat_25519x6_loose_field_element` array of 6 elements where the result of the subtraction will be stored.
    - `arg1`: A `fiat_25519x6_tight_field_element` array of 6 elements representing the minuend in the subtraction.
    - `arg2`: A `fiat_25519x6_tight_field_element` array of 6 elements representing the subtrahend in the subtraction.
- **Control Flow**:
    - Initialize six 64-bit unsigned integers (x1 to x6) to store intermediate subtraction results.
    - For each element in the input arrays (arg1 and arg2), perform subtraction with a specific constant added to the element from arg1 to ensure non-negative results.
    - Store the result of each subtraction in the corresponding index of the output array out1.
- **Output**: The function outputs the result of the subtraction in the `out1` array, which is a `fiat_25519x6_loose_field_element`.


---
### fiat\_25519x6\_opp<!-- {{#callable:fiat_25519x6_opp}} -->
The function `fiat_25519x6_opp` computes the negation of a field element in the 25519x6 field representation.
- **Inputs**:
    - `out1`: A `fiat_25519x6_loose_field_element` array of size 6 where the result will be stored.
    - `arg1`: A `fiat_25519x6_tight_field_element` array of size 6 representing the field element to be negated.
- **Control Flow**:
    - Initialize six 64-bit unsigned integers x1 to x6.
    - Compute the negation of each element in `arg1` by subtracting it from a constant specific to its position, storing the result in x1 to x6.
    - Assign the computed values x1 to x6 to the corresponding positions in the output array `out1`.
- **Output**: The function outputs the negated field element in the `out1` array.


---
### fiat\_25519x6\_selectznz<!-- {{#callable:fiat_25519x6_selectznz}} -->
The function `fiat_25519x6_selectznz` performs a conditional selection between two 6-element arrays based on a single-bit flag.
- **Inputs**:
    - `out1`: An array of 6 uint64_t elements where the result will be stored.
    - `arg1`: A single-bit flag (fiat_25519x6_uint1) that determines which array to select.
    - `arg2`: A 6-element array of uint64_t values, one of the potential outputs.
    - `arg3`: A 6-element array of uint64_t values, the other potential output.
- **Control Flow**:
    - The function initializes six local uint64_t variables (x1 to x6).
    - For each element in the arrays (from 0 to 5), it calls [`fiat_25519x6_cmovznz_u64`](#fiat_25519x6_cmovznz_u64), which performs a conditional move based on `arg1`.
    - If `arg1` is 0, the corresponding element from `arg2` is selected; otherwise, the element from `arg3` is selected.
    - The selected values are stored in the local variables x1 to x6.
    - Finally, the selected values are assigned to the output array `out1`.
- **Output**: The function outputs a 6-element array `out1` where each element is conditionally selected from either `arg2` or `arg3` based on the value of `arg1`.
- **Functions called**:
    - [`fiat_25519x6_cmovznz_u64`](#fiat_25519x6_cmovznz_u64)


---
### fiat\_25519x6\_to\_bytes<!-- {{#callable:fiat_25519x6_to_bytes}} -->
The function `fiat_25519x6_to_bytes` serializes a 25519 field element into a 32-byte array in little-endian order.
- **Inputs**:
    - `out1`: A 32-byte array where the serialized output will be stored.
    - `arg1`: A 25519 field element represented as a 6-element array of 64-bit unsigned integers.
- **Control Flow**:
    - Subtracts constants from each element of `arg1` using [`fiat_25519x6_subborrowx_u43`](#fiat_25519x6_subborrowx_u43) and [`fiat_25519x6_subborrowx_u42`](#fiat_25519x6_subborrowx_u42) to ensure the field element is within bounds.
    - Uses [`fiat_25519x6_cmovznz_u64`](#fiat_25519x6_cmovznz_u64) to conditionally select between zero and a mask based on the borrow result.
    - Adds the mask to the subtracted values using [`fiat_25519x6_addcarryx_u43`](#fiat_25519x6_addcarryx_u43) and [`fiat_25519x6_addcarryx_u42`](#fiat_25519x6_addcarryx_u42) to adjust the field element.
    - Shifts and combines the adjusted values to form a 256-bit integer.
    - Extracts each byte from the 256-bit integer and stores them in the `out1` array in little-endian order.
- **Output**: The function outputs a 32-byte array `out1` containing the serialized field element.
- **Functions called**:
    - [`fiat_25519x6_subborrowx_u43`](#fiat_25519x6_subborrowx_u43)
    - [`fiat_25519x6_subborrowx_u42`](#fiat_25519x6_subborrowx_u42)
    - [`fiat_25519x6_cmovznz_u64`](#fiat_25519x6_cmovznz_u64)
    - [`fiat_25519x6_addcarryx_u43`](#fiat_25519x6_addcarryx_u43)
    - [`fiat_25519x6_addcarryx_u42`](#fiat_25519x6_addcarryx_u42)


---
### fiat\_25519x6\_from\_bytes<!-- {{#callable:fiat_25519x6_from_bytes}} -->
The function `fiat_25519x6_from_bytes` deserializes a 32-byte array into a 6-element field element representation with specific bit-width constraints.
- **Inputs**:
    - `out1`: A `fiat_25519x6_tight_field_element` array of 6 `uint64_t` elements where the deserialized field element will be stored.
    - `arg1`: A 32-element array of `uint8_t` representing the serialized field element in little-endian order.
- **Control Flow**:
    - Initialize multiple `uint64_t` variables to store intermediate results of bit-shifting and addition operations.
    - Extract and shift bits from the input byte array `arg1` to form 64-bit integers, each representing a portion of the field element.
    - Perform bitwise operations to combine these 64-bit integers into the final field element representation, ensuring each element fits within its designated bit-width constraint.
    - Store the resulting field element in the `out1` array.
- **Output**: The function outputs a 6-element array of `uint64_t` representing the deserialized field element, with each element fitting within specific bit-width constraints.


