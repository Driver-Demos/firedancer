<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

A Bash script for building projects with options for compiler selection, target specification, and error handling.

# Purpose
The `build.sh` script is a Bash script designed to automate the build process for a software project. It provides a command-line interface with various flags and arguments to customize the build process. The script supports building with different compilers, specifically GCC and Clang, and allows users to specify versions of these compilers. It also includes options to exclude certain compiler, machine, and target combinations from the build process. The script manages dependencies, supports dry-run and verbose modes, and can exit on the first error if specified. It calculates and displays elapsed time for builds and handles cleanup tasks after each build. The script is relevant to the codebase as it streamlines the compilation and testing of the software across different environments and configurations.
# Content Summary
The provided script is a Bash script designed to automate the build process for a software project. It supports building with different compilers (GCC and Clang) and allows for various configurations and options to customize the build process. Below are the key functional details:

1. **Flags and Arguments**: The script accepts several command-line flags and arguments to control its behavior:
   - `--no-gcc`, `--no-clang`: Skip GCC or Clang builds.
   - `--no-deps`, `--no-rust`: Skip installation of dependencies or Rust.
   - `--dry-run`: Display the build matrix and exit without building.
   - `--check-run`: Run `make check` instead of full builds.
   - `--verbose`: Show output from failed builds.
   - `--exit-on-err`: Exit on the first build failure.
   - `--help` or `-h`: Display help information.
   - `--targets` or `-t`: Specify targets to compile.
   - `--machines` or `-m`: Specify machine types for building.
   - `--gcc-versions` or `-g`, `--clang-versions` or `-c`: Specify compiler versions.
   - `--gcc-except`, `--clang-except`: Exclude specific compiler, machine, and target combinations.

2. **Build Process**: The script automates the build process by:
   - Setting up the build environment, including optional Rust installation.
   - Installing necessary packages and dependencies.
   - Iterating over specified or default compilers and machine types to perform builds.
   - Using custom target lists for specific machine types unless overridden by user-specified targets.
   - Logging build outputs and errors, with options to display verbose logs.

3. **Compiler and Machine Management**: The script manages compilers and machines by:
   - Detecting available GCC and Clang versions from `/opt/gcc` and `/opt/clang`.
   - Allowing exclusion of specific compiler, machine, and target combinations.
   - Using activation scripts to set up the environment for each compiler.

4. **Error Handling and Exit Codes**: The script provides exit codes to indicate the result of the build process:
   - `0`: All builds were successful.
   - `1`: One or more builds failed.
   - `2`: Compiler environment activation script not found.
   - `3`: Failed to compile and install dependencies.

5. **Helper Functions**: The script includes helper functions for logging information and errors, calculating elapsed time, and managing the build process flow.

Overall, this script is a comprehensive tool for managing complex build processes with multiple configurations, providing flexibility and control over the build environment and targets.

---
Made with ❤️ by [Driver](https://www.driver.ai/)