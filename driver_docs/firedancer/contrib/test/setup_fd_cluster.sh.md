<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Shell script to set up a Solana test cluster with key generation, program fetching, and validator start.

# Purpose
This Bash script is designed to set up and start a Solana blockchain test environment. It begins by configuring the environment, including setting the primary IP address and defining the RPC URL. The script creates necessary key pairs for minting, staking, and validating, and stores them in a designated directory. It then fetches and prepares various Solana programs, such as token and memo programs, for inclusion in the genesis block. The script generates the genesis block with specified parameters and starts a bootstrap validator using the generated keys and configuration. This setup is intended for testing and development purposes within a Solana network environment.
# Global Variables

---
### PRIMARY\_IP
- **Type**: `string`
- **Description**: The `PRIMARY_IP` variable stores the primary IPv4 address of the machine on which the script is running. It is obtained by executing a shell command that lists all global IPv4 addresses and extracts the first one using `awk` and `cut` commands.
- **Use**: Used to configure network-related settings such as the RPC URL and gossip host for the Solana validator.


---
### RPC\_URL
- **Type**: `string`
- **Description**: Contains the URL for the RPC (Remote Procedure Call) endpoint. It is constructed using the primary IP address of the machine and a fixed port number, 8899.
- **Use**: Used to specify the RPC endpoint URL for network communication.


---
### AGAVE\_PATH
- **Type**: `string`
- **Description**: Specifies the file path to the Agave executable directory. It defaults to './agave/target/release' if not set by the user.
- **Use**: Used to execute various Solana-related commands by referencing the Agave executable path.


---
### upgradeableLoader
- **Type**: `string`
- **Description**: A string that represents the identifier for the upgradeable BPF loader in the Solana blockchain environment. This identifier is used to specify the loader type when deploying or managing upgradeable programs on the blockchain.
- **Use**: Used in the `fetch_program` function to determine if a program should be deployed as an upgradeable program.


---
### genesis\_args
- **Type**: `array`
- **Description**: The `genesis_args` variable is an array that stores command-line arguments for the Solana genesis process. These arguments include options for loading programs into the genesis block, such as specifying whether a program is upgradeable or not, along with the program's address, loader, and shared object file.
- **Use**: Used to accumulate and pass command-line arguments to the Solana genesis command for program initialization.


---
### GENESIS\_OUTPUT
- **Type**: ``string``
- **Description**: Contains the output of the `solana-genesis` command, which is executed to generate the genesis block for a Solana blockchain network. This output includes important information such as the genesis hash and shred version, which are used to configure the bootstrap validator.
- **Use**: Stores the result of the `solana-genesis` command for further processing and configuration of the blockchain network.


---
### GENESIS\_HASH
- **Type**: ``string``
- **Description**: Extracts the genesis hash from the `GENESIS_OUTPUT` variable. The genesis hash is a unique identifier for the initial state of the blockchain ledger.
- **Use**: Used to set the expected genesis hash for the bootstrap validator.


---
### SHRED\_VERSION
- **Type**: ``string``
- **Description**: The `SHRED_VERSION` variable is a string that stores the shred version extracted from the `GENESIS_OUTPUT`. The shred version is a part of the output generated by the `solana-genesis` command, which is used to initialize the Solana blockchain ledger.
- **Use**: Used to set the `--expected-shred-version` parameter when starting the Solana validator.


---
### \_PRIMARY\_INTERFACE
- **Type**: ``string``
- **Description**: The `_PRIMARY_INTERFACE` variable stores the name of the network interface used for the default route. It is determined by parsing the output of the `ip route show default` command and extracting the fifth field using `awk`. This variable is used to identify the primary network interface for network operations.
- **Use**: Used to identify the primary network interface for network operations.


# Functions

---
### fetch\_program
Downloads and prepares a Solana program for inclusion in the genesis configuration.
- **Inputs**:
    - `name`: The name of the Solana program to fetch.
    - `version`: The version of the Solana program to fetch.
    - `address`: The address of the Solana program.
    - `loader`: The loader type for the Solana program, which determines if the program is upgradeable.
- **Logic and Control Flow**:
    - Declare the program's shared object file name using the `name` and `version` inputs.
    - Check if the `loader` is equal to `upgradeableLoader`; if true, append upgradeable program arguments to `genesis_args`, otherwise append BPF program arguments.
    - Check if the shared object file (`so`) is readable; if true, return from the function.
    - Check if the shared object file exists in the cache directory (`~/.cache/solana-spl/`); if true, copy it to the current directory.
    - If the shared object file is not in the cache, download it from the Solana program library releases on GitHub, retrying up to 5 times if necessary.
    - Create the cache directory if it does not exist and copy the downloaded shared object file to the cache.
- **Output**: None; the function modifies the `genesis_args` array and ensures the program's shared object file is available in the current directory.



---
Made with ❤️ by [Driver](https://www.driver.ai/)