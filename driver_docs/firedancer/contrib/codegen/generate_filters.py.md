<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

A Python script that compiles symbolic expressions into C header files for cBPF code generation.

# Purpose
The code is a Python script that functions as a compiler to convert symbolic expressions into cBPF (classic Berkeley Packet Filter) code, specifically targeting C header files. This script is designed to generate seccomp (secure computing mode) filters, which are used to restrict the system calls that a process can make, enhancing security by reducing the attack surface. The script reads a policy file, processes the symbolic expressions defined within it, and outputs a C header file containing the generated BPF instructions.

Key components of the script include classes such as `ReloCondJump`, `ReloJump`, and `CommentedLiteral`, which represent different types of BPF instructions with optional comments. The [`codegen`](<#codegen>) function is responsible for generating the BPF code based on the policy lines, while the [`eval_`](<#eval_>) function recursively processes symbolic expressions to produce the corresponding BPF instructions. The script also handles label management for conditional and unconditional jumps, ensuring that the generated BPF code is correctly structured. The output is a C header file that includes the necessary BPF instructions to enforce the specified seccomp policy.
# Imports and Dependencies

---
- `os`
- `sys`
- `edn_format`
- `collections.defaultdict`


# Global Variables

---
### relo\_label\_counter
- **Type**: ``int``
- **Description**: A global integer variable that starts at 0. It is used to generate unique labels for relocation purposes in the compiler.
- **Use**: Increments each time `new_relo_label` is called to ensure each label is unique.


---
### relo\_abs\_mapping
- **Type**: ``dict``
- **Description**: A dictionary that maps labels to their absolute positions in the instruction list. It is used to store the mapping of labels to their corresponding line numbers in the generated filter code.
- **Use**: Used to track and replace labels with their absolute positions during the code generation process.


# Classes

---
### ReloCondJump<!-- {{#class:firedancer/contrib/codegen/generate_filters.ReloCondJump}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L36>)

- **Members**:
    - `code`: Holds the code for the conditional jump.
    - `t_label`: Stores the label for the true branch of the jump.
    - `f_label`: Stores the label for the false branch of the jump.
    - `pre_comment`: Optional comment placed before the jump instruction.
    - `post_comment`: Optional comment placed after the jump instruction.
- **Description**: Represents a conditional jump instruction that is not yet realized, with labels for true and false branches and optional comments.
- **Methods**:
    - [`firedancer/contrib/codegen/generate_filters.ReloCondJump.__init__`](<#relocondjump__init__>)
    - [`firedancer/contrib/codegen/generate_filters.ReloCondJump.__str__`](<#relocondjump__str__>)
    - [`firedancer/contrib/codegen/generate_filters.ReloCondJump.relocate`](<#relocondjumprelocate>)
- **Inherits From**:
    - `object`

**Methods**

---
#### ReloCondJump\.\_\_init\_\_<!-- {{#callable:firedancer/contrib/codegen/generate_filters.ReloCondJump.__init__}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L37>)

Initializes an instance of the `ReloCondJump` class with specified code, true label, false label, and optional comments.
- **Inputs**:
    - `code`: The code for the conditional jump instruction.
    - `t_label`: The label to jump to if the condition is true.
    - `f_label`: The label to jump to if the condition is false.
    - `pre_comment`: An optional comment to include before the instruction.
    - `post_comment`: An optional comment to include after the instruction.
- **Logic and Control Flow**:
    - Assigns the `code` parameter to the instance variable `self.code`.
    - Assigns the `t_label` parameter to the instance variable `self.t_label`.
    - Assigns the `f_label` parameter to the instance variable `self.f_label`.
    - Assigns the `pre_comment` parameter to the instance variable `self.pre_comment`.
    - Assigns the `post_comment` parameter to the instance variable `self.post_comment`.
- **Output**: None, as this is a constructor method for initializing an object.
- **See also**: [`firedancer/contrib/codegen/generate_filters.ReloCondJump`](<#relocondjump>)  (Base Class)


---
#### ReloCondJump\.\_\_str\_\_<!-- {{#callable:firedancer/contrib/codegen/generate_filters.ReloCondJump.__str__}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L44>)

Formats the `ReloCondJump` object as a string representing a BPF jump instruction.
- **Inputs**: None
- **Logic and Control Flow**:
    - Uses the `code`, `t_label`, and `f_label` attributes of the `ReloCondJump` object to format a string.
    - Returns a formatted string in the form of `BPF_JUMP( <code>, <t_label>, <f_label> )`.
- **Output**: A string representing the BPF jump instruction with the object's `code`, `t_label`, and `f_label`.
- **See also**: [`firedancer/contrib/codegen/generate_filters.ReloCondJump`](<#relocondjump>)  (Base Class)


---
#### ReloCondJump\.relocate<!-- {{#callable:firedancer/contrib/codegen/generate_filters.ReloCondJump.relocate}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L47>)

Updates the true and false labels of a conditional jump instruction with new relative distances based on a given instruction index.
- **Inputs**:
    - `instr_idx`: An integer representing the index of the instruction to which the labels should be relocated.
- **Logic and Control Flow**:
    - Calls [`replace_label`](<#replace_label>) on `self.t_label` with `instr_idx` to update the true label.
    - Calls [`replace_label`](<#replace_label>) on `self.f_label` with `instr_idx` to update the false label.
- **Output**: None; the method updates the object's `t_label` and `f_label` attributes in place.
- **Functions Called**:
    - [`firedancer/contrib/codegen/generate_filters.replace_label`](<#replace_label>)
- **See also**: [`firedancer/contrib/codegen/generate_filters.ReloCondJump`](<#relocondjump>)  (Base Class)



---
### ReloJump<!-- {{#class:firedancer/contrib/codegen/generate_filters.ReloJump}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L60>)

- **Members**:
    - `label`: Holds the label for the jump instruction.
    - `pre_comment`: Stores an optional comment to be placed before the instruction.
    - `post_comment`: Stores an optional comment to be placed after the instruction.
- **Description**: Represents an unconditional jump instruction that is not yet realized. It includes a label for the jump target and optional comments that can be added before and after the instruction. The class provides functionality to relocate the jump target based on an instruction index.
- **Methods**:
    - [`firedancer/contrib/codegen/generate_filters.ReloJump.__init__`](<#relojump__init__>)
    - [`firedancer/contrib/codegen/generate_filters.ReloJump.__str__`](<#relojump__str__>)
    - [`firedancer/contrib/codegen/generate_filters.ReloJump.relocate`](<#relojumprelocate>)
- **Inherits From**:
    - `object`

**Methods**

---
#### ReloJump\.\_\_init\_\_<!-- {{#callable:firedancer/contrib/codegen/generate_filters.ReloJump.__init__}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L61>)

Initializes an instance of the `ReloJump` class with a label and optional comments.
- **Inputs**:
    - `label`: A string representing the label for the jump instruction.
    - `pre_comment`: An optional string for a comment to be placed before the instruction.
    - `post_comment`: An optional string for a comment to be placed after the instruction.
- **Logic and Control Flow**:
    - Assigns the `label` parameter to the instance variable `self.label`.
    - Assigns the `pre_comment` parameter to the instance variable `self.pre_comment`.
    - Assigns the `post_comment` parameter to the instance variable `self.post_comment`.
- **Output**: None, as this is a constructor method for initializing an object.
- **See also**: [`firedancer/contrib/codegen/generate_filters.ReloJump`](<#relojump>)  (Base Class)


---
#### ReloJump\.\_\_str\_\_<!-- {{#callable:firedancer/contrib/codegen/generate_filters.ReloJump.__str__}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L66>)

Formats the `ReloJump` object as a string representing a BPF jump instruction with the object's label.
- **Inputs**: None
- **Logic and Control Flow**:
    - Returns a formatted string that represents a BPF jump instruction.
    - The string includes the label of the `ReloJump` object.
- **Output**: A string formatted as "{ BPF_JMP | BPF_JA, 0, 0, %s }" with the object's label inserted.
- **See also**: [`firedancer/contrib/codegen/generate_filters.ReloJump`](<#relojump>)  (Base Class)


---
#### ReloJump\.relocate<!-- {{#callable:firedancer/contrib/codegen/generate_filters.ReloJump.relocate}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L69>)

Updates the `label` attribute of the `ReloJump` instance by replacing it with a new label based on the given instruction index.
- **Inputs**:
    - `instr_idx`: An integer representing the instruction index used to calculate the new label.
- **Logic and Control Flow**:
    - Calls the [`replace_label`](<#replace_label>) function with the current `label` and `instr_idx` as arguments.
    - Assigns the result of [`replace_label`](<#replace_label>) to the `label` attribute of the instance.
- **Output**: None; the method updates the `label` attribute of the instance in place.
- **Functions Called**:
    - [`firedancer/contrib/codegen/generate_filters.replace_label`](<#replace_label>)
- **See also**: [`firedancer/contrib/codegen/generate_filters.ReloJump`](<#relojump>)  (Base Class)



---
### CommentedLiteral<!-- {{#class:firedancer/contrib/codegen/generate_filters.CommentedLiteral}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L73>)

- **Members**:
    - `lit`: Stores the literal instruction.
    - `pre_comment`: Holds an optional comment that appears before the literal.
    - `post_comment`: Holds an optional comment that appears after the literal.
- **Description**: Represents an instruction with optional comments attached before and after it. This class allows the inclusion of comments in the generated code, which can help in understanding the purpose of each instruction.
- **Methods**:
    - [`firedancer/contrib/codegen/generate_filters.CommentedLiteral.__init__`](<#commentedliteral__init__>)
    - [`firedancer/contrib/codegen/generate_filters.CommentedLiteral.__str__`](<#commentedliteral__str__>)
- **Inherits From**:
    - `object`

**Methods**

---
#### CommentedLiteral\.\_\_init\_\_<!-- {{#callable:firedancer/contrib/codegen/generate_filters.CommentedLiteral.__init__}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L74>)

Initializes a `CommentedLiteral` object with a literal and optional comments.
- **Inputs**:
    - `lit`: A string representing the literal value to store in the object.
    - `pre_comment`: An optional string for a comment to store before the literal.
    - `post_comment`: An optional string for a comment to store after the literal.
- **Logic and Control Flow**:
    - Assigns the input `lit` to the instance variable `self.lit`.
    - Assigns the input `pre_comment` to the instance variable `self.pre_comment`.
    - Assigns the input `post_comment` to the instance variable `self.post_comment`.
- **Output**: None, as this is a constructor method for initializing an object.
- **See also**: [`firedancer/contrib/codegen/generate_filters.CommentedLiteral`](<#commentedliteral>)  (Base Class)


---
#### CommentedLiteral\.\_\_str\_\_<!-- {{#callable:firedancer/contrib/codegen/generate_filters.CommentedLiteral.__str__}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L79>)

Returns the literal value stored in the `lit` attribute of the `CommentedLiteral` class.
- **Inputs**: None
- **Logic and Control Flow**:
    - Accesses the `lit` attribute of the `CommentedLiteral` instance.
    - Returns the value of the `lit` attribute.
- **Output**: The string representation of the `lit` attribute.
- **See also**: [`firedancer/contrib/codegen/generate_filters.CommentedLiteral`](<#commentedliteral>)  (Base Class)



# Functions

---
### new\_relo\_label<!-- {{#callable:firedancer/contrib/codegen/generate_filters.new_relo_label}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L22>)

Generates a unique relocation label by incrementing a global counter.
- **Inputs**: None
- **Logic and Control Flow**:
    - Accesses the global variable `relo_label_counter`.
    - Increments `relo_label_counter` by 1.
    - Formats a string with the prefix 'lbl_' followed by the current value of `relo_label_counter`.
- **Output**: Returns a string in the format 'lbl_<counter_value>' where <counter_value> is the incremented value of `relo_label_counter`.


---
### reverse\_multi\_mapping<!-- {{#callable:firedancer/contrib/codegen/generate_filters.reverse_multi_mapping}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L28>)

Reverses a mapping from keys to values into a mapping from values to lists of keys.
- **Inputs**:
    - `mapping`: A dictionary where each key is associated with a value.
- **Logic and Control Flow**:
    - Initialize a `defaultdict` named `res` with lists as the default value type.
    - Iterate over each key-value pair in the input `mapping`.
    - For each pair, append the key to the list in `res` corresponding to the value.
    - Return the `res` dictionary.
- **Output**: A `defaultdict` where each key is a value from the input `mapping`, and each value is a list of keys from the input `mapping` that were associated with that value.


---
### replace\_label<!-- {{#callable:firedancer/contrib/codegen/generate_filters.replace_label}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L52>)

Replaces a label with a relative distance if a relocation mapping exists, otherwise returns the label unchanged.
- **Inputs**:
    - `label`: The label to replace, which is a string.
    - `instr_idx`: The index of the instruction, which is an integer.
- **Logic and Control Flow**:
    - Get the relocation value for the given `label` from the `relo_abs_mapping` dictionary.
    - If the relocation value (`maybe_relo`) is not `None`, calculate the relative distance by subtracting `instr_idx` and 1 from `maybe_relo`, and return it as a formatted string with the original label as a comment.
    - If the relocation value is `None`, return the original `label`.
- **Output**: Returns a string that is either the original label or a formatted string with the relative distance if a relocation mapping exists.


---
### append\_prelude<!-- {{#callable:firedancer/contrib/codegen/generate_filters.append_prelude}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L84>)

Appends a sequence of BPF instructions to a filter list to set up a prelude for syscall filtering.
- **Inputs**:
    - `filter`: A list to which BPF instructions are appended.
- **Logic and Control Flow**:
    - Appends a [`CommentedLiteral`](<#commentedliteral>) to load the architecture field from `seccomp_data` and includes a comment about checking the architecture.
    - Appends a [`ReloCondJump`](<#relocondjump>) to conditionally jump to `RET_KILL_PROCESS` if the architecture does not match `ARCH_NR`.
    - Appends a [`CommentedLiteral`](<#commentedliteral>) to load the syscall number from `seccomp_data` and includes a comment about loading the syscall number.
- **Output**: None; the function modifies the `filter` list in place by appending BPF instructions.
- **Functions Called**:
    - [`firedancer/contrib/codegen/generate_filters.CommentedLiteral`](<#commentedliteral>)
    - [`firedancer/contrib/codegen/generate_filters.ReloCondJump`](<#relocondjump>)


---
### codegen<!-- {{#callable:firedancer/contrib/codegen/generate_filters.codegen}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L92>)

Generates BPF code for given policy lines and appends it to a filter list.
- **Inputs**:
    - `policy_lines`: A list of strings, each representing a policy line that specifies a syscall and optionally an expression.
    - `filt`: A list to which the generated BPF code will be appended.
- **Logic and Control Flow**:
    - Calls [`append_prelude`](<#append_prelude>) to add initial BPF instructions to `filt`.
    - Initializes an empty dictionary `syscall_to_expression` to map syscalls to their expressions.
    - Iterates over `policy_lines`, splitting each line by ':' to separate syscall and expression.
    - If a line has only a syscall, appends a [`ReloCondJump`](<#relocondjump>) to `filt` to allow the syscall unconditionally.
    - If a line has a syscall and an expression, appends a [`ReloCondJump`](<#relocondjump>) to `filt` to allow the syscall conditionally and stores the expression in `syscall_to_expression`.
    - If a line is malformed, prints an error message and exits the program.
    - Appends a [`ReloJump`](<#relojump>) to `filt` to handle unmatched syscalls by killing the process.
    - Iterates over `syscall_to_expression` to append expression checks to `filt` using the [`expression`](<#expression>) function.
    - Registers the `RET_KILL_PROCESS` label in `relo_abs_mapping` and appends a [`CommentedLiteral`](<#commentedliteral>) to `filt` for killing the process.
    - Registers the `RET_ALLOW` label in `relo_abs_mapping` and appends a [`CommentedLiteral`](<#commentedliteral>) to `filt` for allowing the syscall.
    - Iterates over `filt` to relocate any [`ReloCondJump`](<#relocondjump>) or [`ReloJump`](<#relojump>) entries.
- **Output**: The function does not return a value; it modifies the `filt` list in place by appending BPF code.
- **Functions Called**:
    - [`firedancer/contrib/codegen/generate_filters.append_prelude`](<#append_prelude>)
    - [`firedancer/contrib/codegen/generate_filters.ReloCondJump`](<#relocondjump>)
    - [`firedancer/contrib/codegen/generate_filters.ReloJump`](<#relojump>)
    - [`firedancer/contrib/codegen/generate_filters.expression`](<#expression>)
    - [`firedancer/contrib/codegen/generate_filters.CommentedLiteral`](<#commentedliteral>)
    - [`firedancer/contrib/codegen/generate_filters.ReloCondJump.relocate`](<#relocondjumprelocate>)


---
### expression<!-- {{#callable:firedancer/contrib/codegen/generate_filters.expression}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L134>)

Handles a rule with a symbolic expression attached to a syscall name and updates the filter list accordingly.
- **Inputs**:
    - `name`: The name of the syscall to check.
    - `expr`: The symbolic expression associated with the syscall.
    - `filt`: The list of filter instructions to which new instructions will be appended.
- **Logic and Control Flow**:
    - Maps the check for the given `name` to the current length of `filt` in `relo_abs_mapping`.
    - Parses the `expr` using `edn_format.loads`.
    - If `expr` is a tuple, sets `success` to 'RET_ALLOW' and calls [`eval_`](<#eval_>) with `expr`, `filt`, `success`, and 'RET_KILL_PROCESS'.
    - If `expr` is an `edn_format.Symbol`, appends a [`ReloCondJump`](<#relocondjump>) to `filt` with the syscall name and expression.
- **Output**: Updates the `filt` list with new instructions based on the symbolic expression.
- **Functions Called**:
    - [`firedancer/contrib/codegen/generate_filters.eval_`](<#eval_>)
    - [`firedancer/contrib/codegen/generate_filters.ReloCondJump`](<#relocondjump>)


---
### eval\_<!-- {{#callable:firedancer/contrib/codegen/generate_filters.eval_}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L153>)

Evaluates a symbolic expression and generates corresponding cBPF code with conditional logic.
- **Inputs**:
    - `expr`: A symbolic expression, typically a tuple, representing logical operations or comparisons.
    - `filt`: A list to which the function appends cBPF code instructions.
    - `label_t`: A label to jump to if the expression evaluates to true.
    - `label_f`: A label to jump to if the expression evaluates to false.
- **Logic and Control Flow**:
    - Checks if the expression is a tuple and processes based on the first element of the tuple, which is a string representing a logical operation or comparison.
    - Handles 'not' by flipping the true and false labels and recursively evaluating the single argument.
    - Handles 'and' by evaluating each argument in sequence, creating new labels for intermediate results, and updating the relocation mapping.
    - Handles 'or' by evaluating each argument, creating new labels for intermediate results, and updating the relocation mapping.
    - Handles 'arg' by checking the argument number, ensuring it is an integer between 0 and 5, and appending a BPF statement to load the syscall argument into the accumulator.
    - Handles comparison operations ('eq', '<', '<=', '>', '>=') by calling specific evaluation functions that generate comparison instructions.
    - Raises an error if the expression's first element is not recognized as a valid operation.
- **Output**: Appends cBPF code instructions to the `filt` list based on the evaluation of the expression.
- **Functions Called**:
    - [`firedancer/contrib/codegen/generate_filters.new_relo_label`](<#new_relo_label>)
    - [`firedancer/contrib/codegen/generate_filters.CommentedLiteral`](<#commentedliteral>)
    - [`firedancer/contrib/codegen/generate_filters.eval_equal`](<#eval_equal>)
    - [`firedancer/contrib/codegen/generate_filters.eval_less`](<#eval_less>)
    - [`firedancer/contrib/codegen/generate_filters.eval_less_or_equal`](<#eval_less_or_equal>)
    - [`firedancer/contrib/codegen/generate_filters.eval_greater`](<#eval_greater>)
    - [`firedancer/contrib/codegen/generate_filters.eval_greater_or_equal`](<#eval_greater_or_equal>)


---
### gen\_cmp<!-- {{#callable:firedancer/contrib/codegen/generate_filters.gen_cmp}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L225>)

Generates a conditional jump instruction based on the types and values of two operands.
- **Inputs**:
    - `filt`: A list to which the generated conditional jump instruction is appended.
    - `op1`: The first operand, which can be a tuple or an immediate value.
    - `op2`: The second operand, which can be a tuple or an immediate value.
    - `label_t`: The label to jump to if the condition is true.
    - `label_f`: The label to jump to if the condition is false.
    - `cmp_instr`: The comparison instruction to use in the conditional jump.
- **Logic and Control Flow**:
    - Determine the types of `op1` and `op2`.
    - If both `op1` and `op2` are `edn_format.Symbol`, raise an 'unsupported' exception because comparing two immediate values is not supported.
    - If `op1` is a tuple and `op2` is not, evaluate `op1`, then append a [`ReloCondJump`](<#relocondjump>) to `filt` using `op2` as an immediate value.
    - If `op2` is a tuple and `op1` is not, evaluate `op2`, then append a [`ReloCondJump`](<#relocondjump>) to `filt` using `op1` as an immediate value.
    - If neither of the above conditions are met, raise an 'unsupported' exception because the calling convention is not defined.
- **Output**: Appends a [`ReloCondJump`](<#relocondjump>) instruction to the `filt` list or raises an exception if the operation is unsupported.
- **Functions Called**:
    - [`firedancer/contrib/codegen/generate_filters.eval_`](<#eval_>)
    - [`firedancer/contrib/codegen/generate_filters.ReloCondJump`](<#relocondjump>)


---
### eval\_equal<!-- {{#callable:firedancer/contrib/codegen/generate_filters.eval_equal}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L251>)

Generates a comparison operation for equality between two operands and appends the result to a filter list.
- **Inputs**:
    - `filt`: A list to which the generated comparison operation will be appended.
    - `op1`: The first operand for the equality comparison.
    - `op2`: The second operand for the equality comparison.
    - `label_t`: The label to jump to if the comparison evaluates to true.
    - `label_f`: The label to jump to if the comparison evaluates to false.
- **Logic and Control Flow**:
    - Calls the [`gen_cmp`](<#gen_cmp>) function with the provided operands, labels, and the comparison instruction `BPF_JEQ`.
- **Output**: No direct output; modifies the `filt` list by appending a conditional jump instruction.
- **Functions Called**:
    - [`firedancer/contrib/codegen/generate_filters.gen_cmp`](<#gen_cmp>)


---
### eval\_less<!-- {{#callable:firedancer/contrib/codegen/generate_filters.eval_less}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L254>)

Generates a comparison operation for less-than evaluation using BPF instructions.
- **Inputs**:
    - `filt`: A list to which the generated BPF instructions are appended.
    - `op1`: The first operand for the comparison, which can be a tuple or a non-tuple value.
    - `op2`: The second operand for the comparison, which can be a tuple or a non-tuple value.
    - `label_t`: The label to jump to if the comparison evaluates to true.
    - `label_f`: The label to jump to if the comparison evaluates to false.
- **Logic and Control Flow**:
    - Calls the [`gen_cmp`](<#gen_cmp>) function with the provided operands and labels.
    - Uses the BPF instruction `BPF_JGE` to perform the comparison, which checks if the first operand is greater than or equal to the second operand.
    - Swaps the true and false labels to effectively perform a less-than comparison.
- **Output**: No direct output; modifies the `filt` list by appending BPF instructions.
- **Functions Called**:
    - [`firedancer/contrib/codegen/generate_filters.gen_cmp`](<#gen_cmp>)


---
### eval\_less\_or\_equal<!-- {{#callable:firedancer/contrib/codegen/generate_filters.eval_less_or_equal}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L257>)

Generates a comparison operation for less than or equal to using BPF instructions.
- **Inputs**:
    - `filt`: A list to which the generated BPF instructions are appended.
    - `op1`: The first operand for the comparison, which can be a tuple or a non-tuple value.
    - `op2`: The second operand for the comparison, which can be a tuple or a non-tuple value.
    - `label_t`: The label to jump to if the comparison is true.
    - `label_f`: The label to jump to if the comparison is false.
- **Logic and Control Flow**:
    - Calls the [`gen_cmp`](<#gen_cmp>) function with the provided operands and labels.
    - Uses the comparison instruction `BPF_JGT` to generate the BPF code for the less than or equal to operation.
- **Output**: No direct output; modifies the `filt` list by appending BPF instructions.
- **Functions Called**:
    - [`firedancer/contrib/codegen/generate_filters.gen_cmp`](<#gen_cmp>)


---
### eval\_greater<!-- {{#callable:firedancer/contrib/codegen/generate_filters.eval_greater}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L260>)

Calls the [`gen_cmp`](<#gen_cmp>) function to generate a comparison operation for greater-than logic in a filter.
- **Inputs**:
    - `filt`: A list that represents the filter to which the comparison operation will be appended.
    - `op1`: The first operand for the comparison, which can be a tuple or a non-tuple value.
    - `op2`: The second operand for the comparison, which can be a tuple or a non-tuple value.
    - `label_t`: The label to jump to if the comparison evaluates to true.
    - `label_f`: The label to jump to if the comparison evaluates to false.
- **Logic and Control Flow**:
    - Calls the [`gen_cmp`](<#gen_cmp>) function with the provided operands `op1` and `op2`, labels `label_t` and `label_f`, and the comparison instruction `BPF_JGT`.
- **Output**: No direct output; modifies the `filt` list by appending a comparison operation.
- **Functions Called**:
    - [`firedancer/contrib/codegen/generate_filters.gen_cmp`](<#gen_cmp>)


---
### eval\_greater\_or\_equal<!-- {{#callable:firedancer/contrib/codegen/generate_filters.eval_greater_or_equal}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L263>)

Calls the [`gen_cmp`](<#gen_cmp>) function to generate a comparison operation for greater than or equal to.
- **Inputs**:
    - `filt`: A list that stores the generated BPF instructions.
    - `op1`: The first operand for the comparison.
    - `op2`: The second operand for the comparison.
    - `label_t`: The label to jump to if the comparison is true.
    - `label_f`: The label to jump to if the comparison is false.
- **Logic and Control Flow**:
    - Calls the [`gen_cmp`](<#gen_cmp>) function with the provided operands, labels, and the comparison instruction `BPF_JGE`.
- **Output**: No direct output; modifies the `filt` list by appending BPF instructions.
- **Functions Called**:
    - [`firedancer/contrib/codegen/generate_filters.gen_cmp`](<#gen_cmp>)


---
### resplit\_lines<!-- {{#callable:firedancer/contrib/codegen/generate_filters.resplit_lines}} -->
[View Source →](<../../../../contrib/codegen/generate_filters.py#L266>)

Merges lines that start with a space into the previous line in a list of strings.
- **Inputs**:
    - `lines`: A list of strings where each string represents a line.
- **Logic and Control Flow**:
    - Initialize a counter `i` to 0.
    - Enter a while loop that continues as long as `i` is less than the length of `lines`.
    - Check if the current line `lines[i]` starts with a space.
    - If it does, append the current line to the previous line (`lines[i-1]`) and remove the current line from the list.
    - If it does not, increment the counter `i` by 1.
- **Output**: Returns the modified list of strings with merged lines.



---
Made with ❤️ by [Driver](https://www.driver.ai/)