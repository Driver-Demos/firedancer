<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines metric types, converters, and macros for testing enum-based metrics with error detection.

# Purpose
The code defines a set of macros and structures to manage and track metrics, specifically focusing on counters and enums related to transaction results. It includes definitions for different types of metrics (`FD_METRICS_TYPE_GAUGE`, `FD_METRICS_TYPE_COUNTER`, `FD_METRICS_TYPE_HISTOGRAM`) and converters (`FD_METRICS_CONVERTER_NONE`, `FD_METRICS_CONVERTER_SECONDS`, `FD_METRICS_CONVERTER_NANOSECONDS`). The `DECLARE_METRIC_ENUM` macro is used to create metric metadata, which includes the name, type, description, offset, and converter for each metric. The `fd_metrics_meta_t` structure holds this metadata. The code also defines specific metrics and enums for transaction results, such as `FD_METRICS_COUNTER_BANK_TRANSACTION_RESULT` and `FD_METRICS_ENUM_TRANSACTION_ERROR`.

The [`main`](<#main>) function demonstrates potential issues with array access and metric management, such as out-of-bounds access, mismatched counts, and incorrect enum usage. It highlights common pitfalls when working with metrics and enums, such as accessing arrays with incorrect indices or using mismatched enum names. The function also includes a test for copying metric values using the `FD_MCNT_ENUM_COPY` macro, which shows a size mismatch issue. The code is structured to facilitate the definition and management of metrics, providing a framework for tracking and reporting on various transaction-related metrics.
# Global Variables

---
### fd\_metrics\_tl
- **Type**: `volatile ulong*`
- **Description**: A pointer to a volatile unsigned long integer, used to store metric data.
- **Use**: Used to store and update metric values in a thread-safe manner.


---
### ignored
- **Type**: `fd_metrics_meta_t[]`
- **Description**: An array of `fd_metrics_meta_t` structures that define metadata for different bank transaction results. Each element in the array represents a specific transaction error type and its associated metadata, such as name, type, description, and offset.
- **Use**: Used to store and access metadata for different bank transaction result metrics.


# Data Structures

---
### fd\_metrics\_meta\_t
- **Type**: ``struct``
- **Members**:
    - `name`: Pointer to a constant character string that holds the name of the metric.
    - `enum_name`: Pointer to a constant character string that holds the name of the associated enumeration.
    - `enum_variant`: Pointer to a constant character string that holds the name of the specific variant of the enumeration.
    - `type`: Integer that represents the type of the metric, such as gauge, counter, or histogram.
    - `desc`: Pointer to a constant character string that holds the description of the metric.
    - `offset`: Unsigned long integer that represents the offset of the metric in a data structure.
    - `converter`: Integer that indicates the conversion type applied to the metric, such as none, seconds, or nanoseconds.
- **Description**: Defines metadata for a metric, including its name, type, description, and conversion details, as well as its association with an enumeration and its specific variant.


# Functions

---
### main<!-- {{#callable:main}} -->
[View Source →](<../../../../../../../contrib/codeql/test/query-tests/MetricsEnumAccess/MetricsEnumAccess.c#L89>)

Demonstrates various issues related to array bounds, mismatched counts, and enum usage in C.
- **Inputs**: None
- **Logic and Control Flow**:
    - Defines an array `test_array` with size `FD_METRICS_ENUM_TEST_CNT` (3) and attempts to access index 3, which is out of bounds.
    - Defines an array `mismatched_count_array` with size 4 and iterates over it using a loop that runs `FD_METRICS_ENUM_TEST_CNT` (3) times, causing potential mismatches.
    - Defines an array `mismatched_enum_array` with size `FD_METRICS_ENUM_TEST_CNT` (3) and accesses it using an index from a different enum (`FD_METRICS_ENUM_OTHER_V_SECOND_IDX`).
    - Defines a `counter_array` with size `FD_METRICS_COUNTER_BANK_TRANSACTION_RESULT_CNT` (4) and accesses it using an index from a mismatched enum (`FD_METRICS_ENUM_TEST_V_FIRST_IDX`).
    - Defines a `counter_array2` with size `FD_METRICS_COUNTER_BANK_TRANSACTION_RESULT_CNT` (4) and accesses it using a matching enum index (`FD_METRICS_ENUM_TRANSACTION_ERROR_V_SUCCESS_IDX`).
    - Defines an array `txn_result` with size 2 and attempts to copy data into it using `FD_MCNT_ENUM_COPY`, which expects a size of 4, leading to a size mismatch.
    - Prints "Test complete" to the console.
- **Output**: Returns 0 to indicate successful execution.



---
Made with ❤️ by [Driver](https://www.driver.ai/)