<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Documentation for CodeQL tests in the Firedancer codebase, detailing test structure and contribution guidelines.

# Purpose
This documentation describes the structure and purpose of the Firedancer CodeQL tests directory. The directory contains tests for specific CodeQL queries related to the Firedancer project. Each test consists of a QL query and one or more C/C++ files that serve as test cases. The expected output of the query is stored in a `.expected` file, and the actual output is compared to this expected output to identify test failures. Tests can be executed in Visual Studio Code or via the `codeql test run .` command. The documentation also provides guidelines for contributing to the tests, emphasizing the need for both positive and negative test cases. Query tests are organized in subdirectories named after the query they test, and they use inline expectation tests to annotate expected alerts directly in the code. Additionally, the documentation explains the necessity of mocking external headers to avoid dependencies on specific system environments.
# Content Summary
The document describes the structure and guidelines for CodeQL tests specific to the Firedancer project. These tests are designed to validate custom CodeQL queries using C/C++ test cases. Each test consists of a QL query, test case files, and a `.expected` file that contains the expected output of the query. The actual output is compared to the expected output to identify test failures.

Tests can be executed in Visual Studio Code or via the command line using `codeql test run .`. Contributors are encouraged to create small, focused tests that include both positive and negative cases to demonstrate the query's intended use. For instance, a test for a "Trivial memcpy" query should include cases that both trigger and do not trigger alerts.

Query tests are organized in subdirectories named after the query they test. Each subdirectory contains C/C++ test files, a `.ql` or `.qlref` file for the query, and a `.expected` file. Inline expectation tests are used to annotate test cases with comments indicating expected alerts. A `.qlref` file specifies the query and a postprocessing step using `InlineExpectationsTestQuery.ql` to compare query results with expectations.

If there are discrepancies between expected and actual results, the test fails, and the `.expected` file highlights these differences. Initially, the `.expected` file may be empty, and users can generate it by accepting the actual output as expected output through VS Code or the command line.

External library headers are not included in the test database to avoid system dependencies. Instead, necessary functions like `memcpy` are mocked within the test files. `#include` directives can be used for files within the same directory or subdirectories to share common definitions.

---
Made with ❤️ by [Driver](https://www.driver.ai/)