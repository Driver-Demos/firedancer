<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Detects inconsistent operations on function return values in C++ code, potentially causing resource leaks.

# Purpose
The code is a static analysis script designed to identify potential issues in C++ code where a function's return value is inconsistently operated upon. Specifically, it checks for cases where operations such as `free`, `delete`, or `close` are usually performed on a function's return value, but are omitted in some instances. This inconsistency can lead to resource leaks or misuse of the API, which the script flags as a warning with medium precision.

The script defines several predicates to facilitate its analysis. The `exclude` predicate filters out functions based on their names, such as those starting with "get" or "strto", which are typically not subject to the operations in question. The `checkExpr` predicate verifies if a specific operation is performed on a variable associated with a function call. The `checkedFunctionCall` and `relevantFunctionCall` predicates determine whether a function call is relevant to the analysis and if the necessary operation is performed on its return value. The `functionStats` predicate calculates statistics on how often the operation is performed relative to the total number of calls to a function.

The script concludes by selecting function calls that do not have the expected operation performed on their return value, provided that the operation is performed in at least 70% of other calls to the same function. It generates a warning message indicating the percentage of calls where the operation is performed and suggests that the operation might be missing in the flagged instance. This analysis is limited to files within a specific directory structure, excluding those in build directories.
# Imports and Dependencies

---
- `cpp`



---
Made with ❤️ by [Driver](https://www.driver.ai/)