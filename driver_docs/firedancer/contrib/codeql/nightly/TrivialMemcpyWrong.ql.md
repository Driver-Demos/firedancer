<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Detects incorrect `memcpy` size arguments when destination and source pointer types differ in size.

# Purpose
This code defines a static analysis rule to detect potential errors in the use of the `memcpy` function. The rule checks for cases where the size argument in a `memcpy` call is derived from the `sizeof` operator applied to a type, and the source (`src`) and destination (`dst`) pointers point to types of different sizes. The rule suggests that an assignment expression might be more appropriate in such cases, as the size mismatch could lead to incorrect memory copying.

The code consists of several components. The `MemcpyFunction` class extends a `Function` class and identifies functions with global or standard names like `memcpy`, `fd_memcpy`, or `__builtin_memcpy`. The `NotVoidChar` class extends a `Type` class and filters out types that are not `CharType` or `VoidType`. The main logic is implemented in a query that selects function calls to `memcpy` where the size argument is a `SizeofTypeOperator`, and the base types of the source and destination pointers differ in size. If these conditions are met, the rule generates a message indicating the potential error.

This code is part of a static analysis tool, likely used to ensure code correctness by identifying and reporting potential issues with `memcpy` usage. It does not define a public API or external interface but rather provides a specific rule for internal use within a code analysis framework. The rule is tagged with metadata such as severity, precision, and tags to categorize the type of problem it addresses.
# Imports and Dependencies

---
- `cpp`
- `filter`


# Data Structures

---
### MemcpyFunction
- **Type**: `class`
- **Members**:
    - ``MemcpyFunction``: A class that extends `Function` to identify `memcpy` or similar functions.
    - ``NotVoidChar``: A class that extends `Type` to identify types that are neither `CharType` nor `VoidType`.
- **Description**: The `MemcpyFunction` class extends the `Function` class to identify calls to `memcpy` or similar functions like `fd_memcpy` and `__builtin_memcpy`. It is used in conjunction with the `NotVoidChar` class to detect potential issues with the size argument in `memcpy` calls, specifically when the sizes of the source and destination types differ or do not match the size specified by the `sizeof` operator. This structure is part of a mechanism to ensure correctness in memory copy operations by flagging potential errors in the size argument.


---
### NotVoidChar
- **Type**: ``Type``
- **Members**:
    - ``CharType``: Represents a character type in the type system.
    - ``VoidType``: Represents a void type in the type system.
- **Description**: Represents a type that is neither a character type nor a void type, used to filter out these specific types in type-related operations.



---
Made with ❤️ by [Driver](https://www.driver.ai/)