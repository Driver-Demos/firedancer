<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Detects functions with const or pure attributes that illegally access pointers.

# Purpose
This code defines a set of classes and predicates to identify violations of `const` and `pure` function attributes in C++ code. The primary purpose is to detect when functions marked with these attributes access pointers in ways that violate the constraints implied by the attributes. The code is structured to be part of a static analysis tool, likely used to analyze C++ source code for potential issues related to function purity and const-correctness.

The code includes an abstract class `RestrictedFunc`, which extends the `Function` class. This class provides a method `getAPointerParam` to retrieve parameters that are pointers. It also defines a predicate `isViolated`, which is overridden in derived classes to specify the conditions under which a violation occurs. The `ConstFunc` and `PureFunc` classes extend `RestrictedFunc` and implement specific logic to detect violations for functions marked with `const` and `pure` attributes, respectively. The `ConstFunc` class checks if a pointer parameter is dereferenced, while the `PureFunc` class checks for impure variable access through pointer parameters.

The code uses a query to select functions that violate the specified conditions. It checks if a function is included in the analysis and if it violates the constraints of its attribute. If a violation is found, it generates a warning message indicating the nature of the violation. This code is intended to be part of a larger system that performs static code analysis, providing high-precision warnings about potential issues in C++ code related to function attributes.
# Imports and Dependencies

---
- `cpp`
- `filter`


# Data Structures

---
### RestrictedFunc
- **Type**: ``abstract class``
- **Members**:
    - ``getAPointerParam``: Returns a parameter of the function that has a pointer indirection level greater than zero.
    - ``isViolated``: Defines a predicate that always returns false, indicating no violation by default.
- **Description**: Represents an abstract class that extends the `Function` class and provides a framework for functions that are attributed with `const` or `pure`. It includes a method to retrieve pointer parameters and a predicate to check for violations, which derived classes can override to implement specific violation checks.


---
### ConstFunc
- **Type**: ``class``
- **Members**:
    - ``ConstFunc``: Represents a function that is attributed with `const` and checks for illegal pointer access.
    - ``ConstFunc()``: Constructor that sets the attribute name to `const`.
    - ``isViolated()``: Overrides the `isViolated` predicate to check if a pointer parameter is accessed illegally.
- **Description**: Represents a specialized function class that extends `RestrictedFunc` and is used to identify violations where a function marked as `const` accesses a pointer in a way that is not allowed. It overrides the `isViolated` predicate to determine if the function's pointer parameter is accessed inappropriately, thus violating the `const` attribute.


---
### PureFunc
- **Type**: ``class``
- **Members**:
    - ``PureFunc``: A class that extends `RestrictedFunc` and represents functions attributed with `pure`.
    - ``PureFunc()``: A constructor that sets the attribute name to `pure`.
    - ``isViolated()``: An overridden predicate that checks if a `pure` function accesses a pointer in an illegal way.
- **Description**: Represents a class that extends `RestrictedFunc` to model functions attributed with `pure`. It includes a constructor to set the attribute name to `pure` and an overridden predicate `isViolated()` to determine if the function accesses a pointer in an illegal way, which violates the `pure` attribute.



---
Made with ❤️ by [Driver](https://www.driver.ai/)