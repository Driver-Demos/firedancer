<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Detects suspicious comparisons between index-based and max-sized expressions that can cause off-by-one errors.

# Purpose
The code is designed to identify and warn about potentially incorrect comparisons between index-based expressions and max-sized expressions in C++ code. These comparisons can lead to off-by-one errors, which are common sources of bugs in software development. The code defines classes and predicates to detect these issues by analyzing the structure and naming patterns of expressions.

The `NamedExpr` class serves as a base class for expressions that can be identified by their name, such as variable accesses, function calls, and macro invocations. The `IdxBasedExpr` and `MaxBasedExpr` classes extend `NamedExpr` to specifically identify index-based and max-sized expressions, respectively. These classes use naming patterns to match common index and max size variable names, such as `%IDX%`, `%MAX%`, and others.

The `wrongComparison` predicate is central to the functionality. It checks for specific relational operations that are suspicious, such as using `<=` instead of `<` when comparing an index to a max size. The code then selects these operations and generates a warning message to inform the developer of the potential error. This functionality is useful for improving code security and correctness by highlighting areas where index and size comparisons may not behave as intended.
# Imports and Dependencies

---
- `cpp`
- `filter`


# Data Structures

---
### NamedExpr
- **Type**: ``class``
- **Members**:
    - ``NamedExpr``: A base class for expressions that can be identified by their name.
    - ``getName``: A method that returns the name of the expression, which can be a variable, function, or macro.
- **Description**: Represents a base class for expressions that can be identified by their name, including variable accesses, function calls, and macro invocations. The `NamedExpr` class extends the `Expr` class and includes a constructor that checks if the instance is a `VariableAccess`, `Call`, or a `MacroInvocation`. The `getName` method retrieves the name of the target expression, which can be a variable, function, or macro, by checking the type of the expression and returning the appropriate name.


---
### IdxBasedExpr
- **Type**: ``class``
- **Members**:
    - `IdxBasedExpr`: A constructor that checks if the name of the expression matches a pattern for index-based names.
- **Description**: `IdxBasedExpr` extends `NamedExpr` and represents expressions that are identified by names matching common index patterns such as `%IDX%`, `%idx%`, or single-letter variables like `i`, `j`, `k`, etc. It is used to identify index-based expressions in code, which can be involved in potentially suspicious comparisons with max-sized expressions.


---
### MaxBasedExpr
- **Type**: ``class``
- **Members**:
    - `MaxBasedExpr`: Represents expressions identified by names that match a pattern for maximum or size-related terms.
- **Description**: `MaxBasedExpr` is a class that extends `NamedExpr` and represents expressions whose names match patterns related to maximum or size terms, such as `%MAX%`, `%max%`, `%SIZE%`, `%size%`, `%LENGTH%`, or `%length%`. It excludes names that match `max_idx%`. This class is used to identify expressions that are potentially involved in suspicious comparisons with index-based expressions, which can lead to off-by-one errors.



---
Made with ❤️ by [Driver](https://www.driver.ai/)