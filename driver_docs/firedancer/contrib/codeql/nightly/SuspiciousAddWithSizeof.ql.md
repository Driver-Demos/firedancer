<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Detects suspicious pointer arithmetic with `sizeof` that can cause buffer overflows in C++ code.

# Purpose
This code defines a static analysis rule for identifying potential security issues related to pointer arithmetic in C++ code. The rule specifically targets expressions where the `sizeof` operator is used in conjunction with pointer arithmetic, which can lead to buffer overflow conditions if the offset is implicitly scaled. The rule is categorized as a problem with a high precision and a security severity rating of 8.8, indicating its importance in identifying critical security vulnerabilities.

The code imports necessary modules such as `cpp`, `IncorrectPointerScalingCommon`, and `filter` to facilitate the analysis. It defines a private predicate `isCharSzPtrExpr` that checks if an expression is a pointer to a `char` or `void` type. This is important because pointer arithmetic involving these types can be prone to errors if not handled correctly.

The main logic of the rule is implemented using a query that identifies expressions involving `addWithSizeof`. It checks if the pointer expression is not of type `char*` or `void*`, which would indicate a potential mistake. If such an expression is found, the rule selects it and generates a warning message indicating the suspicious use of `sizeof` in the pointer arithmetic expression. This helps developers identify and correct potential security issues in their code.
# Imports and Dependencies

---
- `cpp`
- `IncorrectPointerScalingCommon`
- `filter`



---
Made with ❤️ by [Driver](https://www.driver.ai/)