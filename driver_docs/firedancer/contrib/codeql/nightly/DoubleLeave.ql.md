<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Detects and warns about operations on objects that are not properly joined before use in C++ code.

# Purpose
The code defines a static analysis rule for identifying a specific pattern of potential errors in C++ code, known as "double leave." This pattern occurs when an object is operated on without being properly joined, which can lead to issues with correctness and maintainability. The rule is categorized as a path problem with a warning severity level and high precision. It is part of the `asymmetric-research` namespace and is tagged for correctness and maintainability.

The code imports several modules, including `cpp`, `GenericDoubleFree`, and `semmle.code.cpp.dataflow.new.DataFlow`, which are necessary for performing data flow analysis. It defines two functions, `matchLeave` and `matchJoin`, which use regular expressions to identify patterns in strings that represent operations on objects. These functions are used to configure a data flow analysis module, `Flow`, which is instantiated with `DoubleFreeConfig` to track the flow of operations between "leave" and "join" actions.

The main logic of the code is a query that identifies paths in the code where an object is left without being joined. It uses the `Flow::flowPath` predicate to find paths between source and sink nodes in the code's control flow graph. The query ensures that the source and sink nodes are on different lines and are included in the analysis. The `select` statement at the end of the query specifies the output format, highlighting the sink node and the path from source to sink with the message "double leave." This code is intended to be used as part of a static analysis tool to help developers identify and fix potential issues in their C++ code.
# Imports and Dependencies

---
- `cpp`
- `GenericDoubleFree`
- `semmle.code.cpp.dataflow.new.DataFlow`
- `Flow::PathGraph`
- `filter`


# Functions

---
### matchLeave
Extracts a substring from the input string that matches a pattern ending with '_leave'.
- **Inputs**:
    - `x`: A string from which the function will extract a substring that matches the pattern.
- **Logic and Control Flow**:
    - Uses the `regexpCapture` method on the input string `x` to find a substring that matches the pattern '(.*)_leave'.
    - Captures the first group of the regular expression match, which is the part of the string before '_leave'.
- **Output**: Returns the captured substring from the input string `x` that matches the pattern.


---
### matchJoin
Extracts the substring from a given string that matches the pattern ending with '_join'.
- **Inputs**:
    - `x`: A string input from which the function will extract a substring.
- **Logic and Control Flow**:
    - Uses the `regexpCapture` method to search for a pattern in the input string `x`.
    - The pattern searched is any sequence of characters followed by '_join'.
    - Extracts the part of the string that matches the pattern before '_join'.
- **Output**: Returns the substring that matches the pattern before '_join' in the input string.



---
Made with ❤️ by [Driver](https://www.driver.ai/)