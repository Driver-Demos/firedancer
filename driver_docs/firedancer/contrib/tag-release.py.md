<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Automates version incrementing and tagging in a Git repository based on version.mk and branch name.

# Purpose
The code is a script designed to manage versioning for a software project. It reads version information from a file named `version.mk`, which is expected to contain `VERSION_MAJOR`, `VERSION_MINOR`, and `VERSION_PATCH` definitions. The script verifies that these version components are correctly formatted and present. It also checks the current Git branch name to ensure it follows a specific naming convention (`v0.x`) and that the minor version in the branch name matches the one in `version.mk`.

After validation, the script increments the patch version number, ensuring it does not exceed a predefined limit. It retrieves the Solana version from a Cargo package and formats it for use in version tagging. The script updates the `version.mk` file with the new version information, commits the changes to the Git repository, and creates a new Git tag with the updated version. This process helps maintain consistent version control and ensures that version increments are properly documented and tagged in the repository.
# Imports and Dependencies

---
- `subprocess`


# Functions

---
### main<!-- {{#callable:firedancer/contrib/tag-release.main}} -->
[View Source →](<../../../contrib/tag-release.py#L1>)

Reads, updates, and commits version information from a file and the current git branch.
- **Inputs**: None
- **Logic and Control Flow**:
    - Open the file `src/app/fdctl/version.mk` and read its lines.
    - Initialize `version_major`, `version_minor`, and `version_patch` to `None`.
    - Iterate over each line in the file to extract version numbers; exit with an error if the format is incorrect.
    - Check if any version number is `None` and exit with an error if true.
    - Retrieve the current git branch name using `git rev-parse --abbrev-ref HEAD`.
    - Verify the branch name starts with 'v0.'; exit with an error if not.
    - Extract the minor version from the branch name and compare it with `version_minor`; exit with an error if they do not match.
    - Increment `version_patch` by 1 and check if it is less than 100; exit with an error if not.
    - Retrieve the Solana version using `cargo pkgid` and parse its major, minor, and patch numbers.
    - Format the Solana version into a string `solana_version`.
    - Write the updated version numbers back to `src/app/fdctl/version.mk`.
    - Create a git commit and tag with the new version information.
- **Output**: No return value; performs file operations and git commands as side effects.



---
Made with ❤️ by [Driver](https://www.driver.ai/)