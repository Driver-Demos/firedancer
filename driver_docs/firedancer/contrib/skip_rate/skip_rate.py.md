<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Calculates skip rate and adjusted skip rate for a Solana validator during a given epoch.

# Purpose
This script interacts with the Solana blockchain to calculate the skip rate and the adjusted skip rate for a specific validator during a given epoch. It uses the Solana JSON-RPC API to retrieve epoch information and leader schedules, and it identifies which slots were missed by the validator. The script first retrieves the current epoch and the range of slots within that epoch. It then requests the leader schedule for the validator and determines which slots were missed by checking if blocks were produced for those slots.

The script further analyzes the missed slots to determine if they were due to the validator being offline. It does this by checking surrounding slots for the presence of transactions involving the validator. The skip rate is calculated as the ratio of missed slots to total leader slots, while the adjusted skip rate accounts for slots missed due to the validator being offline. The script outputs the skip rate, adjusted skip rate, and lists of missed and made leader slots.
# Imports and Dependencies

---
- `requests`
- `time`


# Global Variables

---
### api\_endpoint
- **Type**: ``str``
- **Description**: Defines the URL of the Solana testnet API endpoint. This string is used to make HTTP POST requests to the Solana blockchain network for retrieving epoch and leader schedule information.
- **Use**: Used as the target URL for HTTP requests to interact with the Solana testnet API.


---
### json\_data
- **Type**: ``dict``
- **Description**: A dictionary that represents a JSON-RPC request to the Solana API. It contains keys such as `jsonrpc`, `id`, `method`, and `params` to specify the request details.
- **Use**: Used to send a request to the Solana API to retrieve the leader schedule for a specific validator identity.


---
### fd\_validator
- **Type**: ``str``
- **Description**: A string that represents the identity of a validator in the Solana network. This string is used to identify the validator when making requests to the Solana API.
- **Use**: Used to specify the validator identity in API requests to retrieve leader schedule and block information.


---
### response
- **Type**: ``requests.models.Response``
- **Description**: The `response` variable stores the HTTP response object returned by the `requests.post` method. This object contains the server's response to the HTTP request made to the specified API endpoint.
- **Use**: Used to check the status of the HTTP request and to access the JSON data returned by the server.


---
### epoch\_json
- **Type**: ``dict``
- **Description**: Contains the result of the JSON response from the Solana API call to get epoch information. The data structure is a dictionary that includes details about the current epoch, such as the epoch number and slot information.
- **Use**: Used to extract and print the current epoch and calculate slot indices for further processing.


---
### cur\_epoch
- **Type**: ``int``
- **Description**: Holds the current epoch number obtained from the Solana network's epoch information. The epoch number is extracted from the JSON response of the `getEpochInfo` API call.
- **Use**: Used to track the current epoch in the Solana network for further processing and calculations.


---
### end\_slot
- **Type**: `int`
- **Description**: Represents the absolute slot number at the end of the current epoch as retrieved from the Solana API response.
- **Use**: Used to determine the range of slots for the current epoch and to filter leader slots that have occurred.


---
### start\_slot
- **Type**: `int`
- **Description**: The `start_slot` variable is an integer that represents the starting slot number for the current epoch. It is calculated by subtracting the `slotIndex` from the `absoluteSlot` obtained from the `epoch_json` data.
- **Use**: Used to determine the starting point for leader slots in the current epoch.


---
### leader\_slots
- **Type**: `list`
- **Description**: A list of leader slots for a specific validator in the current epoch. The list is filtered to include only those slots that have already occurred, based on the current slot index and the start slot of the epoch.
- **Use**: Used to track and analyze the slots assigned to a validator, determining which slots were missed or successfully processed.


---
### missed\_leaders
- **Type**: ``list``
- **Description**: Stores the slots that were missed by the validator during the current epoch. A slot is considered missed if the API response for the slot contains an error.
- **Use**: Used to keep track of missed leader slots for further analysis and calculation of skip rates.


---
### made\_leaders
- **Type**: ``list``
- **Description**: Stores the slots that were successfully processed by the leader. The list is populated by iterating over `leader_slots` and checking if a block was successfully retrieved for each slot.
- **Use**: Used to keep track of slots where the leader successfully processed a block.


---
### true\_skipped\_slots
- **Type**: ``list``
- **Description**: A list that stores slots that were missed due to the validator being offline. It is populated by checking missed slots against nearby slots to determine if the validator was offline during those times.
- **Use**: Used to calculate the adjusted skip rate by identifying slots that were truly skipped due to the validator being offline.


---
### skip\_rate
- **Type**: `float`
- **Description**: Calculates the proportion of leader slots that were missed during the current epoch. It is computed by dividing the number of missed leader slots (`missed_leaders`) by the total number of leader slots (`leader_slots`).
- **Use**: Used to determine the basic skip rate for leader slots in the current epoch.


---
### adjusted\_skip\_rate
- **Type**: ``float``
- **Description**: Represents the adjusted skip rate for a validator, calculated as the ratio of truly skipped slots to the total of made leaders and truly skipped slots. This calculation accounts for slots that were missed due to reasons other than the validator being offline.
- **Use**: Used to determine the validator's performance by factoring in offline periods when calculating the skip rate.



---
Made with ❤️ by [Driver](https://www.driver.ai/)