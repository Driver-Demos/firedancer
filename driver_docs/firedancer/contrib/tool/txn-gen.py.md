<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

A tool for generating and sending Solana transactions with various types and configurations.

# Purpose
The code is a Python script designed to interact with the Solana blockchain, specifically for managing and sending transactions. It imports various modules and libraries to facilitate blockchain operations, including `solana.rpc.api`, `solders`, and `spl.token`. The script defines several functions to perform tasks such as fetching recent block hashes, checking account balances, creating accounts, and sending different types of transactions (e.g., system transfers, token transfers, and nano token transfers). It uses multiprocessing and threading to handle concurrent operations, allowing for efficient transaction processing and monitoring.

The script is structured to be executed as a standalone program, as indicated by the `main()` function and the `if __name__ == "__main__":` block. It uses command-line arguments to configure its operation, such as specifying the number of keys, transaction type, and account access distribution. The script sets up UDP connections to send transactions to specified TPU endpoints and includes mechanisms to monitor transaction throughput and fetch recent block hashes continuously. The primary purpose of the script is to automate the process of creating accounts and sending transactions on the Solana blockchain, making it suitable for testing or managing blockchain operations at scale.
# Imports and Dependencies

---
- `argparse`
- `logging`
- `json`
- `time`
- `random`
- `socket`
- `math`
- `multiprocessing`
- `threading`
- `requests`
- `functools.partial`
- `typing.List`
- `multiprocessing.sharedctypes.SynchronizedBase`
- `multiprocessing.Event`
- `multiprocessing.Value`
- `multiprocessing.Array`
- `base64`
- `numpy`
- `tqdm`
- `pqdm.processes.pqdm`
- `solana.transaction.Transaction`
- `solana.rpc.api.Client`
- `solders.hash.Hash`
- `solana.rpc.commitment.Commitment`
- `solders.keypair.Keypair`
- `solders.system_program.TransferParams`
- `solders.system_program.transfer`
- `solders.system_program.create_account`
- `solders.system_program.CreateAccountParams`
- `solders.compute_budget.set_compute_unit_limit`
- `solders.compute_budget.set_compute_unit_price`
- `solders.pubkey.Pubkey`
- `solders.instruction.AccountMeta`
- `solders.instruction.Instruction`
- `solders.system_program.ID`
- `spl.token.client.Token`
- `spl.token.constants.TOKEN_PROGRAM_ID`
- `spl.token._layouts.ACCOUNT_LAYOUT`
- `spl.token._layouts.MINT_LAYOUT`
- `spl.token._layouts.MULTISIG_LAYOUT`
- `spl.token.instructions.initialize_mint`
- `spl.token.instructions.get_associated_token_address`
- `spl.token.instructions.create_associated_token_account`
- `spl.token.instructions.InitializeMintParams`
- `spl.token.instructions.mint_to`
- `spl.token.instructions.MintToParams`
- `spl.token.instructions.transfer`
- `spl.token.instructions.TransferParams`
- `solders.rent.Rent`
- `solana.rpc.types.TxOpts`


# Global Variables

---
### TXN\_TYPE\_EMPTY
- **Type**: ``int``
- **Description**: Represents a transaction type identifier for an empty transaction. It is assigned the integer value `0`. This variable is part of a set of constants that define different transaction types.
- **Use**: Used to specify the type of transaction as empty in various transaction processing functions.


---
### TXN\_TYPE\_SYSTEM\_TRANSFER
- **Type**: ``int``
- **Description**: Represents a constant integer value used to identify a specific type of transaction, specifically a system transfer transaction, in the code. It is assigned the value `1`.
- **Use**: Used to specify the transaction type as a system transfer in various functions and logic throughout the code.


---
### TXN\_TYPE\_TOKEN\_TRANSFER
- **Type**: ``int``
- **Description**: Represents the transaction type identifier for token transfer operations. It is assigned the integer value `2`, which is used to distinguish token transfer transactions from other types of transactions in the system.
- **Use**: Used to specify the type of transaction when creating or processing transactions that involve token transfers.


---
### TXN\_TYPE\_NANO\_TOKEN\_TRANSFER
- **Type**: `int`
- **Description**: Represents a constant integer value used to identify a specific type of transaction, specifically a nano token transfer, within the system.
- **Use**: Used to specify the transaction type as a nano token transfer in various functions and logic throughout the code.


---
### ACCT\_ACCESS\_DIST\_REGULAR
- **Type**: ``int``
- **Description**: Represents a constant integer value used to define a specific type of account access distribution. It is set to `0`, indicating a regular distribution type.
- **Use**: Used to specify the type of account access distribution in transaction processing.


---
### ACCT\_ACCESS\_DIST\_POWER
- **Type**: `int`
- **Description**: Represents a constant integer value used to specify a type of account access distribution.
- **Use**: Used to determine the account access distribution type in transaction processing.


---
### NANO\_TOKEN\_ID
- **Type**: ``Pubkey``
- **Description**: Represents a public key for a specific token, identified by the string 'GjyKyRCSygSaszrjJFu43jkAshFc1sWs45HqKEDXhvwx'. This public key is used in the context of Solana blockchain operations.
- **Use**: Used as the owner identifier in various account creation and transaction operations related to the NANO token.


---
### NOOP\_ID
- **Type**: ``Pubkey``
- **Description**: Represents a public key object created from a string that is used as a unique identifier for a 'No Operation' token. This public key is generated using the `from_string` method of the `Pubkey` class with a specific string value.
- **Use**: Used as a constant identifier for a 'No Operation' token within the application.


---
### seed\_file
- **Type**: `file object`
- **Description**: Opens the file located at `../test-ledger/faucet-keypair.json` in read mode. This file is expected to contain JSON data that is used to initialize the `top_seed` variable.
- **Use**: Used to read JSON data from a file to initialize the `top_seed` variable.


---
### top\_seed
- **Type**: ``bytes``
- **Description**: The `top_seed` variable is a byte sequence that is loaded from a JSON file named `faucet-keypair.json`. This file is opened in read mode, and its contents are parsed using the `json.load` function, which returns a Python object. The object is then converted into a byte sequence using the `bytes` constructor.
- **Use**: Used as a seed for generating key pairs with specific derivation paths.


---
### fd\_mint
- **Type**: ``Keypair``
- **Description**: Represents a keypair generated from a seed and a derivation path. The `fd_mint` variable is created using the `Keypair.from_seed_and_derivation_path` method, which takes a seed (`top_seed`) and a specific derivation path (`m/44'/45'/30'/99999'`).
- **Use**: Used to generate a public key for the mint address and to sign transactions related to the minting process.


---
### config\_acc
- **Type**: ``Keypair``
- **Description**: Represents a keypair object created from bytes loaded from a JSON configuration file. The keypair is initialized using the `Keypair.from_bytes` method, which converts the byte data into a keypair object.
- **Use**: Used to manage and access the public key and private key for a specific account configuration.


---
### nano\_mint
- **Type**: ``Keypair``
- **Description**: Represents a keypair generated from a seed and a specific derivation path. The `nano_mint` variable is created using the `Keypair.from_seed_and_derivation_path` method with a seed (`top_seed`) and a derivation path (`m/44'/45'/30'/99996'`).
- **Use**: Used to generate a public key for the nano mint address and to sign transactions related to the nano mint account.


# Functions

---
### get\_recent\_blockhash<!-- {{#callable:firedancer/contrib/tool/txn-gen.get_recent_blockhash}} -->
[View Source →](<../../../../contrib/tool/txn-gen.py#L63>)

Fetches the most recent blockhash from a Solana RPC endpoint.
- **Inputs**:
    - `rpc`: A string representing the URL of the Solana RPC endpoint to query.
- **Logic and Control Flow**:
    - Constructs a JSON-RPC request payload to get the latest blockhash with a commitment level of 'processed'.
    - Sends a POST request to the specified RPC endpoint with the constructed payload.
    - Parses the JSON response to extract the blockhash value.
    - Converts the blockhash string into a `Hash` object and returns it.
- **Output**: A `Hash` object representing the most recent blockhash.


---
### get\_balance<!-- {{#callable:firedancer/contrib/tool/txn-gen.get_balance}} -->
[View Source →](<../../../../contrib/tool/txn-gen.py#L68>)

Fetches the balance of a given account using an RPC endpoint.
- **Inputs**:
    - `rpc`: A string representing the RPC endpoint URL.
    - `acc`: A `Pubkey` object representing the account for which to fetch the balance.
- **Logic and Control Flow**:
    - Convert the `acc` object to a string and store it in `acc_str`.
    - Create a JSON-RPC request payload as a string, using the `acc_str` and a commitment level of 'confirmed'.
    - Send a POST request to the `rpc` URL with the JSON-RPC payload and appropriate headers.
    - Check if the response status code is not 200; if so, return 0.
    - If the response status code is 200, parse the JSON response to extract and return the balance value from the 'result' field.
    - If any exception occurs during the process, return 0.
- **Output**: An integer representing the balance of the account, or 0 if an error occurs.


---
### get\_account\_info<!-- {{#callable:firedancer/contrib/tool/txn-gen.get_account_info}} -->
[View Source →](<../../../../contrib/tool/txn-gen.py#L80>)

Fetches account information from a Solana RPC endpoint and decodes the account data if available.
- **Inputs**:
    - `rpc`: A string representing the URL of the Solana RPC endpoint to send the request to.
    - `acc`: A string representing the account address for which to fetch information.
- **Logic and Control Flow**:
    - Constructs a JSON-RPC request payload to fetch account information for the given account address with specific parameters.
    - Sends a POST request to the specified RPC endpoint with the constructed payload and appropriate headers.
    - Checks if the HTTP response status code is not 200, and returns None if true.
    - Checks if the 'value' field in the JSON response is None, and returns None if true.
    - Decodes the base64-encoded account data from the JSON response and returns it.
- **Output**: Returns the decoded account data as bytes if available, otherwise returns None.


---
### parse\_args<!-- {{#callable:firedancer/contrib/tool/txn-gen.parse_args}} -->
[View Source →](<../../../../contrib/tool/txn-gen.py#L90>)

Parses command-line arguments for a script that interacts with Solana transactions.
- **Inputs**:
    - `None`: This function does not take any input parameters directly.
- **Logic and Control Flow**:
    - Creates an `ArgumentParser` object to handle command-line arguments.
    - Defines several required arguments with specific types and help descriptions, including `--tpus`, `--rpc`, `--nkeys`, `--seed`, `--funder`, `--workers`, `--txn-type`, and `--acct-access-distr`.
    - Parses the command-line arguments using `parser.parse_args()`.
- **Output**: Returns an `argparse.Namespace` object containing the parsed command-line arguments.


---
### send\_round\_of\_txs<!-- {{#callable:firedancer/contrib/tool/txn-gen.send_round_of_txs}} -->
[View Source →](<../../../../contrib/tool/txn-gen.py#L145>)

Sends a batch of transactions to multiple TPU endpoints using a socket.
- **Inputs**:
    - `txs`: A list of `Transaction` objects to send.
    - `sock`: A socket object used to send the transactions.
    - `tpus`: A list of TPU (Transaction Processing Unit) endpoints to which the transactions are sent.
- **Logic and Control Flow**:
    - Iterates over each transaction in the `txs` list using a progress bar provided by `tqdm`.
    - Converts each transaction to a byte format using the `to_solders` method.
    - Iterates over each TPU endpoint in the `tpus` list.
    - Sends the byte-formatted transaction to each TPU endpoint using the `sendto` method of the `sock` object.
    - Pauses for 0.001 seconds after sending the transaction to all TPU endpoints.
- **Output**: No return value; the function sends transactions over the network.


---
### fund\_config\_account<!-- {{#callable:firedancer/contrib/tool/txn-gen.fund_config_account}} -->
[View Source →](<../../../../contrib/tool/txn-gen.py#L153>)

Creates and signs a Solana transaction to fund a configuration account with specified lamports and range.
- **Inputs**:
    - `funder`: The `Keypair` object representing the account that will fund the transaction.
    - `lamports`: The number of lamports to transfer to the configuration account.
    - `recent_blockhash`: The recent blockhash to use for the transaction.
    - `range`: An additional amount to add to the lamports for the transaction.
- **Logic and Control Flow**:
    - Creates a `Transaction` object with the given `recent_blockhash`, no fee payer, the funder's public key, and sets compute unit price and limit.
    - Adds an instruction to create an account with the specified parameters, including the sum of `lamports` and `range`, and assigns it to the `NANO_TOKEN_ID` owner.
    - Signs the transaction with the `funder` and `config_acc` keypairs.
    - Returns the signed transaction.
- **Output**: A signed `Transaction` object ready to be sent to the Solana network.


---
### fund\_config\_account2<!-- {{#callable:firedancer/contrib/tool/txn-gen.fund_config_account2}} -->
[View Source →](<../../../../contrib/tool/txn-gen.py#L160>)

Creates and signs a Solana transaction to fund a configuration account with specific instructions and returns the transaction.
- **Inputs**:
    - `funder`: The `Keypair` object representing the account that will fund the transaction.
    - `lamports`: The amount of lamports to transfer.
    - `recent_blockhash`: The recent blockhash to use for the transaction.
    - `range`: An additional range value to adjust the lamports, though it is not used in this function.
- **Logic and Control Flow**:
    - Creates a `Transaction` object with the given `recent_blockhash`, the funder's public key, and sets compute unit price and limit.
    - Initializes a zero value and converts it to a byte array to use as instruction data.
    - Defines a list of `AccountMeta` objects representing the accounts involved in the transaction, including the configuration account, system program ID, and funder's public key.
    - Creates an `Instruction` object with the defined accounts, program ID, and data, and adds it to the transaction.
    - Signs the transaction with the funder's keypair.
    - Returns the signed transaction.
- **Output**: A signed `Transaction` object ready to be sent to the Solana network.


---
### fund\_nano\_mint\_account2<!-- {{#callable:firedancer/contrib/tool/txn-gen.fund_nano_mint_account2}} -->
[View Source →](<../../../../contrib/tool/txn-gen.py#L174>)

Creates and signs a transaction to fund a nano mint account with specified lamports and additional range.
- **Inputs**:
    - `funder`: The `Keypair` object representing the account that will fund the transaction.
    - `lamports`: The number of lamports to transfer to the nano mint account.
    - `recent_blockhash`: The recent blockhash to use for the transaction.
    - `range`: An additional amount of lamports to add to the transfer.
- **Logic and Control Flow**:
    - Creates a `Transaction` object with the given `recent_blockhash`, no fee payer, and the funder's public key.
    - Sets compute unit price to 3 and compute unit limit to 300,000 for the transaction.
    - Adds an instruction to create an account with the specified lamports plus range, space of 64 bytes, and owner as `NANO_TOKEN_ID`.
    - Signs the transaction with the funder's and nano mint's keypairs.
- **Output**: Returns the signed `Transaction` object.


---
### fund\_nano\_mint\_account<!-- {{#callable:firedancer/contrib/tool/txn-gen.fund_nano_mint_account}} -->
[View Source →](<../../../../contrib/tool/txn-gen.py#L182>)

Creates and signs a transaction to fund a nano mint account with specific parameters.
- **Inputs**:
    - `funder`: The `Keypair` object representing the account that will fund the transaction.
    - `lamports`: The amount of lamports to transfer.
    - `recent_blockhash`: The recent blockhash to use for the transaction.
    - `range`: An additional parameter that is not used in the function logic.
- **Logic and Control Flow**:
    - Creates a `Transaction` object with the given `recent_blockhash`, no fee payer, the funder's public key, and sets compute unit price and limit.
    - Initializes data for the transaction by converting integers to bytes and concatenating them with the funder's public key bytes.
    - Defines a list of `AccountMeta` objects representing the accounts involved in the transaction, specifying their roles as signer or writable.
    - Creates an `Instruction` object with the defined accounts, program ID, and data, then adds it to the transaction.
    - Signs the transaction with the funder's keypair.
    - Returns the signed transaction.
- **Output**: A signed `Transaction` object ready to be sent to the network.


---
### fund\_token\_account<!-- {{#callable:firedancer/contrib/tool/txn-gen.fund_token_account}} -->
[View Source →](<../../../../contrib/tool/txn-gen.py#L204>)

Creates and signs a transaction to fund a token account with specified lamports and initializes the mint.
- **Inputs**:
    - `funder`: The `Keypair` object representing the account that will fund the token account.
    - `lamports`: The number of lamports to transfer to the new token account.
    - `recent_blockhash`: The recent blockhash to use for the transaction.
    - `is_print`: A boolean flag, though it is not used in the function.
    - `range`: An additional amount to add to the lamports for the account creation.
- **Logic and Control Flow**:
    - Creates a `Transaction` object with the given `recent_blockhash`, no fee payer, and the funder's public key.
    - Sets compute unit price and limit for the transaction using `set_compute_unit_price` and `set_compute_unit_limit`.
    - Adds an instruction to create a new account with the specified lamports plus the range, using `create_account` with `CreateAccountParams`.
    - Initializes mint parameters with a fixed decimal value, the mint's public key, the funder's public key as mint authority, and the token program ID.
    - Adds an instruction to initialize the mint using `initialize_mint` with the specified parameters.
    - Signs the transaction with the funder's and mint's keypairs.
- **Output**: Returns the signed `Transaction` object.


---
### create\_accounts\_tx<!-- {{#callable:firedancer/contrib/tool/txn-gen.create_accounts_tx}} -->
[View Source →](<../../../../contrib/tool/txn-gen.py#L221>)

Creates a transaction to transfer lamports and optionally set up token accounts based on the transaction type.
- **Inputs**:
    - `funder`: The account that funds the transaction and signs it.
    - `lamports`: The amount of lamports to transfer.
    - `recent_blockhash`: The recent blockhash to use for the transaction.
    - `txn_type`: The type of transaction, which determines the setup of token accounts.
    - `accs`: A list of accounts to which lamports will be transferred.
- **Logic and Control Flow**:
    - Set the compute unit limit to 200,000 by default, or 15,000 if the transaction type is `TXN_TYPE_NANO_TOKEN_TRANSFER`.
    - Create a new transaction with the given `recent_blockhash`, `funder`'s public key, and compute unit settings.
    - Iterate over each account in `accs` and add a lamport transfer instruction to the transaction.
    - If `txn_type` is `TXN_TYPE_TOKEN_TRANSFER`, add instructions to create an associated token account and mint tokens to it.
    - If `txn_type` is `TXN_TYPE_NANO_TOKEN_TRANSFER`, derive the nano token address, create an associated token account, and add instructions to mint tokens to it.
    - Sign the transaction with the `funder`'s key.
- **Output**: A signed `Transaction` object ready to be sent to the network.


---
### get\_balance\_sufficient<!-- {{#callable:firedancer/contrib/tool/txn-gen.get_balance_sufficient}} -->
[View Source →](<../../../../contrib/tool/txn-gen.py#L283>)

Checks if an account has a sufficient balance for a transaction, considering specific transaction types.
- **Inputs**:
    - `lamports`: The minimum balance required for the transaction.
    - `rpc`: The RPC endpoint URL to query account information.
    - `txn_type`: The type of transaction to check, such as nano token transfer.
    - `acc`: The account object to check the balance for.
- **Logic and Control Flow**:
    - If the transaction type is `TXN_TYPE_NANO_TOKEN_TRANSFER`, derive the associated token address using the account's public key and a zero value as seeds.
    - Call [`get_account_info`](<#get_account_info>) with the derived address to check if the account data exists and is valid.
    - If the account data does not exist or is invalid, return `None`.
    - Call [`get_balance`](<#get_balance>) with the account's public key to get the current balance.
    - If the balance is available, print the account's public key and balance.
    - If the balance is greater than or equal to the required lamports, return the account object.
    - If the balance is insufficient, return `None`.
- **Output**: Returns the account object if the balance is sufficient; otherwise, returns `None`.
- **Functions Called**:
    - [`firedancer/contrib/tool/txn-gen.get_account_info`](<#get_account_info>)
    - [`firedancer/contrib/tool/txn-gen.get_balance`](<#get_balance>)


---
### create\_accounts<!-- {{#callable:firedancer/contrib/tool/txn-gen.create_accounts}} -->
[View Source →](<../../../../contrib/tool/txn-gen.py#L305>)

Creates multiple accounts and manages their funding and initialization based on transaction type.
- **Inputs**:
    - `funder`: The account that provides the initial funding for the new accounts.
    - `rpc`: The RPC endpoint URL for blockchain communication.
    - `num_accs`: The number of accounts to create.
    - `lamports`: The amount of lamports to allocate to each account.
    - `seed`: The seed used to generate keypairs for the accounts.
    - `sock`: The socket used for sending transactions.
    - `tpus`: A list of TPU (Transaction Processing Unit) endpoints to send transactions to.
    - `txn_type`: The type of transaction to perform, which affects account setup and funding.
- **Logic and Control Flow**:
    - Retrieve account information for `nano_mint` and `fd_mint` using [`get_account_info`](<#get_account_info>) and print balances.
    - Generate keypairs for the specified number of accounts using the provided seed and store them in `accs`.
    - Divide the accounts into chunks for processing in parallel.
    - Check and initialize configuration and mint accounts if `txn_type` is `TXN_TYPE_NANO_TOKEN_TRANSFER`.
    - If `txn_type` is `TXN_TYPE_TOKEN_TRANSFER`, ensure the `fd_mint` account is initialized.
    - Iterate over remaining accounts to check their balance sufficiency and remove funded accounts from the list.
    - Create and send transactions to fund remaining accounts in chunks, adjusting chunk size as needed.
    - Return the list of created accounts.
- **Output**: A list of created `Keypair` objects representing the new accounts.
- **Functions Called**:
    - [`firedancer/contrib/tool/txn-gen.get_account_info`](<#get_account_info>)
    - [`firedancer/contrib/tool/txn-gen.get_balance`](<#get_balance>)
    - [`firedancer/contrib/tool/txn-gen.get_recent_blockhash`](<#get_recent_blockhash>)
    - [`firedancer/contrib/tool/txn-gen.fund_config_account`](<#fund_config_account>)
    - [`firedancer/contrib/tool/txn-gen.send_round_of_txs`](<#send_round_of_txs>)
    - [`firedancer/contrib/tool/txn-gen.fund_nano_mint_account`](<#fund_nano_mint_account>)


---
### gen\_tx\_empty<!-- {{#callable:firedancer/contrib/tool/txn-gen.gen_tx_empty}} -->
[View Source →](<../../../../contrib/tool/txn-gen.py#L393>)

Generates an empty transaction with specified compute unit price and limit, signs it, and returns the transaction.
- **Inputs**:
    - `recent_blockhash`: The recent block hash to use for the transaction.
    - `key`: The keypair used to sign the transaction.
    - `acc`: The account public key associated with the transaction.
    - `cu_price`: The compute unit price to set for the transaction.
- **Logic and Control Flow**:
    - Creates a `Transaction` object with the given `recent_blockhash`, `acc`, and instructions to set compute unit price and limit.
    - Signs the transaction using the provided `key`.
    - Returns the signed transaction.
- **Output**: A signed `Transaction` object.


---
### gen\_tx\_system\_transfer<!-- {{#callable:firedancer/contrib/tool/txn-gen.gen_tx_system_transfer}} -->
[View Source →](<../../../../contrib/tool/txn-gen.py#L398>)

Generates a system transfer transaction with specified parameters and signs it.
- **Inputs**:
    - `recent_blockhash`: The recent blockhash to use for the transaction.
    - `key`: The keypair used to sign the transaction.
    - `acc`: The account public key involved in the transaction.
    - `cu_price`: The compute unit price to set for the transaction.
- **Logic and Control Flow**:
    - Creates a `Transaction` object with the given `recent_blockhash`, `acc`, and compute unit settings.
    - Adds a system transfer instruction to the transaction, transferring 1 lamport from `acc` to `acc`.
    - Signs the transaction using the provided `key`.
    - Returns the signed transaction.
- **Output**: A signed `Transaction` object representing the system transfer.


---
### gen\_tx\_token\_transfer<!-- {{#callable:firedancer/contrib/tool/txn-gen.gen_tx_token_transfer}} -->
[View Source →](<../../../../contrib/tool/txn-gen.py#L405>)

Generates a token transfer transaction on the Solana blockchain.
- **Inputs**:
    - `recent_blockhash`: The recent blockhash to use for the transaction.
    - `key`: The keypair used to sign the transaction.
    - `acc`: The account from which the transaction is initiated.
    - `cu_price`: The compute unit price for the transaction.
- **Logic and Control Flow**:
    - Create a `Transaction` object with the given `recent_blockhash`, `acc`, and compute unit settings.
    - Get the associated token address for the given `key` and `fd_mint` public key.
    - Create `SplTransferParams` with the token program ID, source and destination addresses, owner public key, and amount to transfer.
    - Add a SPL token transfer instruction to the transaction using the `spl_transfer` function and the created parameters.
    - Sign the transaction with the provided `key`.
- **Output**: Returns the signed `Transaction` object.


---
### gen\_tx\_nano\_token\_transfer<!-- {{#callable:firedancer/contrib/tool/txn-gen.gen_tx_nano_token_transfer}} -->
[View Source →](<../../../../contrib/tool/txn-gen.py#L417>)

Generates a transaction for transferring a nano token between two accounts.
- **Inputs**:
    - `recent_blockhash`: The recent blockhash to use for the transaction.
    - `src_key`: The keypair of the source account, used to sign the transaction.
    - `src_acc`: The public key of the source account.
    - `src_nano_ata`: The associated token address of the source account for the nano token.
    - `dst_nano_ata`: The associated token address of the destination account for the nano token.
    - `cu_price`: The compute unit price to set for the transaction.
- **Logic and Control Flow**:
    - Create a `Transaction` object with the given `recent_blockhash`, `src_acc`, and compute unit settings.
    - Define the instruction data for the token transfer, setting a transfer tag and amount.
    - Create a list of `AccountMeta` objects representing the source and destination token accounts and the source account as a signer.
    - Create an `Instruction` object with the nano token program ID, the account metadata, and the instruction data.
    - Add the instruction to the transaction.
    - Sign the transaction with the `src_key`.
- **Output**: Returns the signed `Transaction` object for the nano token transfer.


---
### send\_txs<!-- {{#callable:firedancer/contrib/tool/txn-gen.send_txs}} -->
[View Source →](<../../../../contrib/tool/txn-gen.py#L442>)

Sends transactions to specified TPU endpoints using provided keypairs and transaction parameters.
- **Inputs**:
    - `rpc`: A string representing the RPC endpoint URL.
    - `tpus`: A list of strings representing the TPU UDP endpoints to send transactions to.
    - `keys`: A list of `Keypair` objects used for signing transactions.
    - `tx_idx`: A shared multiprocessing value to track the index of transactions.
    - `mult`: An integer multiplier for transaction processing (not used in the function).
    - `idx`: An integer index for identifying the worker process.
    - `stop_event`: A multiprocessing event used to signal when to stop sending transactions.
    - `rbh`: A byte array representing the recent blockhash.
    - `txn_type`: An integer representing the type of transaction to send.
    - `acct_access_distr`: An integer representing the account access distribution type.
- **Logic and Control Flow**:
    - Create a UDP socket for sending transactions.
    - Generate a list of public keys from the provided keypairs.
    - Derive associated token addresses (ATAs) for each account using the `Pubkey.find_program_address` method.
    - Initialize the recent blockhash and compute unit price variables.
    - Determine the number of iterations (`niter`) based on the account access distribution and transaction type.
    - Enter a loop that continues until the `stop_event` is set.
    - Update the recent blockhash and adjust the compute unit price if the blockhash has not changed.
    - For each iteration, select account indices `i` and `j` based on the account access distribution type.
    - Generate a transaction based on the transaction type using helper functions like [`gen_tx_empty`](<#gen_tx_empty>), [`gen_tx_system_transfer`](<#gen_tx_system_transfer>), etc.
    - Convert the transaction to bytes and send it to each TPU endpoint using the socket.
    - Update the transaction index (`tx_idx`) with the number of iterations processed.
    - Print a stopping message when the loop exits.
- **Output**: No return value; the function sends transactions over the network and updates the transaction index.
- **Functions Called**:
    - [`firedancer/contrib/tool/txn-gen.gen_tx_empty`](<#gen_tx_empty>)
    - [`firedancer/contrib/tool/txn-gen.gen_tx_system_transfer`](<#gen_tx_system_transfer>)
    - [`firedancer/contrib/tool/txn-gen.gen_tx_token_transfer`](<#gen_tx_token_transfer>)
    - [`firedancer/contrib/tool/txn-gen.gen_tx_nano_token_transfer`](<#gen_tx_nano_token_transfer>)


---
### monitor\_send\_tps<!-- {{#callable:firedancer/contrib/tool/txn-gen.monitor_send_tps}} -->
[View Source →](<../../../../contrib/tool/txn-gen.py#L500>)

Monitors and prints the transactions per second (TPS) at regular intervals, adjusting the interval if TPS is zero.
- **Inputs**:
    - `tx_idx`: A `SynchronizedBase` object that holds the current transaction index, used to calculate TPS.
    - `stop_event`: An `Event` object that signals when to stop monitoring.
    - `interval`: An integer specifying the time interval in seconds between TPS calculations, default is 1.
- **Logic and Control Flow**:
    - Initialize `prev_count` to 0 and `prev_time` to the current time.
    - Enter a loop that continues while `interval` is less than 10 and `stop_event` is not set.
    - Sleep for the duration of `interval`.
    - Acquire a lock on `tx_idx` and read the current transaction count into `current_count`.
    - Calculate the current time and compute TPS as the difference between `current_count` and `prev_count` divided by `interval`.
    - Update `prev_count` to `current_count` and calculate the elapsed time since `prev_time`.
    - Print the calculated TPS and elapsed time.
    - If TPS is zero, increment `interval` by 1.
    - Update `prev_time` to the current time.
- **Output**: No return value; outputs TPS and elapsed time to the console.


---
### fetch\_recent\_blockhash<!-- {{#callable:firedancer/contrib/tool/txn-gen.fetch_recent_blockhash}} -->
[View Source →](<../../../../contrib/tool/txn-gen.py#L516>)

Fetches the most recent blockhash from a Solana RPC server and updates a shared memory array with it.
- **Inputs**:
    - `rbh`: A shared memory array to store the recent blockhash as bytes.
    - `rpc`: A string representing the RPC server URL to fetch the blockhash from.
    - `stop_event`: A threading event used to signal when to stop fetching the blockhash.
- **Logic and Control Flow**:
    - Initialize `prev_recent_blockhash` with the current blockhash from the RPC server using [`get_recent_blockhash`](<#get_recent_blockhash>) function.
    - Enter a loop that continues until `stop_event` is set.
    - In each iteration, sleep for 0.1 seconds to reduce load on the server.
    - Try to fetch the current blockhash from the RPC server.
    - If the fetched blockhash is the same as `prev_recent_blockhash`, continue to the next iteration without updating.
    - If the fetched blockhash is different, update the `rbh` array with the new blockhash and set `prev_recent_blockhash` to this new value.
    - Print the new blockhash to the console.
    - If an exception occurs during fetching, print 'bad RBH' to the console.
- **Output**: None
- **Functions Called**:
    - [`firedancer/contrib/tool/txn-gen.get_recent_blockhash`](<#get_recent_blockhash>)


---
### main<!-- {{#callable:firedancer/contrib/tool/txn-gen.main}} -->
[View Source →](<../../../../contrib/tool/txn-gen.py#L531>)

Initializes and manages the execution of a transaction processing system using multiple worker processes and threads.
- **Inputs**: None
- **Logic and Control Flow**:
    - Parse command-line arguments using `parse_args()` to get configuration parameters.
    - Create a `Client` object with the RPC endpoint specified in the arguments.
    - Open and read the seed and funder key files to initialize the `seed` and `funder` variables.
    - Create a UDP socket for communication with TPU endpoints.
    - Parse and convert TPU endpoints from strings to tuples of host and port.
    - Determine the transaction type and account access distribution based on the arguments, exiting if unknown types are provided.
    - Call `create_accounts()` to generate accounts needed for transactions.
    - Divide the created accounts into chunks based on the number of workers specified.
    - Initialize shared memory and synchronization primitives for inter-process communication.
    - Start a monitoring thread to track transactions per second and a fetching thread to update the recent blockhash.
    - Create and start worker processes to send transactions using the `send_txs` function.
    - Enter a loop to keep the main process running, allowing worker processes to execute.
    - On termination, set the stop event and join all worker processes to ensure clean shutdown.
- **Output**: No return value; the function orchestrates the setup and execution of transaction processing.
- **Functions Called**:
    - [`firedancer/contrib/tool/txn-gen.parse_args`](<#parse_args>)
    - [`firedancer/contrib/tool/txn-gen.create_accounts`](<#create_accounts>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)