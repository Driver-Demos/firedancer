<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Documentation of the net tile in Firedancer, detailing its role as a fast networking layer using Linux AF_XDP APIs to interface between the Internet and Firedancer's messaging subsystem.

# Purpose
The document describes the architecture and functionality of a "net tile" within the Firedancer system, which serves as a networking component that interfaces between the Internet (IPv4) and the Firedancer messaging subsystem, known as "tango." The net tile uses the Linux AF_XDP APIs to bypass most of the Linux network stack, enabling efficient data transfer by offloading data copies to network hardware, a process known as "zero copy" I/O. The document outlines the persistent and ephemeral configurations required for the net tile, detailing how it manages network interface cards (NICs) and XDP sockets to handle packet transmission and reception. It also explains the RX and TX lifecycles, including the use of UMEM regions for packet buffering and the role of various ring buffers in managing packet flow. Additionally, the document covers security protections, loopback configurations, and development considerations, such as using network namespaces for testing. The net tile's design aims to optimize packet processing performance while maintaining security and flexibility in network configurations.
# Content Summary
The document describes the configuration and operation of a "net tile" within the Firedancer system, which facilitates fast networking by acting as a translation layer between the Internet (IPv4) and the Firedancer messaging subsystem, known as "tango". The net tile uses Linux AF_XDP APIs to bypass most of the Linux network stack, reducing context switches and offloading data copies to network hardware, enabling "zero copy" I/O.

Key components and processes include:

1. **Terminology and Modes**: The document defines terms such as NIC, XDP, AF_XDP, and UMEM. It explains XDP modes, with `drv` being a fast mode implemented in network device drivers, and `skb` as a slower fallback mode.

2. **Configuration**: 
   - **Persistent Configuration**: Involves NIC settings that persist across Firedancer restarts but are reset after a reboot. It includes steering all Firedancer traffic to a single queue per net tile.
   - **Ephemeral Configuration**: Set up during the runtime of Firedancer processes, including installing XDP programs, creating AF_XDP sockets, and binding UMEM regions.

3. **Topology**:
   - **TX Links**: The net tile is agnostic to TX topology but follows tango standard practices.
   - **RX Links**: RX links are unreliable and do not backpressure. Each app tile should handle packets at line rate, with RX topology created by the `fd_net_tile_topo` API.

4. **UMEM Region**: A shared memory region used for both RX and TX, allowing zero copy I/O. It is accessible to Firedancer app tiles, net tiles, the Linux kernel, and PCIe network devices.

5. **Security**: The net tile and network-facing app tiles are sandboxed using seccomp, user namespaces, and capability dropping. UMEM regions and RX mcaches are read-only mapped to app tiles to prevent corruption.

6. **RX and TX Lifecycles**: 
   - **RX Lifecycle**: Involves FILL, RX, and MCACHE rings, where packet buffers transition through these states.
   - **TX Lifecycle**: Involves mcache rings, FREE, TX, and completion rings, where outgoing packets are processed.

7. **Loopback and Development**: The net tile sets up XDP on the loopback device for testing and development. Firedancer supports network namespaces for safe prototyping without affecting the host's network stack.

8. **Considerations**: The document lists limitations such as lack of IPv6 support, single external network interface support, and potential performance impacts on shared interfaces.

This document provides a comprehensive overview of the net tile's role, configuration, and operation within the Firedancer system, focusing on technical details essential for developers working with this component.

---
Made with ❤️ by [Driver](https://www.driver.ai/)