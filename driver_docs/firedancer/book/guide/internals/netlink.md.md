<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Documentation of Firedancer's netlink integration for userland networking, detailing configuration, security, and data flows.

# Purpose
The document describes the integration of Firedancer's userland networking stack with the Linux netlink interface. This integration allows Firedancer to operate with minimal configuration by leveraging netlink for network configuration and management tasks, contrasting with other networking stacks that require complex setups. The document details how Firedancer uses the eXpress Data Path (XDP) for fast packet processing, which necessitates handling routing and neighbor resolution within the software. The netlink tile, a component of Firedancer, manages these tasks by interacting with the kernel's rtnetlink API to obtain necessary network information, which it caches in a shared memory region called "netbase." This setup enhances security by isolating the netlink interface from untrusted traffic and improves performance by reducing the frequency of netlink requests. The document also outlines the data flows between different components, emphasizing the security measures in place to protect against potential attacks through the netlink interface. Additionally, it explains the handling of neighbor discovery and routing, highlighting the synchronization of specific routing tables and the use of a hash table for ARP entries.
# Content Summary
The provided content describes the integration of Firedancer's userland networking stack with the Linux netlink interface. This integration allows for minimal configuration while maintaining interoperability with Linux systems. The document outlines the technical details of how Firedancer uses netlink to manage network configurations and operations.

### Key Functional Details:

1. **Netlink Integration**: Firedancer uses the netlink interface to source configuration data, which allows it to operate with minimal configuration compared to other networking stacks that require complex setups or dedicated IP addresses.

2. **XDP and Packet Processing**: Firedancer employs eXpress Data Path (XDP) for fast networking, which shifts some packet processing tasks from the kernel to the Firedancer software. This includes routing and resolving link-level neighbors.

3. **Netlink Tile Architecture**: 
   - **Security and Performance**: Netlink requests are handled in a separate tile to enhance security and performance. This tile isolates the netlink interface from untrusted user traffic and uses shared memory caches to reduce the frequency of netlink requests.
   - **Shared Memory ("Netbase")**: The netlink tile maintains a read-only cache of interface tables, IPv4 route tables, and neighbor tables in a shared memory region called "netbase."

4. **Security Considerations**: The netlink tile operates with an rtnetlink socket and subscribes to route and neighbor table changes. It can perform netlink interactions without elevated privileges on certain Linux distributions, such as RHEL 8 with a Linux 4.18 kernel. The tile is designed to minimize exposure to untrusted inputs.

5. **Data Flows**:
   - Net tiles access the netbase object in a read-only manner.
   - Route and neighbor table updates are processed by the netlink tile and written to the shared memory region.
   - Neighbor discovery involves deduplicating requests and forwarding them to the kernel, with a focus on maintaining a simple message format for security.

6. **Neighbor Discovery and Routing**:
   - A concurrent hash table is used for storing ARP entries, keeping them in sync with the kernel.
   - The network stack supports simple routing tables, synchronizing only the "local" and "main" tables. Policy-based routing and additional tables are not supported.

This document provides a comprehensive overview of how Firedancer integrates with the Linux netlink interface to manage network configurations efficiently and securely.

---
Made with ❤️ by [Driver](https://www.driver.ai/)