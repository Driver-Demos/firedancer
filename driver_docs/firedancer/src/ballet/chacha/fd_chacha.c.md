<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Reference implementation of the ChaCha20 block function with functions for 8 and 20 round variants.

# Purpose
The code implements the ChaCha20 block function, a cryptographic algorithm used for encryption. It provides a reference implementation of the ChaCha20 block function, which is not optimized for high performance but can be parallelized if needed. The main components of the code include the [`fd_chacha_quarter_round`](<#fd_chacha_quarter_round>) function, which performs the quarter-round operation, and the [`fd_chacha_block`](<#fd_chacha_block>) function, which constructs the ChaCha20 block state and executes the round function multiple times. The [`fd_chacha_block`](<#fd_chacha_block>) function takes a block, a key, and an index nonce as inputs and processes them to produce an encrypted block.

The code also defines two specific functions, [`fd_chacha8_block`](<#fd_chacha8_block>) and [`fd_chacha20_block`](<#fd_chacha20_block>), which are variations of the ChaCha block function with different numbers of rounds (8 and 20, respectively). These functions call [`fd_chacha_block`](<#fd_chacha_block>) with a specified number of rounds, providing flexibility in the level of encryption strength. The code is intended to be part of a larger cryptographic library and can be used to encrypt data by transforming input blocks using the ChaCha20 algorithm.
# Imports and Dependencies

---
- `fd_chacha.h`


# Functions

---
### fd\_chacha\_quarter\_round<!-- {{#callable:fd_chacha_quarter_round}} -->
[View Source →](<../../../../../src/ballet/chacha/fd_chacha.c#L8>)

Performs a ChaCha quarter round operation on four 32-bit unsigned integers.
- **Inputs**:
    - `a`: Pointer to the first 32-bit unsigned integer.
    - `b`: Pointer to the second 32-bit unsigned integer.
    - `c`: Pointer to the third 32-bit unsigned integer.
    - `d`: Pointer to the fourth 32-bit unsigned integer.
- **Logic and Control Flow**:
    - Add the value pointed to by `b` to the value pointed to by `a`.
    - XOR the value pointed to by `d` with the updated value of `a`.
    - Rotate the value pointed to by `d` left by 16 bits.
    - Add the value pointed to by `d` to the value pointed to by `c`.
    - XOR the value pointed to by `b` with the updated value of `c`.
    - Rotate the value pointed to by `b` left by 12 bits.
    - Add the value pointed to by `b` to the value pointed to by `a`.
    - XOR the value pointed to by `d` with the updated value of `a`.
    - Rotate the value pointed to by `d` left by 8 bits.
    - Add the value pointed to by `d` to the value pointed to by `c`.
    - XOR the value pointed to by `b` with the updated value of `c`.
    - Rotate the value pointed to by `b` left by 7 bits.
- **Output**: The function modifies the values pointed to by `a`, `b`, `c`, and `d` in place.


---
### fd\_chacha\_block<!-- {{#callable:fd_chacha_block}} -->
[View Source →](<../../../../../src/ballet/chacha/fd_chacha.c#L19>)

Generates a ChaCha20 block by initializing a state matrix, performing a series of quarter-round transformations, and adding the initial state to the transformed state.
- **Inputs**:
    - `_block`: A pointer to the memory location where the ChaCha20 block will be stored, assumed to be aligned to 64 bytes.
    - `_key`: A pointer to the 256-bit key used in the ChaCha20 algorithm, assumed to be aligned to 32 bytes.
    - `_idx_nonce`: A pointer to the 128-bit index and nonce, assumed to be aligned to 16 bytes.
    - `rnd2_cnt`: The number of double rounds (each consisting of a column round and a diagonal round) to perform on the block.
- **Logic and Control Flow**:
    - Aligns the input pointers `_block`, `_key`, and `_idx_nonce` to 64, 32, and 16 bytes respectively.
    - Initializes the first four words of the `block` with constant values specific to the ChaCha20 algorithm.
    - Copies the `key` into the next eight words of the `block`.
    - Copies the `idx_nonce` into the last four words of the `block`.
    - Stores the initial state of the `block` in `block_pre` for later use.
    - Performs `rnd2_cnt` iterations of the ChaCha quarter-round function, which includes both column and diagonal rounds.
    - After completing the rounds, adds the initial state stored in `block_pre` to the transformed `block`.
- **Output**: Returns a pointer to the transformed ChaCha20 block.
- **Functions Called**:
    - [`fd_chacha_quarter_round`](<#fd_chacha_quarter_round>)


---
### fd\_chacha8\_block<!-- {{#callable:fd_chacha8_block}} -->
[View Source →](<../../../../../src/ballet/chacha/fd_chacha.c#L78>)

Processes a ChaCha8 block by calling [`fd_chacha_block`](<#fd_chacha_block>) with a round count of 4.
- **Inputs**:
    - `_block`: A pointer to the memory location where the ChaCha8 block will be stored.
    - `_key`: A pointer to the memory location containing the key for the ChaCha8 block.
    - `_idx_nonce`: A pointer to the memory location containing the index and nonce for the ChaCha8 block.
- **Logic and Control Flow**:
    - Calls the [`fd_chacha_block`](<#fd_chacha_block>) function with `_block`, `_key`, `_idx_nonce`, and a round count of 4.
    - Returns the result of the [`fd_chacha_block`](<#fd_chacha_block>) function call.
- **Output**: A pointer to the processed ChaCha8 block.
- **Functions Called**:
    - [`fd_chacha_block`](<#fd_chacha_block>)


---
### fd\_chacha20\_block<!-- {{#callable:fd_chacha20_block}} -->
[View Source →](<../../../../../src/ballet/chacha/fd_chacha.c#L85>)

Processes a ChaCha20 block using a key and nonce with 20 rounds of the ChaCha quarter round function.
- **Inputs**:
    - `_block`: A pointer to the memory location where the ChaCha20 block will be stored.
    - `_key`: A pointer to the memory location of the key used for the ChaCha20 block.
    - `_idx_nonce`: A pointer to the memory location of the index and nonce used for the ChaCha20 block.
- **Logic and Control Flow**:
    - Calls the [`fd_chacha_block`](<#fd_chacha_block>) function with the provided `_block`, `_key`, `_idx_nonce`, and a round count of 10.
    - The [`fd_chacha_block`](<#fd_chacha_block>) function initializes the ChaCha20 block state with constants, the key, and the index/nonce.
    - Copies the initial state of the block for later use.
    - Performs 20 rounds of the ChaCha quarter round function, alternating between column and diagonal rounds.
    - Adds the initial state to the processed block to complete the ChaCha20 block.
- **Output**: Returns a pointer to the processed ChaCha20 block.
- **Functions Called**:
    - [`fd_chacha_block`](<#fd_chacha_block>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)