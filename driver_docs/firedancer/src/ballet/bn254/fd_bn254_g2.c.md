<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Implements internal operations for G2 elements in the BN254 elliptic curve, including addition, doubling, negation, and subgroup checks.

# Purpose
The code provides a set of functions for operations on elliptic curve points in the `G2` group of the BN254 curve, which is a pairing-friendly elliptic curve. The operations are not exposed to users directly, indicating that they are intended for internal use within a larger cryptographic library or system. The functions include basic operations such as checking if a point is zero ([`fd_bn254_g2_is_zero`](<#fd_bn254_g2_is_zero>)), comparing two points for equality ([`fd_bn254_g2_eq`](<#fd_bn254_g2_eq>)), setting a point ([`fd_bn254_g2_set`](<#fd_bn254_g2_set>)), negating a point ([`fd_bn254_g2_neg`](<#fd_bn254_g2_neg>)), and setting a point to zero ([`fd_bn254_g2_set_zero`](<#fd_bn254_g2_set_zero>)). 

The code also includes more complex operations such as point doubling ([`fd_bn254_g2_dbl`](<#fd_bn254_g2_dbl>)), mixed addition ([`fd_bn254_g2_add_mixed`](<#fd_bn254_g2_add_mixed>)), and general addition ([`fd_bn254_g2_add`](<#fd_bn254_g2_add>)). Additionally, it provides functions for scalar multiplication ([`fd_bn254_g2_scalar_mul`](<#fd_bn254_g2_scalar_mul>)) and Frobenius endomorphisms ([`fd_bn254_g2_frob`](<#fd_bn254_g2_frob>) and [`fd_bn254_g2_frob2`](<#fd_bn254_g2_frob2>)). The functions [`fd_bn254_g2_frombytes_internal`](<#fd_bn254_g2_frombytes_internal>) and [`fd_bn254_g2_frombytes_check_subgroup`](<#fd_bn254_g2_frombytes_check_subgroup>) handle the conversion of byte arrays to elliptic curve points, with the latter also checking subgroup membership. The code is structured to perform efficient arithmetic operations on the BN254 curve, leveraging optimizations such as the use of inline functions and specific algorithms for elliptic curve arithmetic.
# Imports and Dependencies

---
- `./fd_bn254.h`


# Functions

---
### fd\_bn254\_g2\_is\_zero<!-- {{#callable:fd_bn254_g2_is_zero}} -->
[View Source →](<../../../../../src/ballet/bn254/fd_bn254_g2.c#L8>)

Checks if a given point in the G2 group is the point at infinity by verifying if its Z-coordinate is zero.
- **Inputs**:
    - `p`: A pointer to a constant `fd_bn254_g2_t` structure representing a point in the G2 group.
- **Logic and Control Flow**:
    - Calls the function `fd_bn254_fp2_is_zero` with the Z-coordinate of the point `p` to check if it is zero.
    - Returns the result of the `fd_bn254_fp2_is_zero` function call.
- **Output**: Returns an integer indicating whether the point `p` is the point at infinity (1 if true, 0 otherwise).


---
### fd\_bn254\_g2\_eq<!-- {{#callable:fd_bn254_g2_eq}} -->
[View Source →](<../../../../../src/ballet/bn254/fd_bn254_g2.c#L13>)

Checks if two `fd_bn254_g2_t` points are equal by comparing their coordinates in projective space.
- **Inputs**:
    - `p`: A pointer to the first `fd_bn254_g2_t` point to compare.
    - `q`: A pointer to the second `fd_bn254_g2_t` point to compare.
- **Logic and Control Flow**:
    - Check if point `p` is zero using [`fd_bn254_g2_is_zero`](<#fd_bn254_g2_is_zero>); if true, return the result of `fd_bn254_g2_is_zero(q)`.
    - Check if point `q` is zero; if true, return 0.
    - Compute the square of the `Z` coordinate for both points `p` and `q`, storing the results in `pz2` and `qz2`.
    - Multiply the `X` coordinate of `p` by `qz2` and the `X` coordinate of `q` by `pz2`, storing the results in `l` and `r` respectively.
    - Compare `l` and `r` using `fd_bn254_fp2_eq`; if they are not equal, return 0.
    - Multiply the `Y` coordinate of `p` by `qz2` and `q->Z`, and the `Y` coordinate of `q` by `pz2` and `p->Z`, storing the results in `l` and `r` respectively.
    - Return the result of comparing `l` and `r` using `fd_bn254_fp2_eq`.
- **Output**: Returns 1 if the points are equal, otherwise returns 0.
- **Functions Called**:
    - [`fd_bn254_g2_is_zero`](<#fd_bn254_g2_is_zero>)


---
### fd\_bn254\_g2\_set<!-- {{#callable:fd_bn254_g2_set}} -->
[View Source →](<../../../../../src/ballet/bn254/fd_bn254_g2.c#L42>)

Copies the coordinates of one `fd_bn254_g2_t` structure to another.
- **Inputs**:
    - `r`: A pointer to the `fd_bn254_g2_t` structure where the coordinates will be copied to.
    - `p`: A pointer to the `fd_bn254_g2_t` structure from which the coordinates will be copied.
- **Logic and Control Flow**:
    - Call `fd_bn254_fp2_set` to copy the `X` coordinate from `p` to `r`.
    - Call `fd_bn254_fp2_set` to copy the `Y` coordinate from `p` to `r`.
    - Call `fd_bn254_fp2_set` to copy the `Z` coordinate from `p` to `r`.
    - Return the pointer `r`.
- **Output**: Returns a pointer to the `fd_bn254_g2_t` structure `r` with updated coordinates.


---
### fd\_bn254\_g2\_neg<!-- {{#callable:fd_bn254_g2_neg}} -->
[View Source →](<../../../../../src/ballet/bn254/fd_bn254_g2.c#L51>)

Negates the Y-coordinate of a point on the BN254 curve's G2 group while copying the X and Z coordinates.
- **Inputs**:
    - `r`: A pointer to an `fd_bn254_g2_t` structure where the result will be stored.
    - `p`: A constant pointer to an `fd_bn254_g2_t` structure representing the point to negate.
- **Logic and Control Flow**:
    - Copy the X-coordinate from `p` to `r` using `fd_bn254_fp2_set`.
    - Negate the Y-coordinate from `p` and store it in `r` using `fd_bn254_fp2_neg`.
    - Copy the Z-coordinate from `p` to `r` using `fd_bn254_fp2_set`.
    - Return the pointer `r`.
- **Output**: Returns a pointer to the `fd_bn254_g2_t` structure `r` containing the negated point.


---
### fd\_bn254\_g2\_set\_zero<!-- {{#callable:fd_bn254_g2_set_zero}} -->
[View Source →](<../../../../../src/ballet/bn254/fd_bn254_g2.c#L60>)

Sets the `Z` component of a `fd_bn254_g2_t` structure to zero and returns the modified structure.
- **Inputs**:
    - `r`: A pointer to a `fd_bn254_g2_t` structure that will be modified.
- **Logic and Control Flow**:
    - Calls `fd_bn254_fp2_set_zero` to set the `Z` component of the structure pointed to by `r` to zero.
    - Returns the pointer `r`.
- **Output**: Returns the pointer to the modified `fd_bn254_g2_t` structure.


---
### fd\_bn254\_g2\_frob<!-- {{#callable:fd_bn254_g2_frob}} -->
[View Source →](<../../../../../src/ballet/bn254/fd_bn254_g2.c#L68>)

Applies the Frobenius endomorphism to a point on the BN254 curve in the G2 group.
- **Inputs**:
    - ``r``: A pointer to an `fd_bn254_g2_t` structure where the result will be stored.
    - ``p``: A constant pointer to an `fd_bn254_g2_t` structure representing the input point to which the Frobenius endomorphism is applied.
- **Logic and Control Flow**:
    - Conjugate the `X` component of `p` and store it in `r->X`.
    - Multiply `r->X` by the constant `fd_bn254_const_frob_gamma1_mont[1]`.
    - Conjugate the `Y` component of `p` and store it in `r->Y`.
    - Multiply `r->Y` by the constant `fd_bn254_const_frob_gamma1_mont[2]`.
    - Conjugate the `Z` component of `p` and store it in `r->Z`.
    - Return the pointer `r`.
- **Output**: Returns a pointer to the `fd_bn254_g2_t` structure `r` containing the result of the Frobenius endomorphism.


---
### fd\_bn254\_g2\_frob2<!-- {{#callable:fd_bn254_g2_frob2}} -->
[View Source →](<../../../../../src/ballet/bn254/fd_bn254_g2.c#L79>)

Applies the Frobenius endomorphism twice to a point in the G2 group of the BN254 curve.
- **Inputs**:
    - ``r``: A pointer to a `fd_bn254_g2_t` structure where the result will be stored.
    - ``p``: A constant pointer to a `fd_bn254_g2_t` structure representing the input point to which the Frobenius endomorphism is applied.
- **Logic and Control Flow**:
    - Multiply the `X` component of `p` by the constant `fd_bn254_const_frob_gamma2_mont[1]` and store the result in the `X` component of `r`.
    - Multiply the `Y` component of `p` by the constant `fd_bn254_const_frob_gamma2_mont[2]` and store the result in the `Y` component of `r`.
    - Copy the `Z` component of `p` to the `Z` component of `r`.
    - Return the pointer `r`.
- **Output**: A pointer to the `fd_bn254_g2_t` structure `r` containing the result of the Frobenius endomorphism applied twice.


---
### fd\_bn254\_g2\_dbl<!-- {{#callable:fd_bn254_g2_dbl}} -->
[View Source →](<../../../../../src/ballet/bn254/fd_bn254_g2.c#L95>)

Computes the doubling of a point on the BN254 curve in the G2 group.
- **Inputs**:
    - ``r``: A pointer to a `fd_bn254_g2_t` structure where the result will be stored.
    - ``p``: A constant pointer to a `fd_bn254_g2_t` structure representing the point to be doubled.
- **Logic and Control Flow**:
    - Check if the input point `p` is zero using [`fd_bn254_g2_is_zero`](<#fd_bn254_g2_is_zero>); if true, set `r` to zero using [`fd_bn254_g2_set_zero`](<#fd_bn254_g2_set_zero>) and return `r`.
    - Compute `XX` as the square of `p->X` using `fd_bn254_fp2_sqr`.
    - Compute `YY` as the square of `p->Y` using `fd_bn254_fp2_sqr`.
    - Compute `YYYY` as the square of `YY`.
    - Compute `ZZ` as the square of `p->Z`.
    - Calculate `S` as `2 * ((X1 + YY)^2 - XX - YYYY)` using a series of additions, subtractions, and squaring operations.
    - Calculate `M` as `3 * XX` since `a` is zero, using addition operations.
    - Compute `T` as `M^2 - 2 * S` and set `r->X` to `T`.
    - Compute `Z3` as `(Y1 + Z1)^2 - YY - ZZ` and set `r->Z` to `Z3`.
    - Compute `Y3` as `M * (S - T) - 8 * YYYY` and set `r->Y` to `Y3`.
    - Return the result `r`.
- **Output**: A pointer to the `fd_bn254_g2_t` structure `r` containing the doubled point.
- **Functions Called**:
    - [`fd_bn254_g2_is_zero`](<#fd_bn254_g2_is_zero>)
    - [`fd_bn254_g2_set_zero`](<#fd_bn254_g2_set_zero>)


---
### fd\_bn254\_g2\_add\_mixed<!-- {{#callable:fd_bn254_g2_add_mixed}} -->
[View Source →](<../../../../../src/ballet/bn254/fd_bn254_g2.c#L146>)

Computes the sum of two points on an elliptic curve in the BN254 G2 group, assuming the second point is in affine coordinates.
- **Inputs**:
    - ``r``: A pointer to an `fd_bn254_g2_t` structure where the result will be stored.
    - ``p``: A pointer to a constant `fd_bn254_g2_t` structure representing the first point on the curve.
    - ``q``: A pointer to a constant `fd_bn254_g2_t` structure representing the second point on the curve, assumed to be in affine coordinates (i.e., `q->Z == 1`).
- **Logic and Control Flow**:
    - Check if `p` is the zero point; if so, set `r` to `q` and return `r`.
    - Compute `Z1Z1` as the square of `p->Z`.
    - Compute `U2` as the product of `q->X` and `Z1Z1`.
    - Compute `S2` as the product of `q->Y`, `p->Z`, and `Z1Z1`.
    - Check if `p` is equal to `q`; if so, call [`fd_bn254_g2_dbl`](<#fd_bn254_g2_dbl>) to double `p` and return the result.
    - Compute `H` as the difference between `U2` and `p->X`.
    - Compute `HH` as the square of `H`.
    - Compute `I` as four times `HH`.
    - Compute `J` as the product of `H` and `I`.
    - Compute `r` as twice the difference between `S2` and `p->Y`.
    - Compute `V` as the product of `p->X` and `I`.
    - Compute `r->X` as the square of `r`, subtract `J`, and subtract `2*V`.
    - Compute `i` as twice the product of `p->Y` and `J`.
    - Compute `r->Y` as the product of `r` and the difference between `V` and `r->X`, then subtract `i`.
    - Compute `r->Z` as the square of the sum of `p->Z` and `H`, then subtract `Z1Z1` and `HH`.
    - Return `r`.
- **Output**: A pointer to the `fd_bn254_g2_t` structure `r`, which contains the result of the addition.
- **Functions Called**:
    - [`fd_bn254_g2_is_zero`](<#fd_bn254_g2_is_zero>)
    - [`fd_bn254_g2_set`](<#fd_bn254_g2_set>)
    - [`fd_bn254_g2_dbl`](<#fd_bn254_g2_dbl>)


---
### fd\_bn254\_g2\_add<!-- {{#callable:fd_bn254_g2_add}} -->
[View Source →](<../../../../../src/ballet/bn254/fd_bn254_g2.c#L207>)

Computes the sum of two points `p` and `q` on an elliptic curve in the Jacobian coordinate system.
- **Inputs**:
    - `r`: A pointer to a `fd_bn254_g2_t` structure where the result will be stored.
    - `p`: A constant pointer to a `fd_bn254_g2_t` structure representing the first point to add.
    - `q`: A constant pointer to a `fd_bn254_g2_t` structure representing the second point to add.
- **Logic and Control Flow**:
    - Check if `p` is the point at infinity using [`fd_bn254_g2_is_zero`](<#fd_bn254_g2_is_zero>); if true, set `r` to `q` using [`fd_bn254_g2_set`](<#fd_bn254_g2_set>) and return `r`.
    - Compute `Z1Z1` as the square of `p->Z` and `Z2Z2` as the square of `q->Z`.
    - Calculate `U1` as `p->X` multiplied by `Z2Z2` and `U2` as `q->X` multiplied by `Z1Z1`.
    - Calculate `S1` as `p->Y` multiplied by `q->Z` and `Z2Z2`, and `S2` as `q->Y` multiplied by `p->Z` and `Z1Z1`.
    - Compute `H` as the difference between `U2` and `U1`.
    - Calculate `HH` as the square of `2*H`, and `J` as `H` multiplied by `HH`.
    - Compute `r` as `2*(S2-S1)` and `V` as `U1` multiplied by `HH`.
    - Calculate `X3` as `r^2 - J - 2*V` and store it in `r->X`.
    - Calculate `Y3` as `r*(V-X3) - 2*S1*J` and store it in `r->Y`.
    - Calculate `Z3` as `((Z1+Z2)^2 - Z1Z1 - Z2Z2)*H` and store it in `r->Z`.
    - Return `r` as the result.
- **Output**: A pointer to the `fd_bn254_g2_t` structure `r` containing the result of the addition.
- **Functions Called**:
    - [`fd_bn254_g2_is_zero`](<#fd_bn254_g2_is_zero>)
    - [`fd_bn254_g2_set`](<#fd_bn254_g2_set>)


---
### fd\_bn254\_g2\_scalar\_mul<!-- {{#callable:fd_bn254_g2_scalar_mul}} -->
[View Source →](<../../../../../src/ballet/bn254/fd_bn254_g2.c#L276>)

Performs scalar multiplication on a point in the BN254 G2 group.
- **Inputs**:
    - `r`: A pointer to an `fd_bn254_g2_t` structure where the result will be stored.
    - `p`: A constant pointer to an `fd_bn254_g2_t` structure representing the point to be multiplied.
    - `s`: A constant pointer to an `fd_bn254_scalar_t` structure representing the scalar multiplier.
- **Logic and Control Flow**:
    - Initialize `i` to 255 and decrement `i` until a set bit is found in the scalar `s` or `i` becomes negative.
    - If `i` is negative, set `r` to zero using [`fd_bn254_g2_set_zero`](<#fd_bn254_g2_set_zero>) and return `r`.
    - Set `r` to the value of `p` using [`fd_bn254_g2_set`](<#fd_bn254_g2_set>).
    - Iterate from `i-1` down to 0, doubling `r` using [`fd_bn254_g2_dbl`](<#fd_bn254_g2_dbl>) in each iteration.
    - If the current bit of `s` is set, add `p` to `r` using [`fd_bn254_g2_add_mixed`](<#fd_bn254_g2_add_mixed>).
    - Return the result stored in `r`.
- **Output**: Returns a pointer to the `fd_bn254_g2_t` structure `r` containing the result of the scalar multiplication.
- **Functions Called**:
    - [`fd_bn254_g2_set_zero`](<#fd_bn254_g2_set_zero>)
    - [`fd_bn254_g2_set`](<#fd_bn254_g2_set>)
    - [`fd_bn254_g2_dbl`](<#fd_bn254_g2_dbl>)
    - [`fd_bn254_g2_add_mixed`](<#fd_bn254_g2_add_mixed>)


---
### fd\_bn254\_g2\_frombytes\_internal<!-- {{#callable:fd_bn254_g2_frombytes_internal}} -->
[View Source →](<../../../../../src/ballet/bn254/fd_bn254_g2.c#L301>)

Extracts and validates the (x, y) coordinates from a byte array to initialize a `fd_bn254_g2_t` structure.
- **Inputs**:
    - `p`: A pointer to a `fd_bn254_g2_t` structure where the extracted point will be stored.
    - `in`: A constant byte array of size 128 containing the serialized point data.
- **Logic and Control Flow**:
    - Check if the input byte array `in` is all zeros; if true, set `p` to the point at infinity using [`fd_bn254_g2_set_zero`](<#fd_bn254_g2_set_zero>) and return `p`.
    - Attempt to extract the x-coordinate from the first 64 bytes of `in` using `fd_bn254_fp2_frombytes_be_nm`; if this fails, return `NULL`.
    - Attempt to extract the y-coordinate from the next 64 bytes of `in` using `fd_bn254_fp2_frombytes_be_nm`, also checking for infinity and negative flags; if this fails, return `NULL`.
    - If the y-coordinate indicates infinity, set `p` to the point at infinity using [`fd_bn254_g2_set_zero`](<#fd_bn254_g2_set_zero>) and return `p`.
    - Set the z-coordinate of `p` to one using `fd_bn254_fp2_set_one`.
    - Return the pointer `p`.
- **Output**: A pointer to the initialized `fd_bn254_g2_t` structure `p`, or `NULL` if the extraction or validation fails.
- **Functions Called**:
    - [`fd_bn254_g2_set_zero`](<#fd_bn254_g2_set_zero>)


---
### fd\_bn254\_g2\_frombytes\_check\_subgroup<!-- {{#callable:fd_bn254_g2_frombytes_check_subgroup}} -->
[View Source →](<../../../../../src/ballet/bn254/fd_bn254_g2.c#L330>)

Converts a byte array to a `fd_bn254_g2_t` point and checks if it belongs to the correct subgroup.
- **Inputs**:
    - `p`: A pointer to a `fd_bn254_g2_t` structure where the resulting point will be stored.
    - `in`: A constant byte array of size 128 representing the input data to be converted into a point.
- **Logic and Control Flow**:
    - Call [`fd_bn254_g2_frombytes_internal`](<#fd_bn254_g2_frombytes_internal>) to convert the byte array to a point; return `NULL` if conversion fails.
    - Check if the point is zero using [`fd_bn254_g2_is_zero`](<#fd_bn254_g2_is_zero>); if true, return the point.
    - Convert the `X` and `Y` coordinates to Montgomery form using `fd_bn254_fp2_to_mont`.
    - Set the `Z` coordinate to one using `fd_bn254_fp2_set_one`.
    - Compute `y^2` and `x^3 + b` and check if they are equal; return `NULL` if not.
    - Perform a fast subgroup membership check using scalar multiplication and Frobenius maps.
    - Return `NULL` if the subgroup check fails, otherwise return the point.
- **Output**: Returns a pointer to the `fd_bn254_g2_t` point if successful, or `NULL` if the conversion or subgroup check fails.
- **Functions Called**:
    - [`fd_bn254_g2_frombytes_internal`](<#fd_bn254_g2_frombytes_internal>)
    - [`fd_bn254_g2_is_zero`](<#fd_bn254_g2_is_zero>)
    - [`fd_bn254_g2_scalar_mul`](<#fd_bn254_g2_scalar_mul>)
    - [`fd_bn254_g2_add_mixed`](<#fd_bn254_g2_add_mixed>)
    - [`fd_bn254_g2_frob`](<#fd_bn254_g2_frob>)
    - [`fd_bn254_g2_add`](<#fd_bn254_g2_add>)
    - [`fd_bn254_g2_frob2`](<#fd_bn254_g2_frob2>)
    - [`fd_bn254_g2_dbl`](<#fd_bn254_g2_dbl>)
    - [`fd_bn254_g2_eq`](<#fd_bn254_g2_eq>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)