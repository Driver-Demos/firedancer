<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Implements BN254 pairing operations, including Miller loop and final exponentiation, for elliptic curve cryptography.

# Purpose
The code is a C implementation of cryptographic pairing operations on the BN254 elliptic curve. It includes functions for performing the Miller loop and final exponentiation, which are key steps in computing pairings. The functions [`fd_bn254_pairing_proj_dbl`](<#fd_bn254_pairing_proj_dbl>) and [`fd_bn254_pairing_proj_add_sub`](<#fd_bn254_pairing_proj_add_sub>) handle the doubling and addition/subtraction of points on the elliptic curve in projective coordinates. These operations are essential for the Miller loop, which is implemented in the [`fd_bn254_miller_loop`](<#fd_bn254_miller_loop>) function. The Miller loop computes an intermediate result used in the pairing calculation.

The code also includes the [`fd_bn254_fp12_pow_x`](<#fd_bn254_fp12_pow_x>) and [`fd_bn254_final_exp`](<#fd_bn254_final_exp>) functions, which perform exponentiation in the finite field extension and the final exponentiation step, respectively. The final exponentiation is necessary to obtain a unique and non-degenerate pairing result. The code references external resources and libraries, such as the `gnark-crypto` library, for further optimization and theoretical background. The functions are designed to be used in cryptographic protocols that require efficient and secure pairing computations, such as those used in zero-knowledge proofs and other advanced cryptographic schemes.
# Imports and Dependencies

---
- `./fd_bn254.h`


# Functions

---
### fd\_bn254\_pairing\_proj\_dbl<!-- {{#callable:fd_bn254_pairing_proj_dbl}} -->
[View Source →](<../../../../../src/ballet/bn254/fd_bn254_pairing.c#L5>)

Performs a doubling operation on a point in the projective coordinates of the BN254 curve and updates the result in the pairing context.
- **Inputs**:
    - ``r``: A pointer to `fd_bn254_fp12_t` where the result of the pairing operation will be stored.
    - ``t``: A pointer to `fd_bn254_g2_t` representing the point in projective coordinates to be doubled.
    - ``p``: A constant pointer to `fd_bn254_g1_t` representing a point on the BN254 curve.
- **Logic and Control Flow**:
    - Initialize pointers `X`, `Y`, `Z` to the coordinates of `t` and `x`, `y` to the coordinates of `p`.
    - Compute intermediate values `a`, `b`, `c`, `d`, `e`, `f`, `g`, `h` using field operations such as multiplication, squaring, addition, and halving.
    - Calculate the pairing function `g(P)` using the intermediate values and store the result in `r`.
    - Set specific elements of `r` to zero as part of the pairing function calculation.
    - Update the coordinates of `t` using the computed intermediate values to reflect the doubling operation.
- **Output**: The function does not return a value but updates the `r` and `t` structures with the results of the pairing and doubling operations, respectively.


---
### fd\_bn254\_pairing\_proj\_add\_sub<!-- {{#callable:fd_bn254_pairing_proj_add_sub}} -->
[View Source →](<../../../../../src/ballet/bn254/fd_bn254_pairing.c#L79>)

Performs addition or subtraction of projective points in the BN254 pairing context, updating the result and optionally the input point.
- **Inputs**:
    - ``r``: Pointer to `fd_bn254_fp12_t` where the result will be stored.
    - ``t``: Pointer to `fd_bn254_g2_t` representing the projective point to be updated.
    - ``q``: Pointer to `fd_bn254_g2_t` representing the projective point to add or subtract.
    - ``p``: Pointer to `fd_bn254_g1_t` representing the affine point used in calculations.
    - ``is_add``: Integer flag indicating whether to add (`1`) or subtract (`0`) the point `q`.
    - ``add_point``: Integer flag indicating whether to update the point `t` with the result of the addition or subtraction (`1`) or not (`0`).
- **Logic and Control Flow**:
    - Check if `is_add` is true; if so, set `Y2` to `q->Y`, otherwise negate `q->Y` and store in `Y2`.
    - Calculate intermediate values `a`, `b`, `o`, and `l` using `fd_bn254_fp2_mul` and `fd_bn254_fp2_sub`.
    - Compute `j` and `k` using `fd_bn254_fp2_mul`.
    - Update `r` with calculated values using `fd_bn254_fp_mul`, `fd_bn254_fp2_neg`, and `fd_bn254_fp2_sub`.
    - If `add_point` is true, perform additional calculations to update `t` using `fd_bn254_fp2_sqr`, `fd_bn254_fp2_mul`, `fd_bn254_fp2_add`, and `fd_bn254_fp2_sub`.
- **Output**: Updates the `fd_bn254_fp12_t` result `r` and optionally the projective point `t` based on the addition or subtraction operation.


---
### fd\_bn254\_miller\_loop<!-- {{#callable:fd_bn254_miller_loop}} -->
[View Source →](<../../../../../src/ballet/bn254/fd_bn254_pairing.c#L154>)

Computes the Miller loop for BN254 pairing, iterating over input points to accumulate results in a finite field.
- **Inputs**:
    - `f`: A pointer to an `fd_bn254_fp12_t` structure where the result will be stored.
    - `p`: An array of `fd_bn254_g1_t` structures representing the G1 points.
    - `q`: An array of `fd_bn254_g2_t` structures representing the G2 points.
    - `sz`: The number of elements in the `p` and `q` arrays.
- **Logic and Control Flow**:
    - Initialize `f` to the identity element of the field.
    - Copy each element of `q` into a temporary array `t`.
    - For each element in `t`, double the point and multiply the result into `f`.
    - Square `f` after processing all elements.
    - Iterate over each element in `t` to perform addition and subtraction operations, updating `f` with the results.
    - Iterate over a predefined sequence `s` to conditionally perform addition and subtraction operations based on the sequence values, updating `f`.
    - Apply Frobenius endomorphisms to elements of `q`, perform addition and subtraction operations, and update `f` with the results.
    - Return the updated `f`.
- **Output**: A pointer to the updated `fd_bn254_fp12_t` structure containing the result of the Miller loop computation.
- **Functions Called**:
    - [`fd_bn254_pairing_proj_dbl`](<#fd_bn254_pairing_proj_dbl>)
    - [`fd_bn254_pairing_proj_add_sub`](<#fd_bn254_pairing_proj_add_sub>)


---
### fd\_bn254\_fp12\_pow\_x<!-- {{#callable:fd_bn254_fp12_pow_x}} -->
[View Source →](<../../../../../src/ballet/bn254/fd_bn254_pairing.c#L223>)

Computes the power of a 12th-degree extension field element using a specific exponentiation algorithm.
- **Inputs**:
    - `r`: A pointer to a `fd_bn254_fp12_t` structure where the result will be stored.
    - `a`: A constant pointer to a `fd_bn254_fp12_t` structure representing the base element to be exponentiated.
- **Logic and Control Flow**:
    - Initialize an array `t` of 7 `fd_bn254_fp12_t` elements for intermediate calculations.
    - Square the input `a` and store the result in `t[3]`.
    - Square `t[3]` and store the result in `t[5]`.
    - Square `t[5]` and store the result in `r`.
    - Square `r` and store the result in `t[0]`.
    - Multiply `t[0]` by `a` and store the result in `t[2]`.
    - Multiply `t[2]` by `t[3]` and store the result in `t[0]`.
    - Multiply `t[0]` by `a` and store the result in `t[1]`.
    - Multiply `t[2]` by `r` and store the result in `t[4]`.
    - Square `t[2]` and store the result in `t[6]`.
    - Multiply `t[1]` by `t[0]` and store the result in `t[1]`.
    - Multiply `t[1]` by `t[3]` and store the result in `t[0]`.
    - Perform 6 fast squarings on `t[6]`.
    - Multiply `t[5]` by `t[6]` and store the result in `t[5]`.
    - Multiply `t[5]` by `t[4]` and store the result in `t[5]`.
    - Perform 7 fast squarings on `t[5]`.
    - Multiply `t[4]` by `t[5]` and store the result in `t[4]`.
    - Perform 8 fast squarings on `t[4]`.
    - Multiply `t[4]` by `t[0]` and store the result in `t[4]`.
    - Multiply `t[3]` by `t[4]` and store the result in `t[3]`.
    - Perform 6 fast squarings on `t[3]`.
    - Multiply `t[2]` by `t[3]` and store the result in `t[2]`.
    - Perform 8 fast squarings on `t[2]`.
    - Multiply `t[2]` by `t[0]` and store the result in `t[2]`.
    - Perform 6 fast squarings on `t[2]`.
    - Multiply `t[2]` by `t[0]` and store the result in `t[2]`.
    - Perform 10 fast squarings on `t[2]`.
    - Multiply `t[1]` by `t[2]` and store the result in `t[1]`.
    - Perform 6 fast squarings on `t[1]`.
    - Multiply `t[0]` by `t[1]` and store the result in `t[0]`.
    - Multiply `r` by `t[0]` and store the result in `r`.
- **Output**: A pointer to the `fd_bn254_fp12_t` structure `r` containing the result of the exponentiation.


---
### fd\_bn254\_final\_exp<!-- {{#callable:fd_bn254_final_exp}} -->
[View Source →](<../../../../../src/ballet/bn254/fd_bn254_pairing.c#L261>)

Computes the final exponentiation in the BN254 pairing process.
- **Inputs**:
    - `r`: A pointer to an `fd_bn254_fp12_t` structure where the result will be stored.
    - `x`: A constant pointer to an `fd_bn254_fp12_t` structure representing the input value to be exponentiated.
- **Logic and Control Flow**:
    - Initialize temporary variables `t` and `s` for intermediate computations.
    - Compute the conjugate of `x` and store it in `t[0]`.
    - Compute the inverse of `x` and store it in `t[1]`.
    - Multiply `t[0]` by `t[1]` to get `x^(p^6-1)` and store it back in `t[0]`.
    - Apply the Frobenius map squared to `t[0]` and store the result in `t[2]`.
    - Multiply `t[0]` by `t[2]` to get `x^(p^6-1)(p^2+1)` and store it in `s`.
    - Perform a series of exponentiations and multiplications using the [`fd_bn254_fp12_pow_x`](<#fd_bn254_fp12_pow_x>), `fd_bn254_fp12_conj`, `fd_bn254_fp12_sqr_fast`, and `fd_bn254_fp12_mul` functions to further process `s` and intermediate results in `t`.
    - Apply the Frobenius map and its powers to intermediate results and multiply them to accumulate the final result.
    - Store the final result in `r` and return `r`.
- **Output**: A pointer to the `fd_bn254_fp12_t` structure `r` containing the result of the final exponentiation.
- **Functions Called**:
    - [`fd_bn254_fp12_pow_x`](<#fd_bn254_fp12_pow_x>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)