<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines data structures and functions for AES-GCM encryption and hashing operations.

# Purpose
This C header file defines data structures and function prototypes for implementing the Galois/Counter Mode (GCM) of operation for AES encryption. It includes a union `fd_gcm128` for handling 128-bit data, which can be represented as two `ulong` values or a `uint128` if the platform supports 128-bit integers. The `fd_aes_gcm_ref_state` structure is defined to maintain the state of the GCM operation, including fields for intermediate values and a precomputed hash table `Htable` used in the GCM algorithm. The file declares three functions: [`fd_gcm_init_4bit`](<#fd_gcm_init_4bit>) for initializing the hash table, [`fd_gcm_gmult_4bit`](<#fd_gcm_gmult_4bit>) for performing a multiplication operation in the GCM, and [`fd_gcm_ghash_4bit`](<#fd_gcm_ghash_4bit>) for computing the GCM hash over input data. The header ensures that offsets of certain fields are consistent with assembly modules, indicating a close integration with low-level optimized code.
# Imports and Dependencies

---
- `fd_aes_base.h`


# Data Structures

---
### fd\_gcm128
- **Type**: `union`
- **Members**:
    - `hi`: Stores the high-order bits of a 128-bit value.
    - `lo`: Stores the low-order bits of a 128-bit value.
    - `u128`: Represents a 128-bit integer when `FD_HAS_INT128` is defined.
- **Description**: The `fd_gcm128` union provides a way to represent a 128-bit value using either two 64-bit unsigned long integers (`hi` and `lo`) or a single 128-bit integer (`u128`) if the platform supports 128-bit integers. This union is used in the context of Galois/Counter Mode (GCM) operations, which are part of cryptographic processes.


---
### fd\_gcm128\_t
- **Type**: ``union``
- **Members**:
    - ``hi``: The high 64 bits of the 128-bit value.
    - ``lo``: The low 64 bits of the 128-bit value.
    - ``u128``: A 128-bit integer representation, available if `FD_HAS_INT128` is defined.
- **Description**: Defines a 128-bit data structure that can be accessed as two 64-bit unsigned long integers or as a single 128-bit integer if the platform supports it. This union is used in AES-GCM cryptographic operations to handle 128-bit blocks efficiently.


---
### fd\_aes\_gcm\_ref\_state
- **Type**: ``struct``
- **Members**:
    - `Yi`: A union representing a 128-bit value used in GCM specification.
    - `EKi`: A union representing a 128-bit value used in GCM specification.
    - `EK0`: A union representing a 128-bit value used in GCM specification.
    - `len`: A union representing a 128-bit value used in GCM specification.
    - `Xi`: A union representing a 128-bit value used in GCM specification.
    - `H`: A union representing a 128-bit value used in GCM specification.
    - `Htable`: An array of 16 `fd_gcm128_t` elements used for GCM multiplication.
    - `mres`: An unsigned integer representing message residue.
    - `ares`: An unsigned integer representing additional data residue.
    - `Xn`: An array of 48 unsigned characters used in GCM operations.
    - `key`: An `fd_aes_key_ref_t` representing the AES key.
- **Description**: Aligns to 64 bytes and represents the state for AES-GCM operations, containing unions for GCM-specific values, a precomputed hash table for GCM multiplication, and fields for message and additional data residues, as well as the AES key.


---
### fd\_aes\_gcm\_ref\_t
- **Type**: ``struct``
- **Members**:
    - `Yi`: A union representing a 128-bit value used in GCM specification.
    - `EKi`: A union representing a 128-bit value used in GCM specification.
    - `EK0`: A union representing a 128-bit value used in GCM specification.
    - `len`: A union representing a 128-bit value used in GCM specification.
    - `Xi`: A union representing a 128-bit value used in GCM specification.
    - `H`: A union representing a 128-bit value used in GCM specification.
    - `Htable`: An array of `fd_gcm128_t` used for precomputed values in GCM.
    - `mres`: An unsigned integer representing message residue.
    - `ares`: An unsigned integer representing additional data residue.
    - `Xn`: An array of 48 unsigned characters used in GCM operations.
    - `key`: An `fd_aes_key_ref_t` representing the AES key.
- **Description**: Defines the state for AES-GCM operations, including various 128-bit values and precomputed tables used in the GCM algorithm, as well as the AES key and residues for message and additional data.


# Function Declarations (Public API)

---
### fd\_gcm\_init\_4bit<!-- {{#callable_declaration:fd_gcm_init_4bit}} -->
[View Source →](<../../../../../src/ballet/aes/fd_aes_gcm_ref.h#L38>)

Initializes a 4-bit GCM hash table.
- **Description**: Use this function to initialize a 4-bit GCM hash table for cryptographic operations. It prepares the `Htable` based on the provided hash subkey `H`. This function must be called before using the hash table in GCM operations to ensure correct cryptographic behavior. The function does not return a value and does not handle invalid input explicitly, so ensure that the input parameters are valid before calling.
- **Inputs**:
    - `Htable`: An array of 16 `fd_gcm128_t` elements that will be initialized. The caller must provide a valid array with sufficient space for 16 elements. The function will populate this array with computed values based on `H`.
    - `H`: A constant array of two `ulong` values representing the hash subkey. The caller must provide a valid array with exactly two elements. The function uses these values to initialize the `Htable`.
- **Output**: None
- **See Also**: [`fd_gcm_init_4bit`](<fd_aes_gcm_ref_ghash.c.md#fd_gcm_init_4bit>)  (Implementation)


---
### fd\_gcm\_gmult\_4bit<!-- {{#callable_declaration:fd_gcm_gmult_4bit}} -->
[View Source →](<../../../../../src/ballet/aes/fd_aes_gcm_ref.h#L42>)

Performs a 4-bit Galois field multiplication on a 128-bit block.
- **Description**: Use this function to multiply a 128-bit block represented by `Xi` with a precomputed hash table `Htable` in the context of Galois/Counter Mode (GCM) cryptography. This operation is part of the GCM authentication process. Ensure that `Xi` is a valid 128-bit block and `Htable` is correctly initialized before calling this function. The function modifies the contents of `Xi` to store the result of the multiplication.
- **Inputs**:
    - `Xi`: A pointer to an array of two `ulong` values representing a 128-bit block. The function modifies this array to store the result of the multiplication. The input must be a valid 128-bit block.
    - `Htable`: A constant pointer to an array of 16 `fd_gcm128_t` structures. This table must be precomputed and initialized before calling the function. The function uses this table to perform the multiplication.
- **Output**: None
- **See Also**: [`fd_gcm_gmult_4bit`](<fd_aes_gcm_ref_ghash.c.md#fd_gcm_gmult_4bit>)  (Implementation)


---
### fd\_gcm\_ghash\_4bit<!-- {{#callable_declaration:fd_gcm_ghash_4bit}} -->
[View Source →](<../../../../../src/ballet/aes/fd_aes_gcm_ref.h#L46>)

Computes the GHASH of input data using a 4-bit table.
- **Description**: Use this function to compute the GHASH of a given input data block using a precomputed 4-bit table. This function is typically used in cryptographic operations where GHASH is required, such as in Galois/Counter Mode (GCM) encryption. The input data must be a multiple of 16 bytes in length, as the function processes data in 128-bit blocks. Ensure that the `Htable` is correctly initialized before calling this function. The function updates the `Xi` array with the computed hash value.
- **Inputs**:
    - `Xi`: An array of two unsigned long integers that holds the initial hash value. The function updates this array with the computed GHASH. Must not be null.
    - `Htable`: A constant array of 16 `fd_gcm128_t` structures representing the precomputed 4-bit table. Must be initialized before use. Must not be null.
    - `inp`: A pointer to the input data to hash. The data length must be a multiple of 16 bytes. Must not be null.
    - `len`: The length of the input data in bytes. Must be a multiple of 16.
- **Output**: None
- **See Also**: [`fd_gcm_ghash_4bit`](<fd_aes_gcm_ref_ghash.c.md#fd_gcm_ghash_4bit>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)