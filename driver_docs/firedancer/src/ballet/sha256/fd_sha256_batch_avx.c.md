<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Implements a batched SHA-256 hashing function optimized for AVX SIMD instructions.

# Purpose
The code defines a function [`fd_sha256_private_batch_avx`](<#fd_sha256_private_batch_avx>) that implements a batched SHA-256 hashing algorithm optimized for AVX (Advanced Vector Extensions) instructions. This function processes multiple data blocks in parallel to compute their SHA-256 hashes efficiently. The function is designed to handle a batch of data, where each data block's size and the corresponding output hash location are specified. The code includes logic to decide whether to process the data sequentially or in parallel based on the availability of SHA-NI (SHA New Instructions) and the batch size. If the batch size is below a certain threshold, the function processes each block sequentially using the `fd_sha256_hash` function.

The function uses SIMD (Single Instruction, Multiple Data) operations to optimize the processing of data blocks. It prepares the data by appending necessary padding and size information, then processes the data in blocks of 64 bytes. The function uses a series of transformations and logical operations to update the SHA-256 state for each block. The final hash values are stored in the provided output locations. The code is structured to handle up to eight data blocks in a batch, as indicated by the `FD_SHA256_BATCH_MAX` constant. The function is part of a larger library, as suggested by the inclusion of headers like `fd_sha256.h` and `fd_sha256_constants.h`, and it is intended to be used internally within the library rather than as a public API.
# Imports and Dependencies

---
- `fd_sha256.h`
- `fd_sha256_constants.h`
- `../../util/simd/fd_avx.h`


# Functions

---
### fd\_sha256\_private\_batch\_avx<!-- {{#callable:fd_sha256_private_batch_avx}} -->
[View Source →](<../../../../../src/ballet/sha256/fd_sha256_batch_avx.c#L9>)

Processes a batch of data using the SHA-256 algorithm with AVX optimizations, handling small batches sequentially and larger batches in parallel.
- **Inputs**:
    - `batch_cnt`: The number of data items in the batch to process.
    - `_batch_data`: A pointer to the array of data items to hash.
    - `batch_sz`: An array of sizes for each data item in the batch.
    - `_batch_hash`: A pointer to the array where the resulting hashes will be stored.
- **Logic and Control Flow**:
    - Check if the batch size is smaller than the minimum required for parallel processing; if so, process each item sequentially using [`fd_sha256_hash`](<fd_sha256.c.md#fd_sha256_hash>).
    - Define and initialize variables for tail data and scratch space for processing.
    - Iterate over each data item in the batch to allocate and populate tail blocks, including padding and size encoding.
    - Initialize SHA-256 state variables and prepare for processing using AVX instructions.
    - Enter a loop to process each block of data, switching to tail blocks when necessary, and compute SHA-256 state updates using defined macros for operations like `Sigma0`, `Sigma1`, `Ch`, and `Maj`.
    - After processing all blocks, store the computed hash values in the provided output array.
- **Output**: The function does not return a value but writes the computed SHA-256 hashes to the `_batch_hash` array.
- **Functions Called**:
    - [`fd_sha256_hash`](<fd_sha256.c.md#fd_sha256_hash>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)