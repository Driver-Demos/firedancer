<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Functions and structures for decoding protocol buffers using custom input streams.

# Purpose
The `pb_decode.h` file is a C header file that provides function declarations and data structures for decoding protocol buffer messages. It defines the `pb_istream_s` structure, which is used to create custom input streams for reading data, and includes a callback mechanism for handling input from various sources like files or network sockets. The main function, [`pb_decode`](<#pb_decode>), decodes a protocol buffer message from an input stream into a C structure, while [`pb_decode_ex`](<#pb_decode_ex>) offers extended decoding options with flags for different behaviors. The file also includes utility functions for stream manipulation, such as [`pb_istream_from_buffer`](<#pb_istream_from_buffer>) for creating streams from memory buffers, and helper functions for decoding specific data types like integers and booleans. Additionally, it provides macros for backward compatibility and functions for managing dynamic memory allocation in decoded messages.
# Imports and Dependencies

---
- `pb_firedancer.h`


# Data Structures

---
### pb\_istream\_s
- **Type**: ``struct``
- **Members**:
    - `callback`: A function pointer used to read bytes from a storage medium, or an int pointer in buffer-only configuration.
    - `state`: A user-defined field for storing data needed by the callback function.
    - `bytes_left`: The maximum number of bytes remaining in the stream, used to prevent excessive data processing.
    - `errmsg`: A pointer to a constant string that holds an error message when decoding fails.
- **Description**: Defines a custom input stream for decoding protocol buffers, allowing users to specify a callback function to read data from various storage mediums, such as files or network sockets. The structure includes fields for managing the stream's state, tracking the number of bytes left to read, and storing error messages. It supports different configurations based on compile-time options, such as buffer-only mode, which affects the type of the `callback` field.


# Function Declarations (Public API)

---
### pb\_istream\_from\_buffer<!-- {{#callable_declaration:pb_istream_from_buffer}} -->
[View Source →](<../../../../../src/ballet/nanopb/pb_decode.h#L139>)

Creates an input stream from a memory buffer.
- **Description**: Use this function to create an input stream for reading protocol buffer messages from a memory buffer. This is useful when you have a message stored in memory and want to decode it using the provided decoding functions. The function initializes a `pb_istream_t` structure with the buffer and its length, allowing subsequent read operations to access the data. Ensure that the buffer contains the complete message and that the length accurately reflects the message size. This function is typically used in environments where the message is already loaded into memory, such as embedded systems or applications with preloaded data.
- **Inputs**:
    - `buf`: Pointer to the memory buffer containing the message. Must not be null. The caller retains ownership of the buffer, and it should remain valid for the duration of the stream's use.
    - `msglen`: Size of the message in bytes. Must be less than or equal to the size of the buffer. If the size is incorrect, reading operations may fail or produce incorrect results.
- **Output**: Returns a `pb_istream_t` structure initialized to read from the specified buffer.
- **See Also**: [`pb_istream_from_buffer`](<pb_decode.c.md#pb_istream_from_buffer>)  (Implementation)


---
### pb\_decode\_bool<!-- {{#callable_declaration:pb_decode_bool}} -->
[View Source →](<../../../../../src/ballet/nanopb/pb_decode.h#L171>)

Decodes a boolean value from a protocol buffer stream.
- **Description**: Use this function to decode a boolean value from a protocol buffer input stream. It reads a varint from the stream and interprets it as a boolean, where any non-zero value is considered true. This function must be called with a valid input stream and a pointer to a boolean variable where the result will be stored. It returns false if the decoding fails, which can occur if the stream does not contain a valid varint.
- **Inputs**:
    - `stream`: A pointer to a `pb_istream_t` structure representing the input stream. Must not be null. The stream should be properly initialized and contain the data to decode.
    - `dest`: A pointer to a boolean variable where the decoded value will be stored. Must not be null. The function writes the result to this location.
- **Output**: Returns true if the boolean value is successfully decoded; otherwise, returns false.
- **See Also**: [`pb_decode_bool`](<pb_decode.c.md#pb_decode_bool>)  (Implementation)


---
### pb\_decode\_svarint<!-- {{#callable_declaration:pb_decode_svarint}} -->
[View Source →](<../../../../../src/ballet/nanopb/pb_decode.h#L178>)

Decodes a signed varint from the input stream.
- **Description**: Use this function to decode a signed varint from a protocol buffer input stream and store the result in a destination variable. It is important to ensure that the input stream is properly initialized and contains valid data before calling this function. The function modifies the destination variable to store the decoded value. If the decoding process fails, the function returns false, indicating an error. This function is typically used in the context of decoding protocol buffer messages where signed integers are encoded using the zig-zag encoding scheme.
- **Inputs**:
    - `stream`: A pointer to a `pb_istream_t` structure representing the input stream from which to decode the signed varint. The stream must be properly initialized and must not be null. The function expects the stream to contain valid data for decoding.
    - `dest`: A pointer to a `pb_int64_t` variable where the decoded signed varint will be stored. The pointer must not be null, and the function will modify the value at this location.
- **Output**: Returns a boolean value: true if the decoding is successful, false if there is an error during decoding.
- **See Also**: [`pb_decode_svarint`](<pb_decode.c.md#pb_decode_svarint>)  (Implementation)


---
### pb\_decode\_fixed32<!-- {{#callable_declaration:pb_decode_fixed32}} -->
[View Source →](<../../../../../src/ballet/nanopb/pb_decode.h#L183>)

Decodes a fixed32, sfixed32, or float value from a stream.
- **Description**: Use this function to decode a 32-bit fixed-width value from a protocol buffer input stream. It reads 4 bytes from the stream and stores the result in the provided destination. This function is useful when you need to extract fixed32, sfixed32, or float values from a serialized protocol buffer message. Ensure that the destination pointer points to a valid 4-byte wide memory location. The function returns false if it fails to read the required number of bytes from the stream, indicating an error in the input stream or insufficient data.
- **Inputs**:
    - `stream`: A pointer to a `pb_istream_t` structure representing the input stream. The stream must be properly initialized and must have at least 4 bytes available to read. The caller retains ownership of the stream.
    - `dest`: A pointer to a 4-byte wide memory location where the decoded value will be stored. The pointer must not be null, and the caller is responsible for ensuring that the memory is valid and writable.
- **Output**: Returns true if the function successfully reads and decodes the 4-byte value from the stream. Returns false if the read operation fails, indicating an error or insufficient data in the stream.
- **See Also**: [`pb_decode_fixed32`](<pb_decode.c.md#pb_decode_fixed32>)  (Implementation)


---
### pb\_decode\_fixed64<!-- {{#callable_declaration:pb_decode_fixed64}} -->
[View Source →](<../../../../../src/ballet/nanopb/pb_decode.h#L188>)

Decode a fixed64, sfixed64, or double value from a stream.
- **Description**: Use this function to decode a 64-bit fixed-point or double value from a protocol buffer input stream into a destination variable. The function reads 8 bytes from the input stream and stores the result in the memory location pointed to by `dest`. Ensure that the `stream` is properly initialized and has at least 8 bytes available to read. The function returns false if it cannot read the required number of bytes, indicating an error in the input stream.
- **Inputs**:
    - `stream`: A pointer to a `pb_istream_t` structure representing the input stream. The stream must be initialized and have at least 8 bytes available for reading. The caller retains ownership of the stream.
    - `dest`: A pointer to a memory location where the decoded 64-bit value will be stored. The pointer must not be null, and it must point to a valid 8-byte wide memory location. The caller retains ownership of the memory.
- **Output**: Returns true if the decoding is successful, otherwise returns false if there is an error reading from the stream.
- **See Also**: [`pb_decode_fixed64`](<pb_decode.c.md#pb_decode_fixed64>)  (Implementation)


---
### pb\_decode\_double\_as\_float<!-- {{#callable_declaration:pb_decode_double_as_float}} -->
[View Source →](<../../../../../src/ballet/nanopb/pb_decode.h#L193>)

Decodes a double value from a stream into a float.
- **Description**: Use this function to decode a double-precision floating-point value from a protocol buffer input stream and store it as a single-precision floating-point value. This function is useful when you need to handle double values in environments where only float precision is required or supported. It reads from the provided input stream and writes the converted float value to the specified destination. Ensure that the input stream is correctly initialized and contains a valid double value. The function returns false if it fails to decode the value, which can occur if the stream does not contain a valid double or if there is an I/O error.
- **Inputs**:
    - `stream`: A pointer to a `pb_istream_t` structure representing the input stream from which to read the double value. The stream must be properly initialized and must not be null. The function will return false if the stream does not contain a valid double value.
    - `dest`: A pointer to a float variable where the decoded value will be stored. This pointer must not be null, and the caller retains ownership of the memory.
- **Output**: Returns true if the double value is successfully decoded and converted to a float; otherwise, returns false.
- **See Also**: [`pb_decode_double_as_float`](<pb_decode.c.md#pb_decode_double_as_float>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)