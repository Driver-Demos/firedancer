<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Low-level components and configuration options for the nanopb library, including macros and data structures.

# Purpose
The code is a C header file that defines low-level components and configuration options for the nanopb library, which is a small code-size Protocol Buffers implementation in C. This file provides macros, type definitions, and configuration settings that are essential for the operation of nanopb. It includes options for enabling or disabling features such as dynamic memory allocation, packed structures, and error messages. The file also defines data types and macros for handling Protocol Buffers field types, repetition rules, and allocation types.

The header file includes mechanisms for detecting system-specific features like endianness and provides compatibility with various compilers through conditional compilation. It defines structures and macros for describing Protocol Buffers messages and fields, including support for static assertions to ensure compatibility with different compilation options. The file also includes provisions for handling unknown fields and extensions, as well as memory allocation functions when dynamic memory is enabled. This header is intended to be included in other C source files that implement or use nanopb's encoding and decoding functionalities.
# Imports and Dependencies

---
- `stdint.h`
- `stddef.h`
- `stdbool.h`
- `string.h`
- `limits.h`
- `stdlib.h`
- `avr/pgmspace.h`


# Data Structures

---
### pb\_istream\_t
- **Type**: ``pb_istream_t``
- **Description**: `pb_istream_t` is a forward declaration of a structure used in the nanopb library, which is a small code-size Protocol Buffers implementation in C. The structure is likely used to represent an input stream for reading serialized data, but the actual definition and members of the structure are not provided in the given code.


---
### pb\_ostream\_t
- **Type**: ``pb_ostream_t``
- **Description**: `pb_ostream_t` is a forward declaration of a structure used in the nanopb library, which is a small code-size Protocol Buffers implementation in C. The structure is likely used to represent an output stream for encoding Protocol Buffers messages, but the specific fields and their purposes are not defined in the provided code.


---
### pb\_field\_iter\_t
- **Type**: ``struct``
- **Members**:
    - ``descriptor``: Pointer to a message descriptor constant.
    - ``message``: Pointer to the start of the structure.
    - ``index``: Index of the field.
    - ``field_info_index``: Index to the `descriptor->field_info` array.
    - ``required_field_index``: Index that counts only the required fields.
    - ``submessage_index``: Index that counts only submessages.
    - ``tag``: Tag of the current field.
    - ``data_size``: Size of a single item.
    - ``array_size``: Number of array entries.
    - ``type``: Type of the current field.
    - ``pField``: Pointer to the current field in the structure.
    - ``pData``: Pointer to the current data contents, different from `pField` for arrays and pointers.
    - ``pSize``: Pointer to count/has field.
    - ``submsg_desc``: For submessage fields, pointer to field descriptor for the submessage.
- **Description**: `pb_field_iter_t` is a structure used to iterate over fields in a message descriptor. It contains pointers to the message descriptor and the start of the structure, as well as indices and sizes related to the fields being iterated. It also includes pointers to the current field, data, and size, and handles submessage fields with a pointer to their descriptor.


---
### pb\_msgdesc\_t
- **Type**: ``struct``
- **Members**:
    - ``field_info``: Pointer to an array of `uint32_t` that contains field information.
    - ``submsg_info``: Pointer to an array of pointers to `pb_msgdesc_t` for submessage descriptions.
    - ``default_value``: Pointer to a `pb_byte_t` that holds the default value for fields.
    - ``field_callback``: Function pointer for a callback that processes fields during encoding or decoding.
    - ``field_count``: Number of fields in the message.
    - ``required_field_count``: Number of required fields in the message.
    - ``largest_tag``: Largest tag number used in the message.
- **Description**: Defines a message descriptor used in the nanopb library to describe the structure and properties of a protocol buffer message, including field information, submessage references, default values, and a callback function for field processing.


---
### pb\_msgdesc\_s
- **Type**: ``struct``
- **Members**:
    - ``field_info``: Pointer to an array of field information.
    - ``submsg_info``: Pointer to an array of pointers to submessage descriptors.
    - ``default_value``: Pointer to the default value for fields.
    - ``field_callback``: Function pointer for a callback to handle fields during encoding or decoding.
    - ``field_count``: Total number of fields in the message.
    - ``required_field_count``: Number of required fields in the message.
    - ``largest_tag``: Largest tag number used in the message.
- **Description**: Defines a message descriptor used in the nanopb library to describe the structure of a protocol buffer message, including field information, submessage descriptors, default values, and a callback function for field processing.


---
### pb\_field\_iter\_s
- **Type**: ``struct``
- **Members**:
    - `descriptor`: Pointer to a message descriptor constant.
    - `message`: Pointer to the start of the structure.
    - `index`: Index of the field.
    - `field_info_index`: Index to the `descriptor->field_info` array.
    - `required_field_index`: Index that counts only the required fields.
    - `submessage_index`: Index that counts only submessages.
    - `tag`: Tag of the current field.
    - `data_size`: Size of a single item.
    - `array_size`: Number of array entries.
    - `type`: Type of the current field.
    - `pField`: Pointer to the current field in the structure.
    - `pData`: Pointer to the current data contents, different from `pField` for arrays and pointers.
    - `pSize`: Pointer to count/has field.
    - `submsg_desc`: For submessage fields, pointer to the field descriptor for the submessage.
- **Description**: `pb_field_iter_s` is a structure used to iterate over fields in a protocol buffer message. It contains pointers to the message descriptor and the message itself, as well as indices and pointers for navigating and accessing fields, including their tags, types, sizes, and submessage descriptors. This structure facilitates the traversal and manipulation of fields within a message, supporting operations on required fields, submessages, and arrays.


---
### pb\_bytes\_array\_s
- **Type**: ``struct``
- **Members**:
    - ``size``: Stores the number of bytes in the `bytes` array.
    - ``bytes``: An array of bytes with a minimum size of 1.
- **Description**: Defines a structure for handling byte arrays in the nanopb library, where `size` indicates the number of bytes stored, and `bytes` is an array that holds the actual byte data. The `bytes` array is defined with a size of 1, but it is intended to be used as a flexible array member, allowing for dynamic allocation of additional space as needed.


---
### pb\_bytes\_array\_t
- **Type**: ``struct``
- **Members**:
    - ``size``: Stores the number of bytes in the `bytes` array.
    - ``bytes``: An array of `pb_byte_t` that holds the byte data, with a minimum size of 1.
- **Description**: Defines a structure for handling byte arrays in the nanopb library, where `size` indicates the number of bytes in the `bytes` array, which is used to store the actual byte data. The structure is designed to accommodate variable-length byte arrays, with the `bytes` array being flexible in size beyond the initial declaration.


---
### pb\_callback\_t
- **Type**: ``struct``
- **Members**:
    - ``funcs``: Contains a union of function pointers for encoding and decoding callbacks.
    - ``arg``: A pointer to user-defined data that the callback functions can use.
- **Description**: Defines a structure for handling callback functions in the nanopb library, allowing for custom encoding and decoding of protocol buffer fields. The `funcs` member holds function pointers for encoding and decoding operations, while the `arg` member provides a way to pass user-specific data to these functions.


---
### pb\_callback\_s
- **Type**: ``struct``
- **Members**:
    - ``funcs``: Contains a union of function pointers for decode and encode operations.
    - ``arg``: Pointer to an argument that callback functions can use and modify.
- **Description**: Defines a structure for handling callback functions in the nanopb library, where `funcs` holds function pointers for decoding and encoding operations, and `arg` is a pointer to data that these functions can use or modify during their execution.


---
### pb\_wire\_type\_t
- **Type**: ``enum``
- **Members**:
    - ``PB_WT_VARINT``: Represents a variable-length integer wire type with a value of 0.
    - ``PB_WT_64BIT``: Represents a 64-bit wire type with a value of 1.
    - ``PB_WT_STRING``: Represents a length-delimited string wire type with a value of 2.
    - ``PB_WT_32BIT``: Represents a 32-bit wire type with a value of 5.
    - ``PB_WT_PACKED``: Internal marker for packed arrays with a value of 255.
- **Description**: Defines the wire types used in the nanopb library for encoding protocol buffer messages, specifying different data formats such as variable-length integers, fixed-size integers, and strings.


---
### pb\_extension\_type\_t
- **Type**: ``struct``
- **Members**:
    - ``decode``: Function pointer for decoding unknown fields.
    - ``encode``: Function pointer for encoding unknown fields.
    - ``arg``: Pointer to a free field for use by the callback.
- **Description**: Defines the handling of unknown or extension fields in a message. It includes function pointers for decoding and encoding unknown fields, allowing custom handling of these fields. The `arg` member provides a free field for use by the callback functions.


---
### pb\_extension\_t
- **Type**: ``struct``
- **Members**:
    - ``type``: Pointer to a `pb_extension_type_t` structure that describes the extension field.
    - ``dest``: Pointer to the destination for the decoded data, matching the datatype of the extension field.
    - ``next``: Pointer to the next `pb_extension_t` handler, or `NULL` if there is no next handler.
    - ``found``: Boolean flag set to `true` if the extension was found during decoding; ignored during encoding.
- **Description**: Defines a structure for handling extension fields in a protocol buffer message, allowing for the processing of unknown or additional fields not defined in the main message schema. The structure includes a type descriptor, a destination for decoded data, a pointer to the next extension handler, and a flag indicating if the extension was found during decoding.


---
### pb\_extension\_type\_s
- **Type**: ``struct``
- **Members**:
    - ``decode``: Function pointer for handling unknown fields during decoding.
    - ``encode``: Function pointer for handling encoding after regular fields.
    - ``arg``: Pointer to a constant void, used by the callback.
- **Description**: Defines a structure for handling unknown or extension fields in a protocol buffer message. It includes function pointers for decoding and encoding operations, allowing custom handling of fields that are not part of the standard message definition. The `arg` member provides a way to pass additional data to these callback functions.


---
### pb\_extension\_s
- **Type**: ``struct``
- **Members**:
    - ``type``: Describes the extension field type, usually initialized to a pointer to an automatically generated structure.
    - ``dest``: Holds the destination for the decoded data, which must match the datatype of the extension field.
    - ``next``: Points to the next extension handler or is `NULL` if there is no next handler.
    - ``found``: Indicates if the decoder found the extension, set to true if found and ignored during encoding.
- **Description**: Defines a structure for handling protocol buffer extensions in the nanopb library, allowing for the management of unknown or additional fields in a message. The structure includes a type descriptor, a destination for decoded data, a pointer to the next extension handler, and a flag indicating if the extension was found during decoding.


# Function Declarations (Public API)

---
### pb\_default\_field\_callback<!-- {{#callable_declaration:pb_default_field_callback}} -->
[View Source →](<../../../../../src/ballet/nanopb/pb.h#L417>)

Handles field callbacks for encoding or decoding.
- **Description**: Use this function to process field callbacks during encoding or decoding operations. It checks if the field's data size matches the expected size for a callback and then attempts to call the appropriate decode or encode function if provided. This function should be used when you have a field with a callback and need to handle its encoding or decoding. It returns true if the operation is successful or if no operation is performed.
- **Inputs**:
    - `istream`: Pointer to a `pb_istream_t` structure for input stream. Can be NULL if not decoding.
    - `ostream`: Pointer to a `pb_ostream_t` structure for output stream. Can be NULL if not encoding.
    - `field`: Pointer to a `pb_field_t` structure representing the field to process. Must not be NULL and must have a data size equal to `sizeof(pb_callback_t)`.
- **Output**: Returns a boolean value: true if the callback is successfully processed or if no operation is performed, false if an error occurs during callback execution.
- **See Also**: [`pb_default_field_callback`](<pb_common.c.md#pb_default_field_callback>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)