<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Implements ECDSA public key recovery from a signature using the secp256k1 library.

# Purpose
The code defines a function [`fd_secp256k1_recover`](<#fd_secp256k1_recover>) that performs the recovery of a public key from a given message hash and a recoverable ECDSA (Elliptic Curve Digital Signature Algorithm) signature. This function is part of a cryptographic module that interfaces with the `secp256k1` library, which is commonly used for cryptographic operations in blockchain technologies, such as Bitcoin. The function takes four parameters: a pointer to store the recovered public key, a constant pointer to the message hash, a constant pointer to the signature, and an integer representing the recovery ID. 

The function uses several components from the `secp256k1` library, including `secp256k1_ecdsa_recoverable_signature`, `secp256k1_pubkey`, and functions like `secp256k1_ecdsa_recoverable_signature_parse_compact`, `secp256k1_ecdsa_recover`, and `secp256k1_ec_pubkey_serialize`. It checks the validity of the recovery ID and performs the recovery process, serializing the public key in an uncompressed format. The function returns a pointer to the recovered public key or `NULL` if any step in the process fails. This code is intended to be part of a larger cryptographic library and does not define a public API or external interface on its own.
# Imports and Dependencies

---
- `fd_secp256k1.h`
- `secp256k1.h`
- `secp256k1_recovery.h`


# Functions

---
### fd\_secp256k1\_recover<!-- {{#callable:fd_secp256k1_recover}} -->
[View Source →](<../../../../../src/ballet/secp256k1/fd_secp256k1.c#L6>)

Recovers a public key from a given ECDSA signature and message hash using the secp256k1 library.
- **Inputs**:
    - `public_key`: A pointer to a memory location where the recovered public key will be stored.
    - `msg_hash`: A pointer to the hash of the message that was signed.
    - `sig`: A pointer to the ECDSA signature from which the public key will be recovered.
    - `recovery_id`: An integer representing the recovery ID, which must be between 0 and 3 inclusive.
- **Logic and Control Flow**:
    - Check if `recovery_id` is between 0 and 3; return `NULL` if not.
    - Parse the compact ECDSA signature using `secp256k1_ecdsa_recoverable_signature_parse_compact`; return `NULL` if parsing fails.
    - Recover the public key using `secp256k1_ecdsa_recover`; return `NULL` if recovery fails.
    - Serialize the recovered public key using `secp256k1_ec_pubkey_serialize`; return `NULL` if serialization fails.
    - Copy the serialized public key (excluding the first byte) to the `public_key` location and return the pointer to `public_key`.
- **Output**: A pointer to the recovered public key, or `NULL` if any step in the recovery process fails.



---
Made with ❤️ by [Driver](https://www.driver.ai/)