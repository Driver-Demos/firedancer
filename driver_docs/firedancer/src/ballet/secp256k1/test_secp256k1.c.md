<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Tests for the `fd_secp256k1_recover` function, including performance benchmarks and correctness checks.

# Purpose
The code is a C program that tests the functionality of the `fd_secp256k1_recover` function, which is part of a cryptographic library for handling secp256k1 elliptic curve operations. The program includes a main function that initializes a random number generator and calls the [`test_recover`](<#test_recover>) function. The [`test_recover`](<#test_recover>) function performs a series of tests to verify the correctness of the `fd_secp256k1_recover` function by comparing the recovered public keys against expected values for given message and signature pairs. These tests include cases derived from Solana and Ethereum cryptographic operations.

The program also includes performance benchmarking for the `fd_secp256k1_recover` function. It measures the execution time for a specified number of iterations, both for valid and invalid signature recovery scenarios. The results are logged using the [`log_bench`](<#log_bench>) function, which calculates and displays the performance metrics in terms of calls per second and nanoseconds per call. The program is structured to ensure that the `fd_secp256k1_recover` function behaves correctly under various conditions and provides performance insights for its execution.
# Imports and Dependencies

---
- `../fd_ballet.h`
- `fd_secp256k1.h`
- `../hex/fd_hex.h`


# Functions

---
### log\_bench<!-- {{#callable:log_bench}} -->
[View Source →](<../../../../../src/ballet/secp256k1/test_secp256k1.c#L5>)

Logs the performance metrics of a benchmark test, including the rate of iterations per second and the average time per call.
- **Inputs**:
    - ``descr``: A constant character pointer that describes the benchmark being logged.
    - ``iter``: An unsigned long integer representing the number of iterations performed in the benchmark.
    - ``dt``: A long integer representing the total time taken for the benchmark in microseconds.
- **Logic and Control Flow**:
    - Calculate `khz` as the number of iterations per second per core, scaled to kilohertz, using the formula `1e6f * (float)iter / (float)dt`.
    - Calculate `tau` as the average time per call in nanoseconds, using the formula `(float)dt / (float)iter`.
    - Log the benchmark description, iterations per second per core, and average time per call using the `FD_LOG_NOTICE` macro.
- **Output**: No return value; the function logs the output using `FD_LOG_NOTICE`.


---
### test\_recover<!-- {{#callable:test_recover}} -->
[View Source →](<../../../../../src/ballet/secp256k1/test_secp256k1.c#L14>)

Tests the correctness and performance of the [`fd_secp256k1_recover`](<fd_secp256k1.c.md#fd_secp256k1_recover>) function using predefined test cases and benchmarks.
- **Inputs**:
    - `rng`: A pointer to an `fd_rng_t` structure, which is unused in this function.
- **Logic and Control Flow**:
    - Initializes expected public keys, messages, and signatures for Solana and Ethereum test cases.
    - Calls [`fd_secp256k1_recover`](<fd_secp256k1.c.md#fd_secp256k1_recover>) with the test data and checks if the recovered public key matches the expected public key using `FD_TEST`.
    - Modifies the message and signature to test recovery failure scenarios and checks the results with `FD_TEST`.
    - Tests invalid recovery IDs to ensure the function handles them without errors.
    - Performs benchmarking by calling [`fd_secp256k1_recover`](<fd_secp256k1.c.md#fd_secp256k1_recover>) multiple times and logs the performance metrics using [`log_bench`](<#log_bench>).
- **Output**: No output is returned as the function is `void`, but it performs internal tests and logs results.
- **Functions Called**:
    - [`fd_secp256k1_recover`](<fd_secp256k1.c.md#fd_secp256k1_recover>)
    - [`log_bench`](<#log_bench>)


---
### main<!-- {{#callable:main}} -->
[View Source →](<../../../../../src/ballet/secp256k1/test_secp256k1.c#L137>)

Initializes the environment, runs a test for cryptographic signature recovery, logs the result, and halts the program.
- **Inputs**:
    - `argc`: The number of command-line arguments.
    - `argv`: An array of strings representing the command-line arguments.
- **Logic and Control Flow**:
    - Calls `fd_boot` to initialize the environment with command-line arguments.
    - Creates a random number generator `rng` using `fd_rng_new` and `fd_rng_join`.
    - Calls [`test_recover`](<#test_recover>) with `rng` to perform cryptographic signature recovery tests.
    - Logs a notice message 'pass' using `FD_LOG_NOTICE`.
    - Calls `fd_halt` to terminate the program.
    - Returns 0 to indicate successful execution.
- **Output**: Returns 0 to indicate successful execution.
- **Functions Called**:
    - [`test_recover`](<#test_recover>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)