<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Tests the SHA-384 hashing implementation using NIST CAVP test vectors for validation.

# Purpose
The code is a C program designed to test the functionality of the SHA-384 hashing algorithm. It includes static assertions to verify the alignment and footprint of the `fd_sha384_t` data structure, ensuring that the implementation meets expected memory layout specifications. The program uses test vectors, which are predefined inputs and expected outputs, to validate the correctness of the SHA-384 implementation. These test vectors are included conditionally, based on the `HAS_CAVP_TEST_VECTORS` preprocessor directive, which determines whether the program will execute the tests or skip them with a warning.

The main function initializes the necessary components, such as a random number generator and memory for the SHA-384 context. It then performs a series of tests using the [`test_sha384_vectors`](<#test_sha384_vectors>) function, which checks the hashing process in single-shot, incremental, and streamlined modes against the expected results. The program logs the outcomes of these tests and performs cleanup operations before terminating. If the `HAS_CAVP_TEST_VECTORS` directive is not defined, the program will log a warning and exit without performing the tests. This code is intended to be an executable that verifies the integrity and correctness of the SHA-384 hashing implementation.
# Imports and Dependencies

---
- `../fd_ballet.h`
- `cavp/sha384_short.inc`
- `cavp/sha384_long.inc`


# Data Structures

---
### fd\_sha384\_test\_vector
- **Type**: ``struct``
- **Members**:
    - `msg`: Pointer to a constant character array representing the message to hash.
    - `sz`: Unsigned long integer representing the size of the message.
    - `hash`: Array of unsigned characters storing the SHA-384 hash of the message.
- **Description**: Defines a test vector for SHA-384 hashing, containing a message, its size, and the expected hash result.


---
### fd\_sha384\_test\_vector\_t
- **Type**: ``struct``
- **Members**:
    - ``msg``: Pointer to a constant character array representing the message to hash.
    - ``sz``: Unsigned long integer representing the size of the message.
    - ``hash``: Array of unsigned characters storing the expected SHA-384 hash of the message.
- **Description**: Defines a test vector for SHA-384 hashing, containing a message, its size, and the expected hash result. Used to verify the correctness of SHA-384 hash implementations by comparing computed hashes against known values.


# Functions

---
### test\_sha384\_vectors<!-- {{#callable:test_sha384_vectors}} -->
[View Source →](<../../../../../src/ballet/sha512/test_sha384.c#L24>)

Tests SHA-384 hashing using predefined test vectors for single shot, incremental, and streamlined hashing methods.
- **Inputs**:
    - ``vec``: A pointer to an array of `fd_sha384_test_vector_t` structures, each containing a message, its size, and the expected hash.
    - ``sha``: A pointer to an `fd_sha384_t` structure used for SHA-384 hashing operations.
    - ``rng``: A pointer to an `fd_rng_t` structure used for generating random numbers during incremental hashing tests.
- **Logic and Control Flow**:
    - Initialize a buffer `hash` to store the computed hash, aligned to 64 bytes.
    - Iterate over each test vector in `vec` until `vec->msg` is NULL.
    - For each vector, extract the message `msg`, its size `sz`, and the expected hash `expected`.
    - Perform single shot hashing by initializing `sha`, appending the message, finalizing the hash, and comparing it to `expected`. Log an error if the hashes do not match.
    - Perform incremental hashing by initializing `sha`, then repeatedly appending portions of the message determined by a random size, finalizing the hash, and comparing it to `expected`. Log an error if the hashes do not match.
    - Perform streamlined hashing by directly hashing the message and comparing the result to `expected`. Log an error if the hashes do not match.
- **Output**: No return value; logs errors if any hash does not match the expected value.


---
### main<!-- {{#callable:main}} -->
[View Source →](<../../../../../src/ballet/sha512/test_sha384.c#L146>)

Initializes the environment and logs a warning if CAVP test vectors are not available, then halts execution.
- **Inputs**:
    - `argc`: The number of command-line arguments.
    - `argv`: An array of command-line arguments.
- **Logic and Control Flow**:
    - Calls `fd_boot` to initialize the environment with command-line arguments.
    - Logs a warning message indicating that the unit test requires `HAS_CAVP_TEST_VECTORS`.
    - Calls `fd_halt` to stop further execution.
    - Returns 0 to indicate successful termination.
- **Output**: Returns 0, indicating successful termination of the program.



---
Made with ❤️ by [Driver](https://www.driver.ai/)