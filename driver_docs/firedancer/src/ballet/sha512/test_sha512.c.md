<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Tests and benchmarks for SHA-512 hashing, including single, incremental, and batched operations.

# Purpose
The code is a C program designed to test and benchmark the SHA-512 hashing algorithm. It includes functionality to verify the correctness of the SHA-512 implementation using predefined test vectors and random data. The program also benchmarks the performance of the SHA-512 algorithm in different modes: single-shot, incremental, and batched hashing. The code uses static assertions to ensure that the alignment and footprint of the SHA-512 structures match expected values, which helps maintain consistency and correctness in memory usage.

The program includes conditional compilation for additional test vectors from the NIST CAVP (Cryptographic Algorithm Validation Program) if available. It initializes a random number generator to create random test data and uses various functions to test the SHA-512 implementation. The main function orchestrates the testing and benchmarking processes, including testing with large input sizes and logging the results. The code is structured to be executed as a standalone program, with a [`main`](<#main>) function that serves as the entry point. It does not define public APIs or external interfaces, as its primary purpose is to validate and measure the performance of the SHA-512 hashing algorithm.
# Imports and Dependencies

---
- `../fd_ballet.h`
- `fd_sha512_test_vector.c`
- `cavp/sha512_short.inc`
- `cavp/sha512_long.inc`


# Functions

---
### test\_sha512\_vectors<!-- {{#callable:test_sha512_vectors}} -->
[View Source →](<../../../../../src/ballet/sha512/test_sha512.c#L18>)

Tests SHA-512 hashing using various methods and compares the results against expected values.
- **Inputs**:
    - ``vec``: A pointer to an array of `fd_sha512_test_vector_t` structures, each containing a message, its size, and the expected hash.
    - ``sha``: A pointer to an `fd_sha512_t` structure used for SHA-512 hashing operations.
    - ``rng``: A pointer to an `fd_rng_t` structure used for generating random numbers during incremental hashing tests.
- **Logic and Control Flow**:
    - Initialize a 64-byte array `hash` aligned to 64 bytes for storing hash results.
    - Iterate over each test vector in `vec` until `vec->msg` is NULL.
    - For each vector, extract the message `msg`, its size `sz`, and the expected hash `expected`.
    - Perform single-shot hashing by initializing `sha`, appending the message, finalizing the hash, and comparing the result with `expected`. Log an error if the hashes do not match.
    - Perform incremental hashing by initializing `sha`, then repeatedly appending portions of the message determined by random sizes until the entire message is processed. Finalize the hash and compare it with `expected`. Log an error if the hashes do not match.
    - Perform streamlined hashing using `fd_sha512_hash` and compare the result with `expected`. Log an error if the hashes do not match.
- **Output**: No return value; logs errors if any hash test fails.


---
### main<!-- {{#callable:main}} -->
[View Source →](<../../../../../src/ballet/sha512/test_sha512.c#L95>)

Initializes and tests SHA-512 hashing functionality, including random vector tests, batch processing, benchmarking, and cleanup.
- **Inputs**:
    - `argc`: The number of command-line arguments.
    - `argv`: An array of command-line arguments.
- **Logic and Control Flow**:
    - Calls `fd_boot` to initialize the environment with command-line arguments.
    - Initializes a random number generator `rng` using `fd_rng_new` and `fd_rng_join`.
    - Performs alignment and footprint tests for SHA-512 using `FD_TEST`.
    - Tests SHA-512 memory allocation and joining with `fd_sha512_new` and `fd_sha512_join`.
    - Executes random vector tests using [`test_sha512_vectors`](<#test_sha512_vectors>).
    - Tests batch processing of SHA-512 hashes with random data and verifies results.
    - Optionally tests NIST CAVP message fixtures if `HAS_CAVP_TEST_VECTORS` is defined.
    - Benchmarks SHA-512 hashing for small and large UDP payloads in incremental, streamlined, and batched modes.
    - Tests hashing of a large input size and verifies the result against a known hash.
    - Cleans up by leaving and deleting SHA-512 and RNG objects.
    - Logs the success of tests and halts the program.
- **Output**: Returns 0 to indicate successful execution.
- **Functions Called**:
    - [`test_sha512_vectors`](<#test_sha512_vectors>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)