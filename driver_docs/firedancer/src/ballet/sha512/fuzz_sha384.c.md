<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Fuzz testing for SHA-384 hashing implementation using LLVM's libFuzzer.

# Purpose
The code is a fuzz testing suite for the SHA-384 hashing algorithm. It is designed to be used with LLVM's libFuzzer, a library for coverage-guided fuzz testing. The code includes necessary headers and checks for the `FD_HAS_HOSTED` macro to ensure it is running in a suitable environment. The [`LLVMFuzzerInitialize`](<#llvmfuzzerinitialize>) function sets up the environment by configuring logging and initializing the system without signal handlers. It also registers a cleanup function to be called at program exit.

The [`LLVMFuzzerTestOneInput`](<#llvmfuzzertestoneinput>) function is the core of the fuzz testing process. It takes an input buffer and its size, then hashes the input using two different methods provided by the `fd_sha384` API. The function first initializes a SHA-384 context, appends the input data, and finalizes the hash computation. It then computes the hash directly using a single function call. The results from both methods are compared to ensure they produce the same hash output. The `FD_FUZZ_MUST_BE_COVERED` macro is used to ensure that all code paths are tested during fuzzing.
# Imports and Dependencies

---
- `assert.h`
- `stdio.h`
- `stdlib.h`
- `../../util/fd_util.h`
- `../../util/sanitize/fd_fuzz.h`
- `fd_sha512.h`


# Functions

---
### LLVMFuzzerInitialize<!-- {{#callable:LLVMFuzzerInitialize}} -->
[View Source →](<../../../../../src/ballet/sha512/fuzz_sha384.c#L13>)

Initializes the fuzzer environment by setting environment variables, booting the system, registering an exit function, and setting the log level.
- **Inputs**:
    - `argc`: A pointer to the argument count, typically from the command line.
    - `argv`: A pointer to the argument vector, typically from the command line.
- **Logic and Control Flow**:
    - Set the environment variable `FD_LOG_BACKTRACE` to `0` to disable backtraces in logs.
    - Call `fd_boot` with `argc` and `argv` to initialize the system.
    - Register `fd_halt` to be called on program exit using `atexit`.
    - Set the core log level to `3` using `fd_log_level_core_set`, which causes the program to crash on warning logs.
    - Return `0` to indicate successful initialization.
- **Output**: Returns `0` to indicate successful initialization.


---
### LLVMFuzzerTestOneInput<!-- {{#callable:LLVMFuzzerTestOneInput}} -->
[View Source →](<../../../../../src/ballet/sha512/fuzz_sha384.c#L24>)

Processes input data to verify the consistency of SHA-384 hashing.
- **Inputs**:
    - `data`: A pointer to the input data to be hashed.
    - `size`: The size of the input data in bytes.
- **Logic and Control Flow**:
    - Cast the input `data` to a `char` pointer `msg`.
    - Declare two arrays `hash1` and `hash2` to store the hash results, each aligned to 64 bytes.
    - Initialize a SHA-384 context `sha` using [`fd_sha384_init`](<fd_sha512.c.md#fd_sha384_init>) and verify the initialization with an assertion.
    - Append the message `msg` to the SHA-384 context `sha` using `fd_sha384_append` and verify with an assertion.
    - Finalize the SHA-384 hash computation with [`fd_sha384_fini`](<fd_sha512.c.md#fd_sha384_fini>), storing the result in `hash1`, and verify with an assertion.
    - Compute the SHA-384 hash of the input `data` directly into `hash2` using [`fd_sha384_hash`](<fd_sha512.c.md#fd_sha384_hash>) and verify with an assertion.
    - Compare `hash1` and `hash2` using `memcmp` to ensure they are identical, asserting the result.
    - Invoke `FD_FUZZ_MUST_BE_COVERED` to ensure code coverage requirements are met.
- **Output**: Returns 0 to indicate successful execution.
- **Functions Called**:
    - [`fd_sha384_init`](<fd_sha512.c.md#fd_sha384_init>)
    - [`fd_sha384_fini`](<fd_sha512.c.md#fd_sha384_fini>)
    - [`fd_sha384_hash`](<fd_sha512.c.md#fd_sha384_hash>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)