<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Tests for base58 encoding and decoding functions, including performance and boundary checks, with AVX optimizations.

# Purpose
The code is a C source file that implements and tests functions for encoding and decoding data using the Base58 encoding scheme. Base58 is a binary-to-text encoding scheme that is commonly used in applications like Bitcoin addresses. The file includes functions for both reference and optimized versions of Base58 encoding and decoding for 32-byte and 64-byte data blocks. The functions [`fd_base58_encode_ref`](<#fd_base58_encode_ref>) and [`fd_base58_decode_ref`](<#fd_base58_decode_ref>) are the core implementations for encoding and decoding, respectively, using a reference algorithm. These functions handle data as large big-endian integers and convert them to or from Base58 strings.

The file also contains a series of test functions that validate the correctness and performance of the encoding and decoding functions. These tests include basic encoding tests, boundary tests, failure tests for invalid inputs, and sample tests with known input-output pairs. Additionally, the file includes performance tests to measure the time taken for encoding and decoding operations. The code is structured to support both reference and optimized implementations, with conditional compilation for AVX (Advanced Vector Extensions) optimizations if available. The main function orchestrates the execution of these tests and logs the results, ensuring the reliability and efficiency of the Base58 encoding and decoding processes.
# Imports and Dependencies

---
- `fd_base58.h`
- `fd_base58_avx.h`


# Global Variables

---
### base58\_inverse
- **Type**: ``uchar const[]``
- **Description**: An array of unsigned characters that maps each character in the base58 alphabet to its corresponding index value. This array is used to facilitate the conversion of base58-encoded strings back to their original byte representation.
- **Use**: Used in the `fd_base58_decode_ref` function to convert base58 characters to their respective numerical values for decoding.


---
### base58\_chars
- **Type**: ``char[]``
- **Description**: Contains the characters used in the Base58 encoding scheme, excluding characters that can be easily confused such as '0', 'O', 'I', and 'l'. This array is used to map numerical values to their corresponding Base58 characters.
- **Use**: Used in Base58 encoding and decoding functions to convert data to and from Base58 representation.


# Functions

---
### fd\_base58\_encode\_ref<!-- {{#callable:fd_base58_encode_ref}} -->
[View Source →](<../../../../../src/ballet/base58/test_base58.c#L35>)

Converts a big-endian byte array into a null-terminated base58 string.
- **Inputs**:
    - `bytes`: A pointer to the input byte array to encode.
    - `byte_cnt`: The number of bytes in the input array.
    - `out`: A pointer to the output buffer where the base58 string will be stored.
    - `out_cnt`: The size of the output buffer.
- **Logic and Control Flow**:
    - Check if `byte_cnt` is greater than 64 or `out_cnt` is greater than 128; if so, return NULL.
    - Check if `out_cnt` is less than `byte_cnt` plus 1; if so, return NULL.
    - Copy the input bytes into a `quotient` array for manipulation.
    - Calculate the number of leading zero bytes in the input and store in `zero_cnt`.
    - Perform a long division to convert the byte array to base58, storing remainders in `raw_base58`.
    - Track the last non-zero remainder to determine the length of the base58 representation.
    - Check if the output buffer is too small to hold the result; if so, return NULL.
    - Convert the `raw_base58` values to base58 characters using `base58_chars` and store them in `out`.
    - Terminate the output string with a null character and return the `out` pointer.
- **Output**: Returns a pointer to the output buffer containing the base58 string, or NULL if the output buffer is not large enough.


---
### fd\_base58\_decode\_ref<!-- {{#callable:fd_base58_decode_ref}} -->
[View Source →](<../../../../../src/ballet/base58/test_base58.c#L81>)

Decodes a base58-encoded string into a big-endian byte array.
- **Inputs**:
    - `encoded`: A pointer to the base58-encoded string to decode.
    - `encoded_len`: The length of the encoded string, excluding the null-terminator.
    - `out`: A pointer to the output buffer where the decoded bytes will be stored.
    - `out_cnt`: The number of bytes to write to the output buffer.
- **Logic and Control Flow**:
    - Initialize `zero_cnt` to count leading '1's in the encoded string, setting corresponding bytes in `out` to zero.
    - Adjust pointers and lengths to skip the leading '1's in the encoded string and output buffer.
    - Return NULL if `out_cnt` is zero but `encoded_len` is greater than zero, indicating insufficient output space.
    - Return NULL if `encoded_len` exceeds 128, as this is the maximum supported length.
    - Convert each character in the encoded string to its base58 value using `base58_inverse`, storing results in `raw_base58`. Return NULL if any character is invalid.
    - Perform a grade-school long division on `raw_base58` to convert it to a byte array, storing results in `out`.
    - Return NULL if the number of leading zeros in `out` does not match the number of leading '1's in the encoded string.
    - Return NULL if any non-zero values remain in `raw_base58` after conversion, indicating the output buffer was too small.
    - Return the pointer to the start of the decoded output, adjusted for leading zeros.
- **Output**: Returns a pointer to the start of the decoded output buffer, adjusted for leading zeros, or NULL if decoding fails.


---
### fd\_base58\_encode\_32\_ref<!-- {{#callable:fd_base58_encode_32_ref}} -->
[View Source →](<../../../../../src/ballet/base58/test_base58.c#L132>)

Encodes a 32-byte array into a Base58 string and optionally stores the length of the encoded string.
- **Inputs**:
    - ``bytes``: A pointer to a 32-byte array that contains the data to encode.
    - ``opt_len``: An optional pointer to a `ulong` where the function will store the length of the encoded Base58 string if it is not `NULL`.
    - ``out``: A pointer to a character array where the function will store the resulting Base58 encoded string.
- **Logic and Control Flow**:
    - Calls [`fd_base58_encode_ref`](<#fd_base58_encode_ref>) to encode the 32-byte array `bytes` into a Base58 string, storing the result in `out`.
    - Checks if `opt_len` is not `NULL` and, if so, stores the length of the encoded string in `opt_len` using `fd_ulong_store_if`.
    - Returns the pointer `out` containing the Base58 encoded string.
- **Output**: Returns a pointer to the `out` character array containing the Base58 encoded string.
- **Functions Called**:
    - [`fd_base58_encode_ref`](<#fd_base58_encode_ref>)


---
### fd\_base58\_encode\_64\_ref<!-- {{#callable:fd_base58_encode_64_ref}} -->
[View Source →](<../../../../../src/ballet/base58/test_base58.c#L141>)

Encodes a 64-byte array into a Base58 string and optionally stores the length of the encoded string.
- **Inputs**:
    - ``bytes``: A pointer to an array of 64 bytes to encode.
    - ``opt_len``: An optional pointer to a `ulong` where the function will store the length of the encoded string if not NULL.
    - ``out``: A pointer to a character array where the encoded Base58 string will be stored.
- **Logic and Control Flow**:
    - Calls [`fd_base58_encode_ref`](<#fd_base58_encode_ref>) to encode the 64-byte array into a Base58 string, storing the result in `out`.
    - Checks if `opt_len` is not NULL and stores the length of the encoded string in `opt_len` using `fd_ulong_store_if`.
    - Returns the pointer `out` containing the encoded Base58 string.
- **Output**: Returns a pointer to the `out` character array containing the Base58 encoded string.
- **Functions Called**:
    - [`fd_base58_encode_ref`](<#fd_base58_encode_ref>)


---
### fd\_base58\_decode\_32\_ref<!-- {{#callable:fd_base58_decode_32_ref}} -->
[View Source →](<../../../../../src/ballet/base58/test_base58.c#L150>)

Decodes a base58-encoded string into a 32-byte big-endian integer.
- **Inputs**:
    - `encoded`: A pointer to a null-terminated string containing the base58-encoded data.
    - `out`: A pointer to a buffer where the decoded 32-byte integer will be stored.
- **Logic and Control Flow**:
    - Calls [`fd_base58_decode_ref`](<#fd_base58_decode_ref>) with `encoded`, the length of `encoded`, `out`, and 32 as arguments.
    - Returns the result of [`fd_base58_decode_ref`](<#fd_base58_decode_ref>).
- **Output**: A pointer to the `out` buffer containing the decoded data, or `NULL` if decoding fails.
- **Functions Called**:
    - [`fd_base58_decode_ref`](<#fd_base58_decode_ref>)


---
### fd\_base58\_decode\_64\_ref<!-- {{#callable:fd_base58_decode_64_ref}} -->
[View Source →](<../../../../../src/ballet/base58/test_base58.c#L156>)

Decodes a base58-encoded string into a 64-byte big-endian integer.
- **Inputs**:
    - `encoded`: A pointer to a null-terminated string containing the base58-encoded data.
    - `out`: A pointer to a buffer where the decoded 64-byte integer will be stored.
- **Logic and Control Flow**:
    - Calls [`fd_base58_decode_ref`](<#fd_base58_decode_ref>) with `encoded`, the length of `encoded`, `out`, and 64 as arguments.
    - Returns the result of [`fd_base58_decode_ref`](<#fd_base58_decode_ref>).
- **Output**: A pointer to the `out` buffer containing the decoded data, or `NULL` if decoding fails.
- **Functions Called**:
    - [`fd_base58_decode_ref`](<#fd_base58_decode_ref>)


---
### battery\_encode\_basic32<!-- {{#callable:battery_encode_basic32}} -->
[View Source →](<../../../../../src/ballet/base58/test_base58.c#L165>)

Tests the encoding of 32-byte arrays into Base58 strings using a provided encoding function.
- **Inputs**:
    - `encode_func`: A function pointer to an encoding function that takes a 32-byte array, a pointer to a length variable, and a buffer to store the encoded Base58 string.
- **Logic and Control Flow**:
    - Initialize a 32-byte array `bytes` with zeros and a buffer `buf` for the encoded string.
    - Set the length array `len` to store the length of the encoded string.
    - Use `fd_memset` to fill `bytes` with zeros and call `encode_func` to encode `bytes`, then check if the result matches the expected Base58 string '11111111111111111111111111111111' and if the length is 32.
    - Increment the last byte of `bytes`, encode again, and check if the result matches '11111111111111111111111111111112' and if the length is 32.
    - Increment the second last byte of `bytes`, encode again, and check if the result matches '1111111111111111111111111111115S' and if the length is 32.
    - Fill `bytes` with 0xFF, encode, and check if the result matches 'JEKNVnkbo3jma5nREBBJCDoXFVeKkD56V3xKrvRmWxFG' and if the length is 44.
    - Decrement the last byte of `bytes`, encode again, and check if the result matches 'JEKNVnkbo3jma5nREBBJCDoXFVeKkD56V3xKrvRmWxFF' and if the length is 44.
- **Output**: No output is returned; the function performs tests and uses assertions to validate the encoding.


---
### battery\_encode\_basic64<!-- {{#callable:battery_encode_basic64}} -->
[View Source →](<../../../../../src/ballet/base58/test_base58.c#L193>)

Tests the encoding of 64-byte arrays into Base58 strings using a provided encoding function.
- **Inputs**:
    - `encode_func`: A function pointer to an encoding function that takes a byte array, a pointer to a length, and a buffer to store the encoded Base58 string.
- **Logic and Control Flow**:
    - Initializes a 64-byte array `bytes` with zeros and a buffer `buf` for the encoded string.
    - Sets the length array `len` to store the length of the encoded string.
    - Encodes the zeroed `bytes` array and checks if the result matches the expected Base58 string of 64 '1's and if the length is 64.
    - Increments the last byte of `bytes`, encodes it again, and checks if the result matches the expected Base58 string with the last character incremented to '2'.
    - Increments the second last byte of `bytes`, encodes it, and checks if the result matches the expected Base58 string ending with '5S'.
    - Fills `bytes` with 0xFF, encodes it, and checks if the result matches the expected Base58 string and if the length is 88.
    - Decrements the last byte of `bytes`, encodes it, and checks if the result matches the expected Base58 string with the last character decremented.
- **Output**: No output is returned; the function performs tests and assertions to validate the encoding function.


---
### battery\_encode\_bounds<!-- {{#callable:battery_encode_bounds}} -->
[View Source →](<../../../../../src/ballet/base58/test_base58.c#L226>)

Tests the encoding function for boundary conditions by setting specific byte patterns and verifying the encoded output.
- **Inputs**:
    - ``encode_func``: A function pointer to the encoding function to test.
    - ``n``: The number of bytes to encode.
    - ``encode_sz``: The size of the buffer for the encoded output.
    - ``buf``: A character buffer to store the encoded output, indexed from 0 to `encode_sz`.
    - ``bytes``: A byte array to encode, indexed from 0 to `n`.
- **Logic and Control Flow**:
    - Initialize the `bytes` array to zero using `fd_memset`.
    - Iterate over each byte in the `bytes` array, setting one byte at a time to 1 starting from the last byte.
    - For each iteration, reset the `buf` array to a specific pattern (`\xCC`) using `fd_memset`.
    - Call the `encode_func` to encode the `bytes` array into the `buf` and store the length of the encoded data in `len`.
    - Verify that the encoded buffer is the same as the input buffer using `FD_TEST`.
    - Check that the length of the encoded data is within the expected range using `FD_TEST`.
    - Ensure the length of the string in `buf` matches the encoded length using `FD_TEST`.
    - Verify that the remaining part of the `buf` after the encoded data is still filled with the pattern `\xCC` using `FD_TEST`.
- **Output**: No return value; the function performs tests and assertions.


---
### battery\_decode\_fail32<!-- {{#callable:battery_decode_fail32}} -->
[View Source →](<../../../../../src/ballet/base58/test_base58.c#L244>)

Tests a series of base58-encoded strings to ensure they fail to decode into a 32-byte buffer using a provided decode function.
- **Inputs**:
    - `decode_func`: A function pointer of type `decode_func_t` that takes a base58-encoded string and a buffer, and attempts to decode the string into the buffer.
- **Logic and Control Flow**:
    - Defines a constant `N_TESTS` with a value of 15, representing the number of test cases.
    - Initializes an array `encoded` with 15 base58-encoded strings, each designed to fail decoding for various reasons such as being too short, too long, or containing invalid characters.
    - Declares a buffer `buf` of 32 bytes to store the decoded output.
    - Iterates over each string in the `encoded` array, calling `FD_TEST` to assert that `decode_func` returns a failure (i.e., a null pointer) when attempting to decode each string into `buf`.
- **Output**: No output is returned; the function uses assertions to verify that decoding fails for each test case.


---
### battery\_decode\_fail64<!-- {{#callable:battery_decode_fail64}} -->
[View Source →](<../../../../../src/ballet/base58/test_base58.c#L270>)

Tests the failure of decoding various invalid base58-encoded strings into a 64-byte buffer using a provided decode function.
- **Inputs**:
    - `decode_func`: A function pointer of type `decode_func_t` that takes a base58-encoded string and a buffer, and attempts to decode the string into the buffer.
- **Logic and Control Flow**:
    - Defines a constant `N_TESTS` with the value 15, representing the number of test cases.
    - Initializes an array `encoded` with 15 base58-encoded strings, each representing a different invalid test case.
    - Declares a buffer `buf` of 64 bytes to store the decoded output.
    - Iterates over each test case in the `encoded` array.
    - For each test case, calls the `decode_func` with the encoded string and `buf`, and asserts that the function returns a failure (i.e., `!decode_func(...)`).
- **Output**: No output is returned; the function performs assertions to validate the behavior of the decode function.


---
### battery\_sample32<!-- {{#callable:battery_sample32}} -->
[View Source →](<../../../../../src/ballet/base58/test_base58.c#L297>)

Tests the encoding and decoding of 32-byte binary data to and from Base58 strings using provided functions.
- **Inputs**:
    - `encode_func`: A function pointer to an encoding function that converts binary data to a Base58 string.
    - `decode_func`: A function pointer to a decoding function that converts a Base58 string back to binary data.
- **Logic and Control Flow**:
    - Defines a constant `N_TESTS` with a value of 7, representing the number of test cases.
    - Initializes two static arrays: `encoded` containing Base58 strings and `binary` containing corresponding 32-byte binary data.
    - Iterates over each test case using a loop that runs `N_TESTS` times.
    - For each test case, declares a buffer `buf` for encoding and a buffer `buf2` for decoding.
    - Calls `encode_func` with the binary data and checks if the result matches the expected Base58 string using `FD_TEST` and `strcmp`.
    - Calls `decode_func` with the Base58 string and checks if the result matches the expected binary data using `FD_TEST` and `memcmp`.
- **Output**: No output is returned; the function performs tests and uses assertions to validate the encoding and decoding functions.


---
### battery\_sample64<!-- {{#callable:battery_sample64}} -->
[View Source →](<../../../../../src/ballet/base58/test_base58.c#L338>)

Tests the encoding and decoding of 64-byte binary data to and from Base58 strings using provided functions.
- **Inputs**:
    - `encode_func`: A function pointer to an encoding function that converts binary data to a Base58 string.
    - `decode_func`: A function pointer to a decoding function that converts a Base58 string back to binary data.
- **Logic and Control Flow**:
    - Defines a constant `N_TESTS` with a value of 6, representing the number of test cases.
    - Initializes two static arrays: `encoded` containing Base58 encoded strings and `binary` containing corresponding 64-byte binary data.
    - Iterates over each test case using a loop that runs `N_TESTS` times.
    - For each test case, declares a buffer `buf` for encoding and a buffer `buf2` for decoding.
    - Calls `encode_func` to encode the binary data and compares the result with the expected encoded string using `FD_TEST` and `strcmp`.
    - Calls `decode_func` to decode the encoded string and compares the result with the expected binary data using `FD_TEST` and `memcmp`.
- **Output**: No return value; the function performs tests and uses assertions to validate encoding and decoding.


---
### battery\_match<!-- {{#callable:battery_match}} -->
[View Source →](<../../../../../src/ballet/base58/test_base58.c#L387>)

Tests the encoding and decoding functions for correctness by comparing them against reference implementations using random data.
- **Inputs**:
    - `encode_func_ref`: A reference encoding function used to generate the expected output.
    - `encode_func`: The encoding function under test.
    - `decode_func`: The decoding function under test.
    - `n`: The size of the byte array, assumed to be a power of 2.
    - `encode_sz`: The size of the buffer for encoded data.
    - `rng`: A random number generator used to create test data.
    - `cnt`: The number of test iterations to perform.
    - `buf_ref`: A buffer to store the reference encoded data.
    - `bytes_ref`: An array to store the reference byte data.
    - `buf`: A buffer to store the encoded data from the function under test.
    - `bytes`: An array to store the decoded byte data from the function under test.
- **Logic and Control Flow**:
    - Initialize a mask as `n-1UL` to assist with cyclic operations.
    - For each test iteration, generate random bytes in `bytes_ref` and introduce a random streak of zeros.
    - Encode `bytes_ref` using the reference function and validate the output length and content.
    - Encode `bytes_ref` using the function under test with a NULL length and compare the output to the reference buffer.
    - Encode `bytes_ref` using the function under test with a non-NULL length, validate the output, and compare the length to the reference length.
    - Decode the encoded data and compare the result to the original `bytes_ref`.
- **Output**: No return value; the function performs tests and asserts correctness using `FD_TEST`.


---
### battery\_performance<!-- {{#callable:battery_performance}} -->
[View Source →](<../../../../../src/ballet/base58/test_base58.c#L436>)

Measures the performance of encoding and decoding functions by timing their execution over a set number of iterations.
- **Inputs**:
    - `encode_func`: A function pointer to the encoding function to be tested.
    - `decode_func`: A function pointer to the decoding function to be tested.
    - `n`: The number of bytes to process in each iteration.
    - `encode_sz`: The size of the buffer used for encoding.
    - `rng`: A pointer to a random number generator used to fill the byte array with random data.
    - `buf`: A character buffer used to store encoded data, indexed from 0 to `encode_sz`.
    - `bytes`: An unsigned character array used to store the data to be encoded, indexed from 0 to `n`.
- **Logic and Control Flow**:
    - Initialize `test_count` to 3000, which determines the number of iterations for performance measurement.
    - Calculate the overhead of non-conversion work by timing the process of filling `bytes` with random data and accessing `buf` without performing any encoding or decoding.
    - Warm up the instruction cache by calling the `encode_func` three times with the same input data.
    - Measure the time taken to encode data by filling `bytes` with random data, calling `encode_func`, and accessing `buf` over `test_count` iterations.
    - Warm up the instruction cache by calling the `decode_func` three times with the same input data.
    - Measure the time taken for an encode-decode pair by filling `bytes` with random data, encoding it, decoding it, and accessing `bytes` over `test_count` iterations.
    - Log the average time per encode call and per decode call, excluding the overhead.
- **Output**: No return value; logs performance metrics to the console.


---
### test\_count\_leading\_zeros<!-- {{#callable:test_count_leading_zeros}} -->
[View Source →](<../../../../../src/ballet/base58/test_base58.c#L542>)

Tests the [`count_leading_zeros_32`](<fd_base58_avx.h.md#count_leading_zeros_32>) and [`count_leading_zeros_45`](<fd_base58_avx.h.md#count_leading_zeros_45>) functions using a buffer of 64 bytes.
- **Inputs**: None
- **Logic and Control Flow**:
    - Initialize a 64-byte buffer aligned to 32 bytes and set all bytes to zero using `fd_memset`.
    - Verify that [`count_leading_zeros_32`](<fd_base58_avx.h.md#count_leading_zeros_32>) and [`count_leading_zeros_45`](<fd_base58_avx.h.md#count_leading_zeros_45>) return 32 and 45 respectively when the buffer is all zeros.
    - Set the first byte of the buffer to 2 and verify that both functions return 0.
    - Set the first byte to 0 and the second byte to 7, then verify that both functions return 1.
    - Set the second byte to 255 and verify that both functions still return 1.
    - Set all bytes in the buffer to 123, then iterate over the first 32 bytes, setting each to 0 in turn, and verify that both functions return the correct number of leading zeros.
    - Continue iterating over bytes 32 to 44, setting each to 0 in turn, and verify that [`count_leading_zeros_32`](<fd_base58_avx.h.md#count_leading_zeros_32>) returns 32 and [`count_leading_zeros_45`](<fd_base58_avx.h.md#count_leading_zeros_45>) returns the correct number of leading zeros.
    - Iterate over bytes 45 to 63, setting each to 0 in turn, and verify that both functions return 32 and 45 respectively.
- **Output**: No output is returned; the function uses assertions to validate behavior.
- **Functions Called**:
    - [`count_leading_zeros_32`](<fd_base58_avx.h.md#count_leading_zeros_32>)
    - [`wuc_ld`](<fd_base58_avx.h.md#wuc_ld>)
    - [`count_leading_zeros_45`](<fd_base58_avx.h.md#count_leading_zeros_45>)


---
### test\_raw\_to\_base58<!-- {{#callable:test_raw_to_base58}} -->
[View Source →](<../../../../../src/ballet/base58/test_base58.c#L583>)

Tests the conversion of raw data to base58 encoding and verifies the output against expected base58 characters.
- **Inputs**: None
- **Logic and Control Flow**:
    - Initialize two arrays `in` and `out` with 32 unsigned characters each, aligned to 32 bytes.
    - Iterate over `i` from 0 to 57, representing each possible base58 character.
    - For each `i`, fill the `in` array with values calculated as `(i+j)%58` for each index `j` from 0 to 31.
    - Convert the `in` array to base58 using [`raw_to_base58`](<fd_base58_avx.h.md#raw_to_base58>) and store the result in the `out` array.
    - Verify that each character in the `out` array matches the expected base58 character from `base58_chars` corresponding to the value in the `in` array.
- **Output**: No output is returned; the function performs tests and uses assertions to verify correctness.
- **Functions Called**:
    - [`wuc_st`](<fd_base58_avx.h.md#wuc_st>)
    - [`raw_to_base58`](<fd_base58_avx.h.md#raw_to_base58>)
    - [`wuc_ld`](<fd_base58_avx.h.md#wuc_ld>)


---
### test\_intermediate\_to\_raw<!-- {{#callable:test_intermediate_to_raw}} -->
[View Source →](<../../../../../src/ballet/base58/test_base58.c#L595>)

Tests the conversion of intermediate values to raw format and verifies the output against expected values.
- **Inputs**: None
- **Logic and Control Flow**:
    - Initialize four unsigned long variables `c1`, `c2`, `c3`, and `c4` with specific values.
    - Create an aligned array `out` of 32 unsigned characters.
    - Iterate a loop one million times, incrementing `c1`, `c2`, `c3`, and `c4` by specific values in each iteration.
    - In each iteration, convert the current values of `c1`, `c2`, `c3`, and `c4` into a `wl_t` type using the `wl` function.
    - Convert the `wl_t` type to a `wuc_t` type using the [`intermediate_to_raw`](<fd_base58_avx.h.md#intermediate_to_raw>) function.
    - Store the `wuc_t` type into the `out` array using the [`wuc_st`](<fd_base58_avx.h.md#wuc_st>) function.
    - Verify that the values in the `out` array match expected values using `FD_TEST` assertions.
- **Output**: No output is returned; the function performs tests and assertions internally.
- **Functions Called**:
    - [`intermediate_to_raw`](<fd_base58_avx.h.md#intermediate_to_raw>)
    - [`wuc_st`](<fd_base58_avx.h.md#wuc_st>)


---
### test\_ten\_per\_slot\_down<!-- {{#callable:test_ten_per_slot_down}} -->
[View Source →](<../../../../../src/ballet/base58/test_base58.c#L648>)

Tests the `ten_per_slot_down_32` and `ten_per_slot_down_64` functions by verifying that they correctly transform input data into expected output data.
- **Inputs**: None
- **Logic and Control Flow**:
    - Initialize input and output arrays for the 32-byte test, aligning them to 32 bytes.
    - Set all elements of the input and output arrays to zero using `fd_memset`.
    - Populate the input array with values from 1 to 45, distributed across slots of 10 elements each.
    - Load three 32-byte wide vectors from the input array into `wuc_t` variables `a`, `b`, and `c`.
    - Call `ten_per_slot_down_32` with `a`, `b`, and `c` to produce two output vectors `out0` and `out1`.
    - Store `out0` and `out1` into the output array.
    - Verify that the output array contains values from 1 to 45 in sequence.
    - Repeat the above steps for the 64-byte test, using five input vectors and three output vectors.
    - Verify that the output array contains values from 1 to 90 in sequence.
- **Output**: No return value; the function performs tests and uses assertions to verify correctness.
- **Functions Called**:
    - [`wuc_ld`](<fd_base58_avx.h.md#wuc_ld>)
    - [`wuc_st`](<fd_base58_avx.h.md#wuc_st>)


---
### main<!-- {{#callable:main}} -->
[View Source →](<../../../../../src/ballet/base58/test_base58.c#L698>)

Initializes the environment, processes command-line arguments, and executes a series of tests on base58 encoding and decoding functions, including performance and correctness checks.
- **Inputs**:
    - `argc`: The number of command-line arguments.
    - `argv`: An array of strings representing the command-line arguments.
- **Logic and Control Flow**:
    - Calls `fd_boot` to initialize the environment with command-line arguments.
    - Retrieves the `--cnt` argument from the command line or defaults to 100000 if not provided.
    - Initializes a random number generator `rng` using `fd_rng_new` and `fd_rng_join`.
    - If `FD_HAS_AVX` is defined, logs a notice and runs AVX-specific tests: [`test_intermediate_to_raw`](<#test_intermediate_to_raw>), [`test_raw_to_base58`](<#test_raw_to_base58>), [`test_count_leading_zeros`](<#test_count_leading_zeros>), and [`test_ten_per_slot_down`](<#test_ten_per_slot_down>).
    - Logs a notice and runs reference 256-bit conversion tests: `test_encode_basic32_ref`, `test_encode_bounds32_ref`, `test_decode_fail32_ref`, `test_sample32_ref`, `test_match32_ref`, and `test_performance32_ref`.
    - Logs a notice and runs reference 512-bit conversion tests: `test_encode_basic64_ref`, `test_encode_bounds64_ref`, `test_decode_fail64_ref`, `test_sample64_ref`, `test_match64_ref`, and `test_performance64_ref`.
    - Logs a notice and runs 256-bit conversion tests: `test_encode_basic32`, `test_encode_bounds32`, `test_decode_fail32`, `test_sample32`, `test_match32`, and `test_performance32`.
    - Logs a notice and runs 512-bit conversion tests: `test_encode_basic64`, `test_encode_bounds64`, `test_decode_fail64`, `test_sample64`, `test_match64`, and `test_performance64`.
    - Deletes the random number generator using `fd_rng_delete` and `fd_rng_leave`.
    - Logs a final notice indicating all tests passed and calls `fd_halt` to terminate the program.
- **Output**: Returns 0 to indicate successful execution.
- **Functions Called**:
    - [`test_intermediate_to_raw`](<#test_intermediate_to_raw>)
    - [`test_raw_to_base58`](<#test_raw_to_base58>)
    - [`test_count_leading_zeros`](<#test_count_leading_zeros>)
    - [`test_ten_per_slot_down`](<#test_ten_per_slot_down>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)