<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

A fuzz test for Base58 encoding and decoding round-trip validation.

# Purpose
The code is a fuzz testing suite for the Base58 encoding and decoding functions. It is designed to be used with LLVM's libFuzzer, a library for coverage-guided fuzz testing. The code includes necessary headers and checks for the `FD_HAS_HOSTED` macro to ensure it is running in a suitable environment. The [`LLVMFuzzerInitialize`](<#llvmfuzzerinitialize>) function sets up the environment by configuring logging and registering cleanup functions. The [`LLVMFuzzerTestOneInput`](<#llvmfuzzertestoneinput>) function is the main entry point for the fuzzer, which tests the Base58 encoding and decoding functions with input data of at least 64 bytes.

The code defines a macro `MAKE_FUZZ_TEST` to create fuzz tests for different sizes of data (32 and 64 bytes). It encodes the input data using the Base58 encoding functions and then decodes it to verify the integrity of the data. Assertions are used to ensure that the encoded and decoded data match the expected results, and that the length of the encoded data is within the expected range. The `FD_FUZZ_MUST_BE_COVERED` macro is used to ensure that all code paths are tested. This code is intended to be part of a larger testing framework and does not define public APIs or external interfaces.
# Imports and Dependencies

---
- `assert.h`
- `stdio.h`
- `stdlib.h`
- `../../util/fd_util.h`
- `../../util/sanitize/fd_fuzz.h`
- `fd_base58.h`


# Functions

---
### LLVMFuzzerInitialize<!-- {{#callable:LLVMFuzzerInitialize}} -->
[View Source →](<../../../../../src/ballet/base58/fuzz_base58_roundtrip.c#L13>)

Initializes the fuzzer environment by setting environment variables, booting the framework, registering an exit function, and setting the log level.
- **Inputs**:
    - `argc`: A pointer to the argument count, typically from the command line.
    - `argv`: A pointer to the argument vector, typically from the command line.
- **Logic and Control Flow**:
    - Set the environment variable `FD_LOG_BACKTRACE` to `0` to disable backtraces in logs.
    - Call `fd_boot` with `argc` and `argv` to initialize the framework.
    - Register `fd_halt` to be called on program exit using `atexit`.
    - Set the core log level to `3` using `fd_log_level_core_set`, which causes the program to crash on warning logs.
    - Return `0` to indicate successful initialization.
- **Output**: Returns `0` to indicate successful initialization.


---
### LLVMFuzzerTestOneInput<!-- {{#callable:LLVMFuzzerTestOneInput}} -->
[View Source →](<../../../../../src/ballet/base58/fuzz_base58_roundtrip.c#L24>)

Tests the Base58 encoding and decoding functions with input data of at least 64 bytes.
- **Inputs**:
    - `data`: A pointer to the input data to be tested.
    - `size`: The size of the input data in bytes.
- **Logic and Control Flow**:
    - Check if the input size is less than 64 bytes; if true, return -1.
    - Define a macro `MAKE_FUZZ_TEST` to perform encoding and decoding tests for a given size `n`.
    - For each test size (32 and 64), declare variables for encoded and decoded data.
    - Use `fd_base58_encode_##n` to encode the input data and verify the result with assertions.
    - Check the length of the encoded data and ensure it is within expected bounds.
    - Decode the encoded data using `fd_base58_decode_##n` and verify it matches the original input.
    - Encode the data again without specifying the length and verify the result matches the previous encoding.
    - Invoke `MAKE_FUZZ_TEST` for sizes 32 and 64.
    - Ensure all code paths are covered with `FD_FUZZ_MUST_BE_COVERED`.
    - Return 0 to indicate successful execution.
- **Output**: Returns 0 if the input data passes all tests, otherwise returns -1 if the input size is less than 64 bytes.



---
Made with ❤️ by [Driver](https://www.driver.ai/)