<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Verifies the safety of Base64 decoding against untrusted inputs using fuzz testing.

# Purpose
The code is a fuzz testing suite for verifying the safety of Base64 decoding against untrusted inputs. It is designed to be used with a fuzzing framework, such as LLVM's libFuzzer. The code includes necessary headers and dependencies, such as `fd_util.h`, `fd_fuzz.h`, and `fd_base64.h`, which provide utility functions, fuzzing support, and Base64 decoding functionality, respectively. The [`LLVMFuzzerInitialize`](<#llvmfuzzerinitialize>) function sets up the environment by disabling signal handlers, initializing the framework, and setting the log level to crash on warnings. This ensures that the fuzzing process can run without interference from unexpected signals and that any issues are logged appropriately.

The main fuzzing function, [`LLVMFuzzerTestOneInput`](<#llvmfuzzertestoneinput>), takes a pointer to input data and its size, then attempts to decode the data using the `fd_base64_decode` function. It allocates memory for the decoded output and checks the result of the decoding process. The function uses assertions to ensure that the decoded size is within expected bounds and that memory allocation is successful. It also includes checks to ensure that all code paths are covered during fuzzing, using macros like `FD_FUZZ_MUST_BE_COVERED`. If the decoding result is unexpected, the function calls `abort` to terminate the process, indicating a potential issue with the decoding logic.
# Imports and Dependencies

---
- `assert.h`
- `stdio.h`
- `stdlib.h`
- `../../util/fd_util.h`
- `../../util/sanitize/fd_fuzz.h`
- `fd_base64.h`


# Functions

---
### LLVMFuzzerInitialize<!-- {{#callable:LLVMFuzzerInitialize}} -->
[View Source →](<../../../../../src/ballet/base64/fuzz_base64_dec.c#L16>)

Initializes the fuzzer environment by setting environment variables, booting the system, registering an exit function, and setting the log level.
- **Inputs**:
    - `argc`: A pointer to the argument count, typically from the command line.
    - `argv`: A pointer to the argument vector, typically from the command line.
- **Logic and Control Flow**:
    - Set the environment variable `FD_LOG_BACKTRACE` to `0` to disable backtrace logging.
    - Call `fd_boot` with `argc` and `argv` to initialize the system.
    - Register `fd_halt` to be called on program exit using `atexit`.
    - Set the core log level to `3` using `fd_log_level_core_set`, which will cause the program to crash on a warning log.
- **Output**: Returns `0` to indicate successful initialization.


---
### LLVMFuzzerTestOneInput<!-- {{#callable:LLVMFuzzerTestOneInput}} -->
[View Source →](<../../../../../src/ballet/base64/fuzz_base64_dec.c#L27>)

Tests the safety of Base64 decoding against untrusted inputs by decoding the input data and checking the result.
- **Inputs**:
    - `data`: A pointer to the input data to be tested, represented as an array of unsigned characters.
    - `data_sz`: The size of the input data in bytes, represented as an unsigned long integer.
- **Logic and Control Flow**:
    - Calculate the expected size of the decoded data using `FD_BASE64_DEC_SZ` and assert that it is less than `data_sz + 4UL`.
    - Allocate memory for the decoded data and assert that the allocation is successful.
    - Decode the input data using [`fd_base64_decode`](<fd_base64.c.md#fd_base64_decode>) and store the result in `dec_res`.
    - If `dec_res` is greater than or equal to 0, execute `FD_FUZZ_MUST_BE_COVERED`.
    - If `dec_res` is -1, execute `FD_FUZZ_MUST_BE_COVERED`.
    - If `dec_res` is neither of the above, call `abort()` to terminate the program.
    - Free the allocated memory for the decoded data.
    - Execute `FD_FUZZ_MUST_BE_COVERED` before returning.
- **Output**: Returns 0 after testing the input data.
- **Functions Called**:
    - [`fd_base64_decode`](<fd_base64.c.md#fd_base64_decode>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)