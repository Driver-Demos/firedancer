<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Base64 encoding and decoding functions with an inverse lookup table for ASCII to Base64 conversion.

# Purpose
The code provides functionality for encoding and decoding data using the Base64 encoding scheme. It includes two main functions: [`fd_base64_decode`](<#fd_base64_decode>) and [`fd_base64_encode`](<#fd_base64_encode>). The [`fd_base64_decode`](<#fd_base64_decode>) function takes a Base64 encoded input string and decodes it into its original binary form. It uses an inverse lookup table (`invlut`) to map ASCII characters to Base64 code points and handles padding characters to ensure proper decoding. The function checks for alignment and padding validity, returning the length of the decoded data or an error code if the input is invalid.

The [`fd_base64_encode`](<#fd_base64_encode>) function converts binary data into a Base64 encoded string. It processes the input data in chunks, accumulating bits and mapping them to the Base64 alphabet defined in `base64_alphabet`. The function ensures that the output is properly padded with '=' characters to meet the Base64 encoding requirements. Both functions are designed to handle typical Base64 encoding and decoding tasks, making them suitable for use in applications that require data transformation to and from Base64 format.
# Imports and Dependencies

---
- `fd_base64.h`


# Global Variables

---
### base64\_alphabet
- **Type**: ``char[]``
- **Description**: Contains the Base64 alphabet used for encoding data into Base64 format. The array includes uppercase and lowercase letters, digits, and the characters '+' and '/'.
- **Use**: Used in the `fd_base64_encode` function to map binary data to Base64 encoded characters.


---
### invlut
- **Type**: ``uchar const` array`
- **Description**: An inverse lookup table for Base64 decoding, mapping ASCII byte values to Base64 code points. The table contains 256 entries, where each entry corresponds to an ASCII byte value, and the value at each index is the Base64 code point or 0xff if the byte is not a valid Base64 character.
- **Use**: Used in the `fd_base64_decode` function to convert Base64 encoded characters to their corresponding values.


# Functions

---
### fd\_base64\_decode<!-- {{#callable:fd_base64_decode}} -->
[View Source →](<../../../../../src/ballet/base64/fd_base64.c#L48>)

Decodes a Base64 encoded string into its original binary form.
- **Inputs**:
    - `out`: A pointer to the output buffer where the decoded binary data will be stored.
    - `in`: A constant character pointer to the input Base64 encoded string.
    - `in_len`: The length of the input Base64 encoded string.
- **Logic and Control Flow**:
    - Initialize `out_orig` to point to the start of the output buffer `out`.
    - Return 0 if `in_len` is 0, indicating no data to decode.
    - Check if `in_len` is aligned to 4; return -1 if not aligned, as Base64 requires input length to be a multiple of 4.
    - Count padding characters ('=') at the end of the input and adjust `in_len` accordingly.
    - Return -1 if the adjusted `in_len` modulo 4 equals 1, as this indicates invalid padding.
    - Decode the input in chunks of 4 characters, converting them to 3 bytes of binary data using the `invlut` lookup table.
    - Check for invalid Base64 characters during decoding; return -1 if any are found.
    - For the last chunk of input, handle cases where the input length is less than 4, adjusting for padding and decoding accordingly.
    - Return the number of bytes written to the output buffer by subtracting `out_orig` from `out`.
- **Output**: Returns the number of bytes written to the output buffer, or -1 if an error occurs during decoding.


---
### fd\_base64\_encode<!-- {{#callable:fd_base64_encode}} -->
[View Source →](<../../../../../src/ballet/base64/fd_base64.c#L120>)

Encodes binary data into a Base64 string.
- **Inputs**:
    - `encoded`: A pointer to a character array where the encoded Base64 string will be stored.
    - `_data`: A pointer to the binary data that needs to be encoded.
    - `data_len`: The length of the binary data to encode.
- **Logic and Control Flow**:
    - Initialize `encoded_len`, `accumulator`, and `bits_collected` to zero.
    - Convert `_data` to a `uchar` pointer `data` using `fd_type_pun_const`.
    - Iterate over each byte of `data` while `data_len` is greater than zero.
    - For each byte, shift `accumulator` left by 8 bits and add the byte value, then increase `bits_collected` by 8.
    - While `bits_collected` is at least 6, extract the top 6 bits from `accumulator`, map them to a Base64 character using `base64_alphabet`, and store it in `encoded`.
    - Reduce `bits_collected` by 6 after each character is encoded.
    - If there are remaining bits in `accumulator`, pad the last Base64 character with zeroes and encode it.
    - Add '=' padding characters to `encoded` until its length is a multiple of 4.
    - Return the length of the encoded Base64 string.
- **Output**: The length of the encoded Base64 string.



---
Made with ❤️ by [Driver](https://www.driver.ai/)