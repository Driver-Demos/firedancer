<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Verifies that base64 decoding of encoded data returns the original input using fuzz testing.

# Purpose
The code is a fuzz testing suite for verifying the correctness of Base64 encoding and decoding functions. It uses the LLVM libFuzzer framework to test the `fd_base64_encode` and `fd_base64_decode` functions. The primary goal is to ensure that encoding a data input and then decoding the result returns the original data, thus confirming the identity property of these operations. The code initializes the fuzzer environment by setting up a shell without signal handlers and configuring logging levels. It then allocates memory for encoded and decoded data, performs the encoding and decoding operations, and checks that the decoded data matches the original input.

The code includes necessary headers and utility functions from the project's library, such as `fd_util.h` and `fd_fuzz.h`, to support its operations. It uses assertions to verify that memory allocations are successful and that the encoding and decoding processes produce expected results. The [`LLVMFuzzerTestOneInput`](<#llvmfuzzertestoneinput>) function is the main entry point for the fuzzer, which processes each input by encoding and decoding it, and then checks for correctness. The code is structured to be used as part of a larger testing framework, ensuring the reliability of Base64 operations within the system.
# Imports and Dependencies

---
- `assert.h`
- `stdio.h`
- `stdlib.h`
- `../../util/fd_util.h`
- `../../util/sanitize/fd_fuzz.h`
- `fd_base64.h`


# Functions

---
### LLVMFuzzerInitialize<!-- {{#callable:LLVMFuzzerInitialize}} -->
[View Source →](<../../../../../src/ballet/base64/fuzz_base64_enc.c#L17>)

Initializes the fuzzer environment by setting environment variables, booting the framework, and configuring logging behavior.
- **Inputs**:
    - `argc`: A pointer to the argument count, typically from the command line.
    - `argv`: A pointer to the argument vector, typically from the command line.
- **Logic and Control Flow**:
    - Set the environment variable `FD_LOG_BACKTRACE` to `0` to disable backtrace logging.
    - Call `fd_boot` with `argc` and `argv` to initialize the framework.
    - Register `fd_halt` to be called at program exit using `atexit`.
    - Set the core log level to `3` using `fd_log_level_core_set`, which will cause the program to crash on a warning log.
- **Output**: Returns `0` to indicate successful initialization.


---
### LLVMFuzzerTestOneInput<!-- {{#callable:LLVMFuzzerTestOneInput}} -->
[View Source →](<../../../../../src/ballet/base64/fuzz_base64_enc.c#L28>)

Encodes input data to Base64 and then decodes it to verify the identity function property.
- **Inputs**:
    - `data`: A pointer to the input data to be encoded and decoded.
    - `data_sz`: The size of the input data in bytes.
- **Logic and Control Flow**:
    - Calculate the size required for Base64 encoding using `FD_BASE64_ENC_SZ` and allocate memory for the encoded data.
    - Encode the input data to Base64 using [`fd_base64_encode`](<fd_base64.c.md#fd_base64_encode>) and verify the encoded size matches the expected size.
    - Calculate the size required for Base64 decoding using `FD_BASE64_DEC_SZ` and ensure it does not exceed `data_sz + 3UL`.
    - Allocate memory for the decoded data and decode the Base64 encoded data using [`fd_base64_decode`](<fd_base64.c.md#fd_base64_decode>).
    - Verify the decoded size is non-negative, does not exceed the allocated size, and matches the original data size.
    - Compare the decoded data with the original input data to ensure they are identical.
    - Free the allocated memory for both encoded and decoded data.
    - Invoke `FD_FUZZ_MUST_BE_COVERED` to ensure code coverage requirements are met.
- **Output**: Returns 0 after successful verification of the identity function property.
- **Functions Called**:
    - [`fd_base64_encode`](<fd_base64.c.md#fd_base64_encode>)
    - [`fd_base64_decode`](<fd_base64.c.md#fd_base64_decode>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)