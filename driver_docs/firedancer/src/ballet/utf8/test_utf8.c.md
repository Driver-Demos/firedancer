<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Tests for UTF-8 validation using predefined test vectors and edge cases.

# Purpose
The code is a C program designed to test the functionality of UTF-8 verification. It includes a main function that initializes the test environment and executes a series of tests to validate UTF-8 encoded strings. The program uses a structure `fd_utf8_test_vector` to define test vectors, which consist of an input string, its size, and the expected result of the UTF-8 verification. The test vectors are used to check the correctness of the `fd_utf8_verify` function, which is assumed to be defined in the included `fd_utf8.h` header file.

The program performs several tests, including verifying single glyphs, combinations of glyphs, and edge cases such as out-of-bounds reads and null bytes within strings. It uses assertions to ensure that the `fd_utf8_verify` function returns expected results for each test case. The tests cover various scenarios, including valid and invalid UTF-8 sequences, to ensure the robustness of the UTF-8 verification process. The program concludes by logging a success message if all tests pass and then halts the test environment.
# Imports and Dependencies

---
- `fd_utf8.h`
- `assert.h`


# Global Variables

---
### \_single\_glyph\_vec
- **Type**: ``fd_utf8_test_vector_t const[]``
- **Description**: An array of `fd_utf8_test_vector_t` structures, each containing a UTF-8 encoded string, its size, and a result indicating validity. The array is used to test UTF-8 verification functions.
- **Use**: Used to store test vectors for verifying UTF-8 string validity in the `fd_utf8_verify` function.


# Data Structures

---
### fd\_utf8\_test\_vector
- **Type**: ``struct``
- **Members**:
    - `input`: A pointer to a constant character array representing the UTF-8 encoded input string.
    - `sz`: An unsigned integer representing the size of the input string.
    - `result`: An integer indicating the expected result of UTF-8 verification (1 for valid, 0 for invalid).
- **Description**: Defines a structure used to store test vectors for UTF-8 verification, including the input string, its size, and the expected verification result.


---
### fd\_utf8\_test\_vector\_t
- **Type**: ``struct``
- **Members**:
    - `input`: A pointer to a constant character string representing the UTF-8 input to test.
    - `sz`: An unsigned integer representing the size of the UTF-8 input string.
    - `result`: An integer representing the expected result of the UTF-8 verification (1 for valid, 0 for invalid).
- **Description**: Defines a structure used to store test vectors for UTF-8 validation, including the input string, its size, and the expected validation result.


# Functions

---
### main<!-- {{#callable:main}} -->
[View Source →](<../../../../../src/ballet/utf8/test_utf8.c#L37>)

Executes a series of tests to verify the correctness of UTF-8 encoding using predefined test vectors.
- **Inputs**:
    - `argc`: The number of command-line arguments.
    - `argv`: An array of command-line arguments.
- **Logic and Control Flow**:
    - Calls `fd_boot` to initialize the environment with command-line arguments.
    - Verifies that a NULL input with size 0 is valid UTF-8 using [`fd_utf8_verify`](<fd_utf8.c.md#fd_utf8_verify>).
    - Iterates over `_single_glyph_vec` to test each single glyph for correct UTF-8 verification.
    - For each glyph, tests smaller sizes and inserts a null byte to ensure invalid UTF-8 detection.
    - Checks combinations of two single glyphs to verify UTF-8 encoding correctness using nested loops.
    - Prevents out-of-bounds reads by testing all possible single-byte values with [`fd_utf8_verify`](<fd_utf8.c.md#fd_utf8_verify>).
    - Tests a specific UTF-8 string with a null byte in the middle to ensure it is valid.
    - Tests specific out-of-bounds cases to ensure they are detected as invalid UTF-8.
    - Logs a notice of passing tests and calls `fd_halt` to terminate the program.
- **Output**: Returns 0 to indicate successful execution.
- **Functions Called**:
    - [`fd_utf8_verify`](<fd_utf8.c.md#fd_utf8_verify>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)