<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Tests HMAC implementations using SHA-256, SHA-384, and SHA-512 with predefined test vectors.

# Purpose
The code is a C program designed to test the implementation of HMAC (Hash-based Message Authentication Code) using SHA-256, SHA-384, and SHA-512 hash functions. It includes test vectors defined according to RFC 2104, which are used to verify the correctness of the HMAC functions. The program imports necessary headers for HMAC and SHA functions and defines a structure `fd_hmac_test_vector_t` to store test vectors, including keys, messages, and expected hash outputs.

The [`main`](<#main>) function initializes the test environment and iterates over predefined test vectors for each HMAC variant (SHA-256, SHA-384, and SHA-512). For each test vector, it computes the HMAC of the message using the specified key and compares the result with the expected hash. If the computed hash does not match the expected hash, an error is logged. The program logs success messages for each HMAC variant if all tests pass and concludes with a notice indicating that all tests have passed. The program is structured to be executed as a standalone application, with the primary purpose of validating the HMAC implementations.
# Imports and Dependencies

---
- `fd_hmac.h`
- `../sha256/fd_sha256.h`
- `../sha512/fd_sha512.h`


# Global Variables

---
### fd\_hmac\_sha256\_test\_vector
- **Type**: ``fd_hmac_test_vector_t const[]``
- **Description**: An array of HMAC test vectors for SHA-256, defined as a constant array of `fd_hmac_test_vector_t` structures. Each element in the array contains a key, a message, and the expected hash result, based on RFC 2104 test vectors.
- **Use**: Used to verify the correctness of the HMAC-SHA256 implementation by comparing computed hashes against expected values.


---
### fd\_hmac\_sha384\_test\_vector
- **Type**: ``fd_hmac_test_vector_t` array`
- **Description**: Contains test vectors for HMAC-SHA384, defined as an array of `fd_hmac_test_vector_t` structures. Each element in the array includes a key, message, and expected hash value, which are used to verify the correctness of the HMAC-SHA384 implementation.
- **Use**: Used to validate the HMAC-SHA384 function by comparing computed hash values against expected results.


---
### fd\_hmac\_sha512\_test\_vector
- **Type**: ``fd_hmac_test_vector_t const[]``
- **Description**: An array of HMAC test vectors for the SHA-512 algorithm, each containing a key, message, and expected hash result. The test vectors are based on RFC 2104 and are used to verify the correctness of the HMAC-SHA512 implementation.
- **Use**: Used to validate the HMAC-SHA512 function by comparing computed hashes against expected values.


# Data Structures

---
### fd\_hmac\_test\_vector
- **Type**: ``struct``
- **Members**:
    - `key`: Pointer to a constant character array representing the HMAC key.
    - `key_sz`: Size of the HMAC key in bytes.
    - `msg`: Pointer to a constant character array representing the message to hash.
    - `msg_sz`: Size of the message in bytes.
    - `hash`: Array of unsigned characters storing the resulting hash, with a fixed size of 64 bytes.
- **Description**: Defines a structure for storing test vectors used in HMAC (Hash-based Message Authentication Code) operations, including the key, message, and expected hash result.


---
### fd\_hmac\_test\_vector\_t
- **Type**: ``struct``
- **Members**:
    - `key`: Pointer to a constant character array representing the HMAC key.
    - `key_sz`: Size of the HMAC key in bytes.
    - `msg`: Pointer to a constant character array representing the message to hash.
    - `msg_sz`: Size of the message in bytes.
    - `hash`: Array of unsigned characters storing the resulting hash value.
- **Description**: Defines a structure for storing test vectors used in HMAC (Hash-based Message Authentication Code) operations, including the key, message, and expected hash result. This structure is used to verify the correctness of HMAC implementations by comparing computed hash values against known test vectors.


# Functions

---
### main<!-- {{#callable:main}} -->
[View Source →](<../../../../../src/ballet/hmac/test_hmac.c#L80>)

Executes HMAC-SHA256, HMAC-SHA384, and HMAC-SHA512 tests using predefined test vectors and logs the results.
- **Inputs**:
    - `argc`: The number of command-line arguments.
    - `argv`: The array of command-line arguments.
- **Logic and Control Flow**:
    - Calls `fd_boot` to initialize the environment with `argc` and `argv`.
    - Declares a 64-byte aligned array `hash` to store the computed hash values.
    - Iterates over `fd_hmac_sha256_test_vector`, `fd_hmac_sha384_test_vector`, and `fd_hmac_sha512_test_vector` to perform HMAC tests for SHA-256, SHA-384, and SHA-512 respectively.
    - For each test vector, extracts the key, message, and expected hash values.
    - Computes the HMAC using `fd_hmac_sha256`, `fd_hmac_sha384`, or `fd_hmac_sha512` and stores the result in `hash`.
    - Compares the computed hash with the expected hash using `memcmp`.
    - Logs an error message and exits if the computed hash does not match the expected hash.
    - Logs a success message for each hash type if all tests pass.
    - Logs a final notice message indicating all tests passed.
    - Calls `fd_halt` to clean up and terminate the program.
- **Output**: Returns 0 to indicate successful execution.



---
Made with ❤️ by [Driver](https://www.driver.ai/)