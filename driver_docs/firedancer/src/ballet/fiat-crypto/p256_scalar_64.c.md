<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Autogenerated C code for 64-bit Montgomery arithmetic on the p256_scalar curve, including operations like multiplication, addition, subtraction, and conversion between Montgomery and non-Montgomery domains.

# Purpose
The code is a C implementation of arithmetic operations for the `p256_scalar` curve using Montgomery arithmetic. It is designed to perform operations such as multiplication, squaring, addition, subtraction, and conversion between Montgomery and non-Montgomery domains. The code is auto-generated and optimized for a 64-bit machine word size, specifically targeting the prime modulus `m = 2^256 - 2^224 + 2^192 - 89188191075325690597107910205041859247`.

The file defines several functions that operate on field elements represented as arrays of 64-bit unsigned integers. These functions include [`fiat_p256_scalar_addcarryx_u64`](<#fiat_p256_scalar_addcarryx_u64>) for addition with carry, [`fiat_p256_scalar_subborrowx_u64`](<#fiat_p256_scalar_subborrowx_u64>) for subtraction with borrow, and [`fiat_p256_scalar_mulx_u64`](<#fiat_p256_scalar_mulx_u64>) for multiplication. The code also includes functions for conditional moves and conversions between byte arrays and field elements. The operations ensure that inputs and outputs are within the bounds of the prime modulus and are in the correct representation for Montgomery arithmetic. The file is intended to be used as a library for cryptographic applications that require efficient arithmetic on the `p256_scalar` curve.
# Imports and Dependencies

---
- `stdint.h`


# Global Variables

---
### fiat\_p256\_scalar\_int128
- **Type**: ``typedef signed __int128``
- **Description**: Defines `fiat_p256_scalar_int128` as a signed 128-bit integer type using the `__int128` type extension. This type is used to represent large integers that require more than 64 bits.
- **Use**: Used in arithmetic operations that require handling of large integer values beyond the standard 64-bit integer range.


---
### fiat\_p256\_scalar\_uint128
- **Type**: ``typedef unsigned __int128``
- **Description**: Defines `fiat_p256_scalar_uint128` as an unsigned 128-bit integer type using the `__int128` extension available in some compilers like GCC and Clang. This type is used to handle large integer arithmetic operations that exceed the standard 64-bit integer size.
- **Use**: Used in arithmetic operations where 128-bit precision is necessary, such as in cryptographic computations involving the P-256 scalar field.


# Functions

---
### fiat\_p256\_scalar\_value\_barrier\_u64<!-- {{#callable:fiat_p256_scalar_value_barrier_u64}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/p256_scalar_64.c#L47>)

Acts as a value barrier for a 64-bit unsigned integer, preventing certain compiler optimizations.
- **Inputs**:
    - `a`: A 64-bit unsigned integer input.
- **Logic and Control Flow**:
    - Uses inline assembly to create a barrier for the input value `a`, preventing the compiler from optimizing it away.
    - The assembly code does not perform any operations on `a`, but the `+r` constraint ensures `a` is treated as both input and output, maintaining its value.
- **Output**: Returns the same 64-bit unsigned integer `a` that was input.


---
### fiat\_p256\_scalar\_addcarryx\_u64<!-- {{#callable:fiat_p256_scalar_addcarryx_u64}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/p256_scalar_64.c#L71>)

Performs addition of two 64-bit unsigned integers with a carry-in and produces a carry-out.
- **Inputs**:
    - ``out1``: Pointer to a `uint64_t` where the result of the addition will be stored.
    - ``out2``: Pointer to a `fiat_p256_scalar_uint1` where the carry-out will be stored.
    - ``arg1``: A `fiat_p256_scalar_uint1` representing the carry-in for the addition.
    - ``arg2``: A `uint64_t` representing the first operand for the addition.
    - ``arg3``: A `uint64_t` representing the second operand for the addition.
- **Logic and Control Flow**:
    - Declare a `fiat_p256_scalar_uint128` variable `x1` to store the intermediate result of the addition.
    - Calculate `x1` as the sum of `arg1`, `arg2`, and `arg3`.
    - Extract the lower 64 bits of `x1` and store it in `x2`.
    - Extract the upper bits of `x1` (beyond 64 bits) and store it in `x3`.
    - Store `x2` in the location pointed to by `out1`.
    - Store `x3` in the location pointed to by `out2`.
- **Output**: The function outputs the sum of `arg1`, `arg2`, and `arg3` modulo `2^64` in `out1`, and the carry-out in `out2`.


---
### fiat\_p256\_scalar\_subborrowx\_u64<!-- {{#callable:fiat_p256_scalar_subborrowx_u64}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/p256_scalar_64.c#L97>)

Performs subtraction with borrow on two 64-bit unsigned integers and a borrow flag, producing a result and a borrow flag.
- **Inputs**:
    - `out1`: Pointer to a 64-bit unsigned integer where the result of the subtraction will be stored.
    - `out2`: Pointer to a `fiat_p256_scalar_uint1` where the borrow flag will be stored.
    - `arg1`: A `fiat_p256_scalar_uint1` representing the initial borrow flag.
    - `arg2`: A 64-bit unsigned integer, the minuend.
    - `arg3`: A 64-bit unsigned integer, the subtrahend.
- **Logic and Control Flow**:
    - Calculate the intermediate result `x1` by subtracting `arg1` and `arg3` from `arg2` using 128-bit arithmetic to handle potential overflow.
    - Extract the borrow flag `x2` by right-shifting `x1` by 64 bits, which indicates if the subtraction resulted in a negative value.
    - Extract the lower 64 bits of `x1` as `x3`, which is the result of the subtraction without the borrow.
    - Store `x3` in the location pointed to by `out1`.
    - Calculate the final borrow flag by subtracting `x2` from 0 and store it in the location pointed to by `out2`.
- **Output**: The function outputs the result of the subtraction in `out1` and the borrow flag in `out2`.


---
### fiat\_p256\_scalar\_mulx\_u64<!-- {{#callable:fiat_p256_scalar_mulx_u64}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/p256_scalar_64.c#L122>)

Performs a 64-bit multiplication of two unsigned integers and returns the result as a double-width 128-bit integer split into two 64-bit parts.
- **Inputs**:
    - `out1`: Pointer to a `uint64_t` where the lower 64 bits of the result will be stored.
    - `out2`: Pointer to a `uint64_t` where the upper 64 bits of the result will be stored.
    - `arg1`: First 64-bit unsigned integer operand.
    - `arg2`: Second 64-bit unsigned integer operand.
- **Logic and Control Flow**:
    - Multiply `arg1` and `arg2` to get a 128-bit result stored in `x1`.
    - Extract the lower 64 bits of `x1` and store in `x2`.
    - Extract the upper 64 bits of `x1` and store in `x3`.
    - Assign `x2` to the location pointed by `out1`.
    - Assign `x3` to the location pointed by `out2`.
- **Output**: The function outputs the result of the multiplication in two parts: the lower 64 bits are stored in `*out1`, and the upper 64 bits are stored in `*out2`.


---
### fiat\_p256\_scalar\_cmovznz\_u64<!-- {{#callable:fiat_p256_scalar_cmovznz_u64}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/p256_scalar_64.c#L146>)

Performs a conditional move of two 64-bit unsigned integers based on a flag.
- **Inputs**:
    - `out1`: A pointer to a 64-bit unsigned integer where the result will be stored.
    - `arg1`: A flag of type `fiat_p256_scalar_uint1` (0 or 1) that determines which value to select.
    - `arg2`: A 64-bit unsigned integer to select if `arg1` is 0.
    - `arg3`: A 64-bit unsigned integer to select if `arg1` is 1.
- **Logic and Control Flow**:
    - Negate `arg1` twice to ensure it is either 0 or 1, storing the result in `x1`.
    - Compute `x2` as the bitwise AND of the negated `x1` and the maximum 64-bit unsigned integer value.
    - Use [`fiat_p256_scalar_value_barrier_u64`](<#fiat_p256_scalar_value_barrier_u64>) to apply a value barrier to `x2` and its negation, ensuring no optimization removes the conditional logic.
    - Compute `x3` as the bitwise OR of the masked `arg3` and `arg2`, using the value barriers to select the correct value based on `x2`.
    - Store the result in the location pointed to by `out1`.
- **Output**: The function does not return a value but stores the result in the location pointed to by `out1`.
- **Functions Called**:
    - [`fiat_p256_scalar_value_barrier_u64`](<#fiat_p256_scalar_value_barrier_u64>)


---
### fiat\_p256\_scalar\_mul<!-- {{#callable:fiat_p256_scalar_mul}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/p256_scalar_64.c#L167>)

Multiplies two field elements in the Montgomery domain and reduces the result modulo the prime modulus.
- **Inputs**:
    - `out1`: A pointer to a `fiat_p256_scalar_montgomery_domain_field_element` where the result will be stored.
    - `arg1`: A constant pointer to a `fiat_p256_scalar_montgomery_domain_field_element` representing the first operand.
    - `arg2`: A constant pointer to a `fiat_p256_scalar_montgomery_domain_field_element` representing the second operand.
- **Logic and Control Flow**:
    - Initialize local variables for intermediate calculations.
    - Perform multiplication of each element of `arg1` with each element of `arg2` using [`fiat_p256_scalar_mulx_u64`](<#fiat_p256_scalar_mulx_u64>) to get double-width results.
    - Use [`fiat_p256_scalar_addcarryx_u64`](<#fiat_p256_scalar_addcarryx_u64>) to accumulate the results of the multiplications, handling carry bits appropriately.
    - Multiply the intermediate result by a constant to reduce it modulo the prime modulus using [`fiat_p256_scalar_mulx_u64`](<#fiat_p256_scalar_mulx_u64>).
    - Use [`fiat_p256_scalar_addcarryx_u64`](<#fiat_p256_scalar_addcarryx_u64>) to accumulate the results of the reduction, handling carry bits appropriately.
    - Perform conditional subtraction using [`fiat_p256_scalar_subborrowx_u64`](<#fiat_p256_scalar_subborrowx_u64>) to ensure the result is less than the modulus.
    - Use [`fiat_p256_scalar_cmovznz_u64`](<#fiat_p256_scalar_cmovznz_u64>) to conditionally select the final result based on the subtraction outcome.
    - Store the final result in `out1`.
- **Output**: The function does not return a value but stores the result in the `out1` parameter, which is a `fiat_p256_scalar_montgomery_domain_field_element`.
- **Functions Called**:
    - [`fiat_p256_scalar_mulx_u64`](<#fiat_p256_scalar_mulx_u64>)
    - [`fiat_p256_scalar_addcarryx_u64`](<#fiat_p256_scalar_addcarryx_u64>)
    - [`fiat_p256_scalar_subborrowx_u64`](<#fiat_p256_scalar_subborrowx_u64>)
    - [`fiat_p256_scalar_cmovznz_u64`](<#fiat_p256_scalar_cmovznz_u64>)


---
### fiat\_p256\_scalar\_square<!-- {{#callable:fiat_p256_scalar_square}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/p256_scalar_64.c#L522>)

Squares a field element in the Montgomery domain for the P-256 scalar field.
- **Inputs**:
    - `out1`: A pointer to a `fiat_p256_scalar_montgomery_domain_field_element` where the result will be stored.
    - `arg1`: A constant pointer to a `fiat_p256_scalar_montgomery_domain_field_element` representing the input field element to be squared.
- **Logic and Control Flow**:
    - Initialize variables to store intermediate results and carry bits.
    - Extract individual components of the input field element `arg1`.
    - Perform a series of multiplications using [`fiat_p256_scalar_mulx_u64`](<#fiat_p256_scalar_mulx_u64>) to compute the square of the input element, storing results in temporary variables.
    - Use [`fiat_p256_scalar_addcarryx_u64`](<#fiat_p256_scalar_addcarryx_u64>) to handle carry bits and accumulate results from the multiplications.
    - Multiply the intermediate result by a constant using [`fiat_p256_scalar_mulx_u64`](<#fiat_p256_scalar_mulx_u64>) to adjust for the Montgomery domain.
    - Perform additional carry handling and accumulation using [`fiat_p256_scalar_addcarryx_u64`](<#fiat_p256_scalar_addcarryx_u64>).
    - Subtract the modulus using [`fiat_p256_scalar_subborrowx_u64`](<#fiat_p256_scalar_subborrowx_u64>) to ensure the result is within the field range.
    - Use [`fiat_p256_scalar_cmovznz_u64`](<#fiat_p256_scalar_cmovznz_u64>) to conditionally select the final result based on the carry from the subtraction.
    - Store the final result in `out1`.
- **Output**: The function outputs the squared field element in the Montgomery domain, stored in `out1`.
- **Functions Called**:
    - [`fiat_p256_scalar_mulx_u64`](<#fiat_p256_scalar_mulx_u64>)
    - [`fiat_p256_scalar_addcarryx_u64`](<#fiat_p256_scalar_addcarryx_u64>)
    - [`fiat_p256_scalar_subborrowx_u64`](<#fiat_p256_scalar_subborrowx_u64>)
    - [`fiat_p256_scalar_cmovznz_u64`](<#fiat_p256_scalar_cmovznz_u64>)


---
### fiat\_p256\_scalar\_add<!-- {{#callable:fiat_p256_scalar_add}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/p256_scalar_64.c#L878>)

Adds two field elements in the Montgomery domain and reduces the result modulo the prime modulus.
- **Inputs**:
    - `out1`: A pointer to the output array where the result will be stored, representing a field element in the Montgomery domain.
    - `arg1`: A pointer to the first input array, representing a field element in the Montgomery domain.
    - `arg2`: A pointer to the second input array, representing a field element in the Montgomery domain.
- **Logic and Control Flow**:
    - Initialize temporary variables for intermediate calculations.
    - Perform addition with carry for each corresponding element of `arg1` and `arg2`, storing results in temporary variables.
    - Perform subtraction with borrow to reduce the result modulo the prime modulus, using constants specific to the modulus.
    - Use conditional move operations to select the correct result based on the borrow flag.
    - Store the final result in the `out1` array.
- **Output**: The function does not return a value but stores the result in the `out1` array, which represents the sum of `arg1` and `arg2` in the Montgomery domain, reduced modulo the prime modulus.
- **Functions Called**:
    - [`fiat_p256_scalar_addcarryx_u64`](<#fiat_p256_scalar_addcarryx_u64>)
    - [`fiat_p256_scalar_subborrowx_u64`](<#fiat_p256_scalar_subborrowx_u64>)
    - [`fiat_p256_scalar_cmovznz_u64`](<#fiat_p256_scalar_cmovznz_u64>)


---
### fiat\_p256\_scalar\_sub<!-- {{#callable:fiat_p256_scalar_sub}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/p256_scalar_64.c#L931>)

Subtracts two field elements in the Montgomery domain and ensures the result is within the field's modulus.
- **Inputs**:
    - `out1`: A `fiat_p256_scalar_montgomery_domain_field_element` array to store the result of the subtraction.
    - `arg1`: A `fiat_p256_scalar_montgomery_domain_field_element` array representing the minuend.
    - `arg2`: A `fiat_p256_scalar_montgomery_domain_field_element` array representing the subtrahend.
- **Logic and Control Flow**:
    - Initialize variables for intermediate results and carry/borrow flags.
    - Perform subtraction with borrow for each element of `arg1` and `arg2` using [`fiat_p256_scalar_subborrowx_u64`](<#fiat_p256_scalar_subborrowx_u64>), storing results in `x1`, `x3`, `x5`, and `x7`.
    - Check if the final borrow flag `x8` is set, indicating a negative result, and conditionally set `x9` to a mask of all 1s or 0s using [`fiat_p256_scalar_cmovznz_u64`](<#fiat_p256_scalar_cmovznz_u64>).
    - Add the modulus to the result if the borrow flag was set, using [`fiat_p256_scalar_addcarryx_u64`](<#fiat_p256_scalar_addcarryx_u64>) to ensure the result is non-negative and within the field's modulus.
    - Store the final result in `out1`.
- **Output**: The result of the subtraction is stored in the `out1` array, representing a field element in the Montgomery domain.
- **Functions Called**:
    - [`fiat_p256_scalar_subborrowx_u64`](<#fiat_p256_scalar_subborrowx_u64>)
    - [`fiat_p256_scalar_cmovznz_u64`](<#fiat_p256_scalar_cmovznz_u64>)
    - [`fiat_p256_scalar_addcarryx_u64`](<#fiat_p256_scalar_addcarryx_u64>)


---
### fiat\_p256\_scalar\_opp<!-- {{#callable:fiat_p256_scalar_opp}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/p256_scalar_64.c#L974>)

Negates a field element in the Montgomery domain.
- **Inputs**:
    - `out1`: A pointer to a `fiat_p256_scalar_montgomery_domain_field_element` where the result will be stored.
    - `arg1`: A constant pointer to a `fiat_p256_scalar_montgomery_domain_field_element` representing the input field element to negate.
- **Logic and Control Flow**:
    - Initialize variables `x1` to `x17` for intermediate calculations.
    - Perform a series of subtraction operations using [`fiat_p256_scalar_subborrowx_u64`](<#fiat_p256_scalar_subborrowx_u64>) to compute the negation of `arg1`.
    - Use [`fiat_p256_scalar_cmovznz_u64`](<#fiat_p256_scalar_cmovznz_u64>) to conditionally select between zero and a constant value based on the result of the subtraction.
    - Perform addition operations using [`fiat_p256_scalar_addcarryx_u64`](<#fiat_p256_scalar_addcarryx_u64>) to adjust the result based on the conditional selection.
    - Store the final result in `out1`.
- **Output**: The negated field element is stored in `out1`.
- **Functions Called**:
    - [`fiat_p256_scalar_subborrowx_u64`](<#fiat_p256_scalar_subborrowx_u64>)
    - [`fiat_p256_scalar_cmovznz_u64`](<#fiat_p256_scalar_cmovznz_u64>)
    - [`fiat_p256_scalar_addcarryx_u64`](<#fiat_p256_scalar_addcarryx_u64>)


---
### fiat\_p256\_scalar\_from\_montgomery<!-- {{#callable:fiat_p256_scalar_from_montgomery}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/p256_scalar_64.c#L1017>)

Converts a field element from the Montgomery domain to the standard representation.
- **Inputs**:
    - `out1`: A pointer to a `fiat_p256_scalar_non_montgomery_domain_field_element` where the result will be stored.
    - `arg1`: A `fiat_p256_scalar_montgomery_domain_field_element` representing the input field element in the Montgomery domain.
- **Logic and Control Flow**:
    - Initialize variables for intermediate calculations.
    - Extract the first element of `arg1` and perform a series of multiplications and additions to compute intermediate values.
    - Use the [`fiat_p256_scalar_mulx_u64`](<#fiat_p256_scalar_mulx_u64>) function to perform multiplications and [`fiat_p256_scalar_addcarryx_u64`](<#fiat_p256_scalar_addcarryx_u64>) for additions with carry.
    - Repeat the process for each element of `arg1`, updating the intermediate values accordingly.
    - Perform subtraction with borrow using [`fiat_p256_scalar_subborrowx_u64`](<#fiat_p256_scalar_subborrowx_u64>) to ensure the result is within the field's modulus.
    - Use conditional move operations [`fiat_p256_scalar_cmovznz_u64`](<#fiat_p256_scalar_cmovznz_u64>) to select the correct result based on the borrow flag.
    - Store the final result in `out1`.
- **Output**: The function outputs the converted field element in the standard representation, stored in `out1`.
- **Functions Called**:
    - [`fiat_p256_scalar_mulx_u64`](<#fiat_p256_scalar_mulx_u64>)
    - [`fiat_p256_scalar_addcarryx_u64`](<#fiat_p256_scalar_addcarryx_u64>)
    - [`fiat_p256_scalar_subborrowx_u64`](<#fiat_p256_scalar_subborrowx_u64>)
    - [`fiat_p256_scalar_cmovznz_u64`](<#fiat_p256_scalar_cmovznz_u64>)


---
### fiat\_p256\_scalar\_to\_montgomery<!-- {{#callable:fiat_p256_scalar_to_montgomery}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/p256_scalar_64.c#L1232>)

Converts a field element from the non-Montgomery domain to the Montgomery domain for the P-256 scalar field.
- **Inputs**:
    - `out1`: A pointer to a `fiat_p256_scalar_montgomery_domain_field_element` array where the result will be stored.
    - `arg1`: A constant pointer to a `fiat_p256_scalar_non_montgomery_domain_field_element` array representing the input field element in the non-Montgomery domain.
- **Logic and Control Flow**:
    - Initialize variables to hold intermediate results and carry flags.
    - Extract individual elements from the input array `arg1`.
    - Perform a series of multiplications and additions to convert the input to the Montgomery domain, using constants specific to the P-256 scalar field.
    - Use the [`fiat_p256_scalar_mulx_u64`](<#fiat_p256_scalar_mulx_u64>) function to perform 64-bit multiplications and store the results in two 64-bit variables.
    - Use the [`fiat_p256_scalar_addcarryx_u64`](<#fiat_p256_scalar_addcarryx_u64>) function to add numbers with carry, updating the carry flag as needed.
    - Perform modular reduction using the modulus of the P-256 scalar field to ensure the result is within the field's bounds.
    - Store the final result in the `out1` array.
- **Output**: The function does not return a value but stores the converted Montgomery domain field element in the `out1` array.
- **Functions Called**:
    - [`fiat_p256_scalar_mulx_u64`](<#fiat_p256_scalar_mulx_u64>)
    - [`fiat_p256_scalar_addcarryx_u64`](<#fiat_p256_scalar_addcarryx_u64>)
    - [`fiat_p256_scalar_subborrowx_u64`](<#fiat_p256_scalar_subborrowx_u64>)
    - [`fiat_p256_scalar_cmovznz_u64`](<#fiat_p256_scalar_cmovznz_u64>)


---
### fiat\_p256\_scalar\_nonzero<!-- {{#callable:fiat_p256_scalar_nonzero}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/p256_scalar_64.c#L1559>)

Outputs a single non-zero word if the input array is non-zero, otherwise outputs zero.
- **Inputs**:
    - `out1`: A pointer to a `uint64_t` where the result will be stored.
    - `arg1`: An array of four `uint64_t` values representing the input to check for non-zero.
- **Logic and Control Flow**:
    - Initialize a `uint64_t` variable `x1` to the bitwise OR of all elements in `arg1` array.
    - Assign the value of `x1` to the dereferenced `out1` pointer.
- **Output**: A single `uint64_t` value stored at the location pointed to by `out1`, which is non-zero if any element of `arg1` is non-zero, otherwise zero.


---
### fiat\_p256\_scalar\_selectznz<!-- {{#callable:fiat_p256_scalar_selectznz}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/p256_scalar_64.c#L1578>)

Selects between two 256-bit scalar values based on a condition.
- **Inputs**:
    - `out1`: An array of four 64-bit unsigned integers where the result is stored.
    - `arg1`: A single-bit unsigned integer that acts as the condition for selection.
    - `arg2`: An array of four 64-bit unsigned integers representing the first scalar value.
    - `arg3`: An array of four 64-bit unsigned integers representing the second scalar value.
- **Logic and Control Flow**:
    - Calls [`fiat_p256_scalar_cmovznz_u64`](<#fiat_p256_scalar_cmovznz_u64>) four times, once for each 64-bit segment of the scalar values.
    - Each call to [`fiat_p256_scalar_cmovznz_u64`](<#fiat_p256_scalar_cmovznz_u64>) selects between the corresponding elements of `arg2` and `arg3` based on `arg1`.
    - Stores the selected values in the `out1` array.
- **Output**: The `out1` array contains the selected 256-bit scalar value, either `arg2` or `arg3`, based on the value of `arg1`.
- **Functions Called**:
    - [`fiat_p256_scalar_cmovznz_u64`](<#fiat_p256_scalar_cmovznz_u64>)


---
### fiat\_p256\_scalar\_to\_bytes<!-- {{#callable:fiat_p256_scalar_to_bytes}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/p256_scalar_64.c#L1606>)

Converts a 256-bit scalar from a 4-element array of 64-bit integers to a 32-byte array in little-endian order.
- **Inputs**:
    - `out1`: A 32-byte array where the function will store the serialized output.
    - `arg1`: A 4-element array of 64-bit unsigned integers representing the scalar to be serialized.
- **Logic and Control Flow**:
    - Extracts each 64-bit integer from `arg1` and processes it in little-endian order.
    - For each 64-bit integer, extracts each byte by masking and shifting operations.
    - Stores each extracted byte into the corresponding position in the `out1` array.
- **Output**: A 32-byte array `out1` containing the serialized scalar in little-endian order.


---
### fiat\_p256\_scalar\_from\_bytes<!-- {{#callable:fiat_p256_scalar_from_bytes}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/p256_scalar_64.c#L1775>)

Converts a 32-byte array into a 4-element array of 64-bit unsigned integers, interpreting the input as a little-endian number.
- **Inputs**:
    - `out1`: A pointer to an array of four 64-bit unsigned integers where the result will be stored.
    - `arg1`: A pointer to an array of 32 bytes representing the input number in little-endian order.
- **Logic and Control Flow**:
    - Initialize 60 local variables to store intermediate results.
    - Extract each byte from `arg1` and shift it to its correct position to form 64-bit integers.
    - Combine the shifted bytes to form four 64-bit integers, each representing a segment of the input number.
    - Store the resulting 64-bit integers in the `out1` array.
- **Output**: A 4-element array of 64-bit unsigned integers representing the input number in little-endian order.


---
### fiat\_p256\_scalar\_set\_one<!-- {{#callable:fiat_p256_scalar_set_one}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/p256_scalar_64.c#L1910>)

Sets the output field element to the representation of one in the Montgomery domain for the P-256 scalar field.
- **Inputs**:
    - `out1`: A `fiat_p256_scalar_montgomery_domain_field_element` array of size 4 that will hold the result.
- **Logic and Control Flow**:
    - Assigns the constant `0xc46353d039cdaaf` to `out1[0]`.
    - Assigns the constant `0x4319055258e8617b` to `out1[1]`.
    - Assigns `0x0` to `out1[2]`.
    - Assigns the constant `0xffffffff` to `out1[3]`.
- **Output**: The function does not return a value but modifies the `out1` array to represent the number one in the Montgomery domain.


---
### fiat\_p256\_scalar\_msat<!-- {{#callable:fiat_p256_scalar_msat}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/p256_scalar_64.c#L1927>)

Returns the saturated representation of the prime modulus for the P-256 scalar field.
- **Inputs**:
    - `out1`: An array of 5 `uint64_t` elements where the function will store the saturated representation of the prime modulus.
- **Logic and Control Flow**:
    - Assigns the constant value `0xf3b9cac2fc632551` to `out1[0]`.
    - Assigns the constant value `0xbce6faada7179e84` to `out1[1]`.
    - Assigns the constant value `0xffffffffffffffff` to `out1[2]`.
    - Assigns the constant value `0xffffffff00000000` to `out1[3]`.
    - Assigns the value `0x0` to `out1[4]`.
- **Output**: The function outputs the saturated representation of the prime modulus in the `out1` array.


---
### fiat\_p256\_scalar\_divstep<!-- {{#callable:fiat_p256_scalar_divstep}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/p256_scalar_64.c#L1965>)

Computes a divstep operation for the P-256 scalar field, updating multiple output arrays based on conditional logic and arithmetic operations.
- **Inputs**:
    - `out1`: Pointer to a `uint64_t` where the function stores the result of the divstep operation.
    - `out2`: Array of 5 `uint64_t` elements to store the updated value of `arg2` or `arg3` based on conditions.
    - `out3`: Array of 5 `uint64_t` elements to store the result of a conditional arithmetic operation on `arg2` and `arg3`.
    - `out4`: Array of 4 `uint64_t` elements to store the result of a conditional arithmetic operation on `arg4` and `arg5`.
    - `out5`: Array of 4 `uint64_t` elements to store the result of a conditional arithmetic operation on `arg4` and `arg5`.
    - `arg1`: A `uint64_t` input used in conditional checks and arithmetic operations.
    - `arg2`: Array of 5 `uint64_t` elements representing one of the inputs for the divstep operation.
    - `arg3`: Array of 5 `uint64_t` elements representing another input for the divstep operation.
    - `arg4`: Array of 4 `uint64_t` elements representing one of the inputs for the divstep operation.
    - `arg5`: Array of 4 `uint64_t` elements representing another input for the divstep operation.
- **Logic and Control Flow**:
    - Calculate `x1` as the bitwise negation of `arg1` plus 1, and determine `x3` based on the least significant bit of `arg3[0]` and the sign bit of `x1` shifted right by 63.
    - Use `x3` to conditionally select between `arg1` and `x4`, and between elements of `arg2` and `arg3`, storing results in `x6` to `x11`.
    - Compute the bitwise negation of `arg2` elements, add 1, and store results in `x12` to `x20`.
    - Use `x3` to conditionally select between elements of `arg3` and the negated `arg2`, storing results in `x22` to `x26`.
    - Use `x3` to conditionally select between elements of `arg4` and `arg5`, storing results in `x27` to `x30`.
    - Double the values in `x27` to `x30` and perform modular subtraction with constants, storing results in `x39` to `x47`.
    - Compute the bitwise negation of `arg4` elements, perform modular addition with constants, and store results in `x62` to `x68`.
    - Use `x3` to conditionally select between elements of `arg5` and the modified `arg4`, storing results in `x70` to `x73`.
    - Determine `x74` as the least significant bit of `x22`, and use it to conditionally zero out `x7` to `x11`, storing results in `x75` to `x79`.
    - Add `x75` to `x22`, `x76` to `x23`, and so on, storing results in `x80` to `x88`.
    - Use `x74` to conditionally zero out `x27` to `x30`, storing results in `x90` to `x93`.
    - Add `x90` to `x70`, `x91` to `x71`, and so on, storing results in `x94` to `x100`.
    - Perform modular subtraction with constants on `x94` to `x100`, storing results in `x102` to `x110`.
    - Increment `x6` by 1 and store in `x112`.
    - Right shift `x80` to `x88` by 1 bit, storing results in `x114` to `x118`.
    - Use `x48` to conditionally select between `x39` to `x45` and `x31` to `x37`, storing results in `x119` to `x122`.
    - Use `x111` to conditionally select between `x102` to `x108` and `x94` to `x100`, storing results in `x123` to `x126`.
    - Assign `x112` to `*out1`, `x7` to `x11` to `out2`, `x114` to `x118` to `out3`, `x119` to `x122` to `out4`, and `x123` to `x126` to `out5`.
- **Output**: The function updates `out1` with a `uint64_t` result, and modifies `out2`, `out3`, `out4`, and `out5` arrays based on the divstep operation.
- **Functions Called**:
    - [`fiat_p256_scalar_addcarryx_u64`](<#fiat_p256_scalar_addcarryx_u64>)
    - [`fiat_p256_scalar_cmovznz_u64`](<#fiat_p256_scalar_cmovznz_u64>)
    - [`fiat_p256_scalar_subborrowx_u64`](<#fiat_p256_scalar_subborrowx_u64>)


---
### fiat\_p256\_scalar\_divstep\_precomp<!-- {{#callable:fiat_p256_scalar_divstep_precomp}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/p256_scalar_64.c#L2210>)

Initializes a 4-element array with precomputed constants for the Bernstein-Yang inversion in Montgomery form.
- **Inputs**:
    - `out1`: A 4-element array of type `uint64_t` where the function stores the precomputed constants.
- **Logic and Control Flow**:
    - Assigns the constant `0xd739262fb7fcfbb5` to `out1[0]`.
    - Assigns the constant `0x8ac6f75d20074414` to `out1[1]`.
    - Assigns the constant `0xc67428bfb5e3c256` to `out1[2]`.
    - Assigns the constant `0x444962f2eda7aedf` to `out1[3]`.
- **Output**: The function does not return a value but modifies the `out1` array in place.



---
Made with ❤️ by [Driver](https://www.driver.ai/)