<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Autogenerated C code for secp256k1 curve operations using 64-bit Montgomery arithmetic, including functions for addition, subtraction, multiplication, and conversion between Montgomery and non-Montgomery domains.

# Purpose
The code is a C implementation of arithmetic operations for the secp256k1 elliptic curve using the Montgomery representation. It is designed to perform operations such as addition, subtraction, multiplication, and squaring of field elements within the Montgomery domain. The code also includes functions for converting between Montgomery and non-Montgomery representations, as well as functions for serialization and deserialization of field elements to and from byte arrays.

The code defines several types and functions that are specific to the secp256k1 curve, such as [`fiat_secp256k1_montgomery_addcarryx_u64`](<#fiat_secp256k1_montgomery_addcarryx_u64>), [`fiat_secp256k1_montgomery_subborrowx_u64`](<#fiat_secp256k1_montgomery_subborrowx_u64>), and [`fiat_secp256k1_montgomery_mulx_u64`](<#fiat_secp256k1_montgomery_mulx_u64>), which handle arithmetic operations with carry and borrow. It also includes functions for conditional moves and setting constants like the prime modulus and the field element one in the Montgomery domain. The code is intended to be used in cryptographic applications where secp256k1 is employed, such as in Bitcoin and other blockchain technologies.
# Imports and Dependencies

---
- `stdint.h`


# Global Variables

---
### fiat\_secp256k1\_montgomery\_int128
- **Type**: ``typedef signed __int128``
- **Description**: Defines a type `fiat_secp256k1_montgomery_int128` as a signed 128-bit integer using the `__int128` type extension. This type is used to represent large integers that require more than the standard 64-bit integer size.
- **Use**: Used in arithmetic operations that require handling of large integer values, particularly in cryptographic computations.


---
### fiat\_secp256k1\_montgomery\_uint128
- **Type**: ``typedef unsigned __int128``
- **Description**: Defines `fiat_secp256k1_montgomery_uint128` as an alias for the `unsigned __int128` type. This type represents a 128-bit unsigned integer, which is used in the context of the secp256k1 Montgomery arithmetic operations.
- **Use**: Used to perform arithmetic operations that require 128-bit precision in the secp256k1 Montgomery domain.


# Functions

---
### fiat\_secp256k1\_montgomery\_value\_barrier\_u64<!-- {{#callable:fiat_secp256k1_montgomery_value_barrier_u64}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_64.c#L47>)

Implements a value barrier for a 64-bit unsigned integer using inline assembly.
- **Inputs**:
    - `a`: A 64-bit unsigned integer input.
- **Logic and Control Flow**:
    - Uses inline assembly to create a value barrier for the input `a`.
    - The assembly code does not perform any operations but ensures that the value of `a` is not optimized away by the compiler.
- **Output**: Returns the same 64-bit unsigned integer `a`.


---
### fiat\_secp256k1\_montgomery\_addcarryx\_u64<!-- {{#callable:fiat_secp256k1_montgomery_addcarryx_u64}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_64.c#L71>)

Performs addition of two 64-bit unsigned integers with a carry-in and produces a carry-out.
- **Inputs**:
    - ``out1``: Pointer to a `uint64_t` where the result of the addition will be stored.
    - ``out2``: Pointer to a `fiat_secp256k1_montgomery_uint1` where the carry-out will be stored.
    - ``arg1``: A `fiat_secp256k1_montgomery_uint1` representing the carry-in for the addition.
    - ``arg2``: A `uint64_t` representing the first operand for the addition.
    - ``arg3``: A `uint64_t` representing the second operand for the addition.
- **Logic and Control Flow**:
    - Declare variables `x1`, `x2`, and `x3` to store intermediate results.
    - Compute `x1` as the sum of `arg1`, `arg2`, and `arg3` using 128-bit arithmetic to handle overflow.
    - Extract the lower 64 bits of `x1` and store in `x2`.
    - Extract the upper bits of `x1` (carry-out) and store in `x3`.
    - Store `x2` in the location pointed to by `out1`.
    - Store `x3` in the location pointed to by `out2`.
- **Output**: The function does not return a value but outputs the result of the addition in `out1` and the carry-out in `out2`.


---
### fiat\_secp256k1\_montgomery\_subborrowx\_u64<!-- {{#callable:fiat_secp256k1_montgomery_subborrowx_u64}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_64.c#L97>)

Performs subtraction with borrow on two 64-bit unsigned integers and a borrow flag, returning the result and the new borrow flag.
- **Inputs**:
    - `out1`: Pointer to a `uint64_t` where the result of the subtraction will be stored.
    - `out2`: Pointer to a `fiat_secp256k1_montgomery_uint1` where the new borrow flag will be stored.
    - `arg1`: A `fiat_secp256k1_montgomery_uint1` representing the initial borrow flag.
    - `arg2`: A `uint64_t` representing the minuend.
    - `arg3`: A `uint64_t` representing the subtrahend.
- **Logic and Control Flow**:
    - Calculate the intermediate result `x1` by subtracting `arg1` and `arg3` from `arg2`, using 128-bit integer arithmetic to handle potential overflow.
    - Extract the new borrow flag `x2` by right-shifting `x1` by 64 bits, which indicates if the subtraction resulted in a negative value.
    - Extract the lower 64 bits of `x1` to get the result `x3` of the subtraction without the borrow.
    - Store `x3` in the location pointed to by `out1`.
    - Calculate the new borrow flag to store in `out2` by subtracting `x2` from 0, effectively negating it.
- **Output**: The function outputs the result of the subtraction in `out1` and the new borrow flag in `out2`.


---
### fiat\_secp256k1\_montgomery\_mulx\_u64<!-- {{#callable:fiat_secp256k1_montgomery_mulx_u64}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_64.c#L122>)

Performs a 64-bit multiplication of two unsigned integers and returns the result as a double-width product split into two 64-bit parts.
- **Inputs**:
    - `out1`: Pointer to a `uint64_t` where the lower 64 bits of the product will be stored.
    - `out2`: Pointer to a `uint64_t` where the upper 64 bits of the product will be stored.
    - `arg1`: First unsigned 64-bit integer to multiply.
    - `arg2`: Second unsigned 64-bit integer to multiply.
- **Logic and Control Flow**:
    - Declare a variable `x1` of type `fiat_secp256k1_montgomery_uint128` to store the full 128-bit product of `arg1` and `arg2`.
    - Calculate the product of `arg1` and `arg2` and store it in `x1`.
    - Extract the lower 64 bits of `x1` and store it in `x2`.
    - Extract the upper 64 bits of `x1` and store it in `x3`.
    - Assign the value of `x2` to the location pointed to by `out1`.
    - Assign the value of `x3` to the location pointed to by `out2`.
- **Output**: The function does not return a value but outputs the lower and upper 64 bits of the product through the pointers `out1` and `out2`, respectively.


---
### fiat\_secp256k1\_montgomery\_cmovznz\_u64<!-- {{#callable:fiat_secp256k1_montgomery_cmovznz_u64}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_64.c#L146>)

Performs a conditional move between two 64-bit unsigned integers based on a condition flag.
- **Inputs**:
    - ``out1``: Pointer to a `uint64_t` where the result will be stored.
    - ``arg1``: Condition flag of type `fiat_secp256k1_montgomery_uint1` (0 or 1) that determines which value to select.
    - ``arg2``: First `uint64_t` value to select if `arg1` is 0.
    - ``arg3``: Second `uint64_t` value to select if `arg1` is 1.
- **Logic and Control Flow**:
    - Initialize `x1` as the logical negation of the logical negation of `arg1`, effectively converting `arg1` to a boolean value.
    - Compute `x2` as the bitwise AND of the negated `x1` and the maximum 64-bit unsigned integer, resulting in either all bits set or all bits cleared based on `arg1`.
    - Compute `x3` as the bitwise OR of the bitwise AND of `x2` with `arg3` and the bitwise AND of the negated `x2` with `arg2`, effectively selecting `arg3` if `arg1` is 1, otherwise `arg2`.
    - Store the result `x3` in the location pointed to by `out1`.
- **Output**: Stores the selected `uint64_t` value in the location pointed to by `out1`.
- **Functions Called**:
    - [`fiat_secp256k1_montgomery_value_barrier_u64`](<#fiat_secp256k1_montgomery_value_barrier_u64>)


---
### fiat\_secp256k1\_montgomery\_mul<!-- {{#callable:fiat_secp256k1_montgomery_mul}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_64.c#L167>)

Multiplies two field elements in the Montgomery domain and reduces the result modulo the prime modulus.
- **Inputs**:
    - `out1`: A pointer to a `fiat_secp256k1_montgomery_montgomery_domain_field_element` where the result will be stored.
    - `arg1`: A constant pointer to a `fiat_secp256k1_montgomery_montgomery_domain_field_element` representing the first operand.
    - `arg2`: A constant pointer to a `fiat_secp256k1_montgomery_montgomery_domain_field_element` representing the second operand.
- **Logic and Control Flow**:
    - Initialize multiple 64-bit unsigned integers and carry variables for intermediate calculations.
    - Extract individual elements from `arg1` and `arg2` for multiplication.
    - Perform a series of multiplications using [`fiat_secp256k1_montgomery_mulx_u64`](<#fiat_secp256k1_montgomery_mulx_u64>) to compute partial products of the elements of `arg1` and `arg2`.
    - Use [`fiat_secp256k1_montgomery_addcarryx_u64`](<#fiat_secp256k1_montgomery_addcarryx_u64>) to accumulate the results of the multiplications, handling carry bits appropriately.
    - Multiply the intermediate result by a constant using [`fiat_secp256k1_montgomery_mulx_u64`](<#fiat_secp256k1_montgomery_mulx_u64>) to prepare for reduction modulo the prime modulus.
    - Perform additional multiplications and additions to complete the Montgomery reduction process.
    - Use [`fiat_secp256k1_montgomery_subborrowx_u64`](<#fiat_secp256k1_montgomery_subborrowx_u64>) to subtract the modulus if necessary, ensuring the result is within the correct range.
    - Use [`fiat_secp256k1_montgomery_cmovznz_u64`](<#fiat_secp256k1_montgomery_cmovznz_u64>) to conditionally select the correct result based on the final carry bit.
    - Store the final result in `out1`.
- **Output**: The function does not return a value but stores the result in the `out1` parameter, which is a field element in the Montgomery domain.
- **Functions Called**:
    - [`fiat_secp256k1_montgomery_mulx_u64`](<#fiat_secp256k1_montgomery_mulx_u64>)
    - [`fiat_secp256k1_montgomery_addcarryx_u64`](<#fiat_secp256k1_montgomery_addcarryx_u64>)
    - [`fiat_secp256k1_montgomery_subborrowx_u64`](<#fiat_secp256k1_montgomery_subborrowx_u64>)
    - [`fiat_secp256k1_montgomery_cmovznz_u64`](<#fiat_secp256k1_montgomery_cmovznz_u64>)


---
### fiat\_secp256k1\_montgomery\_square<!-- {{#callable:fiat_secp256k1_montgomery_square}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_64.c#L522>)

Squares a field element in the Montgomery domain for the secp256k1 curve.
- **Inputs**:
    - `out1`: A pointer to a `fiat_secp256k1_montgomery_montgomery_domain_field_element` where the result will be stored.
    - `arg1`: A constant pointer to a `fiat_secp256k1_montgomery_montgomery_domain_field_element` representing the input field element to be squared.
- **Logic and Control Flow**:
    - Initialize temporary variables for intermediate calculations.
    - Extract individual components of the input field element `arg1`.
    - Perform a series of multiplications using [`fiat_secp256k1_montgomery_mulx_u64`](<#fiat_secp256k1_montgomery_mulx_u64>) to compute the square of the input element.
    - Use [`fiat_secp256k1_montgomery_addcarryx_u64`](<#fiat_secp256k1_montgomery_addcarryx_u64>) to handle carry propagation during addition operations.
    - Compute the Montgomery reduction using a constant `UINT64_C(0xd838091dd2253531)` and perform further multiplications and additions.
    - Perform conditional subtraction using [`fiat_secp256k1_montgomery_subborrowx_u64`](<#fiat_secp256k1_montgomery_subborrowx_u64>) to ensure the result is within the field's modulus.
    - Use [`fiat_secp256k1_montgomery_cmovznz_u64`](<#fiat_secp256k1_montgomery_cmovznz_u64>) to conditionally select the correct result based on the subtraction outcome.
    - Store the final result in the output parameter `out1`.
- **Output**: The function does not return a value but stores the squared result in the `out1` parameter.
- **Functions Called**:
    - [`fiat_secp256k1_montgomery_mulx_u64`](<#fiat_secp256k1_montgomery_mulx_u64>)
    - [`fiat_secp256k1_montgomery_addcarryx_u64`](<#fiat_secp256k1_montgomery_addcarryx_u64>)
    - [`fiat_secp256k1_montgomery_subborrowx_u64`](<#fiat_secp256k1_montgomery_subborrowx_u64>)
    - [`fiat_secp256k1_montgomery_cmovznz_u64`](<#fiat_secp256k1_montgomery_cmovznz_u64>)


---
### fiat\_secp256k1\_montgomery\_add<!-- {{#callable:fiat_secp256k1_montgomery_add}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_64.c#L878>)

Adds two field elements in the Montgomery domain and reduces the result modulo the prime modulus.
- **Inputs**:
    - `out1`: A pointer to the output field element in the Montgomery domain.
    - `arg1`: A pointer to the first input field element in the Montgomery domain.
    - `arg2`: A pointer to the second input field element in the Montgomery domain.
- **Logic and Control Flow**:
    - Initialize temporary variables for intermediate results and carry flags.
    - Use [`fiat_secp256k1_montgomery_addcarryx_u64`](<#fiat_secp256k1_montgomery_addcarryx_u64>) to add corresponding elements of `arg1` and `arg2` with carry propagation.
    - Use [`fiat_secp256k1_montgomery_subborrowx_u64`](<#fiat_secp256k1_montgomery_subborrowx_u64>) to subtract the prime modulus from the addition result to check if reduction is needed.
    - Use [`fiat_secp256k1_montgomery_cmovznz_u64`](<#fiat_secp256k1_montgomery_cmovznz_u64>) to conditionally select the reduced or non-reduced result based on the borrow flag.
    - Store the final result in `out1`.
- **Output**: The function does not return a value but stores the result in the `out1` array.
- **Functions Called**:
    - [`fiat_secp256k1_montgomery_addcarryx_u64`](<#fiat_secp256k1_montgomery_addcarryx_u64>)
    - [`fiat_secp256k1_montgomery_subborrowx_u64`](<#fiat_secp256k1_montgomery_subborrowx_u64>)
    - [`fiat_secp256k1_montgomery_cmovznz_u64`](<#fiat_secp256k1_montgomery_cmovznz_u64>)


---
### fiat\_secp256k1\_montgomery\_sub<!-- {{#callable:fiat_secp256k1_montgomery_sub}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_64.c#L931>)

Subtracts two field elements in the Montgomery domain and ensures the result is within the field's bounds.
- **Inputs**:
    - ``out1``: A pointer to a `fiat_secp256k1_montgomery_montgomery_domain_field_element` where the result will be stored.
    - ``arg1``: A constant pointer to a `fiat_secp256k1_montgomery_montgomery_domain_field_element` representing the minuend.
    - ``arg2``: A constant pointer to a `fiat_secp256k1_montgomery_montgomery_domain_field_element` representing the subtrahend.
- **Logic and Control Flow**:
    - Initialize temporary variables for intermediate results and borrow flags.
    - Perform subtraction with borrow for each of the four 64-bit limbs of the input field elements `arg1` and `arg2`, storing results in temporary variables.
    - Check if the final borrow flag indicates a negative result, and if so, conditionally add the modulus to the result to ensure it is non-negative.
    - Store the final result in the output field element `out1`.
- **Output**: The result is stored in the `out1` field element, representing the difference of `arg1` and `arg2` in the Montgomery domain.
- **Functions Called**:
    - [`fiat_secp256k1_montgomery_subborrowx_u64`](<#fiat_secp256k1_montgomery_subborrowx_u64>)
    - [`fiat_secp256k1_montgomery_cmovznz_u64`](<#fiat_secp256k1_montgomery_cmovznz_u64>)
    - [`fiat_secp256k1_montgomery_addcarryx_u64`](<#fiat_secp256k1_montgomery_addcarryx_u64>)


---
### fiat\_secp256k1\_montgomery\_opp<!-- {{#callable:fiat_secp256k1_montgomery_opp}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_64.c#L974>)

Negates a field element in the Montgomery domain for the secp256k1 curve.
- **Inputs**:
    - `out1`: A pointer to an array of four `uint64_t` elements where the result will be stored.
    - `arg1`: A constant pointer to an array of four `uint64_t` elements representing the field element to negate.
- **Logic and Control Flow**:
    - Initialize temporary variables for intermediate calculations.
    - Perform subtraction with borrow for each element of `arg1` from zero, storing results in temporary variables.
    - Use a conditional move to handle the case where the subtraction results in a borrow, setting a mask to all ones if a borrow occurs.
    - Add the mask to the results of the subtraction, ensuring the result is non-negative and within the field's range.
    - Store the final results in the `out1` array.
- **Output**: The negated field element is stored in the `out1` array.
- **Functions Called**:
    - [`fiat_secp256k1_montgomery_subborrowx_u64`](<#fiat_secp256k1_montgomery_subborrowx_u64>)
    - [`fiat_secp256k1_montgomery_cmovznz_u64`](<#fiat_secp256k1_montgomery_cmovznz_u64>)
    - [`fiat_secp256k1_montgomery_addcarryx_u64`](<#fiat_secp256k1_montgomery_addcarryx_u64>)


---
### fiat\_secp256k1\_montgomery\_from\_montgomery<!-- {{#callable:fiat_secp256k1_montgomery_from_montgomery}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_64.c#L1017>)

Converts a field element from the Montgomery domain to the standard representation.
- **Inputs**:
    - `out1`: A pointer to an array of four `uint64_t` where the result will be stored.
    - `arg1`: A constant pointer to an array of four `uint64_t` representing the field element in the Montgomery domain.
- **Logic and Control Flow**:
    - Initialize several `uint64_t` and `fiat_secp256k1_montgomery_uint1` variables for intermediate calculations.
    - Extract the first element of `arg1` and perform a series of multiplications and additions using the [`fiat_secp256k1_montgomery_mulx_u64`](<#fiat_secp256k1_montgomery_mulx_u64>) and [`fiat_secp256k1_montgomery_addcarryx_u64`](<#fiat_secp256k1_montgomery_addcarryx_u64>) functions to compute intermediate values.
    - Repeat the process for each element of `arg1`, updating the intermediate values with each iteration.
    - Perform a series of subtractions using [`fiat_secp256k1_montgomery_subborrowx_u64`](<#fiat_secp256k1_montgomery_subborrowx_u64>) to ensure the result is within the field's modulus.
    - Use [`fiat_secp256k1_montgomery_cmovznz_u64`](<#fiat_secp256k1_montgomery_cmovznz_u64>) to conditionally move values based on the result of the subtraction, ensuring the final result is non-negative.
    - Store the final computed values in the `out1` array.
- **Output**: The function outputs a field element in the standard representation, stored in the `out1` array.
- **Functions Called**:
    - [`fiat_secp256k1_montgomery_mulx_u64`](<#fiat_secp256k1_montgomery_mulx_u64>)
    - [`fiat_secp256k1_montgomery_addcarryx_u64`](<#fiat_secp256k1_montgomery_addcarryx_u64>)
    - [`fiat_secp256k1_montgomery_subborrowx_u64`](<#fiat_secp256k1_montgomery_subborrowx_u64>)
    - [`fiat_secp256k1_montgomery_cmovznz_u64`](<#fiat_secp256k1_montgomery_cmovznz_u64>)


---
### fiat\_secp256k1\_montgomery\_to\_montgomery<!-- {{#callable:fiat_secp256k1_montgomery_to_montgomery}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_64.c#L1251>)

Converts a field element from the non-Montgomery domain to the Montgomery domain using the secp256k1 curve parameters.
- **Inputs**:
    - `out1`: A pointer to a `fiat_secp256k1_montgomery_montgomery_domain_field_element` where the result will be stored.
    - `arg1`: A constant pointer to a `fiat_secp256k1_montgomery_non_montgomery_domain_field_element` representing the input field element in the non-Montgomery domain.
- **Logic and Control Flow**:
    - Initialize variables to hold intermediate results and carry flags.
    - Multiply the first element of `arg1` by a constant to start the conversion process.
    - Perform a series of multiplications and additions to compute the Montgomery representation, using the secp256k1 curve's modulus and constants.
    - Use [`fiat_secp256k1_montgomery_addcarryx_u64`](<#fiat_secp256k1_montgomery_addcarryx_u64>) to handle additions with carry and [`fiat_secp256k1_montgomery_mulx_u64`](<#fiat_secp256k1_montgomery_mulx_u64>) for multiplications.
    - Repeat the process for each element of `arg1`, accumulating results and handling carries.
    - Perform a final subtraction to ensure the result is within the field's modulus.
    - Use conditional moves to select the correct result based on the final carry flag.
    - Store the result in `out1`.
- **Output**: The function does not return a value but stores the converted Montgomery domain field element in `out1`.
- **Functions Called**:
    - [`fiat_secp256k1_montgomery_mulx_u64`](<#fiat_secp256k1_montgomery_mulx_u64>)
    - [`fiat_secp256k1_montgomery_addcarryx_u64`](<#fiat_secp256k1_montgomery_addcarryx_u64>)
    - [`fiat_secp256k1_montgomery_subborrowx_u64`](<#fiat_secp256k1_montgomery_subborrowx_u64>)
    - [`fiat_secp256k1_montgomery_cmovznz_u64`](<#fiat_secp256k1_montgomery_cmovznz_u64>)


---
### fiat\_secp256k1\_montgomery\_nonzero<!-- {{#callable:fiat_secp256k1_montgomery_nonzero}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_64.c#L1518>)

Outputs a single non-zero word if the input array is non-zero, otherwise outputs zero.
- **Inputs**:
    - `out1`: A pointer to a `uint64_t` where the result will be stored.
    - `arg1`: An array of four `uint64_t` values representing the input to check for non-zero.
- **Logic and Control Flow**:
    - Compute the bitwise OR of all elements in `arg1` to determine if any element is non-zero.
    - Assign the result of the OR operation to the location pointed to by `out1`.
- **Output**: A single `uint64_t` value stored at the location pointed to by `out1`, which is non-zero if any element of `arg1` is non-zero, otherwise zero.


---
### fiat\_secp256k1\_montgomery\_selectznz<!-- {{#callable:fiat_secp256k1_montgomery_selectznz}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_64.c#L1537>)

Selects one of two 256-bit numbers based on a condition.
- **Inputs**:
    - `out1`: An array of four 64-bit unsigned integers where the result is stored.
    - `arg1`: A single-bit unsigned integer that acts as the condition for selection.
    - `arg2`: An array of four 64-bit unsigned integers representing the first number.
    - `arg3`: An array of four 64-bit unsigned integers representing the second number.
- **Logic and Control Flow**:
    - Calls [`fiat_secp256k1_montgomery_cmovznz_u64`](<#fiat_secp256k1_montgomery_cmovznz_u64>) four times, once for each 64-bit segment of the input arrays `arg2` and `arg3`.
    - Each call to [`fiat_secp256k1_montgomery_cmovznz_u64`](<#fiat_secp256k1_montgomery_cmovznz_u64>) selects between the corresponding elements of `arg2` and `arg3` based on `arg1`.
    - Stores the selected values in the corresponding positions of the `out1` array.
- **Output**: The `out1` array contains the selected 256-bit number, either `arg2` or `arg3`, based on the value of `arg1`.
- **Functions Called**:
    - [`fiat_secp256k1_montgomery_cmovznz_u64`](<#fiat_secp256k1_montgomery_cmovznz_u64>)


---
### fiat\_secp256k1\_montgomery\_to\_bytes<!-- {{#callable:fiat_secp256k1_montgomery_to_bytes}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_64.c#L1565>)

Converts a 256-bit integer from a 4-element array of 64-bit words to a 32-byte array in little-endian order.
- **Inputs**:
    - `out1`: A 32-byte array where the function will store the resulting bytes.
    - `arg1`: A 4-element array of 64-bit unsigned integers representing the 256-bit integer to convert.
- **Logic and Control Flow**:
    - Extracts each 64-bit word from `arg1` and processes it individually.
    - For each word, extracts each byte by masking and shifting operations.
    - Stores each extracted byte into the `out1` array in little-endian order.
- **Output**: The function does not return a value but populates the `out1` array with the byte representation of the input integer.


---
### fiat\_secp256k1\_montgomery\_from\_bytes<!-- {{#callable:fiat_secp256k1_montgomery_from_bytes}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_64.c#L1734>)

Converts a 32-byte array into a 4-element array of 64-bit unsigned integers, interpreting the input as a little-endian representation of a large integer.
- **Inputs**:
    - `out1`: A 4-element array of 64-bit unsigned integers where the result will be stored.
    - `arg1`: A 32-byte array representing a large integer in little-endian order.
- **Logic and Control Flow**:
    - Initialize 60 local variables to store intermediate results.
    - Extract each byte from `arg1` and shift it to its correct position to form 64-bit integers.
    - Combine the shifted bytes to form four 64-bit integers, each representing a segment of the large integer.
    - Store the resulting 64-bit integers in the `out1` array.
- **Output**: A 4-element array of 64-bit unsigned integers representing the input byte array as a large integer.


---
### fiat\_secp256k1\_montgomery\_set\_one<!-- {{#callable:fiat_secp256k1_montgomery_set_one}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_64.c#L1869>)

Sets the output field element to the representation of one in the Montgomery domain for the secp256k1 curve.
- **Inputs**:
    - `out1`: A `fiat_secp256k1_montgomery_montgomery_domain_field_element` array of size 4 that will hold the output value.
- **Logic and Control Flow**:
    - Assigns the constant `0x1000003d1` to the first element of `out1`.
    - Sets the remaining three elements of `out1` to zero.
- **Output**: The function does not return a value but modifies the `out1` array to represent the number one in the Montgomery domain.


---
### fiat\_secp256k1\_montgomery\_msat<!-- {{#callable:fiat_secp256k1_montgomery_msat}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_64.c#L1886>)

Returns the saturated representation of the prime modulus for the secp256k1 curve in the Montgomery domain.
- **Inputs**:
    - `out1`: An array of 5 `uint64_t` elements where the function will store the saturated representation of the prime modulus.
- **Logic and Control Flow**:
    - Assigns the constant value `0xfffffffefffffc2f` to `out1[0]`.
    - Assigns the constant value `0xffffffffffffffff` to `out1[1]`, `out1[2]`, and `out1[3]`.
    - Assigns the value `0x0` to `out1[4]`.
- **Output**: The function does not return a value but populates the `out1` array with the saturated representation of the prime modulus.


---
### fiat\_secp256k1\_montgomery\_divstep<!-- {{#callable:fiat_secp256k1_montgomery_divstep}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_64.c#L1924>)

Computes a divstep operation for the secp256k1 curve in the Montgomery domain.
- **Inputs**:
    - `out1`: Pointer to a `uint64_t` where the function stores the result of the divstep operation.
    - `out2`: Array of 5 `uint64_t` where the function stores the updated value of `arg2` or `arg3` based on conditions.
    - `out3`: Array of 5 `uint64_t` where the function stores the result of a computation involving `arg2` and `arg3`.
    - `out4`: Array of 4 `uint64_t` where the function stores the updated value of `arg4` or `arg5` based on conditions.
    - `out5`: Array of 4 `uint64_t` where the function stores the result of a computation involving `arg4` and `arg5`.
    - `arg1`: A `uint64_t` input value used in the divstep computation.
    - `arg2`: Array of 5 `uint64_t` representing one of the inputs for the divstep operation.
    - `arg3`: Array of 5 `uint64_t` representing another input for the divstep operation.
    - `arg4`: Array of 4 `uint64_t` representing one of the inputs for the divstep operation.
    - `arg5`: Array of 4 `uint64_t` representing another input for the divstep operation.
- **Logic and Control Flow**:
    - Calculate `x1` as the bitwise negation of `arg1` plus 1, and determine `x3` based on the least significant bit of `arg3[0]` and the sign of `x1` shifted right by 63 bits.
    - Use `x3` to conditionally move values between `arg1` and `x4`, `arg2` and `arg3`, and `arg4` and `arg5` into `x6` to `x11`, `x22` to `x26`, and `x27` to `x30` respectively.
    - Compute the negation of `arg2` into `x12` to `x20` and use `x3` to conditionally move values between `arg3` and these negated values into `x22` to `x26`.
    - Double the values in `x27` to `x30` and perform modular subtraction with the prime modulus, storing results in `x39` to `x47`.
    - Compute the negation of `arg4` into `x53` to `x59` and adjust with the prime modulus if necessary, storing results in `x62` to `x68`.
    - Use `x3` to conditionally move values between `arg5` and `x62` to `x68` into `x70` to `x73`.
    - Determine if `x22` is odd and use this to conditionally move zero or `x7` to `x11` into `x75` to `x79`, then add these to `x22` to `x26` to get `x80` to `x88`.
    - Add `x70` to `x90` to `x93` to get `x94` to `x100`, then perform modular subtraction with the prime modulus, storing results in `x102` to `x110`.
    - Compute the new value of `out1` as `x6` plus 1.
    - Shift `x80` to `x88` right by 1 bit to get `x114` to `x118`.
    - Use `x48` and `x111` to conditionally move values between `x39` to `x47` and `x31` to `x37`, and between `x102` to `x110` and `x94` to `x100`, storing results in `out4` and `out5`.
    - Store `x7` to `x11` in `out2` and `x114` to `x118` in `out3`.
- **Output**: The function outputs the results of the divstep operation in `out1`, `out2`, `out3`, `out4`, and `out5`.
- **Functions Called**:
    - [`fiat_secp256k1_montgomery_addcarryx_u64`](<#fiat_secp256k1_montgomery_addcarryx_u64>)
    - [`fiat_secp256k1_montgomery_cmovznz_u64`](<#fiat_secp256k1_montgomery_cmovznz_u64>)
    - [`fiat_secp256k1_montgomery_subborrowx_u64`](<#fiat_secp256k1_montgomery_subborrowx_u64>)


---
### fiat\_secp256k1\_montgomery\_divstep\_precomp<!-- {{#callable:fiat_secp256k1_montgomery_divstep_precomp}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_64.c#L2169>)

Precomputes a constant value used for Bernstein-Yang inversion in Montgomery form.
- **Inputs**: None
- **Logic and Control Flow**:
    - Assigns the precomputed constant values to the elements of the `out1` array.
    - The values are hardcoded as four 64-bit unsigned integers.
- **Output**: An array `out1` of four 64-bit unsigned integers containing the precomputed values.



---
Made with ❤️ by [Driver](https://www.driver.ai/)