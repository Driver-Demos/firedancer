<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Autogenerated C code for arithmetic operations on Curve25519 field elements using 32-bit words.

# Purpose
The code is a C implementation of arithmetic operations for the Curve25519 elliptic curve, specifically using the "unsaturated Solinas" method. It provides functions to perform arithmetic operations such as addition, subtraction, multiplication, and squaring on field elements, which are represented as arrays of integers. The field elements are defined with both loose and tight bounds, allowing for different levels of precision and optimization in calculations. The code also includes functions for conditional moves, serialization to and from bytes, and a specific scalar multiplication by the constant 121666, which is used in the Diffie-Hellman key exchange process.

The module is designed to be used in cryptographic applications, particularly those involving elliptic curve cryptography (ECC) on Curve25519. It defines a set of static inline functions that perform operations on field elements, ensuring that the results are reduced modulo the prime `2^255 - 19`, which defines the field over which Curve25519 is defined. The code is intended to be included in other C programs or libraries, providing a low-level API for cryptographic operations. The use of inline functions and conditional compilation directives ensures compatibility with different compilers and systems, while maintaining performance through direct manipulation of field elements.
# Imports and Dependencies

---
- `stdint.h`


# Functions

---
### fiat\_25519\_value\_barrier\_u32<!-- {{#callable:fiat_25519_value_barrier_u32}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519_32.c#L37>)

Applies a value barrier to a 32-bit unsigned integer to prevent certain compiler optimizations.
- **Inputs**:
    - `a`: A 32-bit unsigned integer to which the value barrier is applied.
- **Logic and Control Flow**:
    - Uses inline assembly to apply a value barrier to the input `a`, preventing the compiler from optimizing away certain operations involving `a`.
    - The assembly code does not modify `a` but ensures that `a` is treated as a volatile variable, which can prevent reordering or elimination of operations involving `a`.
    - Returns the input `a` after applying the value barrier.
- **Output**: Returns the same 32-bit unsigned integer `a` after applying the value barrier.


---
### fiat\_25519\_addcarryx\_u26<!-- {{#callable:fiat_25519_addcarryx_u26}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519_32.c#L61>)

Performs addition with carry for three 26-bit integers and outputs the result and carry.
- **Inputs**:
    - `out1`: Pointer to a `uint32_t` where the result of the addition will be stored.
    - `out2`: Pointer to a `fiat_25519_uint1` where the carry from the addition will be stored.
    - `arg1`: A `fiat_25519_uint1` representing the first operand, which is a carry bit (0 or 1).
    - `arg2`: A `uint32_t` representing the second operand, a 26-bit integer.
    - `arg3`: A `uint32_t` representing the third operand, a 26-bit integer.
- **Logic and Control Flow**:
    - Calculate the sum of `arg1`, `arg2`, and `arg3` and store it in `x1`.
    - Mask `x1` with `0x3ffffff` to get the lower 26 bits and store it in `x2`.
    - Shift `x1` right by 26 bits to get the carry and store it in `x3`.
    - Store `x2` in the location pointed to by `out1`.
    - Store `x3` in the location pointed to by `out2`.
- **Output**: The function outputs the result of the addition modulo `2^26` in `out1` and the carry bit in `out2`.


---
### fiat\_25519\_subborrowx\_u26<!-- {{#callable:fiat_25519_subborrowx_u26}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519_32.c#L87>)

Performs subtraction with borrow on two 26-bit integers and a borrow flag, producing a result and a new borrow flag.
- **Inputs**:
    - `out1`: Pointer to a `uint32_t` where the result of the subtraction will be stored.
    - `out2`: Pointer to a `fiat_25519_uint1` where the new borrow flag will be stored.
    - `arg1`: A `fiat_25519_uint1` representing the initial borrow flag.
    - `arg2`: A `uint32_t` representing the first operand of the subtraction.
    - `arg3`: A `uint32_t` representing the second operand of the subtraction.
- **Logic and Control Flow**:
    - Calculate `x1` as the result of `arg2 - arg1 - arg3` cast to `int32_t` to handle potential negative values.
    - Shift `x1` right by 26 bits to determine the borrow flag `x2`.
    - Mask `x1` with `0x3ffffff` to obtain the 26-bit result `x3`.
    - Store `x3` in the location pointed to by `out1`.
    - Store the negation of `x2` in the location pointed to by `out2`.
- **Output**: Stores the 26-bit result of the subtraction in `out1` and the new borrow flag in `out2`.


---
### fiat\_25519\_addcarryx\_u25<!-- {{#callable:fiat_25519_addcarryx_u25}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519_32.c#L113>)

Performs addition with carry for three input values, reducing the result modulo 2^25 and providing the carry as a separate output.
- **Inputs**:
    - `out1`: Pointer to a `uint32_t` where the result of the addition modulo 2^25 will be stored.
    - `out2`: Pointer to a `fiat_25519_uint1` where the carry resulting from the addition will be stored.
    - `arg1`: A `fiat_25519_uint1` representing the first addend, which is a single-bit value (0 or 1).
    - `arg2`: A `uint32_t` representing the second addend, which can be up to 25 bits wide.
    - `arg3`: A `uint32_t` representing the third addend, which can be up to 25 bits wide.
- **Logic and Control Flow**:
    - Calculate the sum of `arg1`, `arg2`, and `arg3` and store it in `x1`.
    - Compute `x2` as `x1` bitwise AND with `0x1ffffff` to get the result modulo 2^25.
    - Compute `x3` as `x1` right-shifted by 25 bits to get the carry.
    - Store `x2` in the location pointed to by `out1`.
    - Store `x3` in the location pointed to by `out2`.
- **Output**: The function outputs the result of the addition modulo 2^25 in `out1` and the carry in `out2`.


---
### fiat\_25519\_subborrowx\_u25<!-- {{#callable:fiat_25519_subborrowx_u25}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519_32.c#L139>)

Performs subtraction with borrow on two 25-bit integers and a borrow flag, producing a result and a new borrow flag.
- **Inputs**:
    - `out1`: Pointer to a `uint32_t` where the result of the subtraction will be stored.
    - `out2`: Pointer to a `fiat_25519_uint1` where the new borrow flag will be stored.
    - `arg1`: A `fiat_25519_uint1` representing the initial borrow flag.
    - `arg2`: A `uint32_t` representing the first operand.
    - `arg3`: A `uint32_t` representing the second operand.
- **Logic and Control Flow**:
    - Calculate `x1` as the difference between `arg2`, `arg1`, and `arg3` cast to `int32_t`.
    - Shift `x1` right by 25 bits to obtain `x2`, the new borrow flag, cast to `fiat_25519_int1`.
    - Mask `x1` with `0x1ffffff` to obtain `x3`, the result of the subtraction, cast to `uint32_t`.
    - Store `x3` in the location pointed to by `out1`.
    - Store the negation of `x2` in the location pointed to by `out2`, cast to `fiat_25519_uint1`.
- **Output**: The function outputs the result of the subtraction in `out1` and the new borrow flag in `out2`.


---
### fiat\_25519\_cmovznz\_u32<!-- {{#callable:fiat_25519_cmovznz_u32}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519_32.c#L163>)

Selects between two 32-bit unsigned integers based on a condition.
- **Inputs**:
    - `out1`: Pointer to a `uint32_t` where the result will be stored.
    - `arg1`: A `fiat_25519_uint1` condition (0 or 1) to determine which value to select.
    - `arg2`: A `uint32_t` value to select if `arg1` is 0.
    - `arg3`: A `uint32_t` value to select if `arg1` is 1.
- **Logic and Control Flow**:
    - Convert `arg1` to a boolean value `x1` by negating it twice.
    - Calculate `x2` as the bitwise AND of the negation of `x1` and `0xffffffff`.
    - Use [`fiat_25519_value_barrier_u32`](<#fiat_25519_value_barrier_u32>) to apply a value barrier to `x2` and `~x2`.
    - Calculate `x3` as the bitwise OR of the AND of `x2` and `arg3`, and the AND of `~x2` and `arg2`.
    - Store the result `x3` in the location pointed to by `out1`.
- **Output**: Stores the selected `uint32_t` value in the location pointed to by `out1`.
- **Functions Called**:
    - [`fiat_25519_value_barrier_u32`](<#fiat_25519_value_barrier_u32>)


---
### fiat\_25519\_carry\_mul<!-- {{#callable:fiat_25519_carry_mul}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519_32.c#L180>)

Multiplies two field elements and reduces the result modulo `2^255 - 19`.
- **Inputs**:
    - `out1`: A `fiat_25519_tight_field_element` array to store the result.
    - `arg1`: A `fiat_25519_loose_field_element` array representing the first operand.
    - `arg2`: A `fiat_25519_loose_field_element` array representing the second operand.
- **Logic and Control Flow**:
    - Initialize multiple `uint64_t` and `uint32_t` variables to store intermediate results.
    - Perform multiplication of elements from `arg1` and `arg2`, applying specific scaling factors (e.g., `0x26`, `0x13`) to certain terms.
    - Accumulate the results of these multiplications into several intermediate sums.
    - Perform a series of right shifts and bitwise operations to reduce the intermediate sums, ensuring they fit within the bounds of the field element representation.
    - Store the final reduced results into the `out1` array.
- **Output**: The result is stored in the `out1` array, representing the reduced product of `arg1` and `arg2`.


---
### fiat\_25519\_carry\_square<!-- {{#callable:fiat_25519_carry_square}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519_32.c#L494>)

Squares a field element and reduces the result modulo `2^255 - 19`.
- **Inputs**:
    - `out1`: A `fiat_25519_tight_field_element` array of size 10 to store the result.
    - `arg1`: A `fiat_25519_loose_field_element` array of size 10 representing the input field element to be squared.
- **Logic and Control Flow**:
    - Calculate intermediate values by multiplying elements of `arg1` with constants and other elements, using both 32-bit and 64-bit integers.
    - Perform a series of additions and shifts to accumulate the results of these multiplications into larger sums.
    - Apply bitwise operations to reduce these sums modulo `2^255 - 19`, ensuring each element of the result fits within specified bounds.
    - Store the reduced results into the `out1` array.
- **Output**: The `out1` array contains the reduced result of the squared field element.


---
### fiat\_25519\_carry<!-- {{#callable:fiat_25519_carry}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519_32.c#L754>)

Reduces a loose field element to a tight field element by performing a series of carry operations.
- **Inputs**:
    - `out1`: A `fiat_25519_tight_field_element` array where the result is stored.
    - `arg1`: A `fiat_25519_loose_field_element` array that represents the input field element to be reduced.
- **Logic and Control Flow**:
    - Initialize variables `x1` to `x22` to store intermediate results.
    - Assign `x1` to the first element of `arg1`.
    - Perform a series of right shifts and additions to propagate carries through the elements of `arg1`.
    - Calculate `x11` by adding the carry from `x10` to the first element of `arg1` and multiplying by 19.
    - Store the results of the carry operations in `out1` by assigning each element of `out1` to the corresponding reduced value.
- **Output**: A `fiat_25519_tight_field_element` array `out1` containing the reduced field element.


---
### fiat\_25519\_add<!-- {{#callable:fiat_25519_add}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519_32.c#L818>)

Adds two `fiat_25519_tight_field_element` arrays element-wise and stores the result in a `fiat_25519_loose_field_element` array.
- **Inputs**:
    - `out1`: A `fiat_25519_loose_field_element` array where the result of the addition is stored.
    - `arg1`: A `fiat_25519_tight_field_element` array representing the first operand.
    - `arg2`: A `fiat_25519_tight_field_element` array representing the second operand.
- **Logic and Control Flow**:
    - Initialize ten `uint32_t` variables `x1` to `x10` to store intermediate results.
    - For each index from 0 to 9, add the corresponding elements of `arg1` and `arg2`, and store the result in `x1` to `x10`.
    - Assign the values of `x1` to `x10` to the corresponding indices of `out1`.
- **Output**: The function does not return a value but modifies the `out1` array to contain the sum of `arg1` and `arg2`.


---
### fiat\_25519\_sub<!-- {{#callable:fiat_25519_sub}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519_32.c#L858>)

Subtracts two field elements with specific bounds and stores the result in a loose field element.
- **Inputs**:
    - `out1`: A `fiat_25519_loose_field_element` array where the result of the subtraction is stored.
    - `arg1`: A `fiat_25519_tight_field_element` array representing the minuend.
    - `arg2`: A `fiat_25519_tight_field_element` array representing the subtrahend.
- **Logic and Control Flow**:
    - Initialize ten `uint32_t` variables `x1` to `x10` to store intermediate subtraction results.
    - For each element index `i` from 0 to 9, compute `x[i]` as the sum of a constant and `arg1[i]`, minus `arg2[i]`.
    - Store the results `x1` to `x10` in the `out1` array.
- **Output**: The function does not return a value but modifies the `out1` array to contain the result of the subtraction.


---
### fiat\_25519\_opp<!-- {{#callable:fiat_25519_opp}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519_32.c#L898>)

Negates a field element by subtracting each component from a constant value.
- **Inputs**:
    - `out1`: A `fiat_25519_loose_field_element` array where the result is stored.
    - `arg1`: A `fiat_25519_tight_field_element` array representing the field element to negate.
- **Logic and Control Flow**:
    - Subtracts each element of `arg1` from a predefined constant: `0x7ffffda` for the first element and `0x3fffffe` or `0x7fffffe` for subsequent elements, alternating between them.
    - Stores the result of each subtraction in the corresponding index of `out1`.
- **Output**: The negated field element is stored in `out1`.


---
### fiat\_25519\_selectznz<!-- {{#callable:fiat_25519_selectznz}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519_32.c#L944>)

Selects elements from two arrays based on a condition and stores the result in an output array.
- **Inputs**:
    - `out1`: An array of 10 `uint32_t` elements where the result will be stored.
    - `arg1`: A `fiat_25519_uint1` value (0 or 1) that determines which array to select elements from.
    - `arg2`: An array of 10 `uint32_t` elements, one of the two possible sources for the output.
    - `arg3`: An array of 10 `uint32_t` elements, the other possible source for the output.
- **Logic and Control Flow**:
    - For each index from 0 to 9, call [`fiat_25519_cmovznz_u32`](<#fiat_25519_cmovznz_u32>) to select between `arg2` and `arg3` based on `arg1`.
    - Store the result of each selection in the corresponding index of `out1`.
- **Output**: The `out1` array is filled with elements from either `arg2` or `arg3` based on the value of `arg1`.
- **Functions Called**:
    - [`fiat_25519_cmovznz_u32`](<#fiat_25519_cmovznz_u32>)


---
### fiat\_25519\_to\_bytes<!-- {{#callable:fiat_25519_to_bytes}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519_32.c#L986>)

Serializes a `fiat_25519_tight_field_element` into a 32-byte array in little-endian order.
- **Inputs**:
    - `out1`: A 32-byte array to store the serialized output.
    - `arg1`: A `fiat_25519_tight_field_element` representing the field element to serialize.
- **Logic and Control Flow**:
    - Subtracts each element of `arg1` from a constant, using [`fiat_25519_subborrowx_u26`](<#fiat_25519_subborrowx_u26>) and [`fiat_25519_subborrowx_u25`](<#fiat_25519_subborrowx_u25>), to ensure the result is non-negative.
    - Uses [`fiat_25519_cmovznz_u32`](<#fiat_25519_cmovznz_u32>) to conditionally select between zero and a mask based on the borrow flag.
    - Adds the mask to the result using [`fiat_25519_addcarryx_u26`](<#fiat_25519_addcarryx_u26>) and [`fiat_25519_addcarryx_u25`](<#fiat_25519_addcarryx_u25>) to ensure the result fits within the field bounds.
    - Shifts and combines the results to form a 256-bit integer.
    - Extracts each byte from the 256-bit integer and stores it in `out1` in little-endian order.
- **Output**: A 32-byte array `out1` containing the serialized field element.
- **Functions Called**:
    - [`fiat_25519_subborrowx_u26`](<#fiat_25519_subborrowx_u26>)
    - [`fiat_25519_subborrowx_u25`](<#fiat_25519_subborrowx_u25>)
    - [`fiat_25519_cmovznz_u32`](<#fiat_25519_cmovznz_u32>)
    - [`fiat_25519_addcarryx_u26`](<#fiat_25519_addcarryx_u26>)
    - [`fiat_25519_addcarryx_u25`](<#fiat_25519_addcarryx_u25>)


---
### fiat\_25519\_from\_bytes<!-- {{#callable:fiat_25519_from_bytes}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519_32.c#L1244>)

Deserializes a 32-byte array into a 10-element field element array with specific bit shifts and masks.
- **Inputs**:
    - `out1`: A `fiat_25519_tight_field_element` array where the deserialized field element will be stored.
    - `arg1`: A 32-byte array of type `uint8_t` representing the serialized field element in little-endian order.
- **Logic and Control Flow**:
    - Extracts and shifts bits from `arg1` to form 32-bit integers `x1` to `x78` with specific bit positions.
    - Combines these integers using addition and bitwise operations to form the field element components.
    - Applies bitwise AND with `0x3ffffff` or `0x1ffffff` to ensure each component fits within its bounds.
    - Stores the resulting components into the `out1` array.
- **Output**: A 10-element array of type `fiat_25519_tight_field_element` representing the deserialized field element.


---
### fiat\_25519\_relax<!-- {{#callable:fiat_25519_relax}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519_32.c#L1420>)

Copies elements from a tight field element to a loose field element without modification.
- **Inputs**:
    - `out1`: A `fiat_25519_loose_field_element` array where the function will store the copied elements.
    - `arg1`: A `fiat_25519_tight_field_element` array from which the function will copy elements.
- **Logic and Control Flow**:
    - Assigns each element of `arg1` to the corresponding element in `out1`.
- **Output**: The `out1` array contains the same elements as `arg1`, effectively converting a tight field element to a loose field element.


---
### fiat\_25519\_carry\_scmul\_121666<!-- {{#callable:fiat_25519_carry_scmul_121666}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519_32.c#L1460>)

Multiplies a field element by 121666 and reduces the result modulo `2^255 - 19`.
- **Inputs**:
    - `out1`: A `fiat_25519_tight_field_element` array to store the result.
    - `arg1`: A `fiat_25519_loose_field_element` array representing the input field element to be multiplied.
- **Logic and Control Flow**:
    - Initialize variables `x1` to `x10` to store intermediate multiplication results of each element of `arg1` with 121666.
    - Perform a series of additions and bitwise operations to reduce the results modulo `2^255 - 19`.
    - Store the reduced results in the `out1` array.
- **Output**: A `fiat_25519_tight_field_element` array `out1` containing the reduced result of the multiplication.



---
Made with ❤️ by [Driver](https://www.driver.ai/)