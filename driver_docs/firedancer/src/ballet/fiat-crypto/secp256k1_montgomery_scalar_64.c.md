<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Autogenerated C code for secp256k1 Montgomery scalar arithmetic, including operations like multiplication, addition, subtraction, and conversion between Montgomery and non-Montgomery domains.

# Purpose
The code is a C implementation of arithmetic operations for the secp256k1 curve using the Montgomery representation. It is designed to perform operations on field elements within the finite field defined by the prime modulus `m = 2^256 - 432420386565659656852420866394968145599`. The code provides functions for addition, subtraction, multiplication, and squaring of field elements in the Montgomery domain, as well as conversion functions to and from the Montgomery domain. It also includes utility functions for conditional moves, serialization to and from bytes, and a divstep function used in modular inversion algorithms.

The code defines several types and macros to facilitate operations on 64-bit words, including `fiat_secp256k1_montgomery_scalar_uint1` and `fiat_secp256k1_montgomery_scalar_int1` for single-bit operations, and `fiat_secp256k1_montgomery_scalar_uint128` for 128-bit arithmetic. The functions are implemented with inline assembly and compiler-specific extensions to optimize performance on supported platforms. The code is intended to be used as part of a cryptographic library, providing efficient and secure arithmetic operations for elliptic curve cryptography on the secp256k1 curve, commonly used in blockchain technologies like Bitcoin.
# Imports and Dependencies

---
- `stdint.h`


# Global Variables

---
### fiat\_secp256k1\_montgomery\_scalar\_int128
- **Type**: ``typedef signed __int128 fiat_secp256k1_montgomery_scalar_int128``
- **Description**: This is a type definition for a signed 128-bit integer, which is used in the context of the secp256k1 Montgomery scalar arithmetic. The `fiat_secp256k1_montgomery_scalar_int128` type is defined using the `__int128` type, which is a compiler extension for 128-bit integers available in GCC and Clang compilers.
- **Use**: Used to perform arithmetic operations that require 128-bit signed integer precision in the secp256k1 Montgomery scalar arithmetic.


---
### fiat\_secp256k1\_montgomery\_scalar\_uint128
- **Type**: ``unsigned __int128``
- **Description**: Represents an unsigned 128-bit integer type used in the context of the secp256k1 Montgomery scalar arithmetic. This type is used to handle large integer values that exceed the standard 64-bit integer range.
- **Use**: Used in arithmetic operations that require handling of large numbers, such as multiplication and addition with carry, within the secp256k1 Montgomery scalar arithmetic.


# Functions

---
### fiat\_secp256k1\_montgomery\_scalar\_value\_barrier\_u64<!-- {{#callable:fiat_secp256k1_montgomery_scalar_value_barrier_u64}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_scalar_64.c#L47>)

Applies a value barrier to a 64-bit unsigned integer to prevent certain compiler optimizations.
- **Inputs**:
    - `a`: A 64-bit unsigned integer input.
- **Logic and Control Flow**:
    - Uses inline assembly to apply a value barrier to the input `a`, which prevents the compiler from optimizing away certain operations involving `a`.
    - The inline assembly does not modify `a`, but ensures that `a` is treated as a volatile variable, preventing certain optimizations.
- **Output**: Returns the same 64-bit unsigned integer `a` after applying the value barrier.


---
### fiat\_secp256k1\_montgomery\_scalar\_addcarryx\_u64<!-- {{#callable:fiat_secp256k1_montgomery_scalar_addcarryx_u64}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_scalar_64.c#L71>)

Performs addition of two 64-bit unsigned integers with a carry input and outputs the result and carry.
- **Inputs**:
    - ``out1``: Pointer to a `uint64_t` where the result of the addition will be stored.
    - ``out2``: Pointer to a `fiat_secp256k1_montgomery_scalar_uint1` where the carry-out will be stored.
    - ``arg1``: A `fiat_secp256k1_montgomery_scalar_uint1` representing the carry-in for the addition.
    - ``arg2``: A `uint64_t` representing the first operand for the addition.
    - ``arg3``: A `uint64_t` representing the second operand for the addition.
- **Logic and Control Flow**:
    - Calculate the sum of `arg1`, `arg2`, and `arg3` and store it in `x1` as a 128-bit integer.
    - Extract the lower 64 bits of `x1` and store it in `x2`.
    - Extract the upper 64 bits of `x1` and store it in `x3` as the carry-out.
    - Store `x2` in the location pointed to by `out1`.
    - Store `x3` in the location pointed to by `out2`.
- **Output**: The function outputs the 64-bit result of the addition in `out1` and the carry-out in `out2`.


---
### fiat\_secp256k1\_montgomery\_scalar\_subborrowx\_u64<!-- {{#callable:fiat_secp256k1_montgomery_scalar_subborrowx_u64}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_scalar_64.c#L97>)

Performs subtraction with borrow on two 64-bit unsigned integers and a borrow flag, returning the result and the new borrow flag.
- **Inputs**:
    - `out1`: Pointer to a 64-bit unsigned integer where the result of the subtraction will be stored.
    - `out2`: Pointer to a `fiat_secp256k1_montgomery_scalar_uint1` where the new borrow flag will be stored.
    - `arg1`: A `fiat_secp256k1_montgomery_scalar_uint1` representing the initial borrow flag.
    - `arg2`: A 64-bit unsigned integer, the minuend.
    - `arg3`: A 64-bit unsigned integer, the subtrahend.
- **Logic and Control Flow**:
    - Calculate `x1` as the result of `arg2` minus `arg1` and `arg3`, using 128-bit integer arithmetic to handle potential overflow.
    - Shift `x1` right by 64 bits to determine the new borrow flag `x2`.
    - Mask `x1` with `0xffffffffffffffff` to get the lower 64 bits as the result `x3`.
    - Store `x3` in the location pointed to by `out1`.
    - Calculate the new borrow flag as `0x0 - x2` and store it in the location pointed to by `out2`.
- **Output**: The function outputs the result of the subtraction in `out1` and the new borrow flag in `out2`.


---
### fiat\_secp256k1\_montgomery\_scalar\_mulx\_u64<!-- {{#callable:fiat_secp256k1_montgomery_scalar_mulx_u64}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_scalar_64.c#L122>)

Performs a 64-bit multiplication of two unsigned integers and returns the result as a double-width product split into two 64-bit parts.
- **Inputs**:
    - `out1`: Pointer to a `uint64_t` where the lower 64 bits of the product will be stored.
    - `out2`: Pointer to a `uint64_t` where the upper 64 bits of the product will be stored.
    - `arg1`: First unsigned 64-bit integer to multiply.
    - `arg2`: Second unsigned 64-bit integer to multiply.
- **Logic and Control Flow**:
    - Declare a variable `x1` of type `fiat_secp256k1_montgomery_scalar_uint128` to store the full 128-bit product of `arg1` and `arg2`.
    - Calculate the product of `arg1` and `arg2` and store it in `x1`.
    - Extract the lower 64 bits of `x1` and store it in `x2`.
    - Extract the upper 64 bits of `x1` and store it in `x3`.
    - Assign the value of `x2` to the location pointed to by `out1`.
    - Assign the value of `x3` to the location pointed to by `out2`.
- **Output**: The function does not return a value, but it outputs the lower and upper 64 bits of the product through the pointers `out1` and `out2`, respectively.


---
### fiat\_secp256k1\_montgomery\_scalar\_cmovznz\_u64<!-- {{#callable:fiat_secp256k1_montgomery_scalar_cmovznz_u64}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_scalar_64.c#L146>)

Performs a conditional move between two 64-bit unsigned integers based on a condition flag.
- **Inputs**:
    - ``out1``: Pointer to a `uint64_t` where the result will be stored.
    - ``arg1``: A `fiat_secp256k1_montgomery_scalar_uint1` condition flag (0 or 1) that determines which value to select.
    - ``arg2``: A `uint64_t` value to select if `arg1` is 0.
    - ``arg3``: A `uint64_t` value to select if `arg1` is 1.
- **Logic and Control Flow**:
    - Initialize `x1` as the logical negation of the logical negation of `arg1`, effectively converting `arg1` to a boolean value.
    - Compute `x2` as the bitwise AND of the negation of `x1` and the maximum 64-bit unsigned integer, resulting in either all bits set or all bits cleared.
    - Compute `x3` as the bitwise OR of the bitwise AND of `x2` with `arg3` and the bitwise AND of the negation of `x2` with `arg2`, effectively selecting `arg3` if `x2` is all bits set, otherwise selecting `arg2`.
    - Store the result in the location pointed to by `out1`.
- **Output**: The function does not return a value but stores the selected `uint64_t` in the location pointed to by `out1`.
- **Functions Called**:
    - [`fiat_secp256k1_montgomery_scalar_value_barrier_u64`](<#fiat_secp256k1_montgomery_scalar_value_barrier_u64>)


---
### fiat\_secp256k1\_montgomery\_scalar\_mul<!-- {{#callable:fiat_secp256k1_montgomery_scalar_mul}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_scalar_64.c#L167>)

Multiplies two field elements in the Montgomery domain and reduces the result modulo the prime modulus.
- **Inputs**:
    - `out1`: A pointer to a `fiat_secp256k1_montgomery_scalar_montgomery_domain_field_element` where the result will be stored.
    - `arg1`: A pointer to a `fiat_secp256k1_montgomery_scalar_montgomery_domain_field_element` representing the first operand.
    - `arg2`: A pointer to a `fiat_secp256k1_montgomery_scalar_montgomery_domain_field_element` representing the second operand.
- **Logic and Control Flow**:
    - Initialize multiple 64-bit unsigned integers and carry variables for intermediate calculations.
    - Perform a series of multiplications using [`fiat_secp256k1_montgomery_scalar_mulx_u64`](<#fiat_secp256k1_montgomery_scalar_mulx_u64>) to compute partial products of `arg1` and `arg2`.
    - Use [`fiat_secp256k1_montgomery_scalar_addcarryx_u64`](<#fiat_secp256k1_montgomery_scalar_addcarryx_u64>) to accumulate the results of the multiplications, handling carry bits appropriately.
    - Compute the Montgomery reduction by multiplying with the constant `0x4b0dff665588b13f` and reducing modulo the prime modulus using additional multiplications and additions.
    - Use conditional moves [`fiat_secp256k1_montgomery_scalar_cmovznz_u64`](<#fiat_secp256k1_montgomery_scalar_cmovznz_u64>) to ensure the result is less than the modulus.
    - Store the final result in `out1`.
- **Output**: The result is stored in `out1`, which is a field element in the Montgomery domain.
- **Functions Called**:
    - [`fiat_secp256k1_montgomery_scalar_mulx_u64`](<#fiat_secp256k1_montgomery_scalar_mulx_u64>)
    - [`fiat_secp256k1_montgomery_scalar_addcarryx_u64`](<#fiat_secp256k1_montgomery_scalar_addcarryx_u64>)
    - [`fiat_secp256k1_montgomery_scalar_subborrowx_u64`](<#fiat_secp256k1_montgomery_scalar_subborrowx_u64>)
    - [`fiat_secp256k1_montgomery_scalar_cmovznz_u64`](<#fiat_secp256k1_montgomery_scalar_cmovznz_u64>)


---
### fiat\_secp256k1\_montgomery\_scalar\_square<!-- {{#callable:fiat_secp256k1_montgomery_scalar_square}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_scalar_64.c#L522>)

Squares a field element in the Montgomery domain for the secp256k1 curve.
- **Inputs**:
    - `out1`: A pointer to an array of four `uint64_t` elements where the result will be stored.
    - `arg1`: A constant pointer to an array of four `uint64_t` elements representing the field element to be squared.
- **Logic and Control Flow**:
    - Initialize variables to store intermediate results and carry bits.
    - Perform a series of multiplications using [`fiat_secp256k1_montgomery_scalar_mulx_u64`](<#fiat_secp256k1_montgomery_scalar_mulx_u64>) to compute the product of `arg1` with itself, storing results in temporary variables.
    - Use [`fiat_secp256k1_montgomery_scalar_addcarryx_u64`](<#fiat_secp256k1_montgomery_scalar_addcarryx_u64>) to add the results of the multiplications, managing carry bits appropriately.
    - Multiply the result by a constant using [`fiat_secp256k1_montgomery_scalar_mulx_u64`](<#fiat_secp256k1_montgomery_scalar_mulx_u64>) to adjust for the Montgomery domain.
    - Perform additional additions with carry to accumulate the final result.
    - Use [`fiat_secp256k1_montgomery_scalar_subborrowx_u64`](<#fiat_secp256k1_montgomery_scalar_subborrowx_u64>) to ensure the result is within the field by subtracting the modulus if necessary.
    - Use [`fiat_secp256k1_montgomery_scalar_cmovznz_u64`](<#fiat_secp256k1_montgomery_scalar_cmovznz_u64>) to conditionally select the correct result based on the borrow flag.
    - Store the final result in `out1`.
- **Output**: The function outputs the squared field element in the Montgomery domain, stored in the `out1` array.
- **Functions Called**:
    - [`fiat_secp256k1_montgomery_scalar_mulx_u64`](<#fiat_secp256k1_montgomery_scalar_mulx_u64>)
    - [`fiat_secp256k1_montgomery_scalar_addcarryx_u64`](<#fiat_secp256k1_montgomery_scalar_addcarryx_u64>)
    - [`fiat_secp256k1_montgomery_scalar_subborrowx_u64`](<#fiat_secp256k1_montgomery_scalar_subborrowx_u64>)
    - [`fiat_secp256k1_montgomery_scalar_cmovznz_u64`](<#fiat_secp256k1_montgomery_scalar_cmovznz_u64>)


---
### fiat\_secp256k1\_montgomery\_scalar\_add<!-- {{#callable:fiat_secp256k1_montgomery_scalar_add}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_scalar_64.c#L878>)

Adds two field elements in the Montgomery domain and reduces the result modulo the prime modulus.
- **Inputs**:
    - `out1`: A pointer to the output field element in the Montgomery domain.
    - `arg1`: A pointer to the first input field element in the Montgomery domain.
    - `arg2`: A pointer to the second input field element in the Montgomery domain.
- **Logic and Control Flow**:
    - Initialize temporary variables for intermediate results and carry flags.
    - Perform addition with carry for each corresponding pair of elements from `arg1` and `arg2`, storing results in temporary variables.
    - Subtract the prime modulus from the result using subtraction with borrow to ensure the result is within the field range.
    - Use conditional move to select the correct result based on the borrow flag, ensuring the result is reduced modulo the prime modulus.
    - Store the final result in `out1`.
- **Output**: The function does not return a value but stores the result in the `out1` array.
- **Functions Called**:
    - [`fiat_secp256k1_montgomery_scalar_addcarryx_u64`](<#fiat_secp256k1_montgomery_scalar_addcarryx_u64>)
    - [`fiat_secp256k1_montgomery_scalar_subborrowx_u64`](<#fiat_secp256k1_montgomery_scalar_subborrowx_u64>)
    - [`fiat_secp256k1_montgomery_scalar_cmovznz_u64`](<#fiat_secp256k1_montgomery_scalar_cmovznz_u64>)


---
### fiat\_secp256k1\_montgomery\_scalar\_sub<!-- {{#callable:fiat_secp256k1_montgomery_scalar_sub}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_scalar_64.c#L931>)

Subtracts two field elements in the Montgomery domain and ensures the result is within the field's bounds.
- **Inputs**:
    - `out1`: A pointer to the output field element in the Montgomery domain.
    - `arg1`: A pointer to the first input field element in the Montgomery domain.
    - `arg2`: A pointer to the second input field element in the Montgomery domain.
- **Logic and Control Flow**:
    - Initialize variables for intermediate results and carry flags.
    - Perform subtraction with borrow for each 64-bit segment of the input arrays `arg1` and `arg2` using [`fiat_secp256k1_montgomery_scalar_subborrowx_u64`](<#fiat_secp256k1_montgomery_scalar_subborrowx_u64>).
    - Check if the final borrow flag indicates a negative result, and conditionally set a mask to the maximum 64-bit value if so.
    - Add the modulus to the result if the subtraction resulted in a negative value, using [`fiat_secp256k1_montgomery_scalar_addcarryx_u64`](<#fiat_secp256k1_montgomery_scalar_addcarryx_u64>).
    - Store the final result in the `out1` array.
- **Output**: The result of the subtraction, stored in the `out1` array, is a field element in the Montgomery domain.
- **Functions Called**:
    - [`fiat_secp256k1_montgomery_scalar_subborrowx_u64`](<#fiat_secp256k1_montgomery_scalar_subborrowx_u64>)
    - [`fiat_secp256k1_montgomery_scalar_cmovznz_u64`](<#fiat_secp256k1_montgomery_scalar_cmovznz_u64>)
    - [`fiat_secp256k1_montgomery_scalar_addcarryx_u64`](<#fiat_secp256k1_montgomery_scalar_addcarryx_u64>)


---
### fiat\_secp256k1\_montgomery\_scalar\_opp<!-- {{#callable:fiat_secp256k1_montgomery_scalar_opp}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_scalar_64.c#L974>)

Negates a field element in the Montgomery domain for the secp256k1 curve.
- **Inputs**:
    - `out1`: A pointer to an array of four `uint64_t` elements where the result will be stored.
    - `arg1`: A constant pointer to an array of four `uint64_t` elements representing the field element to negate.
- **Logic and Control Flow**:
    - Initialize variables for intermediate calculations and carry flags.
    - Perform subtraction with borrow for each element of `arg1` from zero, storing results in temporary variables and updating carry flags.
    - Use a conditional move to set a mask based on the final carry flag, which determines if the result needs correction by adding the modulus.
    - Add the modulus conditionally to the intermediate results using the mask, ensuring the result is within the field range.
    - Store the final results in the `out1` array.
- **Output**: The negated field element is stored in the `out1` array.
- **Functions Called**:
    - [`fiat_secp256k1_montgomery_scalar_subborrowx_u64`](<#fiat_secp256k1_montgomery_scalar_subborrowx_u64>)
    - [`fiat_secp256k1_montgomery_scalar_cmovznz_u64`](<#fiat_secp256k1_montgomery_scalar_cmovznz_u64>)
    - [`fiat_secp256k1_montgomery_scalar_addcarryx_u64`](<#fiat_secp256k1_montgomery_scalar_addcarryx_u64>)


---
### fiat\_secp256k1\_montgomery\_scalar\_from\_montgomery<!-- {{#callable:fiat_secp256k1_montgomery_scalar_from_montgomery}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_scalar_64.c#L1017>)

Converts a field element from the Montgomery domain to the standard representation.
- **Inputs**:
    - `out1`: A pointer to an array of four `uint64_t` elements where the result will be stored.
    - `arg1`: A constant pointer to an array of four `uint64_t` elements representing the field element in the Montgomery domain.
- **Logic and Control Flow**:
    - Initialize several `uint64_t` and `fiat_secp256k1_montgomery_scalar_uint1` variables for intermediate calculations.
    - Extract the first element of `arg1` and perform a series of multiplications and additions to compute intermediate values `x2` to `x17`.
    - Use [`fiat_secp256k1_montgomery_scalar_addcarryx_u64`](<#fiat_secp256k1_montgomery_scalar_addcarryx_u64>) to add the results of the multiplications and handle carry bits.
    - Repeat the process for the remaining elements of `arg1`, updating the intermediate values and handling carries.
    - Perform a series of conditional moves using [`fiat_secp256k1_montgomery_scalar_cmovznz_u64`](<#fiat_secp256k1_montgomery_scalar_cmovznz_u64>) to select between the computed values and the original values based on the carry flag.
    - Store the final results in the `out1` array.
- **Output**: The function outputs a field element in the standard representation, stored in the `out1` array.
- **Functions Called**:
    - [`fiat_secp256k1_montgomery_scalar_mulx_u64`](<#fiat_secp256k1_montgomery_scalar_mulx_u64>)
    - [`fiat_secp256k1_montgomery_scalar_addcarryx_u64`](<#fiat_secp256k1_montgomery_scalar_addcarryx_u64>)
    - [`fiat_secp256k1_montgomery_scalar_subborrowx_u64`](<#fiat_secp256k1_montgomery_scalar_subborrowx_u64>)
    - [`fiat_secp256k1_montgomery_scalar_cmovznz_u64`](<#fiat_secp256k1_montgomery_scalar_cmovznz_u64>)


---
### fiat\_secp256k1\_montgomery\_scalar\_to\_montgomery<!-- {{#callable:fiat_secp256k1_montgomery_scalar_to_montgomery}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_scalar_64.c#L1251>)

Converts a non-Montgomery domain field element to a Montgomery domain field element using the secp256k1 curve parameters.
- **Inputs**:
    - `out1`: A pointer to an array of four `uint64_t` where the result will be stored, representing the Montgomery domain field element.
    - `arg1`: A constant pointer to an array of four `uint64_t` representing the non-Montgomery domain field element to be converted.
- **Logic and Control Flow**:
    - Initialize multiple `uint64_t` variables for intermediate calculations.
    - Extract individual elements from `arg1` into `x1`, `x2`, `x3`, and `x4`.
    - Perform a series of multiplications and additions using the constants specific to the secp256k1 curve to transform the input into the Montgomery domain.
    - Use the [`fiat_secp256k1_montgomery_scalar_mulx_u64`](<#fiat_secp256k1_montgomery_scalar_mulx_u64>) function to perform 64-bit multiplications and store results in pairs of variables.
    - Use the [`fiat_secp256k1_montgomery_scalar_addcarryx_u64`](<#fiat_secp256k1_montgomery_scalar_addcarryx_u64>) function to add values with carry, storing results and carry flags.
    - Perform modular reduction using the secp256k1 prime modulus by multiplying with a constant and reducing the result.
    - Store the final results in the `out1` array.
- **Output**: The function outputs a Montgomery domain field element stored in the `out1` array.
- **Functions Called**:
    - [`fiat_secp256k1_montgomery_scalar_mulx_u64`](<#fiat_secp256k1_montgomery_scalar_mulx_u64>)
    - [`fiat_secp256k1_montgomery_scalar_addcarryx_u64`](<#fiat_secp256k1_montgomery_scalar_addcarryx_u64>)
    - [`fiat_secp256k1_montgomery_scalar_subborrowx_u64`](<#fiat_secp256k1_montgomery_scalar_subborrowx_u64>)
    - [`fiat_secp256k1_montgomery_scalar_cmovznz_u64`](<#fiat_secp256k1_montgomery_scalar_cmovznz_u64>)


---
### fiat\_secp256k1\_montgomery\_scalar\_nonzero<!-- {{#callable:fiat_secp256k1_montgomery_scalar_nonzero}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_scalar_64.c#L1578>)

Outputs a non-zero value if any element of the input array is non-zero, otherwise outputs zero.
- **Inputs**:
    - `out1`: A pointer to a `uint64_t` where the result will be stored.
    - `arg1`: An array of four `uint64_t` values representing the input to check for non-zero elements.
- **Logic and Control Flow**:
    - Initialize a `uint64_t` variable `x1` to the bitwise OR of all elements in `arg1`.
    - Assign the value of `x1` to the location pointed to by `out1`.
- **Output**: A `uint64_t` value stored at the location pointed to by `out1`, which is non-zero if any element of `arg1` is non-zero, otherwise zero.


---
### fiat\_secp256k1\_montgomery\_scalar\_selectznz<!-- {{#callable:fiat_secp256k1_montgomery_scalar_selectznz}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_scalar_64.c#L1597>)

Selects one of two 256-bit values based on a condition.
- **Inputs**:
    - ``out1``: An array of four `uint64_t` elements where the selected value will be stored.
    - ``arg1``: A `fiat_secp256k1_montgomery_scalar_uint1` condition flag that determines which value to select.
    - ``arg2``: An array of four `uint64_t` elements representing the first 256-bit value.
    - ``arg3``: An array of four `uint64_t` elements representing the second 256-bit value.
- **Logic and Control Flow**:
    - Call [`fiat_secp256k1_montgomery_scalar_cmovznz_u64`](<#fiat_secp256k1_montgomery_scalar_cmovznz_u64>) for each of the four elements of the input arrays `arg2` and `arg3`, using `arg1` as the condition.
    - Store the result of each call in the corresponding element of the `out1` array.
- **Output**: The `out1` array contains the selected 256-bit value, either `arg2` or `arg3`, based on the condition `arg1`.
- **Functions Called**:
    - [`fiat_secp256k1_montgomery_scalar_cmovznz_u64`](<#fiat_secp256k1_montgomery_scalar_cmovznz_u64>)


---
### fiat\_secp256k1\_montgomery\_scalar\_to\_bytes<!-- {{#callable:fiat_secp256k1_montgomery_scalar_to_bytes}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_scalar_64.c#L1625>)

Converts a 256-bit scalar from a 4-element array of 64-bit integers to a 32-byte array in little-endian order.
- **Inputs**:
    - `out1`: A 32-byte array to store the resulting bytes.
    - `arg1`: A 4-element array of 64-bit integers representing the scalar to convert.
- **Logic and Control Flow**:
    - Extracts each 64-bit integer from `arg1` and processes it in little-endian order.
    - For each 64-bit integer, extracts each byte by masking and shifting operations.
    - Stores each extracted byte into the `out1` array in sequence.
- **Output**: A 32-byte array `out1` containing the little-endian byte representation of the input scalar.


---
### fiat\_secp256k1\_montgomery\_scalar\_from\_bytes<!-- {{#callable:fiat_secp256k1_montgomery_scalar_from_bytes}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_scalar_64.c#L1794>)

Converts a 32-byte array into a 4-element array of 64-bit unsigned integers, representing a field element not in the Montgomery domain.
- **Inputs**:
    - `out1`: A pointer to an array of four 64-bit unsigned integers where the result will be stored.
    - `arg1`: A pointer to an array of 32 bytes representing the input data in little-endian order.
- **Logic and Control Flow**:
    - Initialize 60 local variables to store intermediate results.
    - Extract and shift each byte from `arg1` to form 64-bit integers, combining them to form four 64-bit integers.
    - Store the resulting 64-bit integers in the `out1` array.
- **Output**: A 4-element array of 64-bit unsigned integers stored in `out1`, representing the deserialized field element.


---
### fiat\_secp256k1\_montgomery\_scalar\_set\_one<!-- {{#callable:fiat_secp256k1_montgomery_scalar_set_one}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_scalar_64.c#L1929>)

Sets the output field element to the representation of one in the Montgomery domain for the secp256k1 curve.
- **Inputs**:
    - `out1`: A `fiat_secp256k1_montgomery_scalar_montgomery_domain_field_element` array of size 4 that will hold the output value.
- **Logic and Control Flow**:
    - Assigns the constant `0x402da1732fc9bebf` to `out1[0]`.
    - Assigns the constant `0x4551231950b75fc4` to `out1[1]`.
    - Assigns the constant `0x1` to `out1[2]`.
    - Assigns the constant `0x0` to `out1[3]`.
- **Output**: The function does not return a value but modifies the `out1` array to represent the number one in the Montgomery domain.


---
### fiat\_secp256k1\_montgomery\_scalar\_msat<!-- {{#callable:fiat_secp256k1_montgomery_scalar_msat}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_scalar_64.c#L1946>)

Returns the saturated representation of the prime modulus for the secp256k1 curve in the Montgomery domain.
- **Inputs**:
    - `out1`: An array of 5 `uint64_t` elements where the function will store the saturated representation of the prime modulus.
- **Logic and Control Flow**:
    - Assigns the first element of `out1` to `0xbfd25e8cd0364141`.
    - Assigns the second element of `out1` to `0xbaaedce6af48a03b`.
    - Assigns the third element of `out1` to `0xfffffffffffffffe`.
    - Assigns the fourth element of `out1` to `0xffffffffffffffff`.
    - Assigns the fifth element of `out1` to `0x0`.
- **Output**: The function does not return a value but populates the `out1` array with the saturated representation of the prime modulus.


---
### fiat\_secp256k1\_montgomery\_scalar\_divstep<!-- {{#callable:fiat_secp256k1_montgomery_scalar_divstep}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_scalar_64.c#L1984>)

Computes a divstep operation for the secp256k1 curve in the Montgomery domain.
- **Inputs**:
    - ``out1``: Pointer to a `uint64_t` where the result of the divstep operation will be stored.
    - ``out2``: Array of 5 `uint64_t` elements where the updated value of `arg2` will be stored.
    - ``out3``: Array of 5 `uint64_t` elements where the updated value of `arg3` will be stored.
    - ``out4``: Array of 4 `uint64_t` elements where the updated value of `arg4` will be stored.
    - ``out5``: Array of 4 `uint64_t` elements where the updated value of `arg5` will be stored.
    - ``arg1``: A `uint64_t` representing the initial value for the divstep operation.
    - ``arg2``: Array of 5 `uint64_t` elements representing the initial value of `arg2`.
    - ``arg3``: Array of 5 `uint64_t` elements representing the initial value of `arg3`.
    - ``arg4``: Array of 4 `uint64_t` elements representing the initial value of `arg4`.
    - ``arg5``: Array of 4 `uint64_t` elements representing the initial value of `arg5`.
- **Logic and Control Flow**:
    - Calculate `x1` as the negation of `arg1` plus 1, and determine if `arg3[0]` is odd to set `x3`.
    - Use `x3` to conditionally move values between `arg1` and `x4`, and between `arg2` and `arg3` to `x7` to `x11`.
    - Compute the negation of `arg2` and store in `x12` to `x20`, then use `x3` to conditionally move values between `arg3` and `x12` to `x20` to `x22` to `x26`.
    - Use `x3` to conditionally move values between `arg4` and `arg5` to `x27` to `x30`.
    - Double the values in `x27` to `x30` and perform modular subtraction with constants, storing results in `x39` to `x47`.
    - Compute the negation of `arg4` and adjust with constants, storing results in `x62` to `x68`.
    - Use `x3` to conditionally move values between `arg5` and `x62` to `x68` to `x70` to `x73`.
    - Determine if `x22` is odd and use it to conditionally move values to `x75` to `x79`, then add these to `x22` to `x26` to get `x80` to `x88`.
    - Use `x74` to conditionally move values to `x90` to `x93`, then add these to `x70` to `x73` to get `x94` to `x100`.
    - Perform modular subtraction on `x94` to `x100` with constants, storing results in `x102` to `x110`.
    - Add 1 to `x6` to get `x112`, and shift `x80` to `x88` to get `x114` to `x118`.
    - Use `x48` and `x111` to conditionally move values to `x119` to `x126`.
    - Store results in `out1`, `out2`, `out3`, `out4`, and `out5`.
- **Output**: The function updates `out1` with the result of the divstep operation, and updates `out2`, `out3`, `out4`, and `out5` with the new values of `arg2`, `arg3`, `arg4`, and `arg5` respectively.
- **Functions Called**:
    - [`fiat_secp256k1_montgomery_scalar_addcarryx_u64`](<#fiat_secp256k1_montgomery_scalar_addcarryx_u64>)
    - [`fiat_secp256k1_montgomery_scalar_cmovznz_u64`](<#fiat_secp256k1_montgomery_scalar_cmovznz_u64>)
    - [`fiat_secp256k1_montgomery_scalar_subborrowx_u64`](<#fiat_secp256k1_montgomery_scalar_subborrowx_u64>)


---
### fiat\_secp256k1\_montgomery\_scalar\_divstep\_precomp<!-- {{#callable:fiat_secp256k1_montgomery_scalar_divstep_precomp}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/secp256k1_montgomery_scalar_64.c#L2229>)

Initializes a 4-element array with precomputed constants for Montgomery inversion.
- **Inputs**:
    - `out1`: A 4-element array of type `uint64_t` where the precomputed constants will be stored.
- **Logic and Control Flow**:
    - Assigns the constant `0xd7431a4d2b9cb4e9` to `out1[0]`.
    - Assigns the constant `0xab67d35a32d9c503` to `out1[1]`.
    - Assigns the constant `0xadf6c7e5859ce35f` to `out1[2]`.
    - Assigns the constant `0x615441451df6c379` to `out1[3]`.
- **Output**: The function does not return a value; it modifies the `out1` array in place.



---
Made with ❤️ by [Driver](https://www.driver.ai/)