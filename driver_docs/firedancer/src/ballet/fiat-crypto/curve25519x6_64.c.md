<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Autogenerated C code for arithmetic operations on 25519x6 field elements using 64-bit words.

# Purpose
The code is a C implementation of arithmetic operations for the `fiat_25519x6` field, which is used in cryptographic computations, specifically for the Curve25519 elliptic curve. The code provides functions to perform arithmetic operations such as addition, subtraction, multiplication, squaring, and scalar multiplication by a constant (121666) on field elements. These operations are implemented with specific constraints and optimizations for the 25519x6 field, which is a representation of the prime field defined by the modulus \(2^{255} - 19\).

The code defines types for field elements with both loose and tight bounds, and it includes functions for converting between these representations. It also provides functions for conditional moves and serialization/deserialization of field elements to and from byte arrays. The operations are implemented using 64-bit words, and the code includes inline assembly optimizations for compilers like GCC and Clang. The functions ensure that the results are reduced modulo the field's prime, maintaining the properties required for cryptographic security.
# Imports and Dependencies

---
- `stdint.h`


# Global Variables

---
### fiat\_25519x6\_int128
- **Type**: ``typedef signed __int128``
- **Description**: Defines a signed 128-bit integer type using the `__int128` extension provided by GCC or Clang compilers. This type is used to represent large integers that require more than the standard 64-bit integer size.
- **Use**: Used in arithmetic operations that require high precision and large number handling.


---
### fiat\_25519x6\_uint128
- **Type**: ``unsigned __int128``
- **Description**: Represents an unsigned 128-bit integer type. This type is used to perform arithmetic operations that require more than the standard 64-bit integer range.
- **Use**: Used in arithmetic operations within functions like `fiat_25519x6_carry_mul` and `fiat_25519x6_carry_square` to handle large intermediate values.


# Functions

---
### fiat\_25519x6\_addcarryx\_u42<!-- {{#callable:fiat_25519x6_addcarryx_u42}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519x6_64.c#L57>)

Performs addition of three numbers with a carry, reducing the result modulo 2^42.
- **Inputs**:
    - `out1`: Pointer to a `uint64_t` where the result of the addition modulo 2^42 is stored.
    - `out2`: Pointer to a `fiat_25519x6_uint1` where the carry resulting from the addition is stored.
    - `arg1`: A `fiat_25519x6_uint1` representing the first addend, which is either 0 or 1.
    - `arg2`: A `uint64_t` representing the second addend, within the range [0, 0x3ffffffffff].
    - `arg3`: A `uint64_t` representing the third addend, within the range [0, 0x3ffffffffff].
- **Logic and Control Flow**:
    - Calculate the sum of `arg1`, `arg2`, and `arg3`, storing the result in `x1`.
    - Compute `x2` as `x1` modulo 2^42, which is `x1 & 0x3ffffffffff`.
    - Compute `x3` as the carry by right-shifting `x1` by 42 bits.
    - Store `x2` in the location pointed to by `out1`.
    - Store `x3` in the location pointed to by `out2`.
- **Output**: The function outputs the result of the addition modulo 2^42 in `out1` and the carry in `out2`.


---
### fiat\_25519x6\_subborrowx\_u42<!-- {{#callable:fiat_25519x6_subborrowx_u42}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519x6_64.c#L83>)

Performs subtraction with borrow on two 42-bit numbers and a borrow flag, producing a result and a new borrow flag.
- **Inputs**:
    - `out1`: Pointer to a `uint64_t` where the result of the subtraction will be stored.
    - `out2`: Pointer to a `fiat_25519x6_uint1` where the new borrow flag will be stored.
    - `arg1`: A `fiat_25519x6_uint1` representing the initial borrow flag.
    - `arg2`: A `uint64_t` representing the first operand in the subtraction.
    - `arg3`: A `uint64_t` representing the second operand in the subtraction.
- **Logic and Control Flow**:
    - Calculate the difference `x1` by subtracting `arg1` and `arg3` from `arg2`.
    - Shift `x1` right by 42 bits to determine the new borrow flag `x2`.
    - Mask `x1` with `0x3ffffffffff` to get the lower 42 bits as the result `x3`.
    - Store `x3` in the location pointed to by `out1`.
    - Store the negation of `x2` in the location pointed to by `out2`.
- **Output**: Stores the result of the subtraction in `out1` and the new borrow flag in `out2`.


---
### fiat\_25519x6\_addcarryx\_u43<!-- {{#callable:fiat_25519x6_addcarryx_u43}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519x6_64.c#L109>)

Performs addition with carry for three inputs and outputs the result modulo 2^43 and the carry.
- **Inputs**:
    - ``out1``: Pointer to a `uint64_t` where the result of the addition modulo 2^43 is stored.
    - ``out2``: Pointer to a `fiat_25519x6_uint1` where the carry of the addition is stored.
    - ``arg1``: A `fiat_25519x6_uint1` representing the first input value, which is either 0 or 1.
    - ``arg2``: A `uint64_t` representing the second input value, which is in the range [0, 0x7ffffffffff].
    - ``arg3``: A `uint64_t` representing the third input value, which is in the range [0, 0x7ffffffffff].
- **Logic and Control Flow**:
    - Calculate the sum of `arg1`, `arg2`, and `arg3` and store it in `x1`.
    - Compute `x2` as `x1` bitwise AND with `0x7ffffffffff` to get the result modulo 2^43.
    - Compute `x3` as `x1` right-shifted by 43 bits to get the carry.
    - Store `x2` in the location pointed to by `out1`.
    - Store `x3` in the location pointed to by `out2`.
- **Output**: The function outputs the result of the addition modulo 2^43 in `out1` and the carry in `out2`.


---
### fiat\_25519x6\_subborrowx\_u43<!-- {{#callable:fiat_25519x6_subborrowx_u43}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519x6_64.c#L135>)

Performs subtraction with borrow on three inputs and outputs the result modulo 2^43 and the borrow flag.
- **Inputs**:
    - `out1`: Pointer to a `uint64_t` where the result of the subtraction will be stored.
    - `out2`: Pointer to a `fiat_25519x6_uint1` where the borrow flag will be stored.
    - `arg1`: A `fiat_25519x6_uint1` representing the first input value, which is subtracted from the second input.
    - `arg2`: A `uint64_t` representing the second input value, from which the first input is subtracted.
    - `arg3`: A `uint64_t` representing the third input value, which is also subtracted from the second input.
- **Logic and Control Flow**:
    - Calculate `x1` as the result of subtracting `arg1` and `arg3` from `arg2` and cast it to `int64_t`.
    - Shift `x1` right by 43 bits to calculate the borrow flag `x2` and cast it to `fiat_25519x6_int1`.
    - Mask `x1` with `0x7ffffffffff` to get the result modulo 2^43 and store it in `x3`.
    - Store `x3` in the location pointed to by `out1`.
    - Calculate the negation of `x2` and store it in the location pointed to by `out2`.
- **Output**: The function outputs the result of the subtraction modulo 2^43 in `out1` and the borrow flag in `out2`.


---
### fiat\_25519x6\_cmovznz\_u64<!-- {{#callable:fiat_25519x6_cmovznz_u64}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519x6_64.c#L159>)

Performs a conditional move based on a flag, selecting between two 64-bit unsigned integers.
- **Inputs**:
    - ``out1``: Pointer to a `uint64_t` where the result will be stored.
    - ``arg1``: A `fiat_25519x6_uint1` flag (0 or 1) that determines which value to select.
    - ``arg2``: A `uint64_t` value to select if `arg1` is 0.
    - ``arg3``: A `uint64_t` value to select if `arg1` is 1.
- **Logic and Control Flow**:
    - Convert `arg1` to a boolean value `x1` by negating it twice.
    - Compute `x2` as the bitwise AND of the negated `x1` and the maximum 64-bit unsigned integer value.
    - Compute `x3` as the bitwise OR of `x2` AND `arg3` with the bitwise NOT of `x2` AND `arg2`.
    - Store the result `x3` in the location pointed to by `out1`.
- **Output**: Stores the selected `uint64_t` value in the location pointed to by `out1`.


---
### fiat\_25519x6\_carry\_mul<!-- {{#callable:fiat_25519x6_carry_mul}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519x6_64.c#L176>)

Multiplies two field elements and reduces the result modulo a prime field.
- **Inputs**:
    - `out1`: A `fiat_25519x6_tight_field_element` array to store the result of the multiplication.
    - `arg1`: A `fiat_25519x6_loose_field_element` array representing the first operand.
    - `arg2`: A `fiat_25519x6_loose_field_element` array representing the second operand.
- **Logic and Control Flow**:
    - Initialize multiple `fiat_25519x6_uint128` variables to store intermediate multiplication results.
    - Perform pairwise multiplications of elements from `arg1` and `arg2`, applying specific constants (0x26, 0x13, or 0x2) to some terms to account for the field's structure.
    - Accumulate the results of these multiplications into several `fiat_25519x6_uint128` variables, representing different parts of the final product.
    - Reduce the accumulated results by shifting and masking to fit within the field's bounds, using constants like `UINT64_C(0x7ffffffffff)` and `UINT64_C(0x3ffffffffff)`.
    - Apply a final reduction step by multiplying the carry with a constant (0x13) and adding it to the least significant part of the result.
    - Store the reduced results into the `out1` array.
- **Output**: A `fiat_25519x6_tight_field_element` array containing the reduced product of `arg1` and `arg2`.


---
### fiat\_25519x6\_carry\_square<!-- {{#callable:fiat_25519x6_carry_square}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519x6_64.c#L326>)

Squares a field element and reduces the result modulo `2^255 - 19`.
- **Inputs**:
    - `out1`: A `fiat_25519x6_tight_field_element` array to store the result.
    - `arg1`: A `fiat_25519x6_loose_field_element` array representing the field element to square.
- **Logic and Control Flow**:
    - Calculate intermediate values by multiplying elements of `arg1` with constants and other elements, storing results in `fiat_25519x6_uint128` variables.
    - Perform a series of additions on these intermediate values to accumulate results into larger sums.
    - Shift and mask these sums to fit within specified bit-widths, propagating carries as needed.
    - Store the final reduced values into the `out1` array.
- **Output**: The function outputs the squared and reduced field element in the `out1` array.


---
### fiat\_25519x6\_carry\_scmul\_121666<!-- {{#callable:fiat_25519x6_carry_scmul_121666}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519x6_64.c#L466>)

Multiplies a field element by 121666 and reduces the result modulo a prime field.
- **Inputs**:
    - `out1`: A `fiat_25519x6_tight_field_element` array where the result is stored.
    - `arg1`: A `fiat_25519x6_loose_field_element` array representing the input field element to be multiplied.
- **Logic and Control Flow**:
    - Multiply each element of `arg1` by 121666, storing the results in temporary variables `x1` to `x6`.
    - Perform bitwise operations to handle carry propagation and reduction, ensuring each element fits within the specified bounds.
    - Store the reduced results into the `out1` array.
- **Output**: A `fiat_25519x6_tight_field_element` array containing the reduced result of the multiplication.


---
### fiat\_25519x6\_carry<!-- {{#callable:fiat_25519x6_carry}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519x6_64.c#L544>)

Reduces a loose field element to a tight field element by performing a series of bitwise operations and modular arithmetic.
- **Inputs**:
    - `out1`: A `fiat_25519x6_tight_field_element` array where the result is stored.
    - `arg1`: A `fiat_25519x6_loose_field_element` array representing the input field element to be reduced.
- **Logic and Control Flow**:
    - Assigns `arg1[0]` to `x1` and calculates `x2` as `x1` right-shifted by 43 bits plus `arg1[1]`.
    - Calculates `x3` as `x2` right-shifted by 42 bits plus `arg1[2]`, `x4` as `x3` right-shifted by 43 bits plus `arg1[3]`, `x5` as `x4` right-shifted by 42 bits plus `arg1[4]`, and `x6` as `x5` right-shifted by 43 bits plus `arg1[5]`.
    - Calculates `x7` as `x1` bitwise AND with `0x7ffffffffff` plus `x6` right-shifted by 42 bits multiplied by 19.
    - Calculates `x8` as `x7` right-shifted by 43 bits plus `x2` bitwise AND with `0x3ffffffffff`.
    - Calculates `x9` as `x7` bitwise AND with `0x7ffffffffff`, `x10` as `x8` bitwise AND with `0x3ffffffffff`, and `x11` as `x8` right-shifted by 42 bits plus `x3` bitwise AND with `0x7ffffffffff`.
    - Calculates `x12` as `x4` bitwise AND with `0x3ffffffffff`, `x13` as `x5` bitwise AND with `0x7ffffffffff`, and `x14` as `x6` bitwise AND with `0x3ffffffffff`.
    - Stores `x9`, `x10`, `x11`, `x12`, `x13`, and `x14` in `out1[0]` to `out1[5]` respectively.
- **Output**: A `fiat_25519x6_tight_field_element` array containing the reduced field element.


---
### fiat\_25519x6\_add<!-- {{#callable:fiat_25519x6_add}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519x6_64.c#L588>)

Adds two 25519x6 field elements and stores the result in a loose field element.
- **Inputs**:
    - `out1`: A `fiat_25519x6_loose_field_element` array where the result of the addition is stored.
    - `arg1`: A `fiat_25519x6_tight_field_element` array representing the first operand.
    - `arg2`: A `fiat_25519x6_tight_field_element` array representing the second operand.
- **Logic and Control Flow**:
    - Initialize six 64-bit unsigned integers `x1` to `x6` to store intermediate results.
    - Add corresponding elements of `arg1` and `arg2` and store the results in `x1` to `x6`.
    - Assign the results from `x1` to `x6` to the corresponding elements of `out1`.
- **Output**: The result of the addition is stored in the `out1` array as a `fiat_25519x6_loose_field_element`.


---
### fiat\_25519x6\_sub<!-- {{#callable:fiat_25519x6_sub}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519x6_64.c#L616>)

Subtracts two field elements with specific bounds and stores the result in a loose field element.
- **Inputs**:
    - `out1`: A `fiat_25519x6_loose_field_element` array where the result of the subtraction is stored.
    - `arg1`: A `fiat_25519x6_tight_field_element` array representing the minuend.
    - `arg2`: A `fiat_25519x6_tight_field_element` array representing the subtrahend.
- **Logic and Control Flow**:
    - Initialize six `uint64_t` variables `x1` to `x6` to store intermediate subtraction results.
    - For each element index from 0 to 5, compute the subtraction of `arg2[i]` from `arg1[i]` with an added constant to ensure non-negative results.
    - Store each result in the corresponding index of `out1`.
- **Output**: The result of the subtraction is stored in the `out1` array, which is a `fiat_25519x6_loose_field_element`.


---
### fiat\_25519x6\_opp<!-- {{#callable:fiat_25519x6_opp}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519x6_64.c#L644>)

Negates a field element by subtracting each component from a constant value.
- **Inputs**:
    - `out1`: A `fiat_25519x6_loose_field_element` array where the result is stored.
    - `arg1`: A `fiat_25519x6_tight_field_element` array representing the field element to negate.
- **Logic and Control Flow**:
    - Calculate `x1` as `0xfffffffffda - arg1[0]`.
    - Calculate `x2` as `0x7fffffffffe - arg1[1]`.
    - Calculate `x3` as `0xffffffffffe - arg1[2]`.
    - Calculate `x4` as `0x7fffffffffe - arg1[3]`.
    - Calculate `x5` as `0xffffffffffe - arg1[4]`.
    - Calculate `x6` as `0x7fffffffffe - arg1[5]`.
    - Store `x1` to `out1[0]`.
    - Store `x2` to `out1[1]`.
    - Store `x3` to `out1[2]`.
    - Store `x4` to `out1[3]`.
    - Store `x5` to `out1[4]`.
    - Store `x6` to `out1[5]`.
- **Output**: The negated field element is stored in the `out1` array.


---
### fiat\_25519x6\_selectznz<!-- {{#callable:fiat_25519x6_selectznz}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519x6_64.c#L678>)

Selects elements from two arrays based on a condition and stores the result in an output array.
- **Inputs**:
    - `out1`: An array of six `uint64_t` elements where the result will be stored.
    - `arg1`: A `fiat_25519x6_uint1` value that acts as a condition (0 or 1) for selection.
    - `arg2`: An array of six `uint64_t` elements, representing the first set of values to select from.
    - `arg3`: An array of six `uint64_t` elements, representing the second set of values to select from.
- **Logic and Control Flow**:
    - For each index from 0 to 5, call [`fiat_25519x6_cmovznz_u64`](<#fiat_25519x6_cmovznz_u64>) to select between `arg2` and `arg3` based on `arg1`.
    - Store the result of each selection in the corresponding index of `out1`.
- **Output**: An array `out1` containing six `uint64_t` elements, each selected from `arg2` or `arg3` based on the value of `arg1`.
- **Functions Called**:
    - [`fiat_25519x6_cmovznz_u64`](<#fiat_25519x6_cmovznz_u64>)


---
### fiat\_25519x6\_to\_bytes<!-- {{#callable:fiat_25519x6_to_bytes}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519x6_64.c#L708>)

Serializes a `fiat_25519x6_tight_field_element` into a 32-byte array in little-endian order.
- **Inputs**:
    - `out1`: A 32-byte array to store the serialized output.
    - `arg1`: A `fiat_25519x6_tight_field_element` representing the field element to serialize.
- **Logic and Control Flow**:
    - Subtracts constants from each element of `arg1` using [`fiat_25519x6_subborrowx_u43`](<#fiat_25519x6_subborrowx_u43>) and [`fiat_25519x6_subborrowx_u42`](<#fiat_25519x6_subborrowx_u42>) to ensure the values are within bounds.
    - Uses [`fiat_25519x6_cmovznz_u64`](<#fiat_25519x6_cmovznz_u64>) to conditionally move values based on the borrow flag.
    - Adds constants back to the results using [`fiat_25519x6_addcarryx_u43`](<#fiat_25519x6_addcarryx_u43>) and [`fiat_25519x6_addcarryx_u42`](<#fiat_25519x6_addcarryx_u42>) to finalize the field element values.
    - Shifts and masks the resulting values to extract individual bytes.
    - Stores the extracted bytes into the `out1` array in little-endian order.
- **Output**: A 32-byte array `out1` containing the serialized field element.
- **Functions Called**:
    - [`fiat_25519x6_subborrowx_u43`](<#fiat_25519x6_subborrowx_u43>)
    - [`fiat_25519x6_subborrowx_u42`](<#fiat_25519x6_subborrowx_u42>)
    - [`fiat_25519x6_cmovznz_u64`](<#fiat_25519x6_cmovznz_u64>)
    - [`fiat_25519x6_addcarryx_u43`](<#fiat_25519x6_addcarryx_u43>)
    - [`fiat_25519x6_addcarryx_u42`](<#fiat_25519x6_addcarryx_u42>)


---
### fiat\_25519x6\_from\_bytes<!-- {{#callable:fiat_25519x6_from_bytes}} -->
[View Source →](<../../../../../src/ballet/fiat-crypto/curve25519x6_64.c#L926>)

Deserializes a 32-byte array into a 6-element field element in little-endian order.
- **Inputs**:
    - `out1`: A `fiat_25519x6_tight_field_element` array where the deserialized field element will be stored.
    - `arg1`: A 32-byte array of type `uint8_t` representing the serialized field element in little-endian order.
- **Logic and Control Flow**:
    - Initialize multiple `uint64_t` variables to store intermediate results of bit-shifting and addition operations.
    - Extract and shift bits from the input byte array `arg1` to form 64-bit integers, each representing a part of the field element.
    - Combine these 64-bit integers using bitwise operations and addition to form the final field element components.
    - Store the results in the `out1` array, ensuring each element is within the specified bounds by applying bit masks.
- **Output**: A 6-element array of type `fiat_25519x6_tight_field_element` representing the deserialized field element.



---
Made with ❤️ by [Driver](https://www.driver.ai/)