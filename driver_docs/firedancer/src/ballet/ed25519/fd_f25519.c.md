<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Implements functions for arithmetic operations on the finite field F_25519, including exponentiation, inversion, and square root ratio computation.

# Purpose
The code provides mathematical operations over the finite field `F_25519`, which is commonly used in cryptographic applications. It includes functions for computing powers, inverses, and square roots within this field. The file conditionally includes different implementations of these operations based on the availability of AVX-512 instructions, which are used to optimize performance on compatible hardware. If AVX-512 is available, the code includes `fd_f25519.c` from the `avx512` directory; otherwise, it includes a reference implementation from the `ref` directory.

The key functions defined in this file are [`fd_f25519_pow22523`](<#fd_f25519_pow22523>), [`fd_f25519_inv`](<#fd_f25519_inv>), and [`fd_f25519_sqrt_ratio`](<#fd_f25519_sqrt_ratio>). The [`fd_f25519_pow22523`](<#fd_f25519_pow22523>) function computes the power of an element to `2^252-3`, which is a common operation in elliptic curve cryptography. The [`fd_f25519_inv`](<#fd_f25519_inv>) function calculates the multiplicative inverse of an element, and [`fd_f25519_sqrt_ratio`](<#fd_f25519_sqrt_ratio>) computes the square root of a ratio of two elements, returning a status code to indicate success or failure. These functions use helper functions like `fd_f25519_sqr` and `fd_f25519_mul` to perform basic arithmetic operations in the field. The code is structured to handle both the arithmetic and logical operations necessary for cryptographic computations, ensuring that the results are consistent with the properties of the field.
# Imports and Dependencies

---
- `fd_f25519.h`
- `../hex/fd_hex.h`
- `avx512/fd_f25519.c`
- `ref/fd_f25519.c`


# Functions

---
### fd\_f25519\_pow22523<!-- {{#callable:fd_f25519_pow22523}} -->
[View Source →](<../../../../../src/ballet/ed25519/fd_f25519.c#L11>)

Computes `r = a^(2^252-3)` using a series of squaring and multiplication operations.
- **Inputs**:
    - `r`: A pointer to an `fd_f25519_t` where the result will be stored.
    - `a`: A constant pointer to an `fd_f25519_t` representing the base of the exponentiation.
- **Logic and Control Flow**:
    - Initialize temporary variables `t0`, `t1`, and `t2` as arrays of `fd_f25519_t` with one element each.
    - Square `a` and store the result in `t0`.
    - Square `t0` and store the result in `t1`.
    - Perform additional squaring on `t1` in a loop to achieve `t1 = a^(2^2)`.
    - Multiply `t1` by `a` and store the result back in `t1`.
    - Multiply `t0` by `t1` and store the result in `t0`.
    - Square `t0` and multiply by `t1` to update `t0`.
    - Square `t0` and perform additional squaring in a loop to achieve `t1 = a^(2^5)`.
    - Multiply `t0` by `t1` and store the result in `t0`.
    - Square `t0` and perform additional squaring in a loop to achieve `t1 = a^(2^10)`.
    - Multiply `t1` by `t0` and store the result in `t1`.
    - Square `t1` and perform additional squaring in a loop to achieve `t2 = a^(2^20)`.
    - Multiply `t1` by `t2` and store the result in `t1`.
    - Square `t1` and perform additional squaring in a loop to achieve `t1 = a^(2^50)`.
    - Multiply `t0` by `t1` and store the result in `t0`.
    - Square `t0` and perform additional squaring in a loop to achieve `t1 = a^(2^100)`.
    - Multiply `t1` by `t0` and store the result in `t1`.
    - Square `t1` and perform additional squaring in a loop to achieve `t2 = a^(2^200)`.
    - Multiply `t1` by `t2` and store the result in `t1`.
    - Square `t1` and perform additional squaring in a loop to achieve `t1 = a^(2^250)`.
    - Multiply `t0` by `t1` and store the result in `t0`.
    - Square `t0` and perform additional squaring in a loop to achieve `t0 = a^(2^252)`.
    - Multiply `t0` by `a` to compute the final result `r = a^(2^252-3)`.
- **Output**: A pointer to `fd_f25519_t` containing the result of the computation `r = a^(2^252-3)`.
- **Functions Called**:
    - [`fd_f25519_mul`](<ref/fd_f25519.h.md#fd_f25519_mul>)


---
### fd\_f25519\_inv<!-- {{#callable:fd_f25519_inv}} -->
[View Source →](<../../../../../src/ballet/ed25519/fd_f25519.c#L62>)

Computes the modular inverse of a given element in the finite field defined by the prime 2^255 - 19.
- **Inputs**:
    - `r`: A pointer to an `fd_f25519_t` structure where the result will be stored.
    - `a`: A constant pointer to an `fd_f25519_t` structure representing the element to invert.
- **Logic and Control Flow**:
    - Initialize temporary variables `t0`, `t1`, `t2`, and `t3` to store intermediate results.
    - Compute `t0` as the square of `a`, resulting in `z**2`.
    - Compute `t1` as `z**8` by squaring `t0` twice and then multiply by `a` to get `z**9`.
    - Multiply `t0` by `t1` to store `z**11` for later use.
    - Compute `t2` as `z**22` by squaring `t0` and then multiply by `t1` to get `z**(2**5 - 1)`.
    - Square `t2` five times to get `z**((2**5) * (2**5 - 1))` and multiply by `t1` to get `z**(2**10 - 1)`.
    - Square `t2` ten times and multiply by `t1` to get `z**(2**20 - 1)`.
    - Square `t3` twenty times and multiply by `t2` to get `z**(2**40 - 1)`.
    - Square `t2` ten times and multiply by `t1` to get `z**(2**50 - 1)`.
    - Square `t2` fifty times and multiply by `t1` to get `z**(2**100 - 1)`.
    - Square `t3` one hundred times and multiply by `t2` to get `z**(2**200 - 1)`.
    - Square `t2` fifty times and multiply by `t1` to get `z**(2**250 - 1)`.
    - Square `t1` five times and multiply by `t0` to get the final result `z**(2**255 - 21)`.
- **Output**: A pointer to the `fd_f25519_t` structure `r` containing the result of the inversion.
- **Functions Called**:
    - [`fd_f25519_mul`](<ref/fd_f25519.h.md#fd_f25519_mul>)


---
### fd\_f25519\_sqrt\_ratio<!-- {{#callable:fd_f25519_sqrt_ratio}} -->
[View Source →](<../../../../../src/ballet/ed25519/fd_f25519.c#L107>)

Computes the square root ratio of two field elements in the finite field defined by the prime 2^255-19, returning 0 on success and 1 on failure.
- **Inputs**:
    - `r`: A pointer to an `fd_f25519_t` where the result will be stored.
    - `u`: A pointer to a constant `fd_f25519_t` representing the numerator of the ratio.
    - `v`: A pointer to a constant `fd_f25519_t` representing the denominator of the ratio.
- **Logic and Control Flow**:
    - Compute `v^2`, `v^3`, `u*v^3`, `v^6`, `v^7`, and `u*v^7` using field multiplication and squaring.
    - Raise `u*v^7` to the power of (2^252-3) using [`fd_f25519_pow22523`](<#fd_f25519_pow22523>) and store the result in `r`.
    - Multiply the result by `u*v^3` to compute the final value of `r`.
    - Compute `check` as `v * r^2` to verify the result.
    - Calculate `u_neg` as the negation of `u` and `u_neg_sqrtm1` as `u_neg` multiplied by `SQRT_M1`.
    - Determine if `check` equals `u`, `u_neg`, or `u_neg_sqrtm1` to set flags `correct_sign_sqrt`, `flipped_sign_sqrt`, and `flipped_sign_sqrt_i`.
    - Compute `r_prime` as `SQRT_M1 * r`.
    - Select `r_prime` or `r` based on the flags `flipped_sign_sqrt` and `flipped_sign_sqrt_i` using `fd_f25519_if`.
    - Take the absolute value of `r` using `fd_f25519_abs`.
    - Return the logical OR of `correct_sign_sqrt` and `flipped_sign_sqrt` to indicate success or failure.
- **Output**: Returns 0 if the computation is successful and 1 if it fails.
- **Functions Called**:
    - [`fd_f25519_mul`](<ref/fd_f25519.h.md#fd_f25519_mul>)
    - [`fd_f25519_pow22523`](<#fd_f25519_pow22523>)
    - [`fd_f25519_eq`](<fd_f25519.h.md#fd_f25519_eq>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)