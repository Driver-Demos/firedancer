<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Public API for Curve25519 operations, including point addition, multiplication, and serialization.

# Purpose
The `fd_curve25519.h` file provides a public API for operations on the Curve25519 elliptic curve, which is commonly used in cryptographic applications. This header file defines a set of functions and constants for performing various mathematical operations on points on the Curve25519 curve, such as addition, subtraction, doubling, and scalar multiplication. It also includes functions for point serialization and deserialization, as well as validation of points and scalars. The file supports both affine and projective coordinates and includes optimizations for constant-time operations to enhance security when handling secret data.

The file conditionally includes architecture-specific implementations based on the availability of AVX512 instructions, which can optimize performance on compatible hardware. It defines several constants and tables used for precomputation to speed up repeated operations. The API is designed to be used in cryptographic protocols, providing both basic operations and more complex multi-scalar multiplications. The header file is intended to be included in other C source files that require Curve25519 functionality, and it defines public interfaces for these operations, making it a crucial component for developers implementing cryptographic systems using Curve25519.
# Imports and Dependencies

---
- `avx512/fd_curve25519.h`
- `ref/fd_curve25519.h`


# Global Variables

---
### fd\_ed25519\_base\_point
- **Type**: ``fd_ed25519_point_t` array`
- **Description**: A static constant array of type `fd_ed25519_point_t` with a single element. It represents the base point used in Ed25519 elliptic curve operations.
- **Use**: Used as the base point for scalar multiplication and other elliptic curve operations in the Ed25519 cryptographic algorithm.


---
### fd\_ed25519\_base\_point\_wnaf\_table
- **Type**: ``fd_ed25519_point_t[128]``
- **Description**: An array of 128 `fd_ed25519_point_t` elements, representing precomputed points for the Ed25519 base point using the windowed non-adjacent form (wNAF) method. This table is used to optimize scalar multiplication operations by allowing faster computation through precomputation.
- **Use**: Used to optimize scalar multiplication operations involving the Ed25519 base point by leveraging precomputed points.


---
### fd\_ed25519\_base\_point\_const\_time\_table
- **Type**: ``fd_ed25519_point_t[32][8]``
- **Description**: A static constant array of `fd_ed25519_point_t` structures, organized in a 32 by 8 matrix. This array is used to store precomputed values of the Ed25519 base point for constant-time operations.
- **Use**: Used in cryptographic operations to ensure constant-time execution when performing scalar multiplications with the Ed25519 base point.


# Functions

---
### fd\_ed25519\_affine\_is\_small\_order<!-- {{#callable:fd_ed25519_affine_is_small_order}} -->
[View Source →](<../../../../../src/ballet/ed25519/fd_curve25519.h#L88>)

Checks if an Ed25519 point has a small order (order <= 8).
- **Inputs**:
    - `a`: A pointer to a constant `fd_ed25519_point_t` structure representing the point to check.
- **Logic and Control Flow**:
    - Declare variables `x`, `y`, `z`, and `t` of type `fd_f25519_t` to hold the coordinates of the point.
    - Convert the point `a` into its coordinates `x`, `y`, `z`, and `t` using [`fd_ed25519_point_to`](<avx512/fd_curve25519.h.md#fd_ed25519_point_to>).
    - Check if `x` is zero using `fd_f25519_is_zero(x)`.
    - Check if `y` is zero using `fd_f25519_is_zero(y)`.
    - Check if `y` is equal to `fd_ed25519_order8_point_y0` using `fd_f25519_eq(y, fd_ed25519_order8_point_y0)`.
    - Check if `y` is equal to `fd_ed25519_order8_point_y1` using `fd_f25519_eq(y, fd_ed25519_order8_point_y1)`.
    - Return the logical OR of the results of the above checks.
- **Output**: Returns 1 if the point has a small order (order <= 8), otherwise returns 0.
- **Functions Called**:
    - [`fd_ed25519_point_to`](<avx512/fd_curve25519.h.md#fd_ed25519_point_to>)


---
### fd\_ed25519\_scalar\_validate<!-- {{#callable:fd_ed25519_scalar_validate}} -->
[View Source →](<../../../../../src/ballet/ed25519/fd_curve25519.h#L136>)

Validates whether a given 32-byte Ed25519 scalar is in its canonical byte representation.
- **Inputs**:
    - `n`: A 32-byte array representing the Ed25519 scalar to validate.
- **Logic and Control Flow**:
    - Calls the function `fd_curve25519_scalar_validate` with the input `n`.
- **Output**: Returns a pointer to the scalar `n` if it is in canonical form, or `NULL` if it is not.


---
### fd\_ed25519\_point\_validate<!-- {{#callable:fd_ed25519_point_validate}} -->
[View Source →](<../../../../../src/ballet/ed25519/fd_curve25519.h#L203>)

Validates if a 32-byte buffer represents a valid compressed Ed25519 point by attempting to decompress it.
- **Inputs**:
    - `buf`: A 32-byte buffer in little-endian form that potentially represents a compressed Ed25519 point.
- **Logic and Control Flow**:
    - Declare a variable `t` of type `fd_ed25519_point_t` to store the decompressed point.
    - Call the function [`fd_ed25519_point_frombytes`](<fd_curve25519.c.md#fd_ed25519_point_frombytes>) with `t` and `buf` as arguments to attempt decompression.
    - Return the result of the decompression attempt as a boolean value, where a non-zero result indicates success.
- **Output**: Returns 1 if `buf` represents a valid compressed point, otherwise returns 0.
- **Functions Called**:
    - [`fd_ed25519_point_frombytes`](<fd_curve25519.c.md#fd_ed25519_point_frombytes>)


---
### fd\_ed25519\_affine\_tobytes<!-- {{#callable:fd_ed25519_affine_tobytes}} -->
[View Source →](<../../../../../src/ballet/ed25519/fd_curve25519.h#L221>)

Serializes an affine Ed25519 point into a 32-byte buffer in little-endian form.
- **Inputs**:
    - `out`: A 32-byte buffer where the serialized point will be stored.
    - `a`: A pointer to an affine Ed25519 point to be serialized.
- **Logic and Control Flow**:
    - Declare temporary variables `x`, `y`, `z`, and `t` of type `fd_f25519_t` to hold the coordinates of the point.
    - Call [`fd_ed25519_point_to`](<avx512/fd_curve25519.h.md#fd_ed25519_point_to>) to extract the coordinates `x`, `y`, `z`, and `t` from the point `a`.
    - Serialize the `y` coordinate into the `out` buffer using `fd_f25519_tobytes`.
    - Modify the last byte of `out` by XORing it with the sign bit of `x`, shifted left by 7 bits, using `fd_f25519_sgn`.
    - Return the `out` buffer.
- **Output**: A pointer to the 32-byte buffer `out` containing the serialized point.
- **Functions Called**:
    - [`fd_ed25519_point_to`](<avx512/fd_curve25519.h.md#fd_ed25519_point_to>)


# Function Declarations (Public API)

---
### fd\_ed25519\_scalar\_mul<!-- {{#callable_declaration:fd_ed25519_scalar_mul}} -->
[View Source →](<../../../../../src/ballet/ed25519/fd_curve25519.h#L143>)

Computes the scalar multiplication of a point on the Ed25519 curve.
- **Description**: Use this function to perform scalar multiplication of a point on the Ed25519 curve, which is a common operation in elliptic curve cryptography. This function multiplies a given point by a scalar and stores the result in the provided output point. Ensure that the input scalar is a 32-byte array and the input point is valid. The function does not perform constant-time operations, so it should not be used with secret data.
- **Inputs**:
    - `r`: A pointer to an `fd_ed25519_point_t` structure where the result will be stored. The caller must allocate this structure before calling the function. The function returns this pointer.
    - `n`: A 32-byte array representing the scalar by which the point will be multiplied. The array must be in little-endian format. The function does not modify this array.
    - `a`: A pointer to a constant `fd_ed25519_point_t` structure representing the point to be multiplied. The function does not modify this point.
- **Output**: Returns a pointer to the `fd_ed25519_point_t` structure containing the result of the multiplication, which is the same as the input parameter `r`.
- **See Also**: [`fd_ed25519_scalar_mul`](<fd_curve25519.c.md#fd_ed25519_scalar_mul>)  (Implementation)


---
### fd\_ed25519\_double\_scalar\_mul\_base<!-- {{#callable_declaration:fd_ed25519_double_scalar_mul_base}} -->
[View Source →](<../../../../../src/ballet/ed25519/fd_curve25519.h#L157>)

Computes a double scalar multiplication on the Ed25519 curve.
- **Description**: Use this function to compute the double scalar multiplication of two scalars and a point on the Ed25519 curve, with one of the scalars multiplied by the base point. This operation is useful in cryptographic protocols that require such computations. Ensure that the input scalars are in canonical form and the point is valid. The function modifies the point `r` to store the result.
- **Inputs**:
    - `r`: A pointer to an `fd_ed25519_point_t` structure where the result will be stored. Must not be null. The caller retains ownership.
    - `n1`: A 32-byte array representing the first scalar. Must be in canonical form. The function does not modify this array.
    - `a`: A pointer to a constant `fd_ed25519_point_t` structure representing the point to be multiplied by `n1`. Must not be null. The caller retains ownership.
    - `n2`: A 32-byte array representing the second scalar. Must be in canonical form. The function does not modify this array.
- **Output**: Returns a pointer to the `fd_ed25519_point_t` structure `r`, which contains the result of the computation.
- **See Also**: [`fd_ed25519_double_scalar_mul_base`](<fd_curve25519.c.md#fd_ed25519_double_scalar_mul_base>)  (Implementation)


---
### fd\_ed25519\_multi\_scalar\_mul<!-- {{#callable_declaration:fd_ed25519_multi_scalar_mul}} -->
[View Source →](<../../../../../src/ballet/ed25519/fd_curve25519.h#L165>)

Computes a multi-scalar multiplication of Ed25519 points.
- **Description**: Use this function to compute the sum of multiple scalar multiplications of Ed25519 points. It takes a vector of scalars and a vector of points, and computes the result as the sum of each scalar multiplied by its corresponding point. The function initializes the result point to zero before performing the operations. Ensure that the size of the scalar vector is `sz * 32` and matches the size of the point vector. This function is not constant time and should not be used with secret data.
- **Inputs**:
    - `r`: A pointer to an `fd_ed25519_point_t` where the result will be stored. Must not be null. The function initializes this point to zero before computation.
    - `n`: A constant pointer to an array of unsigned characters representing the scalars. The array size must be `sz * 32`. Each scalar is 32 bytes long. The caller retains ownership.
    - `a`: A constant pointer to an array of `fd_ed25519_point_t` representing the points. The array size must be `sz`. The caller retains ownership.
    - `sz`: An unsigned long representing the number of scalars and points. Must be non-negative and should match the size of the arrays `n` and `a`.
- **Output**: Returns a pointer to the result `fd_ed25519_point_t` which is also the input `r`. The result is the sum of the scalar multiplications.
- **See Also**: [`fd_ed25519_multi_scalar_mul`](<fd_curve25519.c.md#fd_ed25519_multi_scalar_mul>)  (Implementation)


---
### fd\_ed25519\_multi\_scalar\_mul\_base<!-- {{#callable_declaration:fd_ed25519_multi_scalar_mul_base}} -->
[View Source →](<../../../../../src/ballet/ed25519/fd_curve25519.h#L174>)

Computes a multi-scalar multiplication using the base point.
- **Description**: Use this function to compute a multi-scalar multiplication where the first point is replaced by the base point. This function is useful when you need to perform operations involving multiple scalars and points, with the first point being the base point. Ensure that the size of the input arrays does not exceed the maximum batch size defined by `FD_BALLET_CURVE25519_MSM_BATCH_SZ`. If the size exceeds this limit, the function returns `NULL`.
- **Inputs**:
    - `r`: A pointer to an `fd_ed25519_point_t` where the result will be stored. Must not be null.
    - `n`: An array of scalars, each 32 bytes in size. The array must have a length of `sz * 32`. The caller retains ownership.
    - `a`: An array of `fd_ed25519_point_t` points. The array must have a length of `sz`. The caller retains ownership.
    - `sz`: The number of scalars and points in the arrays `n` and `a`. Must not exceed `FD_BALLET_CURVE25519_MSM_BATCH_SZ`.
- **Output**: Returns a pointer to `fd_ed25519_point_t` containing the result, or `NULL` if `sz` exceeds the maximum batch size.
- **See Also**: [`fd_ed25519_multi_scalar_mul_base`](<fd_curve25519.c.md#fd_ed25519_multi_scalar_mul_base>)  (Implementation)


---
### fd\_ed25519\_point\_frombytes<!-- {{#callable_declaration:fd_ed25519_point_frombytes}} -->
[View Source →](<../../../../../src/ballet/ed25519/fd_curve25519.h#L184>)

Deserializes a 32-byte buffer into an Ed25519 point.
- **Description**: Use this function to convert a 32-byte buffer, formatted in little-endian according to RFC 8032, into an Ed25519 point. This function is useful when you need to interpret serialized point data as an Ed25519 point. It returns the point on success or NULL if the buffer does not represent a valid point. Ensure that the buffer contains valid data before calling this function to avoid errors.
- **Inputs**:
    - `r`: A pointer to an `fd_ed25519_point_t` where the deserialized point will be stored. The caller must allocate this memory before calling the function. The function will modify the contents of this pointer.
    - `buf`: A constant 32-byte array containing the serialized point data in little-endian format. The data must conform to the expected format as per RFC 8032. The function does not modify this buffer.
- **Output**: Returns a pointer to `r` if the deserialization is successful, or NULL if the buffer does not represent a valid point.
- **See Also**: [`fd_ed25519_point_frombytes`](<fd_curve25519.c.md#fd_ed25519_point_frombytes>)  (Implementation)


---
### fd\_ed25519\_point\_tobytes<!-- {{#callable_declaration:fd_ed25519_point_tobytes}} -->
[View Source →](<../../../../../src/ballet/ed25519/fd_curve25519.h#L212>)

Serializes an Ed25519 point into a 32-byte buffer.
- **Description**: Use this function to convert an Ed25519 point into its 32-byte serialized form, which is in little-endian format as specified by RFC 8032. This function is useful when you need to store or transmit the point in a compact form. Ensure that the output buffer is allocated with at least 32 bytes before calling this function. The function modifies the output buffer directly and returns a pointer to it.
- **Inputs**:
    - `out`: A buffer of at least 32 bytes where the serialized point will be stored. The caller must ensure this buffer is properly allocated before calling the function.
    - `a`: A pointer to the `fd_ed25519_point_t` structure representing the point to serialize. This pointer must not be null.
- **Output**: Returns a pointer to the `out` buffer containing the serialized point.
- **See Also**: [`fd_ed25519_point_tobytes`](<fd_curve25519.c.md#fd_ed25519_point_tobytes>)  (Implementation)


---
### fd\_curve25519\_affine\_add<!-- {{#callable_declaration:fd_curve25519_affine_add}} -->
[View Source →](<../../../../../src/ballet/ed25519/fd_curve25519.h#L248>)

Adds two Ed25519 points and converts the result to affine coordinates.
- **Description**: Use this function to add two Ed25519 points and convert the result into affine coordinates. This function is useful when you need the result in affine form for further processing or storage. Ensure that the input points are valid Ed25519 points. The function does not handle null pointers, so all input pointers must be valid and non-null. The result is stored in the location pointed to by the first parameter.
- **Inputs**:
    - `r`: A pointer to an `fd_ed25519_point_t` where the result will be stored. Must not be null. Caller retains ownership.
    - `a`: A pointer to a constant `fd_ed25519_point_t` representing the first point to add. Must not be null. Caller retains ownership.
    - `b`: A pointer to a constant `fd_ed25519_point_t` representing the second point to add. Must not be null. Caller retains ownership.
- **Output**: Returns a pointer to `fd_ed25519_point_t` containing the result in affine coordinates.
- **See Also**: [`fd_curve25519_affine_add`](<fd_curve25519.c.md#fd_curve25519_affine_add>)  (Implementation)


---
### fd\_curve25519\_affine\_dbln<!-- {{#callable_declaration:fd_curve25519_affine_dbln}} -->
[View Source →](<../../../../../src/ballet/ed25519/fd_curve25519.h#L253>)

Doubles an Ed25519 point n times and converts it to affine coordinates.
- **Description**: Use this function to compute the result of doubling an Ed25519 point `a` a specified number of times `n`, and then convert the result into affine coordinates. This function is useful when you need the affine representation of a point after multiple doublings. Ensure that the input point `a` is valid and that `r` is a valid pointer to store the result. The function does not handle secret data securely, so avoid using it with sensitive information.
- **Inputs**:
    - `r`: A pointer to an `fd_ed25519_point_t` structure where the result will be stored. Must not be null. The caller retains ownership.
    - `a`: A constant pointer to an `fd_ed25519_point_t` structure representing the point to be doubled. Must not be null. The caller retains ownership.
    - `n`: An integer specifying the number of times to double the point `a`. There are no explicit constraints on the value of `n`, but it should be non-negative.
- **Output**: Returns a pointer to the `fd_ed25519_point_t` structure `r`, which contains the result in affine coordinates.
- **See Also**: [`fd_curve25519_affine_dbln`](<fd_curve25519.c.md#fd_curve25519_affine_dbln>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)