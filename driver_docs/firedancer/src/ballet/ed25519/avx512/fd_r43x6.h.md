<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines a GF(p) element representation using AVX-512 for arithmetic operations in the field 2^255-19.

# Purpose
The code defines a C header file for operations on elements of the finite field GF(p), where p = 2^255 - 19, using AVX-512 vector instructions. It represents these elements in a 6-limb radix 2^43 format, stored in the first six lanes of an AVX-512 vector. The file provides a variety of functions and macros for arithmetic operations such as addition, subtraction, multiplication, and inversion, as well as utility functions for conditionally swapping values and checking for non-zero elements. The operations are optimized for high performance by leveraging AVX-512 instructions, particularly the `madd52` instruction for efficient multiplication.

The file includes functions for converting between different representations of field elements, such as arbitrary, signed, unsigned, and reduced forms, to facilitate efficient computation and interfacing with cryptographic protocols. It also provides macros for constructing and extracting field elements, as well as for performing carry propagation and modular reduction. The code is designed to be used in high-performance computing (HPC) applications, particularly those involving cryptographic computations, and assumes the presence of AVX-512 support. The header file does not define a public API but rather provides internal utilities for use in other parts of a larger cryptographic library.
# Imports and Dependencies

---
- `../../../util/simd/fd_avx.h`
- `../../../util/simd/fd_avx512.h`
- `fd_r43x6_inl.h`


# Functions

---
### fd\_r43x6\_unpack<!-- {{#callable:fd_r43x6_unpack}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_r43x6.h#L165>)

Converts a 256-bit unsigned integer stored in an AVX-2 vector into an unpacked `fd_r43x6_t` representation.
- **Inputs**:
    - `u`: A 256-bit unsigned integer stored in a little-endian 4 ulong radix 2^64 limb representation held in an AVX-2 vector.
- **Logic and Control Flow**:
    - Initialize a zero vector `wwl_t const zero` and a permutation vector `wwl_t const perm` to rearrange bits for unpacking.
    - Define a right shift vector `wwl_t const rshift` to align bits correctly after permutation.
    - Create a mask `wwl_t const mask` to retain only the 43 least significant bits for each lane.
    - Insert the input vector `u` into the zero vector at position 0 using `_mm512_inserti64x4`.
    - Permute the bits of the inserted vector using `_mm512_permutexvar_epi8` with the permutation vector `perm`.
    - Right shift the permuted vector using `wwl_shru_vector` with the shift vector `rshift`.
    - Apply the mask using `wwl_and` to retain only the desired bits in each lane.
    - Return the resulting `fd_r43x6_t` vector.
- **Output**: An unpacked `fd_r43x6_t` vector with lanes 0-5 containing the unpacked limbs and lanes 6-7 set to zero.


---
### fd\_r43x6\_pack<!-- {{#callable:fd_r43x6_pack}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_r43x6.h#L186>)

Packs a `fd_r43x6_t` element into a `wv_t` by combining and shifting its limbs.
- **Inputs**:
    - `r`: A `fd_r43x6_t` element representing a GF(p) element in a 6-limb radix 2^43 format.
- **Logic and Control Flow**:
    - Permutes and shifts the limbs of `r` to create three temporary vectors `t0`, `t1`, and `t2`.
    - `t0` is created by right-shifting the permuted vector of `r` by specific amounts.
    - `t1` and `t2` are created by left-shifting the permuted vectors of `r` by specific amounts.
    - Combines `t0`, `t1`, and `t2` using bitwise OR operations.
    - Extracts the lower 256 bits from the combined vector to form the final packed `wv_t`.
- **Output**: Returns a `wv_t` representing the packed form of the input `fd_r43x6_t`.


---
### fd\_r43x6\_approx\_mod<!-- {{#callable:fd_r43x6_approx_mod}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_r43x6.h#L586>)

Reduces an arbitrary `fd_r43x6_t` to a nearly reduced form using approximate and biased carry propagation.
- **Inputs**:
    - `x`: An `fd_r43x6_t` representing a GF(p) element in a little-endian 6 long radix 2^43 limb representation.
- **Logic and Control Flow**:
    - Extracts the limbs of `x` into variables `y0` to `y5` using `fd_r43x6_extract_limbs`.
    - Performs an approximate carry propagation on the extracted limbs using `fd_r43x6_approx_carry_propagate_limbs` to reduce the range of the limbs.
    - Applies a biased carry propagation with a bias of 1 using `fd_r43x6_biased_carry_propagate_limbs` to ensure the limbs are in a suitable range for further operations.
    - Returns a new `fd_r43x6_t` constructed from the modified limbs `y0` to `y5`.
- **Output**: A nearly reduced `fd_r43x6_t` with the limbs adjusted to be within specific ranges suitable for further operations.


---
### fd\_r43x6\_approx\_mod\_signed<!-- {{#callable:fd_r43x6_approx_mod_signed}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_r43x6.h#L612>)

Approximates a nearly reduced form of a signed `fd_r43x6_t` element by performing a biased carry propagation.
- **Inputs**:
    - `x`: A signed `fd_r43x6_t` element with limbs in specific ranges: `x0` in [-2^63+19*2^23, 2^63-19*(2^23-1)), `x1-x4` in [-2^63+2^20, 2^63-(2^20-1)), and `x5` in [-2^63+2^20, 2^63).
- **Logic and Control Flow**:
    - Extracts the limbs of `x` into `y0` to `y5` using `fd_r43x6_extract_limbs` macro.
    - Performs a biased carry propagation on the extracted limbs using `fd_r43x6_biased_carry_propagate_limbs` with a bias of `2^20`.
    - Constructs and returns a new `fd_r43x6_t` element from the modified limbs `y0` to `y5`.
- **Output**: Returns a nearly reduced `fd_r43x6_t` element with the same value as the input but in a form suitable for further operations.


---
### fd\_r43x6\_approx\_mod\_unsigned<!-- {{#callable:fd_r43x6_approx_mod_unsigned}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_r43x6.h#L631>)

Approximates the modular reduction of an unsigned `fd_r43x6_t` element to a nearly reduced form.
- **Inputs**:
    - `x`: An `fd_r43x6_t` element representing a GF(p) element in a little-endian 6 long radix 2^43 limb representation, where each limb is in a specific range for unsigned values.
- **Logic and Control Flow**:
    - Extracts the limbs of `x` into six long variables `y0` to `y5` using `fd_r43x6_extract_limbs` macro.
    - Performs an unbiased carry propagation on the extracted limbs using `fd_r43x6_biased_carry_propagate_limbs` with a bias of 0.
    - Reconstructs and returns a new `fd_r43x6_t` element from the modified limbs `y0` to `y5`.
- **Output**: Returns a nearly reduced `fd_r43x6_t` element with the last limb `y5` in the range [0, 2^40 + 2^20 - 1).


---
### fd\_r43x6\_mod<!-- {{#callable:fd_r43x6_mod}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_r43x6.h#L673>)

Reduces an arbitrary `fd_r43x6_t` to a reduced form in the finite field GF(p) where p = 2^255-19.
- **Inputs**:
    - `x`: An `fd_r43x6_t` representing a GF(p) element in a little-endian 6 long radix 2^43 limb representation.
- **Logic and Control Flow**:
    - Extracts the limbs of `x` into variables `y0` to `y5` using `fd_r43x6_extract_limbs`.
    - Applies approximate carry propagation on the limbs using `fd_r43x6_approx_carry_propagate_limbs` to reduce the range of the limbs.
    - Performs biased carry propagation with a bias of 1 using `fd_r43x6_biased_carry_propagate_limbs` to further reduce the limbs.
    - Reduces the nearly reduced limbs to a fully reduced form using `fd_r43x6_mod_nearly_reduced_limbs`.
    - Constructs and returns a new `fd_r43x6_t` from the reduced limbs `y0` to `y5`.
- **Output**: A reduced `fd_r43x6_t` representing the same GF(p) element as the input `x`, but in a reduced form.


---
### fd\_r43x6\_mod\_signed<!-- {{#callable:fd_r43x6_mod_signed}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_r43x6.h#L684>)

Reduces a signed `fd_r43x6_t` element to its canonical form in the field GF(p) where p = 2^255-19.
- **Inputs**:
    - `x`: A signed `fd_r43x6_t` element to be reduced.
- **Logic and Control Flow**:
    - Extracts the limbs of `x` into variables `y0` to `y5`.
    - Applies a biased carry propagation to the limbs with a bias of `1L<<20` to ensure the limbs are nearly reduced.
    - Further reduces the nearly reduced limbs to their canonical form using `fd_r43x6_mod_nearly_reduced_limbs`.
    - Reconstructs and returns the reduced `fd_r43x6_t` from the processed limbs `y0` to `y5`.
- **Output**: A reduced `fd_r43x6_t` element in the field GF(p).


---
### fd\_r43x6\_mod\_unsigned<!-- {{#callable:fd_r43x6_mod_unsigned}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_r43x6.h#L694>)

Reduces an unsigned `fd_r43x6_t` element to its canonical form in the finite field GF(p) where p = 2^255-19.
- **Inputs**:
    - `x`: An `fd_r43x6_t` element representing a GF(p) element in a little-endian 6 long radix 2^43 limb representation.
- **Logic and Control Flow**:
    - Extracts the limbs of `x` into variables `y0` to `y5` using `fd_r43x6_extract_limbs`.
    - Applies `fd_r43x6_biased_carry_propagate_limbs` to propagate carries and adjust the limb values, ensuring the result is nearly reduced.
    - Further reduces the nearly reduced limbs using `fd_r43x6_mod_nearly_reduced_limbs` to ensure the result is in its canonical form.
    - Constructs and returns a new `fd_r43x6_t` element from the reduced limbs `y0` to `y5`.
- **Output**: A reduced `fd_r43x6_t` element representing the canonical form of the input in GF(p).


---
### fd\_r43x6\_mod\_nearly\_reduced<!-- {{#callable:fd_r43x6_mod_nearly_reduced}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_r43x6.h#L707>)

Reduces a nearly reduced `fd_r43x6_t` element to a reduced form.
- **Inputs**:
    - `x`: A nearly reduced `fd_r43x6_t` element to be reduced.
- **Logic and Control Flow**:
    - Declare variables `y0`, `y1`, `y2`, `y3`, `y4`, `y5` to store the limbs of `x`.
    - Extract the limbs of `x` into `y0`, `y1`, `y2`, `y3`, `y4`, `y5` using `fd_r43x6_extract_limbs`.
    - Call `fd_r43x6_mod_nearly_reduced_limbs` to reduce the limbs `y0`, `y1`, `y2`, `y3`, `y4`, `y5`.
    - Return a new `fd_r43x6_t` constructed from the reduced limbs `y0`, `y1`, `y2`, `y3`, `y4`, `y5`.
- **Output**: A reduced `fd_r43x6_t` element.


---
### fd\_r43x6\_mul\_fast<!-- {{#callable:fd_r43x6_mul_fast}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_r43x6.h#L753>)

Performs a fast multiplication of two unreduced `fd_r43x6_t` elements using AVX512 instructions.
- **Inputs**:
    - `x`: An unreduced `fd_r43x6_t` element, with lanes 0 to 5 containing the data and lanes 6 and 7 ignored.
    - `y`: An unreduced `fd_r43x6_t` element, with lanes 0 to 5 containing the data and lanes 6 and 7 set to zero.
- **Logic and Control Flow**:
    - Initialize `zero` as a zero vector.
    - Permute `x` into six vectors `x0` to `x5` using `wwl_permute` with different indices.
    - Compute intermediate products `t0` to `t6` using `wwl_madd52lo` and `wwl_madd52hi`, shifting the high parts by 9 bits.
    - Slide and combine these products into `p0j` to `p6j` and `q3j` to `q6j` using `wwl_slide`.
    - Sum the products to form `zl` and `zh` using `wwl_add`.
    - Mask and slide `zl` and `zh` to form `za` and `zb`.
    - Compute the final result by adding `za` and shifted versions of `zb` using `wwl_add` and `wwl_shl`.
- **Output**: Returns an unsigned `fd_r43x6_t` result with lanes 6 and 7 set to zero, representing the product of `x` and `y`.


---
### fd\_r43x6\_sqr\_fast<!-- {{#callable:fd_r43x6_sqr_fast}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_r43x6.h#L949>)

Computes the square of an unreduced `fd_r43x6_t` element using AVX-512 vector operations, optimizing for minimal shuffling and efficient lane usage.
- **Inputs**:
    - `x`: An `fd_r43x6_t` element representing a GF(p) element in a little-endian 6 long radix 2^43 limb representation, with lanes 6 and 7 ignored.
- **Logic and Control Flow**:
    - Initialize `zero` as a constant zero vector.
    - Permute the input `x` into six vectors `x0` to `x5` to align elements for multiplication.
    - Double the non-square terms in `x0`, `x2`, and `x4` using bitwise shifts.
    - Compute the low parts of the products `p0l`, `p1l`, and `p2l` using `wwl_madd52lo`.
    - Compute the high parts of the products `p0h`, `p1h`, and `p2h` using `wwl_madd52hi` and shift them left by 9 bits.
    - Use masks `mask1` and `mask2` to separate terms into high and low results, `zll`, `zlh`, `zhl`, and `zhh`.
    - Combine the results into `zl` and `zh` using `wwl_add` and `wwl_slide`.
    - Mask and slide `zl` and `zh` to compute `za` and `zb`.
    - Return the final result by combining `za` and `zb` with bitwise shifts and additions.
- **Output**: Returns an `fd_r43x6_t` element representing the square of the input, with lanes 6 and 7 set to zero.


---
### fd\_r43x6\_scale\_fast<!-- {{#callable:fd_r43x6_scale_fast}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_r43x6.h#L1032>)

Computes the product of a scalar and an unreduced `fd_r43x6_t` element, optimizing for zero values.
- **Inputs**:
    - `_x0`: A long integer representing the scalar value to multiply, expected to be in the range [0, 2^47).
    - `y`: An `fd_r43x6_t` type representing an unreduced element, with lanes 6 and 7 assumed to be zero.
- **Logic and Control Flow**:
    - Initialize a zero vector `wwl_t const zero` using `wwl_zero()`.
    - Broadcast the scalar `_x0` to all lanes of a vector `x0` using `wwl_bcast(_x0)`.
    - Compute the low part of the product using `wwl_madd52lo(zero, x0, y)` and store it in `t0`.
    - Compute the high part of the product, shift it left by 9 bits, and store it in `t1` using `wwl_shl(wwl_madd52hi(zero, x0, y), 9)`.
    - Slide `t1` by 7 lanes to align it with `t0` and store the result in `p1j`.
    - Add `p0j` and `p1j` to get `zl`.
    - Mask `zl` to keep only the first 6 lanes and store the result in `za`.
    - Slide `zl` by 6 lanes to align with zero and store the result in `zb`.
    - Add `za` and `zb` shifted by 7, 4, and 3 bits to compute the final result.
- **Output**: Returns an `fd_r43x6_t` representing the scaled product, with lanes 6 and 7 set to zero, and the result fitting within a 59-bit unsigned integer range.


---
### fd\_r43x6\_is\_nonzero<!-- {{#callable:fd_r43x6_is_nonzero}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_r43x6.h#L1108>)

Determines if a given signed `fd_r43x6_t` element is non-zero by reducing it and checking its limbs.
- **Inputs**:
    - `x`: A signed `fd_r43x6_t` element to check for non-zero status.
- **Logic and Control Flow**:
    - Extracts the limbs of `x` into variables `l0` to `l5`.
    - Applies biased carry propagation to the limbs to make them nearly reduced.
    - Reduces the nearly reduced limbs to a fully reduced form.
    - Checks if any of the limbs `l0` to `l5` are non-zero and returns 1 if any are non-zero, otherwise returns 0.
- **Output**: Returns 1 if the input `fd_r43x6_t` is non-zero, otherwise returns 0.


---
### fd\_r43x6\_diagnose<!-- {{#callable:fd_r43x6_diagnose}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_r43x6.h#L1121>)

Reduces a signed `fd_r43x6_t` and returns -1 if the result is zero, otherwise returns the least significant bit of the reduced result.
- **Inputs**:
    - `x`: A signed `fd_r43x6_t` element to be reduced and diagnosed.
- **Logic and Control Flow**:
    - Extracts the limbs of `x` into variables `l0` to `l5`.
    - Applies biased carry propagation to the limbs to make them nearly reduced.
    - Reduces the nearly reduced limbs to a fully reduced form.
    - Checks if all limbs are zero; if true, returns -1.
    - If not zero, returns the least significant bit of `l0`.
- **Output**: Returns -1 if the reduced result is zero, otherwise returns the least significant bit of the reduced result.


# Function Declarations (Public API)

---
### fd\_r43x6\_invert<!-- {{#callable_declaration:fd_r43x6_invert}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_r43x6.h#L1083>)

Calculates the multiplicative inverse of a GF(p) element.
- **Description**: Use this function to find the multiplicative inverse of an element in the finite field GF(p), where p = 2^255-19. The input must be an unreduced `fd_r43x6_t` with lanes 6 and 7 set to zero. The function returns an unreduced `fd_r43x6_t` with lanes 6 and 7 zero, suitable for further arithmetic operations in the same field. Ensure the input is valid and within the expected range to avoid undefined behavior.
- **Inputs**:
    - `z`: An unreduced `fd_r43x6_t` representing a GF(p) element, with lanes 6 and 7 set to zero. The input must be in the range [0, 2^47) for each limb.
- **Output**: Returns an unreduced `fd_r43x6_t` representing the multiplicative inverse of the input in GF(p), with lanes 6 and 7 set to zero.
- **See Also**: [`fd_r43x6_invert`](<fd_r43x6.c.md#fd_r43x6_invert>)  (Implementation)


---
### fd\_r43x6\_pow22523<!-- {{#callable_declaration:fd_r43x6_pow22523}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_r43x6.h#L1134>)

Computes the power of a field element to the exponent (2^252 - 3).
- **Description**: Use this function to compute the power of a given field element in GF(p), where p = 2^255-19, to the exponent (2^252 - 3). This operation is useful in cryptographic protocols that require such exponentiation. The input must be an unreduced `fd_r43x6_t` with lanes 6 and 7 set to zero. The function returns an unreduced result, also with lanes 6 and 7 set to zero. Ensure the input is in the correct format to avoid unexpected results.
- **Inputs**:
    - `z`: An unreduced `fd_r43x6_t` representing a field element in GF(p), where p = 2^255-19. Lanes 6 and 7 must be zero. The input should be in the range suitable for unreduced elements, typically in [0, 2^47) for each limb.
- **Output**: Returns an unreduced `fd_r43x6_t` representing the result of the exponentiation, with lanes 6 and 7 set to zero.
- **See Also**: [`fd_r43x6_pow22523`](<fd_r43x6.c.md#fd_r43x6_pow22523>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)