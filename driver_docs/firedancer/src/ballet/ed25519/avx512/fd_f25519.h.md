<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines and implements operations for Curve25519 field elements using AVX-512 vectorization.

# Purpose
The code defines operations for arithmetic on field elements of the Curve25519 elliptic curve, which is commonly used in cryptographic applications. The primary data structure is `fd_f25519_t`, which stores a field element aligned to 64 bytes. The code provides a set of inline functions to perform arithmetic operations such as multiplication ([`fd_f25519_mul`](<#fd_f25519_mul>)), squaring (`fd_f25519_sqr`), addition (`fd_f25519_add`), and subtraction (`fd_f25519_sub`). These operations are implemented using lower-level functions from the `fd_r43x6` module, which handle the specific arithmetic on the underlying representation of the field elements.

The code also includes functions for serialization and deserialization of field elements to and from byte arrays, following the little-endian format specified in RFC 8032. Additionally, it provides conditional operations like `fd_f25519_if` and [`fd_f25519_swap_if`](<#fd_f25519_swap_if>), which are designed to execute in constant time to prevent timing attacks. The module supports vectorized operations for processing multiple field elements simultaneously, enhancing performance for batch computations. The file is intended to be included indirectly through `fd_f25519.h`, ensuring that the necessary dependencies and configurations are correctly set up.
# Imports and Dependencies

---
- `../../fd_ballet_base.h`
- `fd_r43x6.h`
- `../table/fd_f25519_table_avx512.c`


# Data Structures

---
### fd\_f25519
- **Type**: ``struct``
- **Members**:
    - ``el``: Stores a curve25519 field element using the `fd_r43x6_t` type, aligned to 64 bytes.
- **Description**: Stores a curve25519 field element in a structure that aligns the data to 64 bytes for efficient processing. The `fd_f25519` structure uses the `fd_r43x6_t` type to represent the field element, which is crucial for cryptographic operations involving the curve25519 elliptic curve.


---
### fd\_f25519\_t
- **Type**: ``struct``
- **Members**:
    - ``el``: Stores a curve25519 field element using the `fd_r43x6_t` type, aligned to 64 bytes.
- **Description**: Stores a curve25519 field element in a structure that uses 5 `ulong` values, aligned to 64 bytes, for efficient arithmetic operations in cryptographic computations.


# Functions

---
### fd\_f25519\_mul<!-- {{#callable:fd_f25519_mul}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_f25519.h#L18>)

Computes the product of two `fd_f25519_t` field elements and stores the result in a third `fd_f25519_t` field element.
- **Inputs**:
    - `r`: A pointer to an `fd_f25519_t` structure where the result will be stored.
    - `a`: A pointer to a constant `fd_f25519_t` structure representing the first operand.
    - `b`: A pointer to a constant `fd_f25519_t` structure representing the second operand.
- **Logic and Control Flow**:
    - Calls the macro `FD_R43X6_MUL1_INL` with the elements of `r`, `a`, and `b` to perform the multiplication of the field elements.
    - Returns the pointer `r` containing the result of the multiplication.
- **Output**: A pointer to the `fd_f25519_t` structure `r` containing the result of the multiplication.


---
### fd\_f25519\_tobytes<!-- {{#callable:fd_f25519_tobytes}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_f25519.h#L114>)

Serializes a `fd_f25519_t` field element into a 32-byte buffer in little-endian format.
- **Inputs**:
    - `out`: A 32-byte buffer where the serialized data will be stored.
    - `a`: A pointer to the `fd_f25519_t` field element to serialize.
- **Logic and Control Flow**:
    - Calls [`fd_r43x6_mod`](<fd_r43x6.h.md#fd_r43x6_mod>) on `a->el` to reduce the field element modulo the prime.
    - Calls [`fd_r43x6_pack`](<fd_r43x6.h.md#fd_r43x6_pack>) to pack the reduced field element into a format suitable for serialization.
    - Uses `wv_stu` to store the packed data into the `out` buffer.
- **Output**: Returns the `out` buffer containing the serialized 32-byte data.
- **Functions Called**:
    - [`fd_r43x6_pack`](<fd_r43x6.h.md#fd_r43x6_pack>)
    - [`fd_r43x6_mod`](<fd_r43x6.h.md#fd_r43x6_mod>)


---
### fd\_f25519\_swap\_if<!-- {{#callable:fd_f25519_swap_if}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_f25519.h#L135>)

Swaps the elements of two `fd_f25519_t` structures if a given condition is true, using constant time operations.
- **Inputs**:
    - `r1`: A pointer to the first `fd_f25519_t` structure to potentially swap.
    - `r2`: A pointer to the second `fd_f25519_t` structure to potentially swap.
    - `cond`: An integer condition (0 or 1) that determines whether the swap occurs.
- **Logic and Control Flow**:
    - Initialize `zero` to a zero value using `wwl_zero()`.
    - Compute the XOR of `r1->el` and `r2->el` and store the result in `m`.
    - Use `wwl_if` to conditionally set `m` to either its current value or `zero`, based on the negated condition `-!!cond`.
    - Update `r1->el` by XORing it with `m`.
    - Update `r2->el` by XORing it with `m`.
- **Output**: No return value; the function modifies the elements of `r1` and `r2` in place.


---
### fd\_f25519\_is\_zero<!-- {{#callable:fd_f25519_is_zero}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_f25519.h#L155>)

Checks if a given `fd_f25519_t` field element is zero or equal to the prime `p`.
- **Inputs**:
    - `a`: A pointer to a constant `fd_f25519_t` structure representing the field element to check.
- **Logic and Control Flow**:
    - Calls `wwl_eq` to compare `a->el` with the zero element returned by `fd_r43x6_zero()` and checks if the result masked with `0xFF` equals `0xFF`.
    - Calls `wwl_eq` to compare `a->el` with the prime element returned by `fd_r43x6_p()` and checks if the result masked with `0xFF` equals `0xFF`.
    - Returns 1 if either comparison is true, indicating `a` is zero or equal to `p`; otherwise, returns 0.
- **Output**: Returns 1 if the field element is zero or equal to the prime `p`, otherwise returns 0.


---
### fd\_f25519\_mul2<!-- {{#callable:fd_f25519_mul2}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_f25519.h#L166>)

Performs two parallel multiplications of `fd_f25519_t` field elements.
- **Inputs**:
    - `r1`: Pointer to the result field element for the first multiplication.
    - `a1`: Pointer to the first operand of the first multiplication.
    - `b1`: Pointer to the second operand of the first multiplication.
    - `r2`: Pointer to the result field element for the second multiplication.
    - `a2`: Pointer to the first operand of the second multiplication.
    - `b2`: Pointer to the second operand of the second multiplication.
- **Logic and Control Flow**:
    - Calls the `FD_R43X6_MUL2_INL` macro to perform the multiplications.
    - Passes the elements of the input field elements to the macro for computation.
- **Output**: No return value; results are stored in the field elements pointed to by `r1` and `r2`.


---
### fd\_f25519\_mul3<!-- {{#callable:fd_f25519_mul3}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_f25519.h#L173>)

Performs element-wise multiplication of three pairs of `fd_f25519_t` field elements and stores the results.
- **Inputs**:
    - ``r1``: Pointer to the `fd_f25519_t` structure where the result of the first multiplication will be stored.
    - ``a1``: Pointer to the first `fd_f25519_t` structure of the first pair to multiply.
    - ``b1``: Pointer to the second `fd_f25519_t` structure of the first pair to multiply.
    - ``r2``: Pointer to the `fd_f25519_t` structure where the result of the second multiplication will be stored.
    - ``a2``: Pointer to the first `fd_f25519_t` structure of the second pair to multiply.
    - ``b2``: Pointer to the second `fd_f25519_t` structure of the second pair to multiply.
    - ``r3``: Pointer to the `fd_f25519_t` structure where the result of the third multiplication will be stored.
    - ``a3``: Pointer to the first `fd_f25519_t` structure of the third pair to multiply.
    - ``b3``: Pointer to the second `fd_f25519_t` structure of the third pair to multiply.
- **Logic and Control Flow**:
    - Calls the macro `FD_R43X6_MUL3_INL` with the elements of the input and output `fd_f25519_t` structures to perform the multiplications.
- **Output**: No return value; results are stored in the provided `fd_f25519_t` pointers `r1`, `r2`, and `r3`.


---
### fd\_f25519\_mul4<!-- {{#callable:fd_f25519_mul4}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_f25519.h#L182>)

Performs element-wise multiplication of four pairs of `fd_f25519_t` field elements.
- **Inputs**:
    - `r1`: Pointer to the result field element for the first multiplication.
    - `a1`: Pointer to the first operand of the first multiplication.
    - `b1`: Pointer to the second operand of the first multiplication.
    - `r2`: Pointer to the result field element for the second multiplication.
    - `a2`: Pointer to the first operand of the second multiplication.
    - `b2`: Pointer to the second operand of the second multiplication.
    - `r3`: Pointer to the result field element for the third multiplication.
    - `a3`: Pointer to the first operand of the third multiplication.
    - `b3`: Pointer to the second operand of the third multiplication.
    - `r4`: Pointer to the result field element for the fourth multiplication.
    - `a4`: Pointer to the first operand of the fourth multiplication.
    - `b4`: Pointer to the second operand of the fourth multiplication.
- **Logic and Control Flow**:
    - Calls the `FD_R43X6_MUL4_INL` macro to perform the multiplication of four pairs of field elements.
    - Each result is stored in the corresponding result pointer `r1`, `r2`, `r3`, and `r4`.
- **Output**: No return value; results are stored in the provided result pointers.


---
### fd\_f25519\_sqr2<!-- {{#callable:fd_f25519_sqr2}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_f25519.h#L194>)

Computes the square of two `fd_f25519_t` field elements and stores the results in the provided output variables.
- **Inputs**:
    - `r1`: A pointer to an `fd_f25519_t` structure where the square of `a1` will be stored.
    - `a1`: A pointer to a constant `fd_f25519_t` structure representing the first input field element to be squared.
    - `r2`: A pointer to an `fd_f25519_t` structure where the square of `a2` will be stored.
    - `a2`: A pointer to a constant `fd_f25519_t` structure representing the second input field element to be squared.
- **Logic and Control Flow**:
    - Calls the inline function `FD_R43X6_SQR2_INL` with the elements of `r1`, `a1`, `r2`, and `a2` to compute the squares of the input field elements `a1` and `a2`.
- **Output**: No return value; the results are stored in the `fd_f25519_t` structures pointed to by `r1` and `r2`.


---
### fd\_f25519\_sqr3<!-- {{#callable:fd_f25519_sqr3}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_f25519.h#L201>)

Computes the square of three `fd_f25519_t` field elements and stores the results.
- **Inputs**:
    - `r1`: Pointer to the `fd_f25519_t` structure where the result of the square of `a1` will be stored.
    - `a1`: Pointer to the `fd_f25519_t` structure representing the first field element to be squared.
    - `r2`: Pointer to the `fd_f25519_t` structure where the result of the square of `a2` will be stored.
    - `a2`: Pointer to the `fd_f25519_t` structure representing the second field element to be squared.
    - `r3`: Pointer to the `fd_f25519_t` structure where the result of the square of `a3` will be stored.
    - `a3`: Pointer to the `fd_f25519_t` structure representing the third field element to be squared.
- **Logic and Control Flow**:
    - Calls the macro `FD_R43X6_SQR3_INL` with the elements of the input and output `fd_f25519_t` structures to perform the squaring operation.
- **Output**: No return value; results are stored in the provided `fd_f25519_t` structures `r1`, `r2`, and `r3`.


---
### fd\_f25519\_sqr4<!-- {{#callable:fd_f25519_sqr4}} -->
[View Source →](<../../../../../../src/ballet/ed25519/avx512/fd_f25519.h#L210>)

Computes the square of four `fd_f25519_t` field elements and stores the results.
- **Inputs**:
    - `r1`: Pointer to the first `fd_f25519_t` structure where the result of the square of `a1` will be stored.
    - `a1`: Pointer to the first `fd_f25519_t` structure representing the field element to be squared.
    - `r2`: Pointer to the second `fd_f25519_t` structure where the result of the square of `a2` will be stored.
    - `a2`: Pointer to the second `fd_f25519_t` structure representing the field element to be squared.
    - `r3`: Pointer to the third `fd_f25519_t` structure where the result of the square of `a3` will be stored.
    - `a3`: Pointer to the third `fd_f25519_t` structure representing the field element to be squared.
    - `r4`: Pointer to the fourth `fd_f25519_t` structure where the result of the square of `a4` will be stored.
    - `a4`: Pointer to the fourth `fd_f25519_t` structure representing the field element to be squared.
- **Logic and Control Flow**:
    - Calls the macro `FD_R43X6_SQR4_INL` with the elements of the input and output `fd_f25519_t` structures.
    - The macro computes the square of each input field element (`a1`, `a2`, `a3`, `a4`) and stores the results in the corresponding output structures (`r1`, `r2`, `r3`, `r4`).
- **Output**: No return value; results are stored in the provided `fd_f25519_t` structures `r1`, `r2`, `r3`, and `r4`.



---
Made with ❤️ by [Driver](https://www.driver.ai/)