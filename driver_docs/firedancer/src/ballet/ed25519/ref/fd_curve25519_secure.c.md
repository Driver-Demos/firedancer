<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Secure implementations of Ed25519 point operations with constant-time execution to protect secret data.

# Purpose
The code provides secure implementations of various operations on points in the Ed25519 elliptic curve, which is part of the Curve25519 family. The functions are designed to perform operations in constant time to prevent side-channel attacks, making them suitable for cryptographic applications where input secrecy is crucial. The file includes functions for point addition ([`fd_ed25519_point_add_secure`](<#fd_ed25519_point_add_secure>)), partial doubling ([`fd_ed25519_partial_dbl_secure`](<#fd_ed25519_partial_dbl_secure>)), repeated doubling ([`fd_ed25519_point_dbln_secure`](<#fd_ed25519_point_dbln_secure>)), conditional point selection ([`fd_ed25519_point_if`](<#fd_ed25519_point_if>)), and conditional point negation (`fd_ed25519_point_neg_if`). These functions use temporary variables and clear registers upon completion to ensure that no sensitive data is left in memory, further enhancing security.

The code is intended to be part of a larger cryptographic library, as indicated by the inclusion of the header file `fd_curve25519.h`. The functions are marked with `FD_25519_INLINE` and `FD_FN_SENSITIVE` to suggest inlining for performance and sensitivity to security, respectively. The operations are implemented without local variables, relying instead on temporary storage passed as parameters, which helps in maintaining a small and auditable code base. The use of preprocessor directives like `CURVE25519_PRECOMP_XY` indicates that the code can be configured for different optimization strategies, such as using precomputed tables for faster computation.
# Imports and Dependencies

---
- `../fd_curve25519.h`


# Global Variables

---
### fd\_f25519\_neg
- **Type**: `function`
- **Description**: Negates a field element in the finite field F_25519. The function `fd_f25519_neg` is used to compute the negation of a field element, which is part of the operations on elliptic curve points in the Curve25519 cryptographic protocol.
- **Use**: Used to compute the negation of a field element in constant time as part of elliptic curve operations.


# Functions

---
### fd\_ed25519\_point\_add\_secure<!-- {{#callable:fd_ed25519_point_add_secure}} -->
[View Source →](<../../../../../../src/ballet/ed25519/ref/fd_curve25519_secure.c#L20>)

Computes the sum of two Ed25519 points in a secure manner, ensuring constant time execution to prevent information leakage.
- **Inputs**:
    - `r`: A pointer to an `fd_ed25519_point_t` structure where the result will be stored.
    - `a`: A constant pointer to an `fd_ed25519_point_t` structure representing the first point to add.
    - `b`: A constant pointer to an `fd_ed25519_point_t` structure representing the second point to add, assumed to be from a precomputation table.
    - `tmp0`: A pointer to an `fd_ed25519_point_t` structure used as temporary storage during computation.
    - `tmp1`: A pointer to an `fd_ed25519_point_t` structure used as additional temporary storage during computation.
- **Logic and Control Flow**:
    - Initialize temporary variables `r1` to `r8` using `tmp0` and `tmp1` for intermediate calculations.
    - Compute `r1` as the difference of `a->Y` and `a->X`, and `r3` as their sum.
    - If `CURVE25519_PRECOMP_XY` is defined, multiply `r1` with `b->X`, `r3` with `b->Y`, and `a->T` with `b->T` to get `r5`, `r6`, and `r7` respectively.
    - If `CURVE25519_PRECOMP_XY` is not defined, compute `r2` as the difference of `b->Y` and `b->X`, and `r4` as their sum, then multiply `r1` with `r2`, `r3` with `r4`, and `a->T` with `b->T` to get `r5`, `r6`, and `r7` respectively.
    - Compute `r8` as twice `a->Z`.
    - Calculate `r1` as the difference of `r6` and `r5`, `r2` as the difference of `r8` and `r7`, `r3` as the sum of `r8` and `r7`, and `r4` as the sum of `r6` and `r5`.
    - Perform four multiplications to compute the final result stored in `r->X`, `r->Y`, `r->Z`, and `r->T`.
- **Output**: Returns a pointer to the `fd_ed25519_point_t` structure `r` containing the result of the addition.


---
### fd\_ed25519\_partial\_dbl\_secure<!-- {{#callable:fd_ed25519_partial_dbl_secure}} -->
[View Source →](<../../../../../../src/ballet/ed25519/ref/fd_curve25519_secure.c#L68>)

Partially computes the doubling of an elliptic curve point in a secure manner.
- **Inputs**:
    - `r`: A pointer to an `fd_ed25519_point_t` structure where the result will be stored.
    - `a`: A constant pointer to an `fd_ed25519_point_t` structure representing the point to be doubled.
    - `tmp`: A pointer to an `fd_ed25519_point_t` structure used as temporary storage during computation.
- **Logic and Control Flow**:
    - Initialize temporary variables `r1`, `r2`, `r3`, and `r4` to point to the `X`, `Y`, `Z`, and `T` fields of `tmp`, respectively.
    - Compute the sum of `a->X` and `a->Y` and store the result in `r1` using `fd_f25519_add_nr`.
    - Compute the squares of `a->X`, `a->Y`, `a->Z`, and `r1`, storing the results in `r2`, `r3`, `r4`, and `r1`, respectively, using `fd_f25519_sqr4`.
    - Double the value in `r4` using `fd_f25519_add`.
    - Compute the sum of `r2` and `r3` and store it in `r->T` using `fd_f25519_add`.
    - Compute the difference between `r2` and `r3` and store it in `r->Z` using `fd_f25519_sub`.
    - Compute the sum of `r4` and `r->Z` and store it in `r->Y` using `fd_f25519_add_nr`.
    - Compute the difference between `r->T` and `r1` and store it in `r->X` using `fd_f25519_sub_nr`.
- **Output**: The function does not return a value; it modifies the `fd_ed25519_point_t` structure pointed to by `r` to store the result of the partial doubling operation.


---
### fd\_ed25519\_point\_dbln\_secure<!-- {{#callable:fd_ed25519_point_dbln_secure}} -->
[View Source →](<../../../../../../src/ballet/ed25519/ref/fd_curve25519_secure.c#L100>)

Computes the result of doubling an elliptic curve point `a` `n` times securely.
- **Inputs**:
    - `r`: A pointer to `fd_ed25519_point_t` where the result will be stored.
    - `a`: A constant pointer to `fd_ed25519_point_t` representing the point to be doubled.
    - `n`: An integer representing the number of times to double the point `a`.
    - `t`: A pointer to `fd_ed25519_point_t` used as a temporary storage during computation.
    - `tmp`: A pointer to `fd_ed25519_point_t` used as an additional temporary storage during computation.
- **Logic and Control Flow**:
    - Calls [`fd_ed25519_partial_dbl_secure`](<#fd_ed25519_partial_dbl_secure>) to partially double the point `a` and store the result in `t`.
    - Iterates from 1 to `n-1`, performing the following steps:
    - Multiplies components of `t` and stores the result in `r` using `fd_f25519_mul3`.
    - Calls [`fd_ed25519_partial_dbl_secure`](<#fd_ed25519_partial_dbl_secure>) to partially double the point `r` and store the result back in `t`.
    - After the loop, multiplies components of `t` and stores the final result in `r` using `fd_f25519_mul4`.
- **Output**: The function does not return a value; it stores the result in the `fd_ed25519_point_t` pointed to by `r`.
- **Functions Called**:
    - [`fd_ed25519_partial_dbl_secure`](<#fd_ed25519_partial_dbl_secure>)


---
### fd\_ed25519\_point\_if<!-- {{#callable:fd_ed25519_point_if}} -->
[View Source →](<../../../../../../src/ballet/ed25519/ref/fd_curve25519_secure.c#L125>)

Selects between two elliptic curve points based on a secret condition and assigns the result to a destination point.
- **Inputs**:
    - `r`: A pointer to the destination `fd_ed25519_point_t` where the result will be stored.
    - `secret_cond`: An unsigned character (0 or 1) that determines which point to select.
    - `a0`: A pointer to the first `fd_ed25519_point_t` option.
    - `a1`: A pointer to the second `fd_ed25519_point_t` option.
- **Logic and Control Flow**:
    - Calls `fd_f25519_if` to conditionally assign `a0->X` or `a1->X` to `r->X` based on `secret_cond`.
    - Calls `fd_f25519_if` to conditionally assign `a0->Y` or `a1->Y` to `r->Y` based on `secret_cond`.
    - Calls `fd_f25519_if` to conditionally assign `a0->T` or `a1->T` to `r->T` based on `secret_cond`.
- **Output**: No return value; the result is stored in the `fd_ed25519_point_t` pointed to by `r`.



---
Made with ❤️ by [Driver](https://www.driver.ai/)