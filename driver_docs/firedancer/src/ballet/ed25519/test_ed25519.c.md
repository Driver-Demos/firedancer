<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Tests for Ed25519 and Curve25519 cryptographic operations, including key generation, signing, verification, and field element arithmetic.

# Purpose
The code is a C test suite for cryptographic operations related to the Ed25519 and Curve25519 algorithms. It includes a series of test functions that validate the correctness and performance of various cryptographic operations such as field element arithmetic, scalar operations, and signature generation and verification. The code imports several header files and test cases, indicating that it is part of a larger cryptographic library or framework.

The test suite includes functions for generating random numbers, logging benchmark results, and performing operations like addition, subtraction, multiplication, inversion, and conditional selection on field elements. It also tests the conversion of field elements to and from byte arrays, checks for zero values, and validates points and scalars. The suite includes tests for generating public keys from private keys, signing messages, and verifying signatures, including batch verification. The code is structured to allow for performance benchmarking and includes conditional compilation for comparison with OpenSSL implementations. The main function initializes the test environment, runs all the test functions, and logs the results.
# Imports and Dependencies

---
- `../fd_ballet.h`
- `fd_ed25519.h`
- `fd_curve25519.h`
- `../hex/fd_hex.h`
- `test_ed25519_wycheproof.c`
- `test_ed25519_cctv.c`
- `stdint.h`
- `ATTIC/curve25519.c`


# Functions

---
### fd\_rng\_b256<!-- {{#callable:fd_rng_b256}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L8>)

Generates 256 bits of random data using a random number generator and stores it in a provided buffer.
- **Inputs**:
    - `rng`: A pointer to an `fd_rng_t` structure, which represents the random number generator to use.
    - `r`: A pointer to an array of 32 `uchar` elements where the function will store the generated random data.
- **Logic and Control Flow**:
    - Casts the `uchar` array `r` to a `ulong` pointer `u`.
    - Calls `fd_rng_ulong` four times to fill the `ulong` array `u` with random values from the `rng`.
    - Returns the pointer `r` after filling it with random data.
- **Output**: A pointer to the `uchar` array `r` containing the generated random data.


---
### fd\_rng\_b512<!-- {{#callable:fd_rng_b512}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L16>)

Generates 512 bits of random data using a random number generator and stores it in a provided buffer.
- **Inputs**:
    - `rng`: A pointer to an `fd_rng_t` structure, which represents the random number generator to use.
    - `r`: A buffer of 64 bytes where the generated random data will be stored.
- **Logic and Control Flow**:
    - Casts the buffer `r` to a pointer to `ulong` to facilitate storing 64-bit random numbers.
    - Calls `fd_rng_ulong` eight times to fill the buffer with random 64-bit unsigned integers.
    - Stores each generated random number in the buffer `r`.
- **Output**: Returns the pointer to the buffer `r` containing the generated random data.


---
### log\_bench<!-- {{#callable:log_bench}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L25>)

Logs the performance metrics of a benchmark test.
- **Inputs**:
    - ``descr``: A string that describes the benchmark being logged.
    - ``iter``: The number of iterations performed in the benchmark.
    - ``dt``: The time duration in microseconds for the benchmark to complete.
- **Logic and Control Flow**:
    - Calculate the performance in kilohertz (`khz`) by dividing the number of iterations by the time duration and multiplying by 1,000,000.
    - Calculate the average time per call (`tau`) by dividing the time duration by the number of iterations.
    - Log the description, performance in kilohertz, and average time per call using the `FD_LOG_NOTICE` macro.
- **Output**: No return value; the function logs the output using `FD_LOG_NOTICE`.


---
### fe\_rng<!-- {{#callable:fe_rng}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L39>)

Generates an array of random integers using a random number generator, with specific bit masks applied to each integer.
- **Inputs**:
    - ``h``: A pointer to an integer array where the generated random numbers will be stored.
    - ``rng``: A pointer to a `fd_rng_t` random number generator used to generate random numbers.
- **Logic and Control Flow**:
    - Define two bit masks, `m26` and `m25`, for 26 and 25 least significant bits respectively.
    - Generate a random unsigned integer using `fd_rng_uint` and apply the `m26` mask, storing the result in `h[0]`.
    - Generate another random unsigned integer, apply the `m25` mask, and store the result in `h[1]`.
    - Repeat the above two steps for `h[2]` to `h[9]`, alternating between `m26` and `m25` masks.
    - Return the pointer `h`.
- **Output**: Returns the pointer to the integer array `h` containing the generated random numbers.


---
### test\_fe\_frombytes<!-- {{#callable:test_fe_frombytes}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L52>)

Tests the conversion of byte arrays to field elements and verifies specific conditions and performance.
- **Inputs**:
    - `rng`: A pointer to a random number generator of type `fd_rng_t`.
- **Logic and Control Flow**:
    - Initialize a 32-byte array `_s` and a field element `_h` for testing.
    - Decode a series of hexadecimal strings into the byte array `s` and convert them to field elements using `fd_f25519_frombytes`.
    - Verify if the resulting field element is zero using `fd_f25519_is_zero` for specific byte patterns.
    - Verify if the resulting field element equals two using `fd_f25519_eq` for other specific byte patterns.
    - Generate random bytes using [`fd_rng_b256`](<#fd_rng_b256>) and measure the performance of `fd_f25519_frombytes` over 1,000,000 iterations.
    - Log the performance results using [`log_bench`](<#log_bench>).
- **Output**: No return value; performs tests and logs results.
- **Functions Called**:
    - [`fd_rng_b256`](<#fd_rng_b256>)
    - [`log_bench`](<#log_bench>)


---
### test\_fe\_tobytes<!-- {{#callable:test_fe_tobytes}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L103>)

Tests the conversion of field elements to byte arrays and verifies the correctness of the conversion.
- **Inputs**:
    - ``rng``: A pointer to a random number generator of type `fd_rng_t`.
- **Logic and Control Flow**:
    - Initialize byte arrays `_s` and `_e` and field element `_h` for testing.
    - Decode a series of expected byte arrays `e` using `fd_hex_decode` and convert predefined field elements to byte arrays `s` using `fd_f25519_tobytes`.
    - Verify that the converted byte arrays `s` match the expected byte arrays `e` using `FD_TEST` and `fd_memeq`.
    - Test the reduction of field elements modulo `p` to ensure canonical results by adding and converting field elements.
    - Test the conversion from bytes to field elements and back to bytes, checking for consistency.
    - Perform a benchmark test by converting random field elements to byte arrays in a loop and logging the performance.
- **Output**: No return value; the function performs tests and logs results.
- **Functions Called**:
    - [`log_bench`](<#log_bench>)


---
### test\_fe\_is\_zero<!-- {{#callable:test_fe_is_zero}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L172>)

Tests if a given `fd_f25519_t` field element is zero by decoding various hexadecimal strings into field elements and checking their zero status.
- **Inputs**:
    - `rng`: A pointer to a `fd_rng_t` random number generator, marked as unused in this function.
- **Logic and Control Flow**:
    - Initialize a 32-byte array `_s` and a `fd_f25519_t` array `_h` to hold field elements.
    - Call `FD_TEST` to check if `fd_f25519_zero` is zero using `fd_f25519_is_zero`.
    - Decode a series of hexadecimal strings into the byte array `s` using `fd_hex_decode`.
    - Convert the byte array `s` into a field element `h` using `fd_f25519_frombytes`.
    - Use `FD_TEST_CUSTOM` to verify if the field element `h` is zero or not, based on the expected result for each hexadecimal string.
    - Repeat the decode and test process for several hexadecimal strings representing both zero and non-zero field elements.
- **Output**: No output is returned; the function performs tests and assertions to verify the zero status of field elements.


---
### test\_fe\_copy<!-- {{#callable:test_fe_copy}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L225>)

Tests the copying of finite field elements and benchmarks the `fd_f25519_set` function.
- **Inputs**:
    - `rng`: A pointer to a random number generator of type `fd_rng_t`.
- **Logic and Control Flow**:
    - Declare two finite field elements `_f` and `_h` of type `fd_f25519_t` and assign pointers `f` and `h` to them.
    - If `OPENSSL_COMPARE` is defined, perform a loop 1,000,000 times to compare the results of copying finite field elements using OpenSSL's `fe_copy` and the custom `fd_f25519_set` function.
    - Within the loop, generate random finite field elements `ref_f` and `ref_h`, copy `ref_f` to `f`, and set `h` using `fd_f25519_set`.
    - Verify that `fd_f25519_set` returns the correct pointer and that the memory contents of `f` and `h` match `ref_f` and `ref_h`.
    - Generate a random finite field element `f` using `fd_f25519_rng_unsafe`.
    - Benchmark the `fd_f25519_set` function by measuring the time taken to execute it 1,000,000 times and log the performance.
- **Output**: No return value; the function performs tests and logs benchmark results.
- **Functions Called**:
    - [`fe_rng`](<#fe_rng>)
    - [`log_bench`](<#log_bench>)


---
### test\_fe\_add<!-- {{#callable:test_fe_add}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L250>)

Tests the addition of two field elements using the `fd_f25519_add` function and benchmarks its performance.
- **Inputs**:
    - `rng`: A pointer to a random number generator of type `fd_rng_t` used to generate random field elements.
- **Logic and Control Flow**:
    - Declare and initialize three field elements `f`, `g`, and `h` of type `fd_f25519_t`.
    - If `OPENSSL_COMPARE` is defined, perform a loop 1,000,000 times to compare the results of `fd_f25519_add` with a reference implementation `fe_add` using random field elements.
    - Copy the reference field elements to `f` and `g`, perform the addition using `fd_f25519_add`, and verify the results using `FD_TEST` and `memcmp`.
    - Perform additional tests to ensure that the field elements `f` and `g` remain unchanged after the addition operation.
    - Generate random field elements `f` and `g` using `fd_f25519_rng_unsafe`.
    - Benchmark the `fd_f25519_add` function by performing the addition operation 1,000,000 times and log the performance using [`log_bench`](<#log_bench>).
- **Output**: No return value; the function performs tests and logs benchmark results.
- **Functions Called**:
    - [`fe_rng`](<#fe_rng>)
    - [`log_bench`](<#log_bench>)


---
### test\_fe\_sub<!-- {{#callable:test_fe_sub}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L288>)

Tests the subtraction of two field elements using the `fd_f25519_sub` function and benchmarks its performance.
- **Inputs**:
    - `rng`: A pointer to a `fd_rng_t` structure used for random number generation.
- **Logic and Control Flow**:
    - Declare and initialize three `fd_f25519_t` variables `_f`, `_g`, and `_h` to hold field elements.
    - If `OPENSSL_COMPARE` is defined, perform a loop 1,000,000 times to compare the results of `fd_f25519_sub` with a reference implementation `fe_sub`.
    - In each iteration, generate random field elements `ref_f` and `ref_g`, compute their subtraction using `fe_sub`, and verify the result with `fd_f25519_sub`.
    - Check that the original field elements `f` and `g` remain unchanged after the subtraction operation.
    - Perform the subtraction in-place on `f` and `g` and verify the results.
    - Generate random field elements `f` and `g` using `fd_f25519_rng_unsafe`.
    - Perform a loop 1,000,000 times to benchmark the `fd_f25519_sub` function by subtracting `g` from `f` and storing the result in `h`.
    - Log the benchmark results using [`log_bench`](<#log_bench>).
- **Output**: No return value; the function performs tests and logs benchmark results.
- **Functions Called**:
    - [`fe_rng`](<#fe_rng>)
    - [`log_bench`](<#log_bench>)


---
### test\_fe\_mul<!-- {{#callable:test_fe_mul}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L326>)

Tests the multiplication of two field elements using the `fd_f25519_mul` function and verifies the results against expected values.
- **Inputs**:
    - `rng`: A pointer to a random number generator of type `fd_rng_t` used for generating random field elements.
- **Logic and Control Flow**:
    - Initializes field elements `f`, `g`, `h`, and `e` as arrays of type `fd_f25519_t`.
    - If `OPENSSL_COMPARE` is defined, performs 1,000,000 iterations of multiplying random field elements `f` and `g`, comparing the result with a reference implementation, and verifying the integrity of the inputs and outputs.
    - Decodes hexadecimal strings into field elements `f`, `g`, and `e`, performs multiplication, and checks if the result matches the expected value `e`.
    - Converts the result `h` to bytes and verifies it matches the expected byte array.
    - Generates random field elements `f` and `g`, performs 1,000,000 multiplications, and logs the performance metrics.
- **Output**: No return value; the function performs tests and logs results.
- **Functions Called**:
    - [`fe_rng`](<#fe_rng>)
    - [`log_bench`](<#log_bench>)


---
### test\_fe\_sq<!-- {{#callable:test_fe_sq}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L378>)

Tests the square operation on finite field elements using random inputs and benchmarks the performance.
- **Inputs**:
    - `rng`: A pointer to a `fd_rng_t` structure used for random number generation.
- **Logic and Control Flow**:
    - Initializes two finite field elements `_f` and `_h` as arrays of type `fd_f25519_t` and assigns pointers `f` and `h` to them.
    - If `OPENSSL_COMPARE` is defined, runs a loop 1,000,000 times to compare the results of `fd_f25519_sqr` with a reference implementation `fe_sq` using random inputs generated by [`fe_rng`](<#fe_rng>).
    - Copies the reference finite field elements to `f` and `h` and checks if the square operation results match using `FD_TEST` and `memcmp`.
    - Generates a random finite field element using `fd_f25519_rng_unsafe` and assigns it to `f`.
    - Runs a loop 1,000,000 times to perform the square operation `fd_f25519_sqr` on `f` and stores the result in `h`, while measuring the time taken using `fd_log_wallclock`.
    - Logs the benchmark results using [`log_bench`](<#log_bench>).
- **Output**: No return value; the function performs tests and logs benchmark results.
- **Functions Called**:
    - [`fe_rng`](<#fe_rng>)
    - [`log_bench`](<#log_bench>)


---
### test\_fe\_invert<!-- {{#callable:test_fe_invert}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L404>)

Tests the inversion of field elements using the `fd_f25519_inv` function and benchmarks its performance.
- **Inputs**:
    - `rng`: A pointer to a `fd_rng_t` structure used for random number generation.
- **Logic and Control Flow**:
    - Declare and initialize two `fd_f25519_t` variables `_f` and `_h` as arrays of size 1, and set pointers `f` and `h` to these arrays respectively.
    - If `OPENSSL_COMPARE` is defined, perform a loop 10,000 times to compare the inversion results of `fd_f25519_inv` with the reference implementation `fe_invert`.
    - In each iteration of the loop, generate a random field element `ref_f` using [`fe_rng`](<#fe_rng>), invert it using `fe_invert`, and copy the result to `ref_h`.
    - Copy `ref_f` to `f` and check if `fd_f25519_inv(h, f)` returns `h` and if `f` and `h` match `ref_f` and `ref_h` respectively using `FD_TEST` and `memcmp`.
    - Perform a similar check by inverting `f` in place and comparing it to `ref_h`.
    - Generate a random field element `f` using `fd_f25519_rng_unsafe`.
    - Initialize `iter` to 10,000 and record the current wall clock time in `dt`.
    - Perform a loop `iter` times, forgetting the values of `f` and `h` in each iteration, and call `fd_f25519_inv(h, f)`.
    - Calculate the elapsed time by subtracting the initial `dt` from the current wall clock time.
    - Log the benchmark results using [`log_bench`](<#log_bench>) with the description "fd_f25519_inv".
- **Output**: No return value; the function performs tests and logs benchmark results.
- **Functions Called**:
    - [`fe_rng`](<#fe_rng>)
    - [`log_bench`](<#log_bench>)


---
### test\_fe\_neg<!-- {{#callable:test_fe_neg}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L430>)

Tests the negation operation on finite field elements using random inputs and benchmarks the performance.
- **Inputs**:
    - `rng`: A pointer to a `fd_rng_t` structure used for random number generation.
- **Logic and Control Flow**:
    - Declare and initialize two `fd_f25519_t` variables `_f` and `_h` for storing finite field elements.
    - If `OPENSSL_COMPARE` is defined, perform 100,000 iterations of comparison tests between the custom negation function `fd_f25519_neg` and the reference OpenSSL function `fe_neg`.
    - In each iteration, generate a random finite field element `ref_f`, compute its negation `ref_h` using `fe_neg`, and verify the results using `fd_f25519_neg`.
    - Copy the reference finite field element `ref_f` to `f` and verify that `fd_f25519_neg` produces the same result as `fe_neg`.
    - Perform a performance benchmark by generating a random finite field element `f` using `fd_f25519_rng_unsafe`, then measure the time taken to perform 100,000 negation operations using `fd_f25519_neg`.
    - Log the benchmark results using [`log_bench`](<#log_bench>).
- **Output**: No return value; the function performs tests and logs benchmark results.
- **Functions Called**:
    - [`fe_rng`](<#fe_rng>)
    - [`log_bench`](<#log_bench>)


---
### test\_fe\_if<!-- {{#callable:test_fe_if}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L456>)

Tests the `fd_f25519_if` function by comparing its output with expected results using random inputs and benchmarks its performance.
- **Inputs**:
    - `rng`: A pointer to a `fd_rng_t` structure used for random number generation.
- **Logic and Control Flow**:
    - Initializes three `fd_f25519_t` variables `_f`, `_g`, and `_h` to store field elements.
    - Generates random field elements `f` and `g` using `fd_f25519_rng_unsafe` and ensures they are not equal using `fd_memeq`.
    - Tests the `fd_f25519_if` function with `c` set to 1 and 0, verifying that the output matches `f` and `g` respectively using `fd_memeq`.
    - If `OPENSSL_COMPARE` is defined, performs additional tests comparing `fd_f25519_if` with OpenSSL's `fe_cmov` function for 100,000 iterations.
    - Benchmarks the `fd_f25519_if` function by running it 100,000 times and logs the performance using [`log_bench`](<#log_bench>).
- **Output**: No return value; the function performs tests and logs results.
- **Functions Called**:
    - [`fe_rng`](<#fe_rng>)
    - [`log_bench`](<#log_bench>)


---
### test\_fe\_isnonzero<!-- {{#callable:test_fe_isnonzero}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L505>)

Tests the `fd_f25519_is_nonzero` function for correctness and performance using random field elements.
- **Inputs**:
    - `rng`: A pointer to a random number generator of type `fd_rng_t` used to generate random field elements.
- **Logic and Control Flow**:
    - Declare a field element `_f` and a pointer `f` to it, and an integer `c` for storing results.
    - If `OPENSSL_COMPARE` is defined, loop 100,000 times to compare the result of `fd_f25519_is_nonzero` with `fe_isnonzero` using random field elements generated by [`fe_rng`](<#fe_rng>).
    - Copy the reference field element `ref_f` to `f` and verify that `fd_f25519_is_nonzero(f)` matches `c` and that `f` matches `ref_f`.
    - Generate a random field element using `fd_f25519_rng_unsafe` and store it in `f`.
    - Loop 100,000 times, calling `fd_f25519_is_nonzero(f)` and storing the result in `c`, while using `FD_COMPILER_FORGET` to prevent compiler optimizations.
    - Measure the time taken for the loop and log the performance using [`log_bench`](<#log_bench>).
- **Output**: No return value; the function performs tests and logs results.
- **Functions Called**:
    - [`fe_rng`](<#fe_rng>)
    - [`log_bench`](<#log_bench>)


---
### test\_fe\_pow22523<!-- {{#callable:test_fe_pow22523}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L530>)

Tests the `fd_f25519_pow22523` function for correctness and performance using random inputs.
- **Inputs**:
    - `rng`: A pointer to a `fd_rng_t` structure used for generating random numbers.
- **Logic and Control Flow**:
    - Initializes two `fd_f25519_t` variables, `_f` and `_h`, to store field elements.
    - If `OPENSSL_COMPARE` is defined, runs a loop 100,000 times to compare the results of `fd_f25519_pow22523` with a reference implementation `fe_pow22523`.
    - Copies the reference field element `ref_f` to `f` and checks if `fd_f25519_pow22523` applied to `f` matches `h`.
    - Verifies that `f` and `h` match the reference values `ref_f` and `ref_h` respectively after the operation.
    - Generates a random field element using `fd_f25519_rng_unsafe` and measures the time taken to perform 100,000 iterations of `fd_f25519_pow22523` on it.
    - Logs the performance results using [`log_bench`](<#log_bench>).
    - Contains commented-out code for testing `fd_f25519_pow22523_2` and `fd_f25519_pow22523_4`, which are not implemented.
- **Output**: No return value; the function performs tests and logs results.
- **Functions Called**:
    - [`fe_rng`](<#fe_rng>)
    - [`log_bench`](<#log_bench>)


---
### test\_affine\_frombytes<!-- {{#callable:test_affine_frombytes}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L604>)

Converts hexadecimal byte arrays into an affine point on the Curve25519 elliptic curve and logs a success message.
- **Inputs**:
    - ``rng``: A pointer to a `fd_rng_t` structure, which is unused in this function.
- **Logic and Control Flow**:
    - Declare two 32-byte arrays `x` and `y` to hold hexadecimal values.
    - Declare a `fd_ed25519_point_t` array `fd_ed25519_base_point` to store the resulting affine point.
    - Decode the hexadecimal string "1ad5258f602d56c9b2a7259560c72c695cdcd6fd31e2a4c0fe536ecdd3366921" into the `x` array using `fd_hex_decode`.
    - Decode the hexadecimal string "5866666666666666666666666666666666666666666666666666666666666666" into the `y` array using `fd_hex_decode`.
    - Convert the byte arrays `x` and `y` into an affine point on the Curve25519 elliptic curve using `fd_curve25519_affine_frombytes`, storing the result in `fd_ed25519_base_point`.
    - Log a success message "test_affine_frombytes: ok" using `FD_LOG_NOTICE`.
- **Output**: No output is returned from this function.


---
### test\_affine\_is\_small\_order<!-- {{#callable:test_affine_is_small_order}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L614>)

Tests if certain Ed25519 points are of small order by decoding them from hexadecimal strings and checking their order.
- **Inputs**:
    - `rng`: A pointer to a random number generator of type `fd_rng_t`, which is not used in this function.
- **Logic and Control Flow**:
    - Initialize a 32-byte array `_s` and a pointer `s` to it, and a `fd_ed25519_point_t` array `_r` and a pointer `r` to it.
    - Decode a series of hexadecimal strings into the array `s` using `fd_hex_decode`.
    - Convert the byte array `s` into an Ed25519 point `r` using `fd_ed25519_point_frombytes`.
    - Check if the point `r` is of small order using `fd_ed25519_affine_is_small_order` and assert the expected result with `FD_TEST`.
    - Log a notice message indicating the test completion.
- **Output**: No output is returned; the function performs assertions to validate the behavior of `fd_ed25519_affine_is_small_order`.


---
### test\_point\_validate<!-- {{#callable:test_point_validate}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L670>)

Validates various Ed25519 points by encoding them into bytes and checking their validity using `fd_ed25519_point_validate`.
- **Inputs**:
    - `rng`: A pointer to a `fd_rng_t` structure, which is unused in this function.
- **Logic and Control Flow**:
    - Initialize a 32-byte buffer `buf`.
    - Convert the base point to bytes and validate it using `fd_ed25519_point_validate`.
    - Decode several hexadecimal strings into `buf` and validate each using `fd_ed25519_point_validate`.
    - Perform negative tests by decoding specific hexadecimal strings into `buf` and checking that `fd_ed25519_point_validate` returns false.
- **Output**: No output is returned as the function is of type `void` and performs internal validation checks.


---
### test\_sc\_validate<!-- {{#callable:test_sc_validate}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L716>)

Validates Curve25519 scalars using a series of tests, including edge cases and random values, and benchmarks the validation process.
- **Inputs**:
    - `rng`: A pointer to a `fd_rng_t` structure used for random number generation.
- **Logic and Control Flow**:
    - Initialize two arrays `_in` and `_out` for input and output data.
    - Validate three specific scalars: `fd_curve25519_scalar_zero`, `fd_curve25519_scalar_one`, and `fd_curve25519_scalar_minus_one`.
    - Perform a negative test by modifying `fd_curve25519_scalar_minus_one` and checking that it fails validation.
    - Generate a random 256-bit value, modify it, and check that it fails validation.
    - Generate a random 512-bit value, reduce it to a scalar, and check that it passes validation.
    - Benchmark the `fd_curve25519_scalar_validate` function by running it 1,000,000 times and logging the performance.
- **Output**: No return value; the function performs tests and logs results.
- **Functions Called**:
    - [`fd_rng_b256`](<#fd_rng_b256>)
    - [`fd_rng_b512`](<#fd_rng_b512>)
    - [`log_bench`](<#log_bench>)


---
### test\_sc\_reduce<!-- {{#callable:test_sc_reduce}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L743>)

Tests the `fd_curve25519_scalar_reduce` function for correctness and performance using random inputs.
- **Inputs**:
    - ``rng``: A pointer to a random number generator of type `fd_rng_t` used to generate random input data.
- **Logic and Control Flow**:
    - Initializes two 64-byte arrays `_in` and `_out` for input and output.
    - If `OPENSSL_COMPARE` is defined, runs a loop 1,000,000 times to compare the output of `fd_curve25519_scalar_reduce` with a reference implementation `x25519_sc_reduce`.
    - Copies random data into `in` using [`fd_rng_b512`](<#fd_rng_b512>) and measures the time taken to perform 1,000,000 reductions using `fd_curve25519_scalar_reduce`.
    - Logs the performance metrics using [`log_bench`](<#log_bench>).
- **Output**: No return value; the function performs tests and logs results.
- **Functions Called**:
    - [`fd_rng_b512`](<#fd_rng_b512>)
    - [`log_bench`](<#log_bench>)


---
### test\_sc\_muladd<!-- {{#callable:test_sc_muladd}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L768>)

Tests the `fd_curve25519_scalar_muladd` function by comparing its output with a reference implementation and measures its performance.
- **Inputs**:
    - `rng`: A pointer to a `fd_rng_t` structure used for random number generation.
- **Logic and Control Flow**:
    - Initializes four 32-byte arrays `_a`, `_b`, `_c`, and `_s` for input and output.
    - If `OPENSSL_COMPARE` is defined, runs a loop 1,000,000 times to compare the output of `fd_curve25519_scalar_muladd` with a reference implementation `sc_muladd`.
    - Copies random values into `a`, `b`, and `c` using [`fd_rng_b256`](<#fd_rng_b256>).
    - Runs a loop 1,000,000 times to call `fd_curve25519_scalar_muladd` with `a`, `b`, and `c`, storing the result in `s`.
    - Measures the time taken for the loop and logs the performance using [`log_bench`](<#log_bench>).
- **Output**: No direct output; the function performs tests and logs performance metrics.
- **Functions Called**:
    - [`fd_rng_b256`](<#fd_rng_b256>)
    - [`log_bench`](<#log_bench>)


---
### test\_public\_from\_private<!-- {{#callable:test_public_from_private}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L820>)

Generates a public key from a private key using the Ed25519 algorithm and measures the performance of this operation.
- **Inputs**:
    - `rng`: A pointer to a `fd_rng_t` structure used for random number generation.
    - `sha`: A pointer to a `fd_sha512_t` structure used for SHA-512 hashing.
- **Logic and Control Flow**:
    - Initializes arrays for private key (`prv`), public key (`pub`), and expected public key (`exp`).
    - If `OPENSSL_COMPARE` is defined, runs a loop 10,000 times to compare the generated public key with a reference implementation using `ED25519_public_from_private`.
    - Decodes a fixed private key and expected public key from hexadecimal strings and generates a public key using `fd_ed25519_public_from_private`.
    - Generates a random private key using [`fd_rng_b256`](<#fd_rng_b256>) and computes the corresponding public key.
    - Runs a performance benchmark by generating public keys from private keys 10,000 times and logs the results using [`log_bench`](<#log_bench>).
- **Output**: No return value; the function performs operations and logs results.
- **Functions Called**:
    - [`fd_rng_b256`](<#fd_rng_b256>)
    - [`log_bench`](<#log_bench>)


---
### test\_sign<!-- {{#callable:test_sign}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L855>)

Tests the signing functionality of the Ed25519 algorithm using random and predefined data.
- **Inputs**:
    - `rng`: A pointer to a `fd_rng_t` structure used for random number generation.
    - `sha`: A pointer to a `fd_sha512_t` structure used for SHA-512 hashing.
- **Logic and Control Flow**:
    - Initializes arrays for message, public key, private key, signature, and expected signature.
    - If `OPENSSL_COMPARE` is defined, performs 10,000 iterations of signing and verification using OpenSSL for comparison.
    - Decodes a predefined private key and expected signature, generates a public key from the private key, signs an empty message, and verifies the signature against the expected signature.
    - Generates a random message of 1024 bytes, generates a public key from a random private key, and performs signing operations for message sizes from 128 to 1024 bytes in increments of 128 bytes.
    - Logs the performance of the signing operations.
- **Output**: No return value; the function performs tests and logs results.
- **Functions Called**:
    - [`fd_rng_b256`](<#fd_rng_b256>)
    - [`log_bench`](<#log_bench>)


---
### test\_verify<!-- {{#callable:test_verify}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L905>)

Tests the verification of ED25519 signatures under various conditions, including batch verification and corrupted data scenarios.
- **Inputs**:
    - ``rng``: A pointer to a `fd_rng_t` structure used for random number generation.
    - ``sha``: A pointer to a `fd_sha512_t` structure used for SHA-512 hashing operations.
- **Logic and Control Flow**:
    - Initializes message, public key, signature, and private key buffers.
    - If `OPENSSL_COMPARE` is defined, performs 10,000 iterations of signature verification with potential corruption of signature, message, size, or public key.
    - Generates random messages and derives public keys from private keys for testing.
    - Performs signature signing and verification for message sizes from 128 to 1024 bytes, logging performance metrics.
    - Tests batch verification of signatures with varying batch sizes, logging performance metrics.
    - Corrupts signatures, messages, and public keys to test verification failure scenarios, logging performance metrics.
- **Output**: No return value; the function performs tests and logs results.
- **Functions Called**:
    - [`fd_rng_b256`](<#fd_rng_b256>)
    - [`fd_ed25519_verify`](<fd_ed25519_user.c.md#fd_ed25519_verify>)
    - [`log_bench`](<#log_bench>)
    - [`fd_ed25519_verify_batch_single_msg`](<fd_ed25519_user.c.md#fd_ed25519_verify_batch_single_msg>)


---
### test\_wycheproofs<!-- {{#callable:test_wycheproofs}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L1072>)

Validates Ed25519 signature verification against a set of predefined test vectors (wycheproofs).
- **Inputs**:
    - `sha`: A pointer to an `fd_sha512_t` structure used for SHA-512 hashing operations.
- **Logic and Control Flow**:
    - Initialize a character array `cstr` with a size of 128 to store formatted strings.
    - Iterate over each `fd_ed25519_verify_wycheproof_t` structure in the `ed25519_verify_wycheproofs` array until a `msg` field is null.
    - For each `proof`, call [`fd_ed25519_verify`](<fd_ed25519_user.c.md#fd_ed25519_verify>) with the message, message size, signature, public key, and SHA-512 context to verify the signature.
    - Compare the result of the verification with the expected result (`proof->ok`).
    - Use `FD_TEST_CUSTOM` to assert that the actual verification result matches the expected result, logging the test case ID if it does not.
    - Log a notice message indicating that all wycheproof tests passed.
- **Output**: No return value; the function performs validation and logs results.
- **Functions Called**:
    - [`fd_ed25519_verify`](<fd_ed25519_user.c.md#fd_ed25519_verify>)


---
### test\_cctv<!-- {{#callable:test_cctv}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L1088>)

Verifies a series of Ed25519 cryptographic proofs against expected outcomes using a SHA-512 context.
- **Inputs**:
    - `sha`: A pointer to an `fd_sha512_t` structure used for SHA-512 hashing operations.
- **Logic and Control Flow**:
    - Initialize a character array `cstr` with a size of 128 to store formatted strings.
    - Iterate over each `proof` in the `ed25519_verify_cctvs` array until a `proof` with a null `msg` is encountered.
    - For each `proof`, call [`fd_ed25519_verify`](<fd_ed25519_user.c.md#fd_ed25519_verify>) with the message, message size, signature, public key, and SHA-512 context to verify the signature.
    - Compare the result of [`fd_ed25519_verify`](<fd_ed25519_user.c.md#fd_ed25519_verify>) with `FD_ED25519_SUCCESS` to determine if the verification was successful.
    - Use `FD_TEST_CUSTOM` to assert that the verification result matches the expected outcome (`proof->ok`), and log the test case ID if it does not match.
    - Log a notice message indicating that all `fd_ed25519_verify_cctv` tests passed.
- **Output**: No return value; the function performs verification and logs results.
- **Functions Called**:
    - [`fd_ed25519_verify`](<fd_ed25519_user.c.md#fd_ed25519_verify>)


---
### test\_cctv\_batch<!-- {{#callable:test_cctv_batch}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L1101>)

Tests the batch verification of Ed25519 signatures using a predefined set of test cases.
- **Inputs**:
    - ``rng``: A pointer to a random number generator of type `fd_rng_t` used for generating private keys.
    - ``sha``: A pointer to a SHA-512 context of type `fd_sha512_t` used for hashing during signature generation and verification.
- **Logic and Control Flow**:
    - Initialize a character array `cstr` for logging purposes.
    - Retrieve a message and its size from the `ed25519_verify_cctvs` array for testing.
    - Declare and initialize arrays for public keys, signatures, private keys, and SHA contexts.
    - Generate 16 valid Ed25519 signatures using the random number generator and store them in the `sigs` array.
    - Verify the batch of 16 signatures using [`fd_ed25519_verify_batch_single_msg`](<fd_ed25519_user.c.md#fd_ed25519_verify_batch_single_msg>) and check for success.
    - Iterate over the `ed25519_verify_cctvs` array to test each proof with the same message size.
    - For each proof, copy the signature and public key into the `sigs` and `pubs` arrays respectively.
    - Verify the batch of 2 and 4 signatures using [`fd_ed25519_verify_batch_single_msg`](<fd_ed25519_user.c.md#fd_ed25519_verify_batch_single_msg>) and compare the result with the expected outcome in the proof.
    - Log the success of the batch verification process.
- **Output**: No return value; the function performs tests and logs results.
- **Functions Called**:
    - [`fd_rng_b256`](<#fd_rng_b256>)
    - [`fd_ed25519_verify_batch_single_msg`](<fd_ed25519_user.c.md#fd_ed25519_verify_batch_single_msg>)


---
### main<!-- {{#callable:main}} -->
[View Source →](<../../../../../src/ballet/ed25519/test_ed25519.c#L1146>)

Initializes the environment, runs a series of cryptographic tests, and then cleans up resources before exiting.
- **Inputs**:
    - `argc`: The number of command-line arguments.
    - `argv`: An array of command-line arguments.
- **Logic and Control Flow**:
    - Calls `fd_boot` to initialize the environment with command-line arguments.
    - Creates and joins a random number generator (`fd_rng_t`) and a SHA-512 context (`fd_sha512_t`).
    - Executes a series of test functions related to finite field operations, affine transformations, point validation, scalar operations, and cryptographic signing and verification.
    - Each test function uses the random number generator and, where applicable, the SHA-512 context.
    - Deletes the SHA-512 context and the random number generator to free resources.
    - Logs a notice indicating the tests passed.
    - Calls `fd_halt` to perform any necessary cleanup before exiting.
    - Returns 0 to indicate successful execution.
- **Output**: Returns 0 to indicate successful execution.
- **Functions Called**:
    - [`test_fe_frombytes`](<#test_fe_frombytes>)
    - [`test_fe_tobytes`](<#test_fe_tobytes>)
    - [`test_fe_is_zero`](<#test_fe_is_zero>)
    - [`test_fe_copy`](<#test_fe_copy>)
    - [`test_fe_add`](<#test_fe_add>)
    - [`test_fe_sub`](<#test_fe_sub>)
    - [`test_fe_mul`](<#test_fe_mul>)
    - [`test_fe_sq`](<#test_fe_sq>)
    - [`test_fe_invert`](<#test_fe_invert>)
    - [`test_fe_neg`](<#test_fe_neg>)
    - [`test_fe_if`](<#test_fe_if>)
    - [`test_fe_isnonzero`](<#test_fe_isnonzero>)
    - [`test_fe_pow22523`](<#test_fe_pow22523>)
    - [`test_affine_frombytes`](<#test_affine_frombytes>)
    - [`test_affine_is_small_order`](<#test_affine_is_small_order>)
    - [`test_point_validate`](<#test_point_validate>)
    - [`test_sc_validate`](<#test_sc_validate>)
    - [`test_sc_reduce`](<#test_sc_reduce>)
    - [`test_sc_muladd`](<#test_sc_muladd>)
    - [`test_public_from_private`](<#test_public_from_private>)
    - [`test_sign`](<#test_sign>)
    - [`test_verify`](<#test_verify>)
    - [`test_wycheproofs`](<#test_wycheproofs>)
    - [`test_cctv`](<#test_cctv>)
    - [`test_cctv_batch`](<#test_cctv_batch>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)