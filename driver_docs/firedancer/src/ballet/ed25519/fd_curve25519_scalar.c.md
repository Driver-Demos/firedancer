<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Implements scalar reduction, multiplication-addition, and windowed non-adjacent form for Curve25519.

# Purpose
The code provides functions for operations on Curve25519 scalars, which are used in cryptographic computations. The file includes three main functions: [`fd_curve25519_scalar_reduce`](<#fd_curve25519_scalar_reduce>), [`fd_curve25519_scalar_muladd`](<#fd_curve25519_scalar_muladd>), and [`fd_curve25519_scalar_wnaf`](<#fd_fn_no_asanfd_curve25519_scalar_wnaf>). These functions perform specific mathematical operations on scalar values represented as byte arrays.

The [`fd_curve25519_scalar_reduce`](<#fd_curve25519_scalar_reduce>) function reduces a 512-bit input to a 256-bit output using modular arithmetic specific to Curve25519. It unpacks the input into smaller integers, performs a series of arithmetic operations to reduce the size, and then packs the result back into the output array. The [`fd_curve25519_scalar_muladd`](<#fd_curve25519_scalar_muladd>) function performs a multiply-add operation on three scalar values, which involves multiplying two scalars and adding a third, followed by a reduction step to ensure the result fits within the required size. The [`fd_curve25519_scalar_wnaf`](<#fd_fn_no_asanfd_curve25519_scalar_wnaf>) function computes the windowed non-adjacent form (wNAF) of a scalar, which is a representation used to optimize scalar multiplication in elliptic curve cryptography. This function processes the scalar to create a sparse representation that facilitates efficient computation. The code is intended to be part of a cryptographic library and does not define public APIs or external interfaces directly.
# Imports and Dependencies

---
- `fd_curve25519_scalar.h`


# Functions

---
### fd\_curve25519\_scalar\_reduce<!-- {{#callable:fd_curve25519_scalar_reduce}} -->
[View Source →](<../../../../../src/ballet/ed25519/fd_curve25519_scalar.c#L3>)

Reduces a 512-bit integer to a 256-bit integer using the Curve25519 scalar reduction algorithm.
- **Inputs**:
    - `out`: A 32-byte array where the reduced scalar will be stored.
    - `in`: A 64-byte array representing the 512-bit integer to be reduced.
- **Logic and Control Flow**:
    - Load the 512-bit input into eight 64-bit unsigned long integers.
    - Unpack these integers into 23 21-bit integers and a 29-bit integer.
    - Perform the reduction by iteratively adjusting the 21-bit integers using specific constants and setting the higher bits to zero.
    - Handle carries by shifting and adjusting the values to ensure each part fits within 21 bits.
    - Pack the reduced 256-bit result into the output array.
- **Output**: Returns a pointer to the 32-byte output array containing the reduced scalar.


---
### fd\_curve25519\_scalar\_muladd<!-- {{#callable:fd_curve25519_scalar_muladd}} -->
[View Source →](<../../../../../src/ballet/ed25519/fd_curve25519_scalar.c#L112>)

Performs scalar multiplication and addition on Curve25519 scalars and reduces the result.
- **Inputs**:
    - `s`: A 32-byte array where the result will be stored.
    - `a`: A pointer to a 32-byte array representing the first scalar.
    - `b`: A 32-byte array representing the second scalar.
    - `c`: A 32-byte array representing the third scalar.
- **Logic and Control Flow**:
    - Load the 32-byte arrays `a`, `b`, and `c` into 64-bit unsigned integers `ia0` to `ia3`, `ib0` to `ib3`, and `ic0` to `ic3` respectively.
    - Unpack each 64-bit integer into eleven 21-bit integers and one 25-bit integer.
    - Perform the multiplication and addition of the unpacked integers to compute intermediate results `s0` to `s23`.
    - Reduce the intermediate results by carrying overflows from lower to higher indices, ensuring each result fits within 21 bits.
    - Further reduce the results by applying specific constants to handle overflows and ensure the final result fits within the 32-byte array `s`.
    - Pack the reduced results back into the 32-byte array `s`.
- **Output**: Returns a pointer to the 32-byte array `s` containing the reduced result of the scalar multiplication and addition.


---
### fd\_curve25519\_scalar\_wnaf<!-- {{#callable:FD_FN_NO_ASAN::fd_curve25519_scalar_wnaf}} -->
[View Source →](<../../../../../src/ballet/ed25519/fd_curve25519_scalar.c#L277>)

Converts a scalar into a windowed non-adjacent form (wNAF) representation.
- **Inputs**:
    - `_t`: A 256-entry array of shorts where the wNAF representation will be stored.
    - `_vs`: A 32-byte array representing the scalar to be converted, assumed to be valid.
    - `bits`: An integer specifying the range [1:12] for the wNAF conversion, where 1 represents NAF.
- **Logic and Control Flow**:
    - Initialize `max` as the maximum value for the wNAF representation based on `bits`.
    - Unpack the bits of `_vs` into `_t`, setting each entry to 0 or 1, and ensure `_t[255]` is 0.
    - Find the first non-zero entry in `_t` to start processing.
    - Iterate over `_t` to make the representation sparse by absorbing as many subsequent entries as possible into the current entry.
    - For each non-zero entry, calculate `delta` and check if it can be absorbed into the current entry without exceeding the range [-max, max].
    - If possible, add or subtract `delta` to/from the current entry and zero out the absorbed entry.
    - If subtraction is used, propagate the carry to subsequent entries until a zero is found.
    - Finalize the current entry and move to the next non-zero entry.
- **Output**: The function modifies the `_t` array to contain the wNAF representation of the input scalar.



---
Made with ❤️ by [Driver](https://www.driver.ai/)