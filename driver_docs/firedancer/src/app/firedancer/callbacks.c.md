<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines callback functions for various components like banks, bank hash comparison, funk, fec sets, store, txncache, and exec spad in the Firedancer application.

# Purpose
The code defines a set of callback structures and functions for managing various components in a distributed system. Each component, such as `banks`, `bank_hash_cmp`, `funk`, `fec_sets`, `store`, `txncache`, and `exec_spad`, has associated functions to determine its memory footprint, alignment requirements, and initialization process. These functions use the `fd_topo_t` and `fd_topo_obj_t` structures to interact with the system's topology and object properties. The `VAL` macro is used to query specific properties of an object, ensuring that necessary parameters are set before proceeding with operations.

Each component is represented by a `fd_topo_obj_callbacks_t` structure, which includes pointers to the functions that handle the component's footprint, alignment, and initialization. The code imports several headers from different directories, indicating that it relies on external libraries for functionality related to topology, storage, and runtime operations. The primary purpose of this code is to provide a modular way to manage different system components, ensuring that each component is correctly initialized and aligned within the system's memory architecture.
# Imports and Dependencies

---
- `../../util/pod/fd_pod_format.h`
- `../../disco/topo/fd_topo.h`
- `../../disco/store/fd_store.h`
- `../../flamenco/runtime/fd_bank.h`
- `../../flamenco/runtime/fd_runtime.h`
- `../../flamenco/runtime/fd_txncache_shmem.h`


# Global Variables

---
### fd\_obj\_cb\_banks
- **Type**: ``fd_topo_obj_callbacks_t``
- **Description**: Defines a set of callback functions for handling 'banks' objects in a topology. It includes functions for calculating the footprint, alignment, and creating new instances of 'banks' objects.
- **Use**: Used to manage 'banks' objects within a topology by providing necessary operations like footprint calculation, alignment, and instantiation.


---
### fd\_obj\_cb\_bank\_hash\_cmp
- **Type**: `fd_topo_obj_callbacks_t`
- **Description**: Contains callback functions for handling bank hash comparison objects in a topology. The structure includes function pointers for obtaining the footprint, alignment, and creating new instances of the bank hash comparison object.
- **Use**: Used to manage the lifecycle and properties of bank hash comparison objects within a topology.


---
### fd\_obj\_cb\_funk
- **Type**: `fd_topo_obj_callbacks_t`
- **Description**: Defines a set of callback functions for an object named 'funk'. These callbacks include functions for calculating the footprint, alignment, and loose memory requirements, as well as a function for initializing a new instance of the object.
- **Use**: Used to manage and initialize 'funk' objects within the topology framework.


---
### fd\_obj\_cb\_fec\_sets
- **Type**: ``fd_topo_obj_callbacks_t``
- **Description**: Represents a set of callback functions for handling 'fec_sets' objects in the topology. It includes functions for determining the footprint, alignment, and creation of these objects.
- **Use**: Used to manage 'fec_sets' objects by providing specific operations like footprint calculation, alignment, and instantiation.


---
### fd\_obj\_cb\_store
- **Type**: ``fd_topo_obj_callbacks_t``
- **Description**: Defines a set of callback functions for a 'store' object in the topology. It includes functions for calculating the footprint, alignment, and creating a new instance of the store object.
- **Use**: Used to manage the lifecycle and memory requirements of a 'store' object in the topology.


---
### fd\_obj\_cb\_txncache
- **Type**: `fd_topo_obj_callbacks_t`
- **Description**: Defines a set of callback functions for the transaction cache object in the topology. It includes functions for calculating the footprint, alignment, and initialization of the transaction cache.
- **Use**: Used to manage the lifecycle and memory requirements of the transaction cache in the system.


---
### fd\_obj\_cb\_exec\_spad
- **Type**: ``fd_topo_obj_callbacks_t``
- **Description**: Defines a set of callback functions for the 'exec_spad' object in the topology. The callbacks include functions to determine the footprint, alignment, and initialization of the 'exec_spad' object.
- **Use**: Used to manage the lifecycle and memory requirements of the 'exec_spad' object in the system.


# Functions

---
### banks\_footprint<!-- {{#callable:banks_footprint}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L14>)

Calculates the memory footprint for bank objects using maximum live slots and fork width values from the topology properties.
- **Inputs**:
    - `topo`: A pointer to a `fd_topo_t` structure containing topology properties.
    - `obj`: A pointer to a `fd_topo_obj_t` structure representing the object whose footprint is being calculated.
- **Logic and Control Flow**:
    - Retrieve the value of `max_live_slots` from the topology properties using the `VAL` macro.
    - Retrieve the value of `max_fork_width` from the topology properties using the `VAL` macro.
    - Call `fd_banks_footprint` with the retrieved `max_live_slots` and `max_fork_width` values to calculate the footprint.
- **Output**: Returns an `ulong` representing the calculated memory footprint for the bank object.


---
### banks\_align<!-- {{#callable:banks_align}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L20>)

Returns the alignment requirement for banks by calling `fd_banks_align()`.
- **Inputs**:
    - `topo`: A pointer to a `fd_topo_t` structure, marked as unused.
    - `obj`: A pointer to a `fd_topo_obj_t` structure, marked as unused.
- **Logic and Control Flow**:
    - Calls the function `fd_banks_align()` to get the alignment requirement.
    - Returns the result of `fd_banks_align()`.
- **Output**: The alignment requirement for banks as an `ulong`.


---
### banks\_new<!-- {{#callable:banks_new}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L26>)

Initializes a new bank object using topology and object properties.
- **Inputs**:
    - `topo`: A pointer to a `fd_topo_t` structure that contains the topology properties.
    - `obj`: A pointer to a `fd_topo_obj_t` structure that represents the object with an ID used to query properties.
- **Logic and Control Flow**:
    - Calls `fd_topo_obj_laddr` with `topo` and `obj->id` to get the local address of the object.
    - Uses the `VAL` macro to query `max_live_slots` and `max_fork_width` from the topology properties.
    - Calls `fd_banks_new` with the local address, `max_live_slots`, and `max_fork_width`.
    - Wraps the `fd_banks_new` call with `FD_TEST` to ensure it executes successfully.
- **Output**: No return value; the function performs initialization and checks for success.


---
### bh\_cmp\_footprint<!-- {{#callable:bh_cmp_footprint}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L39>)

Returns the footprint size for a bank hash comparison object.
- **Inputs**:
    - `topo`: A pointer to a constant `fd_topo_t` structure, which is not used in this function.
    - `obj`: A pointer to a constant `fd_topo_obj_t` structure, which is not used in this function.
- **Logic and Control Flow**:
    - Ignores the input parameters `topo` and `obj` by casting them to void.
    - Calls the function `fd_bank_hash_cmp_footprint()` to get the footprint size.
    - Returns the result of `fd_bank_hash_cmp_footprint()`.
- **Output**: The function returns an `ulong` representing the footprint size for a bank hash comparison object.


---
### bh\_cmp\_align<!-- {{#callable:bh_cmp_align}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L46>)

Returns the alignment requirement for a bank hash component.
- **Inputs**:
    - `topo`: A pointer to a constant `fd_topo_t` structure, which is not used in this function.
    - `obj`: A pointer to a constant `fd_topo_obj_t` structure, which is not used in this function.
- **Logic and Control Flow**:
    - Ignore the `topo` and `obj` parameters by casting them to void.
    - Call the `fd_bank_hash_cmp_align` function to get the alignment requirement.
    - Return the result from `fd_bank_hash_cmp_align`.
- **Output**: The function returns an `ulong` value representing the alignment requirement for a bank hash component.


---
### bh\_cmp\_new<!-- {{#callable:bh_cmp_new}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L53>)

Initializes a new bank hash comparator using the local address of a topology object.
- **Inputs**:
    - `topo`: A pointer to a `fd_topo_t` structure representing the topology.
    - `obj`: A pointer to a `fd_topo_obj_t` structure representing the topology object.
- **Logic and Control Flow**:
    - The function casts the input parameters `topo` and `obj` to void to indicate they are unused directly in the function body.
    - Calls `fd_topo_obj_laddr` with `topo` and `obj->id` to get the local address of the topology object.
    - Passes the local address to `fd_bank_hash_cmp_new` to initialize a new bank hash comparator.
    - Uses `FD_TEST` to check the success of `fd_bank_hash_cmp_new`.
- **Output**: No output is returned as the function is of type `void`.


---
### funk\_align<!-- {{#callable:funk_align}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L67>)

Returns the alignment requirement for a 'funk' object by calling 'fd_funk_align'.
- **Inputs**:
    - `topo`: A pointer to a 'fd_topo_t' structure, which is not used in this function.
    - `obj`: A pointer to a 'fd_topo_obj_t' structure, which is not used in this function.
- **Logic and Control Flow**:
    - Ignores the input parameters 'topo' and 'obj'.
    - Calls the function 'fd_funk_align'.
    - Returns the result of 'fd_funk_align'.
- **Output**: The alignment requirement for a 'funk' object as an unsigned long integer.


---
### funk\_footprint<!-- {{#callable:funk_footprint}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L74>)

Calculates the memory footprint for a 'funk' object using transaction and record maximum values.
- **Inputs**:
    - `topo`: A pointer to a constant `fd_topo_t` structure, representing the topology configuration.
    - `obj`: A pointer to a constant `fd_topo_obj_t` structure, representing the specific object within the topology.
- **Logic and Control Flow**:
    - Ignores the `topo` parameter by casting it to void.
    - Uses the `VAL` macro to retrieve the 'txn_max' and 'rec_max' properties from the `obj` within the `topo`.
    - Calls `fd_funk_footprint` with the retrieved 'txn_max' and 'rec_max' values to compute the footprint.
- **Output**: Returns an unsigned long integer representing the memory footprint of the 'funk' object.


---
### funk\_loose<!-- {{#callable:funk_loose}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L81>)

Returns the value of the 'heap_max' property for a given topology object.
- **Inputs**:
    - `topo`: A pointer to a constant `fd_topo_t` structure representing the topology.
    - `obj`: A pointer to a constant `fd_topo_obj_t` structure representing the topology object.
- **Logic and Control Flow**:
    - The function takes two parameters, `topo` and `obj`, but only `obj` is used to query the 'heap_max' property.
    - The macro `VAL` is used to query the 'heap_max' property from the `topo->props` using the `obj->id`.
    - If the 'heap_max' property is not set, the macro logs an error and the function does not return a valid value.
- **Output**: The function returns an `ulong` representing the 'heap_max' value for the specified topology object.


---
### funk\_new<!-- {{#callable:funk_new}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L88>)

Initializes a new funk object with a specified seed and configuration parameters.
- **Inputs**:
    - ``topo``: A pointer to a `fd_topo_t` structure containing topology properties.
    - ``obj``: A pointer to a `fd_topo_obj_t` structure representing the object to initialize.
- **Logic and Control Flow**:
    - Queries the `topo` properties for a seed value associated with the object ID using `fd_pod_queryf_ulong`.
    - If the seed is not found (value is zero), generates a secure random seed using `fd_rng_secure`.
    - Calls `fd_funk_new` with the object's local address, a fixed value of `2UL`, the determined seed, and configuration values for `txn_max` and `rec_max` obtained via the `VAL` macro.
- **Output**: No direct output; the function initializes a funk object in the system.


---
### fec\_sets\_footprint<!-- {{#callable:fec_sets_footprint}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L104>)

Calculates the footprint size for FEC sets using a property value from the topology object.
- **Inputs**:
    - `topo`: A pointer to a `fd_topo_t` structure that contains topology properties.
    - `obj`: A pointer to a `fd_topo_obj_t` structure that represents the topology object with an identifier.
- **Logic and Control Flow**:
    - Uses the `VAL` macro to query the footprint size ('sz') from the topology properties using the object's ID.
    - Returns the queried footprint size.
- **Output**: Returns an `ulong` representing the footprint size for FEC sets.


---
### fec\_sets\_align<!-- {{#callable:fec_sets_align}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L110>)

Returns the alignment requirement for FEC sets by calling `fd_dcache_align()`.
- **Inputs**:
    - `topo`: A pointer to a `fd_topo_t` structure, marked as unused.
    - `obj`: A pointer to a `fd_topo_obj_t` structure, marked as unused.
- **Logic and Control Flow**:
    - Calls the function `fd_dcache_align()` to get the alignment requirement.
    - Returns the result of `fd_dcache_align()`.
- **Output**: The alignment requirement as an `ulong` value.


---
### fec\_sets\_new<!-- {{#callable:fec_sets_new}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L116>)

Validates the logical address of a topology object using its ID.
- **Inputs**:
    - `topo`: A pointer to a constant `fd_topo_t` structure, representing the topology.
    - `obj`: A pointer to a constant `fd_topo_obj_t` structure, representing the topology object.
- **Logic and Control Flow**:
    - Calls `fd_topo_obj_laddr` with `topo` and `obj->id` to get the logical address of the object.
    - Uses `FD_TEST` to check the validity of the logical address returned by `fd_topo_obj_laddr`.
- **Output**: No output is returned; the function performs a validation check.


---
### store\_footprint<!-- {{#callable:store_footprint}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L129>)

Calculates the memory footprint for a store object using the maximum FEC value from the topology properties.
- **Inputs**:
    - `topo`: A pointer to a `fd_topo_t` structure that contains topology properties.
    - `obj`: A pointer to a `fd_topo_obj_t` structure that represents the object for which the footprint is calculated.
- **Logic and Control Flow**:
    - Uses the `VAL` macro to query the `fec_max` property from the topology properties associated with the object.
    - Calls the `fd_store_footprint` function with the retrieved `fec_max` value to calculate the footprint.
- **Output**: Returns an `ulong` representing the calculated memory footprint for the store object.


---
### store\_align<!-- {{#callable:store_align}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L135>)

Returns the alignment requirement for a store object.
- **Inputs**:
    - `topo`: A pointer to a `fd_topo_t` structure, which is not used in this function.
    - `obj`: A pointer to a `fd_topo_obj_t` structure, which is not used in this function.
- **Logic and Control Flow**:
    - Calls the `fd_store_align` function to get the alignment requirement.
    - Returns the result of `fd_store_align`.
- **Output**: The alignment requirement for a store object as an `ulong`.


---
### store\_new<!-- {{#callable:store_new}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L141>)

Initializes a new store object using topology and object properties.
- **Inputs**:
    - ``topo``: A pointer to a `fd_topo_t` structure that contains topology properties.
    - ``obj``: A pointer to a `fd_topo_obj_t` structure that represents the object with an identifier `id`.
- **Logic and Control Flow**:
    - Calls `fd_topo_obj_laddr` with `topo` and `obj->id` to get the local address of the object.
    - Retrieves the values of `fec_max` and `part_cnt` using the `VAL` macro, which queries the topology properties.
    - Calls `fd_store_new` with the local address, `fec_max`, and `part_cnt` to initialize the store.
    - Uses `FD_TEST` to check the success of `fd_store_new`.
- **Output**: No return value; the function performs initialization and checks for success.


---
### txncache\_footprint<!-- {{#callable:txncache_footprint}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L154>)

Calculates the shared memory footprint for a transaction cache using topology properties.
- **Inputs**:
    - `topo`: A pointer to a `fd_topo_t` structure that contains topology properties.
    - `obj`: A pointer to a `fd_topo_obj_t` structure that represents a specific object in the topology.
- **Logic and Control Flow**:
    - Calls the `VAL` macro to retrieve the `max_live_slots` property from the topology using the object's ID.
    - Calls the `VAL` macro to retrieve the `max_txn_per_slot` property from the topology using the object's ID.
    - Passes the retrieved values to the `fd_txncache_shmem_footprint` function to calculate the footprint.
- **Output**: Returns an `ulong` representing the calculated shared memory footprint for the transaction cache.


---
### txncache\_align<!-- {{#callable:txncache_align}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L160>)

Returns the alignment requirement for the transaction cache shared memory.
- **Inputs**:
    - `topo`: A pointer to a constant `fd_topo_t` structure, marked as unused.
    - `obj`: A pointer to a constant `fd_topo_obj_t` structure, marked as unused.
- **Logic and Control Flow**:
    - Calls the function `fd_txncache_shmem_align()` to get the alignment requirement.
    - Returns the result of `fd_txncache_shmem_align()`.
- **Output**: The alignment requirement for the transaction cache shared memory as an unsigned long integer.


---
### txncache\_new<!-- {{#callable:txncache_new}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L166>)

Initializes a new transaction cache in shared memory using topology and object properties.
- **Inputs**:
    - `topo`: A pointer to a `fd_topo_t` structure that contains topology properties.
    - `obj`: A pointer to a `fd_topo_obj_t` structure that represents the object with an ID used to query properties.
- **Logic and Control Flow**:
    - Calls `fd_topo_obj_laddr` with `topo` and `obj->id` to get the local address for the object.
    - Uses the `VAL` macro to query `max_live_slots` and `max_txn_per_slot` from the topology properties.
    - Calls `fd_txncache_shmem_new` with the local address, `max_live_slots`, and `max_txn_per_slot` to create a new transaction cache in shared memory.
    - Uses `FD_TEST` to check the success of `fd_txncache_shmem_new`.
- **Output**: No return value; the function initializes a transaction cache in shared memory.


---
### exec\_spad\_footprint<!-- {{#callable:exec_spad_footprint}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L179>)

Calculates the footprint size for the execution scratchpad by summing predefined constants.
- **Inputs**:
    - `topo`: A pointer to a `fd_topo_t` structure, which is not used in this function.
    - `obj`: A pointer to a `fd_topo_obj_t` structure, which is not used in this function.
- **Logic and Control Flow**:
    - Calls `fd_spad_footprint` with the sum of `FD_EXEC_TXN_CTX_FOOTPRINT` and `FD_RUNTIME_TRANSACTION_EXECUTION_FOOTPRINT_DEFAULT` as the argument.
    - Returns the result of the `fd_spad_footprint` function call.
- **Output**: Returns an `ulong` representing the calculated footprint size for the execution scratchpad.


---
### exec\_spad\_align<!-- {{#callable:exec_spad_align}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L185>)

Returns the alignment requirement for the execution scratchpad.
- **Inputs**:
    - `topo`: A pointer to a constant `fd_topo_t` structure, marked as unused.
    - `obj`: A pointer to a constant `fd_topo_obj_t` structure, marked as unused.
- **Logic and Control Flow**:
    - Calls the `fd_spad_align` function to get the alignment requirement.
    - Returns the result of `fd_spad_align`.
- **Output**: An unsigned long integer representing the alignment requirement for the execution scratchpad.


---
### exec\_spad\_new<!-- {{#callable:exec_spad_new}} -->
[View Source →](<../../../../../src/app/firedancer/callbacks.c#L191>)

Initializes a new shared memory space for transaction execution using default footprint settings.
- **Inputs**:
    - ``topo``: A pointer to a `fd_topo_t` structure that contains topology information.
    - ``obj``: A pointer to a `fd_topo_obj_t` structure that represents the object for which the shared memory space is being initialized.
- **Logic and Control Flow**:
    - Calls `fd_topo_obj_laddr` with `topo` and `obj->id` to get the local address of the object.
    - Calls `fd_spad_new` with the local address and `FD_RUNTIME_TRANSACTION_EXECUTION_FOOTPRINT_DEFAULT` to initialize the shared memory space.
    - Uses `FD_TEST` to check the success of `fd_spad_new`.
- **Output**: No return value; the function performs initialization and checks for success.



---
Made with ❤️ by [Driver](https://www.driver.ai/)