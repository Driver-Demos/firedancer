<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines unit tests for Firedancer tiles, including configuration loading and initialization functions.

# Purpose
The code is a C source file that sets up a testing environment for a tile-based topology system. It includes several header files and external callback objects, which are used to manage different components of the topology. The file defines arrays of callback objects and dummy tiles, which are placeholders for various components in the topology. These components include network, socket, and other functional units, each represented by a `fd_topo_run_tile_t` structure with a specific name.

The primary function, [`fd_tile_unit_test_init`](<#fd_tile_unit_test_init>), initializes a test environment for a specific tile within the topology. It reads configuration files from specified paths, processes these configurations, and initializes the topology using the provided callback functions. The function ensures that the tile under test is placed at the first index of the `TILES` array. It also handles the creation and allocation of workspaces for the topology objects used by the test tile. The function returns a pointer to the initialized test tile, or `NULL` if any errors occur during the initialization process.
# Imports and Dependencies

---
- `fd_tile_unit_test.h`
- `../../app/platform/fd_file_util.h`
- `../../app/shared/fd_obj_callbacks.c`
- `../../app/firedancer/callbacks.c`
- `../../app/shared/fd_action.h`
- `errno.h`
- `sys/mman.h`


# Global Variables

---
### fd\_obj\_cb\_mcache
- **Type**: `fd_topo_obj_callbacks_t`
- **Description**: This variable is a global instance of type `fd_topo_obj_callbacks_t`. It is used to store callback functions related to the management of topology objects in the system.
- **Use**: It is used as an entry in the `CALLBACKS` array to provide specific callback functionality for the memory cache.


---
### fd\_obj\_cb\_dcache
- **Type**: `fd_topo_obj_callbacks_t`
- **Description**: This variable is a global instance of type `fd_topo_obj_callbacks_t`. It is used to define callback functions for managing the data cache in the topology.
- **Use**: It is used in the context of managing and processing topology objects.


---
### fd\_obj\_cb\_fseq
- **Type**: `fd_topo_obj_callbacks_t`
- **Description**: This variable is a global instance of type `fd_topo_obj_callbacks_t`. It is used to define callback functions for a specific object in the topology.
- **Use**: It is used in the `CALLBACKS` array to manage various object callbacks in the system.


---
### fd\_obj\_cb\_metrics
- **Type**: `fd_topo_obj_callbacks_t`
- **Description**: This variable holds a set of callback functions for managing topology objects. It is used to define behavior for specific operations related to the topology.
- **Use**: It is used in the `CALLBACKS` array to provide access to the callback functions during topology operations.


---
### fd\_obj\_cb\_opaque
- **Type**: `fd_topo_obj_callbacks_t`
- **Description**: This variable holds a callback structure of type `fd_topo_obj_callbacks_t`. It is used to define specific callback functions for handling topology objects.
- **Use**: It is used in the `CALLBACKS` array to provide access to various callback functions.


---
### fd\_obj\_cb\_dbl\_buf
- **Type**: `fd_topo_obj_callbacks_t`
- **Description**: This variable is a global instance of type `fd_topo_obj_callbacks_t`. It is used to store callback functions related to a double buffer object in the topology.
- **Use**: It is used in the `CALLBACKS` array to manage and invoke the appropriate callbacks for the double buffer functionality.


---
### fd\_obj\_cb\_neigh4\_hmap
- **Type**: `fd_topo_obj_callbacks_t`
- **Description**: This variable holds a callback structure for topology object operations related to neighbor 4 hash maps. It is defined as an external variable, allowing it to be accessed across different source files.
- **Use**: It is used in the `CALLBACKS` array to manage various topology object callbacks.


---
### fd\_obj\_cb\_fib4
- **Type**: `fd_topo_obj_callbacks_t`
- **Description**: This variable is a global instance of type `fd_topo_obj_callbacks_t`. It is used to define callback functions for a specific topology object in the system.
- **Use**: It is used in the `CALLBACKS` array to manage various topology object callbacks.


---
### fd\_obj\_cb\_keyswitch
- **Type**: `fd_topo_obj_callbacks_t`
- **Description**: This variable holds a callback structure for topology object events. It is used to define specific actions or responses for a keyswitch object in the system.
- **Use**: It is used in the context of managing and responding to events related to the keyswitch topology object.


---
### fd\_obj\_cb\_tile
- **Type**: `fd_topo_obj_callbacks_t`
- **Description**: This variable holds a callback structure for topology object operations. It is used to define specific behaviors for a tile in the system.
- **Use**: It is used in the `CALLBACKS` array to manage different object callbacks.


---
### fd\_obj\_cb\_store
- **Type**: `fd_topo_obj_callbacks_t`
- **Description**: This variable stores callback functions for topology object operations. It is used to manage interactions with various components in the system.
- **Use**: It is used as part of an array of callback pointers for handling different topology objects.


---
### fd\_obj\_cb\_fec\_sets
- **Type**: `fd_topo_obj_callbacks_t`
- **Description**: This variable is a global instance of type `fd_topo_obj_callbacks_t`. It is used to store callback functions related to Forward Error Correction (FEC) settings in the topology.
- **Use**: It is used in the `CALLBACKS` array to manage FEC-related operations in the system.


---
### fd\_obj\_cb\_txncache
- **Type**: `fd_topo_obj_callbacks_t`
- **Description**: This variable holds a set of callback functions for managing transactions in the topology object. It is defined as an external variable, allowing it to be accessed across different source files.
- **Use**: It is used to provide transaction-related callback functionality in the system.


---
### fd\_obj\_cb\_exec\_spad
- **Type**: `fd_topo_obj_callbacks_t`
- **Description**: This variable is a global instance of type `fd_topo_obj_callbacks_t`. It is used to define callback functions for a specific object in the topology.
- **Use**: It is used in the `CALLBACKS` array to manage and invoke the associated callbacks during the execution of the program.


---
### fd\_obj\_cb\_banks
- **Type**: `fd_topo_obj_callbacks_t`
- **Description**: This variable holds a callback structure for topology object operations. It is used to define specific behaviors for managing and interacting with different topology objects.
- **Use**: It is used in the `CALLBACKS` array to provide access to various object callback functions.


---
### fd\_obj\_cb\_funk
- **Type**: `fd_topo_obj_callbacks_t`
- **Description**: This variable holds a callback structure for topology object operations. It is used to define specific behaviors for different objects in the topology.
- **Use**: It is used in the `CALLBACKS` array to manage various object callbacks in the system.


---
### fd\_obj\_cb\_bank\_hash\_cmp
- **Type**: `fd_topo_obj_callbacks_t`
- **Description**: This variable is a global instance of type `fd_topo_obj_callbacks_t`. It is used to define callback functions for handling operations related to bank hash objects in a topology.
- **Use**: It is referenced in the `CALLBACKS` array to manage specific callback operations.


---
### CALLBACKS
- **Type**: `fd_topo_obj_callbacks_t *`
- **Description**: This variable is an array of pointers to `fd_topo_obj_callbacks_t` structures. Each pointer in the array points to a specific callback function used in the topology management.
- **Use**: It is used to store and access various callback functions for handling different object types in the topology.


---
### dummy\_tile\_net
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable represents a tile in the topology with the name 'net'. It is part of a structure that defines various properties and behaviors of tiles used in the system.
- **Use**: It is used to define a specific tile type within the topology for testing and operational purposes.


---
### dummy\_tile\_netlnk
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable represents a tile in the topology with the name 'netlnk'. It is part of a structure that defines various properties and behaviors of tiles used in the system.
- **Use**: It is used to define a specific tile type within the topology for testing and operational purposes.


---
### dummy\_tile\_sock
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name 'sock'.
- **Use**: It is used as a dummy tile in the topology configuration.


---
### dummy\_tile\_quic
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It represents a tile with the name 'quic' in the topology.
- **Use**: It is used to define a specific tile in the topology for testing purposes.


---
### dummy\_tile\_bundle
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It represents a tile in a topology with the name set to "bundle".
- **Use**: It is used to fill up the topology in the `TILES` array.


---
### dummy\_tile\_verify
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name "verify". It represents a dummy tile used in topology testing.
- **Use**: It is used to fill up the topology in the `TILES` array.


---
### dummy\_tile\_dedup
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable represents a tile in the topology with the name 'dedup'. It is part of a set of dummy tiles used to fill up the topology for testing purposes.
- **Use**: It is used to define a specific tile type in the topology configuration.


---
### dummy\_tile\_pack
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name 'pack'. It represents a dummy tile used in topology.
- **Use**: It is used to fill up the topology in the `TILES` array.


---
### dummy\_tile\_shred
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name 'shred'. This instance represents a specific tile in the topology used for testing.
- **Use**: It is used as a dummy tile in the topology configuration.


---
### dummy\_tile\_sign
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable represents a tile in the topology with the name 'sign'. It is part of a collection of dummy tiles used to fill up the topology for testing purposes.
- **Use**: It is used in the `TILES` array to represent a specific tile type in the topology.


---
### dummy\_tile\_metric
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name 'metric'.
- **Use**: It serves as a dummy tile in the topology for testing purposes.


---
### dummy\_tile\_cswtch
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable represents a tile in the topology with the name 'cswtch'. It is part of a collection of tiles used to fill up the topology for testing purposes.
- **Use**: It is used to define a specific tile type within the topology structure.


---
### dummy\_tile\_gui
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name 'gui'.
- **Use**: It serves as a dummy tile in the topology for testing purposes.


---
### dummy\_tile\_plugin
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name 'plugin'. This instance represents a tile in the topology used for testing.
- **Use**: It is used as a placeholder in the `TILES` array for managing different topology tiles.


---
### dummy\_tile\_bencho
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name 'bencho'.
- **Use**: It serves as a dummy tile in the topology for testing purposes.


---
### dummy\_tile\_benchg
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name "benchg". It represents a specific tile in a topology used for testing.
- **Use**: It is used to define a tile in the topology for the system.


---
### dummy\_tile\_benchs
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It represents a tile in a topology with the name set to "benchs".
- **Use**: It is used to define a specific tile in the topology for testing purposes.


---
### dummy\_tile\_pktgen
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is a global instance of the `fd_topo_run_tile_t` structure. It is initialized with the name "pktgen". This structure likely represents a tile in a topology used for packet generation.
- **Use**: It is used to define a specific tile in the topology for packet generation.


---
### dummy\_tile\_resolv
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of the `fd_topo_run_tile_t` structure. It is initialized with the name "resolv" and serves as a dummy tile in the topology.
- **Use**: It is used to represent a specific tile in the topology configuration.


---
### dummy\_tile\_poh
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name "poh". It represents a dummy tile used in the topology.
- **Use**: It is used to fill up the topology in the `TILES` array.


---
### dummy\_tile\_bank
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable represents a tile in the topology with the name 'bank'. It is part of a set of dummy tiles used to fill up the topology for testing purposes.
- **Use**: It is used to define a specific tile type within the topology structure.


---
### dummy\_tile\_store
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name 'store'. This instance represents a dummy tile used in topology.
- **Use**: It is used to fill up the topology in the system.


---
### dummy\_tile\_gossvf
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name "gossvf". This instance represents a specific tile in the topology.
- **Use**: It is used to define a tile in the topology for network operations.


---
### dummy\_tile\_gossip
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name 'gossip'.
- **Use**: It serves as a dummy tile in the topology for testing purposes.


---
### dummy\_tile\_repair
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is a global instance of the `fd_topo_run_tile_t` structure. It is initialized with the name 'repair' and is used to represent a specific tile in the topology.
- **Use**: It is used to fill up the topology in the system.


---
### dummy\_tile\_send
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name "send". It represents a tile in a topology used for network operations.
- **Use**: It is used to define a specific tile type within the topology structure.


---
### dummy\_tile\_replay
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name 'replay'. This instance represents a specific tile in the topology used for testing.
- **Use**: It is used as a placeholder in the `TILES` array for managing different tiles in the topology.


---
### dummy\_tile\_exec
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name 'exec'.
- **Use**: It serves as a dummy tile in the topology for testing purposes.


---
### dummy\_tile\_tower
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable represents a tile in the topology with the name 'tower'. It is part of a collection of dummy tiles used to fill up the topology for testing purposes.
- **Use**: It is used to define a specific tile type within the topology structure.


---
### dummy\_tile\_rpcsrv
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name 'rpcsrv'.
- **Use**: It serves as a dummy tile in the topology for testing purposes.


---
### dummy\_tile\_snapct
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable represents a tile in the topology with the name 'snapct'. It is part of a set of dummy tiles used to fill up the topology for testing purposes.
- **Use**: It is used to define a specific tile in the topology configuration.


---
### dummy\_tile\_snapld
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable represents a tile in the topology with the name 'snapld'. It is part of a collection of tiles used in the system for various operations.
- **Use**: It is used to define a specific tile in the topology for processing.


---
### dummy\_tile\_snapdc
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name "snapdc". It represents a tile in the topology used for testing.
- **Use**: It is used as part of the global array `TILES` to manage different topology tiles.


---
### dummy\_tile\_snapin
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name 'snapin'. This instance represents a specific tile in the topology.
- **Use**: It is used to define a tile in the topology for testing purposes.


---
### dummy\_tile\_arch\_f
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It represents a tile in the topology with the name set to "arch_f".
- **Use**: It is used to define a specific tile in the topology for testing purposes.


---
### dummy\_tile\_arch\_w
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is a global instance of the `fd_topo_run_tile_t` structure. It is initialized with the name 'arch_w'.
- **Use**: It serves as a dummy tile in the topology for testing purposes.


---
### dummy\_tile\_scap
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name 'scap'.
- **Use**: It serves as a dummy tile in the topology configuration.


---
### dummy\_tile\_genesi
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name "genesi".
- **Use**: It serves as a dummy tile in the topology configuration.


---
### dummy\_tile\_ipecho
- **Type**: `fd_topo_run_tile_t`
- **Description**: This variable is an instance of `fd_topo_run_tile_t`. It is initialized with the name "ipecho". This instance represents a specific tile in the topology.
- **Use**: It is used to define a tile in the topology for testing purposes.


---
### TILES
- **Type**: `fd_topo_run_tile_t * TILES[]`
- **Description**: This variable is an array of pointers to `fd_topo_run_tile_t` structures. It holds references to various tile configurations used in the topology, with the first element reserved as a placeholder for the tile under test.
- **Use**: It is used to manage and access different tile configurations during the execution of the program.


---
### ACTIONS
- **Type**: `action_t *`
- **Description**: This variable is an array of pointers to `action_t` structures. It is initialized with a single `NULL` value, indicating that it currently does not hold any valid action references.
- **Use**: It is used to store and manage a collection of actions in the program.


# Functions

---
### fd\_tile\_unit\_test\_init<!-- {{#callable:fd_tile_unit_test_init}} -->
[View Source →](<../../../../../src/app/shared/fd_tile_unit_test.c#L138>)

Initializes a test tile in a topology configuration by loading configuration files, setting up workspaces, and returning the test tile.
- **Inputs**:
    - `default_topo_config_path`: Path to the default topology configuration file.
    - `override_topo_config_path`: Path to the override topology configuration file.
    - `user_topo_config_path`: Path to the user topology configuration file.
    - `netns`: Network namespace identifier.
    - `is_firedancer`: Flag indicating if the configuration is for Firedancer.
    - `is_local_cluster`: Flag indicating if the configuration is for a local cluster.
    - `fd_topo_initialize_`: Function pointer to initialize the topology with the given configuration.
    - `topo_run_tile`: Pointer to the tile to be tested.
    - `out_config`: Pointer to the configuration structure to be filled.
- **Logic and Control Flow**:
    - Set the tile under test at index 0 in `TILES`.
    - Read the default topology configuration file and check for errors.
    - Read the override topology configuration file if provided and check for errors.
    - Read the user topology configuration file if provided and check for errors.
    - Initialize the `out_config` structure to zero.
    - Load the configuration using `fd_config_load` with the provided parameters.
    - Call the `fd_topo_initialize_` function to initialize the topology.
    - Search for the test tile in the configuration's tile list.
    - For each object used by the test tile, check if the workspace is initialized; if not, create and allocate it.
    - Log warnings if any errors occur during the process.
    - Return the test tile if found and initialized, otherwise return `NULL`.
- **Output**: Returns a pointer to the initialized test tile or `NULL` if an error occurs.



---
Made with ❤️ by [Driver](https://www.driver.ai/)