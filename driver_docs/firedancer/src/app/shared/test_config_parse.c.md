<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Tests for parsing and validating TOML configuration strings in the Firedancer application.

# Purpose
This code is an executable C program that tests the functionality of a configuration parsing system using the TOML format. It includes the necessary headers for configuration management and TOML parsing. The program defines two static configuration strings, `cfg_str_1` and `cfg_str_2`, which represent different TOML configurations. The main function initializes the environment and memory structures required for parsing and validating these configurations.

The program uses a series of tests to verify the parsing and extraction of configuration data. It checks that a basic configuration string can be parsed and that the expected values are extracted correctly. It also tests the rejection of unrecognized configuration keys and ensures that a default configuration can be parsed without errors. Additionally, the program verifies that specific fields in the configuration can be selectively overridden while maintaining other values. The use of `FD_TEST` macros indicates that the program is designed to validate the correctness of the configuration parsing and extraction process, and it logs a notice upon successful completion of all tests.
# Imports and Dependencies

---
- `fd_config_private.h`
- `../../ballet/toml/fd_toml.h`


# Global Variables

---
### cfg\_str\_1
- **Type**: ``char const[]``
- **Description**: A constant character array that contains a TOML configuration string for a 'gossip' section with an entry point IP address and port.
- **Use**: Used to parse and extract configuration data for the 'gossip' section in the application.


---
### cfg\_str\_2
- **Type**: ``char const[]``
- **Description**: A static constant character array that contains a configuration string in TOML format. The string defines a key-value pair where the key is 'wumbo' and the value is 'mini'.
- **Use**: Used to test the parsing and rejection of unrecognized configuration keys in the TOML parsing process.


---
### fdctl\_default\_config
- **Type**: ``uchar const[]``
- **Description**: An array of unsigned characters that represents the default configuration data for the application. The size of this array is defined by the variable `fdctl_default_config_sz`. This configuration data is used to initialize or reset the application's settings to a known state.
- **Use**: Used to parse and extract configuration settings into a `config_t` structure for application initialization and validation.


---
### fdctl\_default\_config\_sz
- **Type**: `ulong`
- **Description**: `fdctl_default_config_sz` is a constant global variable of type `ulong` that represents the size of the default configuration data.
- **Use**: Used to specify the size of the `fdctl_default_config` array when parsing the default configuration.


# Functions

---
### main<!-- {{#callable:main}} -->
[View Source →](<../../../../../src/app/shared/test_config_parse.c#L14>)

Initializes the system, parses configuration strings, validates configurations, and tests configuration overrides.
- **Inputs**:
    - `argc`: The number of command-line arguments.
    - `argv`: An array of command-line argument strings.
- **Logic and Control Flow**:
    - Calls `fd_boot` to initialize the system with command-line arguments.
    - Allocates memory for a configuration pod and joins it using `fd_pod_join`.
    - Parses a basic configuration string `cfg_str_1` using `fd_toml_parse` and checks the result with `FD_TEST`.
    - Extracts the configuration from the pod into a `config_t` structure and validates the entrypoints count and value.
    - Clears the configuration structure and parses an unrecognized configuration string `cfg_str_2`, ensuring it is not extracted.
    - Clears the configuration structure again and parses the default configuration, validating it with [`fd_config_validate`](<fd_config.c.md#fd_config_validate>).
    - Modifies the configuration to test selective field overrides, parses `cfg_str_1` again, and checks that only specific fields are overridden.
    - Logs a notice of success and halts the system with `fd_halt`.
- **Output**: No return value; the function performs system initialization, configuration parsing, and validation, and exits the process on failure.
- **Functions Called**:
    - [`fd_config_extract_pod`](<fd_config_parse.c.md#fd_config_extract_pod>)
    - [`fd_config_validate`](<fd_config.c.md#fd_config_validate>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)