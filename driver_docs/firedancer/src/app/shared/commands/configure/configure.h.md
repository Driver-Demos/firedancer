<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Header file for configuration commands, stages, and result handling in the Firedancer application.

# Purpose
The code is a C header file that defines structures, macros, and function prototypes for a configuration management system. It is designed to handle the configuration of various system components, likely within a larger application. The file includes several header files, indicating dependencies on platform-specific checks and configuration actions. It defines a set of macros for handling configuration results, such as `CONFIGURE_OK`, `CONFIGURE_NOT_CONFIGURED`, and `CONFIGURE_PARTIALLY_CONFIGURED`, which are used to standardize the reporting of configuration status.

The file introduces a `configure_stage_t` structure, which represents a stage in the configuration process. Each stage has associated functions for initialization, finalization, and checking the configuration status. The file declares several external `configure_stage_t` instances, such as `fd_cfg_stage_hugetlbfs` and `fd_cfg_stage_sysctl`, which represent specific configuration stages. Additionally, the file provides function prototypes for checking directory and file configurations, as well as executing configuration commands. The `configure_args_t` structure is used to encapsulate command arguments for configuration operations. The header file is intended to be included in other C source files to provide configuration management functionality.
# Imports and Dependencies

---
- `../../../platform/fd_cap_chk.h`
- `../../fd_config.h`
- `../../fd_action.h`
- `stdarg.h`


# Global Variables

---
### fd\_cfg\_stage\_hugetlbfs
- **Type**: ``configure_stage_t``
- **Description**: Represents a configuration stage for managing HugeTLBFS settings. It includes function pointers for enabling, initializing, finalizing, and checking the configuration.
- **Use**: Used to define and manage the configuration process for HugeTLBFS in the application.


---
### fd\_cfg\_stage\_sysctl
- **Type**: ``configure_stage_t``
- **Description**: Represents a configuration stage for system control settings. It includes function pointers for enabling, initializing, finalizing, and checking the configuration stage.
- **Use**: Used to manage the system control configuration stage in a sequence of configuration operations.


---
### fd\_cfg\_stage\_hyperthreads
- **Type**: ``configure_stage_t``
- **Description**: Represents a configuration stage for managing hyperthread settings in a system. It includes function pointers for enabling, initializing, finalizing, and checking the configuration of hyperthreads.
- **Use**: Used to define and manage the configuration process for hyperthreads in a system.


---
### fd\_cfg\_stage\_ethtool\_channels
- **Type**: ``configure_stage_t``
- **Description**: Represents a configuration stage for managing ethtool channels settings. It includes function pointers for enabling, initializing, finalizing, and checking the configuration.
- **Use**: Used to manage the configuration process for ethtool channels, including initialization and validation.


---
### fd\_cfg\_stage\_ethtool\_offloads
- **Type**: ``configure_stage_t``
- **Description**: Represents a configuration stage for managing ethtool offloads settings. It includes function pointers for enabling, initializing, finalizing, and checking the configuration.
- **Use**: Used to manage the configuration process for ethtool offloads in a system.


---
### fd\_cfg\_stage\_ethtool\_loopback
- **Type**: ``configure_stage_t``
- **Description**: Represents a configuration stage for the ethtool loopback settings. It is part of a series of configuration stages used to manage system settings.
- **Use**: Used to define and manage the configuration process for ethtool loopback settings.


---
### fd\_cfg\_stage\_snapshots
- **Type**: ``configure_stage_t``
- **Description**: Represents a configuration stage for managing snapshots in the system. It includes function pointers for enabling, initializing, finalizing, and checking the configuration of snapshots.
- **Use**: Used to define the behavior and operations related to the snapshot configuration stage.


---
### STAGES
- **Type**: ``configure_stage_t *` array`
- **Description**: An array of pointers to `configure_stage_t` structures. Each element in the array represents a different configuration stage in the system.
- **Use**: Used to store and manage multiple configuration stages for system setup and management.


---
### fd\_action\_configure
- **Type**: ``action_t``
- **Description**: `fd_action_configure` is a global variable of type `action_t`. It is declared as an external variable, indicating that it is defined elsewhere in the program.
- **Use**: Used to represent a specific action configuration within the application.


# Data Structures

---
### configure\_result\_t
- **Type**: ``struct``
- **Members**:
    - `result`: Stores an integer that indicates the configuration result status.
    - `message`: Holds a character array of size 256 to store a message related to the configuration result.
- **Description**: Represents the result of a configuration operation, including a status code and an associated message.


---
### configure\_stage\_t
- **Type**: ``struct``
- **Members**:
    - ``name``: A pointer to a constant character string representing the name of the configuration stage.
    - ``always_recreate``: An integer flag indicating whether the stage should always be recreated.
    - ``enabled``: A pointer to a function that checks if the stage is enabled based on the given configuration.
    - ``init_perm``: A pointer to a function that initializes permanent resources for the stage.
    - ``fini_perm``: A pointer to a function that finalizes permanent resources for the stage.
    - ``init``: A pointer to a function that initializes the stage with the given configuration.
    - ``fini``: A pointer to a function that finalizes the stage and returns an integer indicating if any actions were taken.
    - ``check``: A pointer to a function that checks the configuration of the stage and returns a `configure_result_t`.
- **Description**: Defines a configuration stage with associated functions for enabling, initializing, finalizing, and checking the stage based on a given configuration.


---
### configure\_cmd\_t
- **Type**: ``enum``
- **Members**:
    - ``CONFIGURE_CMD_INIT``: Represents the initialization command for configuration.
    - ``CONFIGURE_CMD_CHECK``: Represents the command to check the configuration.
    - ``CONFIGURE_CMD_FINI``: Represents the finalization command for configuration.
- **Description**: Defines a set of commands used to control the configuration process, including initialization, checking, and finalization.


---
### configure\_args\_t
- **Type**: ``struct``
- **Members**:
    - `command`: Specifies the command to execute, represented by `configure_cmd_t`.
    - `stages`: Pointer to an array of `configure_stage_t` pointers, representing the stages of configuration.
- **Description**: Holds the command and stages necessary for a configuration process, where `command` indicates the specific action to perform and `stages` provides the sequence of configuration stages to execute.


# Function Declarations (Public API)

---
### check\_dir<!-- {{#callable_declaration:check_dir}} -->
[View Source →](<../../../../../../../src/app/shared/commands/configure/configure.h#L93>)

Checks if a directory exists and is configured with the specified user ID, group ID, and access mode.
- **Description**: Use this function to verify the existence and configuration of a directory at a given path. It checks if the directory is set with the specified user ID (`uid`), group ID (`gid`), and access mode (`mode`). This function is useful when you need to ensure that a directory meets specific security or access requirements before performing operations that depend on these settings. The function returns a `configure_result_t` structure that indicates the result of the check, which can be used to determine if the directory is correctly configured or if further action is needed.
- **Inputs**:
    - `path`: A pointer to a null-terminated string that specifies the path to the directory. Must not be null.
    - `uid`: An unsigned integer representing the user ID that the directory should be configured with.
    - `gid`: An unsigned integer representing the group ID that the directory should be configured with.
    - `mode`: An unsigned integer representing the access mode that the directory should be configured with.
- **Output**: A `configure_result_t` structure indicating the result of the directory check, including a result code and a message.
- **See Also**: [`check_dir`](<configure.c.md#check_dir>)  (Implementation)


---
### check\_file<!-- {{#callable_declaration:check_file}} -->
[View Source →](<../../../../../../../src/app/shared/commands/configure/configure.h#L101>)

Checks if a file exists and is configured with the specified uid, gid, and access mode.
- **Description**: Use this function to verify the existence and configuration of a file at a given path. It checks if the file is set with the specified user ID (uid), group ID (gid), and access mode. This function is useful in scenarios where file permissions and ownership need to be validated before performing operations that depend on these attributes. Ensure that the path provided is valid and accessible.
- **Inputs**:
    - `path`: A pointer to a null-terminated string representing the file path. Must not be null. The path should be valid and accessible.
    - `uid`: An unsigned integer representing the user ID to check against the file's ownership. Must be a valid user ID.
    - `gid`: An unsigned integer representing the group ID to check against the file's group ownership. Must be a valid group ID.
    - `mode`: An unsigned integer representing the access mode to check against the file's permissions. Must be a valid mode value.
- **Output**: Returns a `configure_result_t` structure containing the result of the check and a message. The result indicates whether the file is correctly configured, partially configured, or not configured.
- **See Also**: [`check_file`](<configure.c.md#check_file>)  (Implementation)


---
### configure\_stage<!-- {{#callable_declaration:configure_stage}} -->
[View Source →](<../../../../../../../src/app/shared/commands/configure/configure.h#L107>)

Executes a configuration command on a specified stage.
- **Description**: Use this function to execute a configuration command on a given stage. It processes the command based on the current configuration state and the specified command type. The function handles initialization, checking, and finalization commands, and logs relevant information or errors during execution. Ensure that the `stage` parameter is properly initialized and that the `config` parameter is valid before calling this function. The function returns an integer indicating the success or failure of the operation.
- **Inputs**:
    - `stage`: A pointer to a `configure_stage_t` structure representing the stage to configure. Must not be null and should be properly initialized.
    - `command`: A `configure_cmd_t` value indicating the command to execute. Valid values are `CONFIGURE_CMD_INIT`, `CONFIGURE_CMD_CHECK`, and `CONFIGURE_CMD_FINI`.
    - `config`: A pointer to a constant `config_t` structure containing the configuration data. Must not be null.
- **Output**: Returns an integer indicating the result of the operation. A return value of 0 indicates success, while a non-zero value indicates a warning or error occurred during the operation.
- **See Also**: [`configure_stage`](<configure.c.md#configure_stage>)  (Implementation)


---
### configure\_cmd\_args<!-- {{#callable_declaration:configure_cmd_args}} -->
[View Source →](<../../../../../../../src/app/shared/commands/configure/configure.h#L112>)

Parses and configures command-line arguments for a configuration command.
- **Description**: Use this function to parse command-line arguments and configure the `args` structure for a configuration command. It expects at least one command argument, which must be one of 'init', 'check', or 'fini'. If the command is not recognized, the function logs an error and terminates. After parsing the command, it processes the remaining arguments as configuration stages. If 'all' is specified as a stage, it includes all available stages. The function modifies `pargc` and `pargv` to reflect the unprocessed arguments. Ensure that `pargc` is at least 2 before calling this function.
- **Inputs**:
    - `pargc`: Pointer to the argument count. Must be at least 2. The function decrements this value as arguments are processed.
    - `pargv`: Pointer to the argument vector. The function advances this pointer as arguments are processed.
    - `args`: Pointer to an `args_t` structure where the parsed command and stages will be stored. Must not be null.
- **Output**: None
- **See Also**: [`configure_cmd_args`](<configure.c.md#configure_cmd_args>)  (Implementation)


---
### configure\_cmd\_perm<!-- {{#callable_declaration:configure_cmd_perm}} -->
[View Source →](<../../../../../../../src/app/shared/commands/configure/configure.h#L113>)

Configures permissions for command stages.
- **Description**: Use this function to configure permissions for each stage in a command sequence. It processes stages based on the command type specified in the `args` parameter. For `CONFIGURE_CMD_INIT`, it initializes permissions if the stage is enabled and not already configured. For `CONFIGURE_CMD_FINI`, it finalizes permissions under similar conditions. The function does not perform any actions for `CONFIGURE_CMD_CHECK`. Ensure that `args` and `chk` are properly initialized before calling this function.
- **Inputs**:
    - `args`: A pointer to an `args_t` structure containing the command and stages to process. Must not be null. The `command` field determines the action taken for each stage.
    - `chk`: A pointer to an `fd_cap_chk_t` structure used for permission checks. Must not be null. The function may modify this structure based on the stage's permission functions.
    - `config`: A pointer to a constant `config_t` structure providing configuration data for the stages. Must not be null. Used to determine if a stage is enabled and to perform checks.
- **Output**: None
- **See Also**: [`configure_cmd_perm`](<configure.c.md#configure_cmd_perm>)  (Implementation)


---
### configure\_cmd\_fn<!-- {{#callable_declaration:configure_cmd_fn}} -->
[View Source →](<../../../../../../../src/app/shared/commands/configure/configure.h#L114>)

Executes configuration commands on specified stages.
- **Description**: Use this function to execute a configuration command on a series of stages specified in the `args` parameter. The function processes each stage in the order provided, unless the command is `CONFIGURE_CMD_FINI`, in which case it processes the stages in reverse order. It logs an error if any stage fails to configure. Ensure that `args` and `config` are properly initialized before calling this function.
- **Inputs**:
    - `args`: A pointer to an `args_t` structure containing the configuration command and stages to process. Must not be null.
    - `config`: A pointer to a `config_t` structure that provides configuration details for the stages. Must not be null.
- **Output**: None
- **See Also**: [`configure_cmd_fn`](<configure.c.md#configure_cmd_fn>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)