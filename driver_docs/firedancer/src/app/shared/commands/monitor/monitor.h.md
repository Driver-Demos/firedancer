<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Function prototypes and an external action declaration for monitoring commands.

# Purpose
This C header file defines the interface for a monitoring command module. It includes necessary configuration and action headers, `fd_config.h` and `fd_action.h`, to access shared configurations and actions. The file declares three functions: [`monitor_cmd_args`](<#monitor_cmd_args>), [`monitor_cmd_perm`](<#monitor_cmd_perm>), and [`monitor_cmd_fn`](<#monitor_cmd_fn>), which handle command-line arguments, permission checks, and command execution, respectively, using the `args_t`, `fd_cap_chk_t`, and `config_t` data types. The file also declares an external variable, `fd_action_monitor`, which represents the action associated with the monitoring command. The use of include guards ensures that the header is only included once during compilation to prevent redefinition errors.
# Imports and Dependencies

---
- `../../fd_config.h`
- `../../fd_action.h`


# Global Variables

---
### fd\_action\_monitor
- **Type**: ``action_t``
- **Description**: `fd_action_monitor` is a global variable of type `action_t`. It is declared as an external variable, indicating that it is defined elsewhere, likely in a different source file.
- **Use**: Used to represent or perform a specific action within the monitoring command functionality.


# Function Declarations (Public API)

---
### monitor\_cmd\_args<!-- {{#callable_declaration:monitor_cmd_args}} -->
[View Source →](<../../../../../../../src/app/shared/commands/monitor/monitor.h#L7>)

Parses and validates command-line arguments for monitoring configuration.
- **Description**: Use this function to extract and validate specific command-line arguments related to monitoring configuration. It modifies the argument count and vector to remove recognized options. This function must be called before using the `args` structure for monitoring purposes. It ensures that the `--dt-min`, `--dt-max`, and `--duration` arguments are within valid ranges and sets default values if they are not provided. It also checks for the presence of `--bench` and `--sankey` flags. If any argument is invalid, the function logs an error and terminates the program.
- **Inputs**:
    - `pargc`: Pointer to the argument count. Must not be null. The function updates this value to reflect the removal of recognized arguments.
    - `pargv`: Pointer to the argument vector. Must not be null. The function updates this array to remove recognized arguments.
    - `args`: Pointer to an `args_t` structure where the parsed values will be stored. Must not be null. The function populates this structure with the parsed and validated values.
- **Output**: None
- **See Also**: [`monitor_cmd_args`](<monitor.c.md#monitor_cmd_args>)  (Implementation)


---
### monitor\_cmd\_fn<!-- {{#callable_declaration:monitor_cmd_fn}} -->
[View Source →](<../../../../../../../src/app/shared/commands/monitor/monitor.h#L11>)

Executes the monitor command with specified arguments and configuration.
- **Description**: Use this function to execute a monitoring command with the given arguments and configuration. It sets up necessary signal handlers, configures file descriptors, and applies security policies. Preconditions include valid `args` and `config` pointers. The function handles specific conditions based on the `args` and `config` values, such as enabling benchmarking or sandboxing. It terminates the process gracefully after execution.
- **Inputs**:
    - `args`: A pointer to an `args_t` structure containing command arguments. Must not be null. The function uses this to determine specific monitoring options and file descriptors.
    - `config`: A pointer to a `config_t` structure containing configuration settings. Must not be null. The function uses this to configure topology, security settings, and sandboxing options.
- **Output**: None
- **See Also**: [`monitor_cmd_fn`](<monitor.c.md#monitor_cmd_fn>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)