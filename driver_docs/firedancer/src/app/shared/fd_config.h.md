<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Header file defining configuration structures and functions for loading and handling Firedancer configurations.

# Purpose
The code defines a C header file that provides configuration structures and functions for a software application. It includes several configuration structures, such as `fd_configh_t`, `fd_configf_t`, `fd_config_net_t`, and `fd_config_t`, which encapsulate various configuration parameters related to network settings, ledger management, consensus protocols, RPC settings, and more. These structures are designed to store configuration data that can be used to initialize and manage different components of the application.

The file also declares two functions: [`fd_config_load`](<#fd_config_load>) and [`fd_config_to_memfd`](<#fd_config_to_memfd>). The [`fd_config_load`](<#fd_config_load>) function is responsible for loading configuration data from files, performing parsing, validation, and integrating system-specific data to produce a complete configuration object. The [`fd_config_to_memfd`](<#fd_config_to_memfd>) function creates a memory file descriptor (memfd) to store the raw bytes of a configuration structure, allowing the configuration to be shared with child processes that do not share memory with the parent process. This header file is intended to be included in other C source files to provide access to these configuration structures and functions, facilitating the management of application settings.
# Imports and Dependencies

---
- `../../disco/topo/fd_topo.h`
- `../../ballet/base58/fd_base58.h`
- `../../util/net/fd_net_headers.h`
- `net/if.h`


# Data Structures

---
### fd\_configh
- **Type**: ``struct``
- **Members**:
    - ``dynamic_port_range``: Stores a range of dynamic ports as a character array.
    - ``paths``: Contains paths related to accounts and authorized voters.
    - ``reporting``: Holds configuration for Solana metrics reporting.
    - ``ledger``: Manages ledger-related configurations including account indexes and paths.
    - ``gossip``: Contains settings for gossip protocol port checking.
    - ``consensus``: Holds consensus-related configurations including snapshot and genesis fetch settings.
    - ``rpc``: Manages RPC settings including API access and transaction history.
    - ``snapshots``: Handles snapshot configurations including paths and retention settings.
    - ``layout``: Contains layout configurations including affinity and scheduler threads.
- **Description**: The `fd_configh` structure defines a comprehensive configuration for a system, including network, ledger, consensus, and snapshot settings. It organizes various configuration parameters into nested structures, each responsible for a specific aspect of the system's operation, such as paths, reporting, ledger management, gossip protocol, consensus, RPC, snapshots, and layout. This structure allows for detailed and organized configuration management, facilitating the setup and operation of complex systems.


---
### fd\_configh\_t
- **Type**: ``struct``
- **Members**:
    - ``dynamic_port_range``: A character array of size 32 to store the dynamic port range.
    - ``paths``: A nested structure containing paths related to accounts and authorized voters.
    - ``reporting``: A nested structure containing configuration for Solana metrics.
    - ``ledger``: A nested structure containing various ledger-related configurations including account indexes and paths.
    - ``gossip``: A nested structure containing a configuration for port checking.
    - ``consensus``: A nested structure containing consensus-related configurations including snapshot and genesis fetch settings.
    - ``rpc``: A nested structure containing RPC-related configurations including API settings and addresses.
    - ``snapshots``: A nested structure containing snapshot-related configurations including paths and retention settings.
    - ``layout``: A nested structure containing layout-related configurations including affinity and scheduler threads.
- **Description**: `fd_configh_t` is a structure that holds configuration settings for various components such as paths, reporting, ledger, gossip, consensus, RPC, snapshots, and layout. Each component is represented by a nested structure that contains specific configuration parameters, such as paths for accounts, Solana metrics configuration, ledger settings, port checking for gossip, consensus parameters, RPC settings, snapshot configurations, and layout details. This structure is used to manage and organize configuration data for a system.


---
### fd\_configf
- **Type**: ``struct``
- **Members**:
    - ``funk``: Contains configuration parameters for account records, heap size, and database transactions.
    - ``layout``: Defines the count of execution, signing, and gossip tiles.
    - ``runtime``: Holds runtime parameters including live slots, vote accounts, fork width, and program cache details.
    - ``gossip``: Stores the host information for gossip communication.
    - ``snapshots``: Manages snapshot sources, download settings, and known validators.
    - ``store``: Specifies the maximum number of completed shred sets.
- **Description**: Defines a configuration structure for a system with various components such as account management, tile layout, runtime settings, gossip communication, snapshot management, and storage. Each component is organized into nested structures to encapsulate related configuration parameters, facilitating modular configuration management.


---
### fd\_configf\_t
- **Type**: ``struct``
- **Members**:
    - `funk`: Contains configuration for account records, heap size, and database transactions.
    - `layout`: Specifies the count of execution, signing, and gossip tile processes.
    - `runtime`: Holds runtime parameters including live slots, vote accounts, and fork width.
    - `gossip`: Contains the host configuration for gossip communication.
    - `snapshots`: Manages snapshot settings including peers, download parameters, and known validators.
    - `store`: Defines the maximum number of completed shred sets.
- **Description**: `fd_configf_t` is a `struct` that defines configuration settings for a system, including parameters for account management, runtime behavior, gossip communication, snapshot handling, and storage. It organizes these settings into several nested structures, each responsible for a specific aspect of the system's configuration, such as `funk` for account records and `runtime` for live slots and vote accounts.


---
### fd\_config\_net
- **Type**: ``struct``
- **Members**:
    - ``provider``: Specifies the network provider, either "xdp" or "socket".
    - ``interface``: Holds the network interface name.
    - ``bind_address``: Stores the bind address as a string.
    - ``bind_address_parsed``: Contains the parsed bind address as an unsigned integer.
    - ``ip_addr``: Represents the IP address as an unsigned integer.
    - ``ingress_buffer_size``: Defines the size of the ingress buffer.
    - ``xdp``: Contains XDP-specific configuration details.
    - ``xdp.xdp_mode``: Specifies the XDP mode.
    - ``xdp.xdp_zero_copy``: Indicates if XDP zero-copy is enabled.
    - ``xdp.xdp_rx_queue_size``: Defines the size of the XDP receive queue.
    - ``xdp.xdp_tx_queue_size``: Defines the size of the XDP transmit queue.
    - ``xdp.flush_timeout_micros``: Specifies the flush timeout in microseconds.
    - ``xdp.rss_queue_mode``: Indicates the RSS queue mode, which can be "simple", "dedicated", or "auto".
    - ``socket``: Contains socket-specific configuration details.
    - ``socket.receive_buffer_size``: Defines the size of the receive buffer for sockets.
    - ``socket.send_buffer_size``: Defines the size of the send buffer for sockets.
- **Description**: Defines network configuration settings, including provider type, interface, and address details, as well as specific configurations for XDP and socket modes. The structure allows for the configuration of network parameters such as buffer sizes and queue modes, facilitating network communication setup.


---
### fd\_config\_net\_t
- **Type**: ``struct``
- **Members**:
    - `provider`: Specifies the network provider, either "xdp" or "socket".
    - `interface`: Stores the network interface name.
    - `bind_address`: Holds the bind address as a string.
    - `bind_address_parsed`: Contains the parsed bind address as an unsigned integer.
    - `ip_addr`: Stores the IP address as an unsigned integer.
    - `ingress_buffer_size`: Specifies the size of the ingress buffer.
    - `xdp`: Contains configuration settings specific to XDP (eXpress Data Path).
    - `socket`: Holds configuration settings for socket-based networking.
- **Description**: The `fd_config_net` structure defines network configuration settings, including provider type, interface details, and buffer sizes. It supports both XDP and socket-based networking, with specific fields for each method. The structure allows for detailed configuration of network parameters, such as bind addresses and buffer sizes, to optimize network performance.


---
### fd\_config
- **Type**: ``struct``
- **Members**:
    - ``name``: Stores the name of the configuration.
    - ``user``: Stores the user name associated with the configuration.
    - ``hostname``: Stores the hostname for the configuration.
    - ``tick_per_ns_mu``: Represents the mean ticks per nanosecond.
    - ``tick_per_ns_sigma``: Represents the standard deviation of ticks per nanosecond.
    - ``boot_timestamp_nanos``: Stores the boot timestamp in nanoseconds.
    - ``topo``: Represents the topology configuration.
    - ``cluster``: Stores the cluster name.
    - ``is_live_cluster``: Indicates if the cluster is live.
    - ``uid``: Stores the user ID.
    - ``gid``: Stores the group ID.
    - ``is_firedancer``: Indicates if the configuration is for Firedancer.
    - ``frankendancer``: Stores configuration specific to Frankendancer.
    - ``firedancer``: Stores configuration specific to Firedancer.
    - ``paths``: Contains various file paths used in the configuration.
    - ``log``: Contains logging configuration details.
    - ``consensus``: Contains consensus-related configuration.
    - ``gossip``: Contains gossip protocol configuration.
    - ``rpc``: Contains RPC configuration details.
    - ``layout``: Contains layout configuration details.
    - ``hugetlbfs``: Contains huge page filesystem configuration.
    - ``net``: Contains network configuration details.
    - ``development``: Contains development environment configuration.
    - ``tiles``: Contains configuration for various tiles.
    - ``capture``: Contains configuration for data capture.
- **Description**: The `fd_config` structure defines a comprehensive configuration for a system, including user and host information, performance metrics, and various subsystem configurations such as logging, consensus, gossip, RPC, and network settings. It supports both Firedancer and Frankendancer configurations through a union, and includes nested structures for paths, logging, consensus, gossip, RPC, layout, huge page filesystem, network, development, tiles, and capture settings. This structure is used to manage and store configuration data for different components and functionalities of the system.


---
### fd\_config\_t
- **Type**: ``struct``
- **Members**:
    - ``name``: Stores the name of the configuration.
    - ``user``: Stores the user associated with the configuration.
    - ``hostname``: Stores the hostname for logging purposes.
    - ``tick_per_ns_mu``: Represents the mean ticks per nanosecond.
    - ``tick_per_ns_sigma``: Represents the standard deviation of ticks per nanosecond.
    - ``boot_timestamp_nanos``: Stores the boot timestamp in nanoseconds.
    - ``topo``: Represents the topology configuration.
    - ``cluster``: Stores the cluster name.
    - ``is_live_cluster``: Indicates if the cluster is live.
    - ``uid``: Stores the user ID.
    - ``gid``: Stores the group ID.
    - ``is_firedancer``: Indicates if the configuration is for Firedancer.
    - ``frankendancer``: Stores the configuration for Frankendancer.
    - ``firedancer``: Stores the configuration for Firedancer.
    - ``paths``: Contains paths for various configuration files.
    - ``log``: Contains logging configuration details.
    - ``consensus``: Contains consensus-related configuration.
    - ``gossip``: Contains gossip protocol configuration.
    - ``rpc``: Contains RPC configuration details.
    - ``layout``: Contains layout configuration details.
    - ``hugetlbfs``: Contains huge page filesystem configuration.
    - ``net``: Contains network configuration details.
    - ``development``: Contains development-related configuration.
    - ``tiles``: Contains tile-related configuration.
    - ``capture``: Contains capture-related configuration.
- **Description**: `fd_config_t` is a complex configuration structure that holds various settings for a system, including network, logging, consensus, and development configurations. It includes fields for user and system identification, performance metrics, and paths for configuration files. The structure also supports different configurations for Frankendancer and Firedancer, and it provides detailed settings for network interfaces, logging, and other system components. This structure is essential for managing and applying configurations in a structured and organized manner.


---
### config\_t
- **Type**: ``struct``
- **Members**:
    - ``name``: Stores the name of the configuration.
    - ``user``: Stores the user associated with the configuration.
    - ``hostname``: Stores the hostname for logging purposes.
    - ``tick_per_ns_mu``: Represents the mean ticks per nanosecond.
    - ``tick_per_ns_sigma``: Represents the standard deviation of ticks per nanosecond.
    - ``boot_timestamp_nanos``: Stores the boot timestamp in nanoseconds.
    - ``topo``: Represents the topology configuration.
    - ``cluster``: Stores the cluster name.
    - ``is_live_cluster``: Indicates if the cluster is live.
    - ``uid``: Stores the user ID.
    - ``gid``: Stores the group ID.
    - ``is_firedancer``: Indicates if the configuration is for Firedancer.
    - ``frankendancer``: Union member for Frankendancer configuration.
    - ``firedancer``: Union member for Firedancer configuration.
    - ``paths``: Contains paths for various configuration files and directories.
    - ``log``: Contains logging configuration details.
    - ``consensus``: Contains consensus-related configuration.
    - ``gossip``: Contains gossip protocol configuration.
    - ``rpc``: Contains RPC configuration details.
    - ``layout``: Contains layout configuration for various tiles.
    - ``hugetlbfs``: Contains huge page file system configuration.
    - ``net``: Contains network configuration details.
    - ``development``: Contains development-related configuration.
    - ``tiles``: Contains configuration for various tiles.
    - ``capture``: Contains configuration for data capture.
- **Description**: The `fd_config` struct is a comprehensive configuration data structure that encapsulates various settings and parameters for a system. It includes fields for general information such as `name`, `user`, and `hostname`, as well as detailed configurations for network, logging, consensus, gossip, RPC, and development settings. The struct also contains union members for different configuration modes (`frankendancer` and `firedancer`), and it supports paths for configuration files and directories. Additionally, it includes specialized configurations for tiles, huge page file systems, and data capture, making it a central component for managing system configurations.


# Function Declarations (Public API)

---
### fd\_config\_load<!-- {{#callable_declaration:fd_config_load}} -->
[View Source →](<../../../../../src/app/shared/fd_config.h#L492>)

Loads and validates a configuration object from multiple sources.
- **Description**: Use this function to load a configuration object from a default configuration file, with optional overrides and user-specific configurations. The function first loads the default configuration, then applies any specified override and user configurations. It validates the configuration at each step and fills in additional data as needed. This function must be called with valid configuration data and will terminate the process with an error message if it encounters an error during loading or validation.
- **Inputs**:
    - `is_firedancer`: Indicates if the configuration is for a Firedancer instance. Must be 0 or 1.
    - `netns`: Specifies the network namespace to use. Must be a valid integer.
    - `is_local_cluster`: Indicates if the configuration is for a local cluster. Must be 0 or 1.
    - `default_config`: Pointer to the default configuration data. Must not be null.
    - `default_config_sz`: Size of the default configuration data in bytes. Must be greater than 0.
    - `override_config`: Pointer to the override configuration data. Can be null if no override is needed.
    - `override_config_path`: Path to the override configuration file. Must be a valid string if `override_config` is not null.
    - `override_config_sz`: Size of the override configuration data in bytes. Must be greater than 0 if `override_config` is not null.
    - `user_config`: Pointer to the user configuration data. Can be null if no user configuration is needed.
    - `user_config_sz`: Size of the user configuration data in bytes. Must be greater than 0 if `user_config` is not null.
    - `user_config_path`: Path to the user configuration file. Must be a valid string if `user_config` is not null.
    - `config`: Pointer to the configuration object to be filled. Must not be null and will be fully initialized on success.
- **Output**: None
- **See Also**: [`fd_config_load`](<fd_config.c.md#fd_config_load>)  (Implementation)


---
### fd\_config\_to\_memfd<!-- {{#callable_declaration:fd_config_to_memfd}} -->
[View Source →](<../../../../../src/app/shared/fd_config.h#L532>)

Create a memfd and write the raw bytes of a config struct into it.
- **Description**: Use this function to create a memory file descriptor (memfd) and write the raw bytes of a given configuration structure into it. This is useful for sharing configuration data with child processes that are spawned using `execve(2)`, as they cannot share memory with the parent process. The function returns a file descriptor for the memfd on success. If the function fails, it returns -1 and sets `errno` to indicate the error. Ensure that the `config` parameter is valid and properly initialized before calling this function.
- **Inputs**:
    - `config`: A pointer to a `fd_config_t` structure containing the configuration data to write to the memfd. Must not be null and should be properly initialized before calling the function.
- **Output**: Returns a file descriptor for the created memfd on success. Returns -1 on failure, with `errno` set to indicate the error.
- **See Also**: [`fd_config_to_memfd`](<fd_config.c.md#fd_config_to_memfd>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)