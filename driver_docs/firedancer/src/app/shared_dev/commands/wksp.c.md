<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines functions to initialize workspaces and manage memory locking limits in the Firedancer application.

# Purpose
The code defines functionality related to workspace initialization and permission management within a system. It includes several header files that provide shared configurations, actions, and system utilities. The primary components of the code are two functions: `wksp_cmd_perm` and `wksp_cmd_fn`. The `wksp_cmd_perm` function calculates the maximum memory lock limit required for the workspaces defined in the configuration and raises the resource limit using `fd_cap_chk_raise_rlimit` to ensure that all memory can be locked with `mlock(2)`. The `wksp_cmd_fn` function initializes the workspaces by calling [`initialize_workspaces`](<#initialize_workspaces>) and then exits the process group using `fd_sys_util_exit_group`.

The code also defines an `action_t` structure named `fd_action_wksp`, which encapsulates the workspace-related actions. This structure includes the action's name, arguments, function, permission function, and a description. The `fd_action_wksp` structure is likely intended to be used as part of a larger system where actions are defined and executed based on configurations. The code is not an executable by itself but is designed to be integrated into a larger application or system that manages workspaces and their associated resources.
# Imports and Dependencies

---
- `../../shared/fd_config.h`
- `../../shared/fd_action.h`
- `../../platform/fd_sys_util.h`
- `sys/resource.h`


# Global Variables

---
### wksp\_cmd\_perm
- **Type**: ``wksp_cmd_perm``
- **Description**: Sets the memory lock limit for workspaces based on the configuration provided. It calculates the maximum memory lock limit required by iterating over the workspaces and determining the largest memory requirement.
- **Use**: Used to adjust the `RLIMIT_MEMLOCK` resource limit to ensure all workspace memory can be locked.


---
### wksp\_cmd\_fn
- **Type**: `function`
- **Description**: Executes the `initialize_workspaces` function with the given `config` parameter and then calls `fd_sys_util_exit_group` to terminate the process with a status of 0.
- **Use**: Used to initialize workspaces and terminate the process.


---
### fd\_action\_wksp
- **Type**: ``action_t``
- **Description**: Defines an action structure for workspace initialization. It includes a name, a function pointer for execution, a permission function pointer, and a description.
- **Use**: Used to initialize and manage workspace-related actions in the system.


# Function Declarations (Public API)

---
### initialize\_workspaces<!-- {{#callable_declaration:initialize_workspaces}} -->
[View Source →](<../../../../../../src/app/shared_dev/commands/wksp.c#L8>)

Initialize workspaces based on the given configuration.
- **Description**: Use this function to set up workspaces as specified in the provided configuration. It must be called with a valid configuration structure that contains workspace details. The function changes the effective user and group IDs to those specified in the configuration for workspace creation, and reverts them after the process. It handles existing workspaces by either updating them or creating new ones, depending on the configuration and current state. Ensure that the configuration is correctly set up before calling this function.
- **Inputs**:
    - `config`: A pointer to a `config_t` structure containing workspace configuration details. Must not be null. The structure should include user and group IDs, and workspace topology information. Invalid or null input will lead to undefined behavior.
- **Output**: None
- **See Also**: [`initialize_workspaces`](<../../shared/commands/run/run.c.md#initialize_workspaces>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)