<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines functions to create and manage a 'core' subtopology with network, metrics, and sign tiles.

# Purpose
The code is a C header file that defines functions and data structures for creating and managing a "core" sub-topology within a larger network topology. The primary function, [`fd_core_subtopo`](<#fd_core_subtopo>), initializes a sub-topology consisting of network, metrics, and sign tiles, and establishes the necessary links between them. This function does not finalize the topology, allowing additional tiles and links to be attached later. The code ensures that all sub-topologies remain disjoint, which is important for maintaining modularity and preventing overlap in the network configuration.

Additionally, the file provides utility functions [`fd_link_permit_no_producers`](<#fd_link_permit_no_producers>) and [`fd_link_permit_no_consumers`](<#fd_link_permit_no_consumers>). These functions modify the properties of links within the topology to allow for the absence of producers or consumers, respectively. This functionality is useful for development and testing scenarios where certain links may not have active data producers or consumers. The header file includes necessary dependencies and external references, such as `fd_topo_obj_callbacks_t` and configuration structures, to support the creation and management of these network components.
# Imports and Dependencies

---
- `../../shared/fd_config.h`
- `../../../disco/topo/fd_topob.h`
- `../../../disco/net/fd_net_tile.h`


# Global Variables

---
### CALLBACKS
- **Type**: `fd_topo_obj_callbacks_t *`
- **Description**: An array of pointers to `fd_topo_obj_callbacks_t` structures. These structures likely contain callback functions related to topology objects.
- **Use**: Used to store and manage callback functions for topology objects in the application.


# Functions

---
### fd\_core\_subtopo<!-- {{#callable:fd_core_subtopo}} -->
[View Source →](<../../../../../../src/app/firedancer-dev/commands/core_subtopo.h#L16>)

Creates a 'core' subtopology with 'metric', 'net', and 'sign' tiles and configures their properties.
- **Inputs**:
    - `config`: A pointer to a `config_t` structure that contains configuration data for the topology.
    - `tile_to_cpu`: An array of unsigned long integers mapping tile indices to CPU indices, with a maximum size of `FD_TILE_MAX`.
- **Logic and Control Flow**:
    - Initialize a pointer `topo` to the topology configuration from `config`.
    - Define an array `tiles_to_add` with tile names 'metric', 'net', and 'sign'.
    - Verify that none of the tiles in `tiles_to_add` already exist in the topology using `fd_topo_find_tile`.
    - Retrieve the number of 'net' and 'sign' tiles from the configuration.
    - Create workspaces for 'metric' and 'metric_in' tiles using `fd_topob_wksp`.
    - Create a 'metric' tile and configure its Prometheus listen address and port.
    - Configure 'net' tiles using `fd_topos_net_tiles` and find the 'net' tile ID, defaulting to 'sock' if not found.
    - Log an error if the 'net' tile is not found.
    - Set the gossip listen port for the 'net' tile.
    - Create a workspace for 'sign' tiles and configure each 'sign' tile with an identity key path.
- **Output**: No return value; the function modifies the topology configuration in place.


---
### fd\_link\_permit\_no\_producers<!-- {{#callable:fd_link_permit_no_producers}} -->
[View Source →](<../../../../../../src/app/firedancer-dev/commands/core_subtopo.h#L55>)

Sets the `permit_no_producers` flag for links with a specified name in a topology.
- **Inputs**:
    - `topo`: A pointer to an `fd_topo_t` structure representing the topology.
    - `link_name`: A string representing the name of the link to search for in the topology.
- **Logic and Control Flow**:
    - Initialize `found` to 0.
    - Iterate over each link in the topology using `link_i`.
    - For each link, compare its name with `link_name` using `strcmp`.
    - If the names match, set `permit_no_producers` to 1 for that link and increment `found`.
    - Return the value of `found`, indicating the number of links updated.
- **Output**: Returns the number of links for which the `permit_no_producers` flag was set.


---
### fd\_link\_permit\_no\_consumers<!-- {{#callable:fd_link_permit_no_consumers}} -->
[View Source →](<../../../../../../src/app/firedancer-dev/commands/core_subtopo.h#L70>)

Enables links with a specified name to permit having no consumers in a topology.
- **Inputs**:
    - ``topo``: A pointer to an `fd_topo_t` structure representing the topology.
    - ``link_name``: A string representing the name of the link to modify.
- **Logic and Control Flow**:
    - Initialize a variable `found` to 0 to count the number of links modified.
    - Iterate over each link in the topology using a loop with index `link_i`.
    - For each link, compare its name with `link_name` using `strcmp`.
    - If the names match, set the `permit_no_consumers` flag of the link to 1 and increment `found`.
    - Return the value of `found`, indicating the number of links modified.
- **Output**: Returns the number of links that were modified to permit having no consumers.



---
Made with ❤️ by [Driver](https://www.driver.ai/)