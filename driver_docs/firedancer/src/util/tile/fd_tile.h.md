<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Header file for managing task dispatching and execution within a thread group using tiles.

# Purpose
The code is a C header file that defines an interface for managing and executing tasks within a thread group using a concept called "tiles." It provides a set of functions and data structures to facilitate the dispatching and execution of tasks on different threads, referred to as tiles, within a group. The file includes definitions for function pointers (`fd_tile_task_t`) that represent tasks, and an opaque structure (`fd_tile_exec_t`) that acts as a handle for task execution. The header also defines constants such as `FD_TILE_MAX`, which sets the maximum number of tiles, and `FD_TILE_PRIVATE_STACK_SZ`, which specifies the stack size for each tile.

The file provides several functions to manage tile execution, including [`fd_tile_exec_new`](<#fd_tile_exec_new>) and [`fd_tile_exec_delete`](<#fd_tile_exec_delete>), which start and stop task execution on a specified tile. It also includes diagnostic functions to monitor stack usage and functions to retrieve information about the current tile, such as [`fd_tile_id`](<#fd_tile_id>), [`fd_tile_idx`](<#fd_tile_idx>), and [`fd_tile_cnt`](<#fd_tile_cnt>). The header is intended to be used in conjunction with other components of a larger system, as indicated by the inclusion of `fd_shmem.h` and the note that the system must be booted to use these APIs. The functions and structures defined in this header are designed to be used internally within the system, as suggested by the presence of private functions like [`fd_tile_private_boot`](<#fd_tile_private_boot>) and [`fd_tile_private_halt`](<#fd_tile_private_halt>).
# Imports and Dependencies

---
- `../shmem/fd_shmem.h`


# Global Variables

---
### fd\_tile\_private\_stack0
- **Type**: ``ulong``
- **Description**: Represents the starting address of the stack for tile 0 in the local address space of the caller. It is used to determine the stack boundaries and size for diagnostic and debugging purposes.
- **Use**: Used to calculate the stack size and estimate the used and free stack space for tile 0.


---
### fd\_tile\_private\_stack1
- **Type**: ``FD_TL ulong``
- **Description**: `fd_tile_private_stack1` is a global variable that represents the upper boundary of the stack memory region for a tile in a thread group. It is used to determine the size and limits of the stack allocated for tile execution.
- **Use**: Used to calculate the stack size and manage stack memory for tile execution.


# Data Structures

---
### fd\_tile\_exec\_t
- **Type**: ``struct``
- **Members**:
    - ``fd_tile_exec_private``: An opaque structure representing a tile execution handle.
- **Description**: Represents an opaque handle for managing the execution of tasks on a tile within a thread group. The `fd_tile_exec_t` type is used to start, manage, and terminate tasks dispatched to specific tiles, ensuring that tasks are executed in parallel and efficiently within the constraints of the thread group.


# Functions

---
### fd\_tile\_stack0<!-- {{#callable:fd_tile_stack0}} -->
[View Source →](<../../../../../src/util/tile/fd_tile.h#L73>)

Returns the starting address of the stack for tile 0.
- **Inputs**: None
- **Logic and Control Flow**:
    - Returns the value of `fd_tile_private_stack0` cast to a `void const *`.
- **Output**: A pointer to the starting address of the stack for tile 0.


---
### fd\_tile\_stack1<!-- {{#callable:fd_tile_stack1}} -->
[View Source →](<../../../../../src/util/tile/fd_tile.h#L74>)

Returns a pointer to the end of the caller's stack in the local address space.
- **Inputs**: None
- **Logic and Control Flow**:
    - Returns a pointer cast to `void const *` from the global variable `fd_tile_private_stack1`.
- **Output**: A pointer to the end of the caller's stack in the local address space.


---
### fd\_tile\_stack\_sz<!-- {{#callable:fd_tile_stack_sz}} -->
[View Source →](<../../../../../src/util/tile/fd_tile.h#L75>)

Calculates the size of the tile stack by subtracting the starting address from the ending address.
- **Inputs**: None
- **Logic and Control Flow**:
    - Accesses the global variable `fd_tile_private_stack1` to get the ending address of the stack.
    - Accesses the global variable `fd_tile_private_stack0` to get the starting address of the stack.
    - Subtracts `fd_tile_private_stack0` from `fd_tile_private_stack1` to compute the stack size.
- **Output**: Returns the size of the stack as an unsigned long integer.


---
### fd\_tile\_stack\_est\_used<!-- {{#callable:fd_tile_stack_est_used}} -->
[View Source →](<../../../../../src/util/tile/fd_tile.h#L77>)

Estimates the number of bytes currently used in the stack.
- **Inputs**: None
- **Logic and Control Flow**:
    - Declare a local array `stack_mem` of type `uchar` with one element.
    - Assign the value `1` to `stack_mem[0]` using the `FD_VOLATILE` macro to ensure it is stored in memory.
    - Return the result of `fd_ulong_if`, which checks if `fd_tile_private_stack1` is zero.
    - If `fd_tile_private_stack1` is zero, return `0UL`; otherwise, return the difference between `fd_tile_private_stack1` and the address of `stack_mem`.
- **Output**: Returns an `ulong` representing the estimated number of bytes used in the stack.


---
### fd\_tile\_stack\_est\_free<!-- {{#callable:fd_tile_stack_est_free}} -->
[View Source →](<../../../../../src/util/tile/fd_tile.h#L84>)

Estimates the number of free bytes in the current stack.
- **Inputs**: None
- **Logic and Control Flow**:
    - Declare a local array `stack_mem` of type `uchar` with one element.
    - Assign the value `1` to `stack_mem[0]` using the `FD_VOLATILE` macro to ensure it is stored in memory.
    - Return `0UL` if `fd_tile_private_stack0` is `0`, otherwise return the difference between the address of `stack_mem` and `fd_tile_private_stack0`.
- **Output**: Returns an `ulong` representing the estimated number of free bytes in the stack.


---
### fd\_tile\_exec\_by\_id\_new<!-- {{#callable:fd_tile_exec_by_id_new}} -->
[View Source →](<../../../../../src/util/tile/fd_tile.h#L116>)

Starts parallel execution of a task on a specified tile using the application thread index.
- **Inputs**:
    - `id`: The application thread index, which must be in the range [fd_tile_id0(), fd_tile_id1()).
    - `task`: A non-NULL function pointer representing the task to execute.
    - `argc`: The number of arguments passed to the task.
    - `argv`: An array of argument strings passed to the task.
- **Logic and Control Flow**:
    - Calculates the tile index by subtracting `fd_tile_id0()` from `id`.
    - Calls `fd_tile_exec_new()` with the calculated tile index, `task`, `argc`, and `argv`.
- **Output**: Returns a handle to the tile execution (`fd_tile_exec_t *`) on success, or NULL on failure.


---
### fd\_tile\_exec\_by\_id<!-- {{#callable:fd_tile_exec_by_id}} -->
[View Source →](<../../../../../src/util/tile/fd_tile.h#L145>)

Retrieves the execution handle for a tile specified by its application thread index.
- **Inputs**:
    - `tile_id`: The application thread index of the tile, which must be within the range [fd_tile_id0(), fd_tile_id1()).
- **Logic and Control Flow**:
    - Subtracts the result of `fd_tile_id0()` from `tile_id` to convert the application thread index to a tile index.
    - Calls `fd_tile_exec()` with the calculated tile index to retrieve the execution handle.
- **Output**: Returns a pointer to `fd_tile_exec_t`, which is the execution handle for the specified tile.


# Function Declarations (Public API)

---
### fd\_tile\_exec\_id<!-- {{#callable_declaration:fd_tile_exec_id}} -->
[View Source →](<../../../../../src/util/tile/fd_tile.h#L150>)

Retrieves the unique identifier of a tile execution.
- **Description**: Use this function to obtain the unique identifier associated with a specific tile execution. This identifier is constant while the tile services are active and can be used to distinguish between different executions within a thread group. Ensure that the `exec` parameter points to a valid and current execution context before calling this function.
- **Inputs**:
    - `exec`: A pointer to a `fd_tile_exec_t` structure representing the tile execution. This must not be null and must point to a valid execution context. If the pointer is invalid, the behavior is undefined.
- **Output**: Returns an unsigned long integer representing the unique identifier of the tile execution.
- **See Also**: [`fd_tile_exec_id`](<fd_tile_threads.cxx.md#fd_tile_exec_id>)  (Implementation)


---
### fd\_tile\_private\_map\_boot<!-- {{#callable_declaration:fd_tile_private_map_boot}} -->
[View Source →](<../../../../../src/util/tile/fd_tile.h#L167>)

Boots a thread group with specified CPU mappings.
- **Description**: Use this function to initialize and start a group of threads, referred to as tiles, with specific CPU mappings. This function must be called after the system is booted and before any tile operations are performed. It logs the booting process and handles thread creation, stack allocation, and CPU affinity settings. Ensure that the `tile_to_cpu` array and `tile_cnt` are correctly set to map each tile to its intended CPU. The function handles errors in thread creation and affinity settings by logging warnings or errors, and it attempts to continue operation where possible.
- **Inputs**:
    - `tile_to_cpu`: An array of unsigned short integers where each element specifies the CPU index for the corresponding tile. The array must have at least `tile_cnt` elements. Values should be less than 65535 to indicate a fixed CPU; otherwise, the tile is considered floating. The caller retains ownership of this array.
    - `tile_cnt`: An unsigned long integer specifying the number of tiles to boot. Must be greater than zero and should not exceed the maximum number of tiles allowed by the system.
- **Output**: None
- **See Also**: [`fd_tile_private_map_boot`](<fd_tile_threads.cxx.md#fd_tile_private_map_boot>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)