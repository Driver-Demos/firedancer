<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Tests for file input/output operations, including buffered and memory-mapped I/O, with error handling.

# Purpose
The code is a C program designed to test various file input/output operations, including basic and buffered read/write operations, file seeking, and memory-mapped I/O (MMIO). It begins by initializing a random number generator and setting up command-line arguments to specify file paths, modes, and whether to keep temporary files. The program creates a temporary file or uses a specified path, writes test data to it, and performs a series of tests to verify the correctness of file operations such as seeking, writing, and reading. It also tests buffered I/O operations using undersized buffers to ensure edge case coverage.

The program includes tests for both static and dynamic reads, compound writes, and zero-copy buffered operations. It also verifies the behavior of file operations under various conditions, such as after closing a file or using invalid file descriptors. Additionally, the program tests the functionality of truncating files and using MMIO to read and write data. Error handling is implemented to log issues encountered during file operations, and the program concludes by cleaning up resources and logging a success message. The code is structured as an executable C file, with a [`main`](<#main>) function serving as the entry point, and it does not define public APIs or external interfaces.
# Imports and Dependencies

---
- `../fd_util.h`
- `stdlib.h`
- `errno.h`
- `unistd.h`
- `fcntl.h`
- `sys/stat.h`


# Functions

---
### main<!-- {{#callable:main}} -->
[View Source →](<../../../../../src/util/io/test_io.c#L8>)

Executes a series of file I/O tests, including creating, writing, reading, and manipulating temporary files, while handling command-line arguments for path, mode, and keep options.
- **Inputs**:
    - `argc`: The number of command-line arguments.
    - `argv`: An array of command-line argument strings.
- **Logic and Control Flow**:
    - Initialize the environment with `fd_boot` and parse command-line arguments for `--path`, `--mode`, and `--keep` options.
    - Create a random number generator `rng` using `fd_rng_new` and `fd_rng_join`.
    - Determine the file path to use: if `--path` is specified, use it; otherwise, create a temporary file with `mkstemp`.
    - If `--keep` is not set, unlink the file to ensure it is deleted upon program termination.
    - Write test data to the file and perform various seek and size tests on the file, both when empty and after writing data.
    - Perform buffered and zero-copy writes using `fd_io_buffered_ostream_t` and test the writes with different buffer sizes.
    - Read the written data back using various read methods, including simple, compound, incremental, and buffered reads.
    - Test file truncation and memory-mapped I/O (MMIO) operations, including writing and reading random patterns.
    - Perform error handling tests for invalid file descriptors, seek types, and empty read/write operations.
    - Log errors and notices using `FD_LOG_ERR`, `FD_LOG_WARNING`, and `FD_LOG_NOTICE`.
    - Clean up resources by closing the file descriptor and deleting the random number generator.
- **Output**: Returns 0 upon successful execution of all tests.



---
Made with ❤️ by [Driver](https://www.driver.ai/)