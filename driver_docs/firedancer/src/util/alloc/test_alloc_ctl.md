<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

A Bash script for testing the `fd_alloc_ctl` command-line tool in the `firedancer` codebase.

# Purpose
This script is a Bash test suite for validating the functionality of the `fd_alloc_ctl` and `fd_wksp_ctl` command-line tools. It sets up a test environment by defining workspace parameters and cleaning up any previous test artifacts. The script tests various operations such as creating, querying, allocating, freeing, compacting, and deleting memory allocations within a specified workspace. It uses a series of commands to verify expected behaviors and error handling, and it reports failures with specific messages if any command does not execute as expected. The script concludes by cleaning up the test environment and indicating a successful test run if all operations pass.
# Global Variables

---
### UNIT\_TEST
- **Type**: ``string``
- **Description**: `UNIT_TEST` is a string variable that stores the directory path of the script's source file. It is determined using the `dirname` command on the `$BASH_SOURCE` variable, which contains the path of the script being executed.
- **Use**: Stores the directory path of the script's source file for use in determining the location of binaries.


---
### BUILD
- **Type**: ``string``
- **Description**: Represents the directory path where the build artifacts are located. It is determined by finding the directory name of the `UNIT_TEST` path.
- **Use**: Used to construct the path to the `bin` directory where executable binaries are stored.


---
### BIN
- **Type**: ``string``
- **Description**: `BIN` is a string variable that stores the path to the 'bin' directory within the build directory. It is determined by appending '/bin' to the `BUILD` variable, which is derived from the directory of the unit test script.
- **Use**: Used to construct the path for executing various control commands like `fd_wksp_ctl` and `fd_alloc_ctl`.


---
### WKSP
- **Type**: ``string``
- **Description**: The `WKSP` variable is a string that specifies the name of the workspace file used in the script. It is set to 'test_fd_alloc_ctl.wksp' and is used in various command-line operations to manage the workspace.
- **Use**: Used to specify the workspace name for operations such as creation, deletion, and allocation in the script.


---
### PAGE\_CNT
- **Type**: `integer`
- **Description**: Specifies the number of pages to allocate for the workspace in the script. It is set to 1, indicating a single page allocation.
- **Use**: Used as an argument in the `fd_wksp_ctl new` command to define the number of pages for the workspace.


---
### PAGE\_SZ
- **Type**: ``string``
- **Description**: The `PAGE_SZ` variable is a global variable defined as a string with the value 'gigantic'. It specifies the size of a page in the context of workspace allocation and management.
- **Use**: Used to define the page size when creating a new workspace with the `fd_wksp_ctl` command.


---
### CPU\_IDX
- **Type**: `integer`
- **Description**: The variable `CPU_IDX` is an integer that specifies the index of the CPU to use for operations. It is set to 0, indicating the first CPU.
- **Use**: Used to specify the CPU index when creating a workspace with the `fd_wksp_ctl` command.


---
### MODE
- **Type**: ``int``
- **Description**: `MODE` is a global variable that stores the file permission mode for the workspace. It is set to `0600`, which means the owner has read and write permissions, while others have no permissions.
- **Use**: Used to specify the file permission mode when creating a new workspace with the `fd_wksp_ctl` command.


---
### TAG\_META
- **Type**: `integer`
- **Description**: A global variable that holds the integer value `1234`. It is used as a tag identifier in the script.
- **Use**: Used as a tag identifier for allocation operations in the script.


---
### TAG\_ALLOC
- **Type**: `integer`
- **Description**: Represents a numeric identifier used for allocation operations in the script. It is set to the value 2345.
- **Use**: Used as a tag identifier in allocation commands to manage resources.


---
### FD\_LOG\_PATH
- **Type**: `string`
- **Description**: A global variable that stores the path to the log file. It is set to an empty string to disable the permanent log.
- **Use**: Used to specify the log file path for logging operations, but is currently set to disable logging.


---
### ALLOC
- **Type**: ``string``
- **Description**: Stores the result of the `fd_alloc_ctl` command that creates a new allocation with a specific tag in the workspace. The value is used in subsequent commands to reference this allocation.
- **Use**: Used to store and reference the allocation identifier for operations like query, malloc, free, compact, and delete.


---
### GADDR0
- **Type**: ``string``
- **Description**: Stores the result of a memory allocation command executed by the `fd_alloc_ctl` tool. The command allocates a memory block with specific parameters and returns an address or identifier for the allocated memory.
- **Use**: Used to hold the address or identifier of a memory block allocated by the `fd_alloc_ctl malloc` command.


---
### GADDR1
- **Type**: ``string``
- **Description**: `GADDR1` is a global variable that stores the result of a memory allocation operation. It is assigned the output of the `fd_alloc_ctl malloc` command, which allocates memory in a workspace with specific parameters.
- **Use**: Stores the address of the allocated memory block for further operations.


---
### GADDR2
- **Type**: ``string``
- **Description**: `GADDR2` is a global variable that stores the result of a memory allocation operation. It is assigned the output of the `fd_alloc_ctl malloc` command with specific parameters.
- **Use**: Stores the address of a memory block allocated by the `fd_alloc_ctl malloc` command.


---
### GADDR3
- **Type**: ``string``
- **Description**: `GADDR3` is a global variable that stores the result of a memory allocation operation. It is assigned the output of the `fd_alloc_ctl malloc` command with specific parameters.
- **Use**: Stores the address or identifier of a memory block allocated by the `fd_alloc_ctl malloc` command.


# Functions

---
### fail
Outputs a failure message, attempts to delete a workspace, and exits with status 1.
- **Inputs**:
    - `$1`: The name or description of the operation that failed.
    - `$2`: The unexpected exit code of the operation.
- **Logic and Control Flow**:
    - Prints a failure message with the operation name and unexpected exit code.
    - Attempts to delete the workspace using the `fd_wksp_ctl delete` command.
    - Suppresses the output of the delete command by redirecting it to `/dev/null`.
    - Prints 'Log N/A' to indicate that no log is available.
    - Exits the script with status code 1.
- **Output**: No output is returned as the function exits the script with status 1.



---
Made with ❤️ by [Driver](https://www.driver.ai/)