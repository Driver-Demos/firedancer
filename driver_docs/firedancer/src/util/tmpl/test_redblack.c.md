<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Tests for red-black tree operations including insertion, deletion, and verification.

# Purpose
The code is a C program that tests the functionality of a red-black tree implementation. It includes the necessary headers and defines a structure `my_rb_node` to represent nodes in the red-black tree, with fields for the key, value, parent, left and right children, and color. The program uses a custom comparison function [`my_rb_compare`](<#my_rb_compare>) to compare nodes based on their keys. The main function initializes a random number generator and sets up a memory pool for the red-black tree nodes. It then performs a series of tests to verify the correctness of the red-black tree operations, such as insertion, search, and deletion.

The program tests various scenarios, including inserting nodes in different orders, verifying the tree structure, and ensuring that the search and deletion operations return the expected results. It also tests the ability to move the tree's memory pool to a different location and verify the tree's integrity after the move. The program uses assertions and error logging to ensure that the red-black tree operations behave as expected. The code is structured to be an executable test suite for the red-black tree implementation, providing a comprehensive set of tests to validate the tree's functionality.
# Imports and Dependencies

---
- `../fd_util.h`
- `stdlib.h`
- `assert.h`
- `fd_redblack.c`


# Global Variables

---
### scratch
- **Type**: `uchar array`
- **Description**: `scratch` is a global array of unsigned characters with a size defined by `SCRATCH_FOOTPRINT`. It is aligned in memory according to `SCRATCH_ALIGN`.
- **Use**: Used as a memory pool for red-black tree operations.


---
### scratch2
- **Type**: `uchar array`
- **Description**: `scratch2` is a global array of unsigned characters with a size defined by `SCRATCH_FOOTPRINT`, which is aligned to `SCRATCH_ALIGN`.
- **Use**: It is used to store a copy of the memory pool for red-black tree nodes, allowing operations on a separate instance of the tree.


# Data Structures

---
### my\_rb\_node
- **Type**: ``struct``
- **Members**:
    - `key`: Stores the key for the node.
    - `val`: Stores the value associated with the key.
    - `redblack_parent`: Stores the index or reference to the parent node in the red-black tree.
    - `redblack_left`: Stores the index or reference to the left child node in the red-black tree.
    - `redblack_right`: Stores the index or reference to the right child node in the red-black tree.
    - `redblack_color`: Stores the color of the node, typically used to maintain red-black tree properties.
- **Description**: Represents a node in a red-black tree, which is a self-balancing binary search tree. Each node contains a key-value pair and references to its parent and children nodes, along with a color attribute to maintain the tree's balance properties.


---
### my\_rb\_node\_t
- **Type**: ``struct``
- **Members**:
    - ``key``: Stores the key value for the node.
    - ``val``: Stores the value associated with the key.
    - ``redblack_parent``: Stores the index or reference to the parent node in the red-black tree.
    - ``redblack_left``: Stores the index or reference to the left child node in the red-black tree.
    - ``redblack_right``: Stores the index or reference to the right child node in the red-black tree.
    - ``redblack_color``: Indicates the color of the node, typically red or black, in the red-black tree.
- **Description**: Defines a node in a red-black tree, which is a self-balancing binary search tree. Each node contains a key-value pair and maintains references to its parent and child nodes, as well as a color attribute to ensure the tree remains balanced during insertions and deletions.


# Functions

---
### my\_rb\_compare<!-- {{#callable:my_rb_compare}} -->
[View Source →](<../../../../../src/util/tmpl/test_redblack.c#L17>)

Compares two red-black tree nodes based on their keys.
- **Inputs**:
    - `left`: A pointer to the first `my_rb_node_t` node to compare.
    - `right`: A pointer to the second `my_rb_node_t` node to compare.
- **Logic and Control Flow**:
    - Subtracts the `key` of the `right` node from the `key` of the `left` node.
    - Casts the result of the subtraction to a `long` type.
- **Output**: Returns a `long` integer representing the difference between the keys of the two nodes.


---
### main<!-- {{#callable:main}} -->
[View Source →](<../../../../../src/util/tmpl/test_redblack.c#L26>)

Initializes and tests a red-black tree implementation with various insertion and deletion scenarios using random and specific key orders.
- **Inputs**:
    - `argc`: The number of command-line arguments.
    - `argv`: An array of command-line argument strings.
- **Logic and Control Flow**:
    - Calls `fd_boot` to initialize the environment with command-line arguments.
    - Initializes a random number generator `rng` using `fd_rng_new` and `fd_rng_join`.
    - Calculates the maximum number of nodes `max` that can fit in the scratch memory footprint using `my_rb_max_for_footprint`.
    - Checks if the calculated footprint exceeds the available scratch memory and logs an error if it does.
    - Creates and joins a red-black tree node pool using `my_rb_new` and `my_rb_join`.
    - Performs three test cases with different key insertion orders (ascending, descending, and pseudo-random) to insert nodes into the red-black tree and verify their presence.
    - Allocates a list for random key ordering and performs 1000 iterations of random insertion and deletion tests on the red-black tree.
    - Verifies the integrity of the red-black tree after each operation using `my_rb_verify`.
    - Releases and deletes the red-black tree and random number generator resources before exiting.
- **Output**: Returns 0 to indicate successful execution.
- **Functions Called**:
    - [`my_rb_node`](<#my_rb_node>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)