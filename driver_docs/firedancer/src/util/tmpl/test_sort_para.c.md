<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Tests parallel sorting algorithms using various data configurations and thread pools.

# Purpose
The code is a C program designed to test and validate parallel sorting algorithms. It includes a main function that initializes a thread pool and a random number generator, and then performs multiple iterations of sorting tests on arrays of floating-point numbers. The program uses a variety of sorting functions, such as `mysort_inplace_para`, `mysort_stable_fast_para`, and `mysort_stable_para`, to sort arrays in different configurations, including monotonically increasing, decreasing, and shuffled arrays. The sorting functions are defined in the included `fd_sort.c` file, and the program verifies the correctness of the sorting operations by comparing the sorted arrays to reference arrays.

The program is structured to run in a parallel computing environment, utilizing multiple threads to perform sorting operations concurrently. It uses a thread pool to manage the threads and includes diagnostic logging to track the progress of the sorting tests. The program also includes a [`shuffle`](<#shuffle>) function to randomize the order of elements in an array, which is used to test the sorting algorithms under different conditions. The code is intended to be executed as a standalone application, and it provides command-line options to configure the number of iterations and diagnostic intervals.
# Imports and Dependencies

---
- `../fd_util.h`
- `fd_sort.c`


# Global Variables

---
### ref
- **Type**: ``TYPE` array`
- **Description**: `ref` is a static array of type `TYPE` with a size defined by the macro `MAX`, which is set to 65536. The array is used to store reference data for sorting operations.
- **Use**: Used to store reference data for comparison in sorting tests.


---
### tst
- **Type**: ``TYPE` array`
- **Description**: `tst` is a static array of type `TYPE` with a size defined by the macro `MAX`, which is set to 65536. The array is used to store elements for sorting operations.
- **Use**: Used to hold data that is sorted and tested for correctness in various sorting functions.


---
### tmp
- **Type**: ``TYPE` array`
- **Description**: A static array named `tmp` with a size defined by the macro `MAX`, which is 65536. The array is of type `TYPE`, which is defined as `float`. It is used as a temporary storage buffer in sorting operations.
- **Use**: Used as a temporary buffer in various parallel sorting functions to hold intermediate data.


# Functions

---
### shuffle<!-- {{#callable:shuffle}} -->
[View Source →](<../../../../../src/util/tmpl/test_sort_para.c#L12>)

Randomly shuffles elements from array `x` into array `y` using a given random number generator.
- **Inputs**:
    - `rng`: A pointer to a random number generator of type `fd_rng_t` used to generate random indices.
    - `y`: A pointer to an array of type `TYPE` where the shuffled elements will be stored.
    - `x`: A pointer to a constant array of type `TYPE` containing the elements to shuffle.
    - `cnt`: An unsigned long integer representing the number of elements to shuffle.
- **Logic and Control Flow**:
    - Iterates over each element in the array `x` up to `cnt` elements.
    - Copies the current element from `x` to `y`.
    - Generates a random index `j` using the random number generator `rng` and the current index `i`.
    - Swaps the elements at indices `i` and `j` in the array `y`.
- **Output**: Returns a pointer to the shuffled array `y`.


---
### main<!-- {{#callable:main}} -->
[View Source →](<../../../../../src/util/tmpl/test_sort_para.c#L32>)

Initializes and runs a parallel sorting test using multiple threads and logs diagnostic information.
- **Inputs**:
    - `argc`: The number of command-line arguments.
    - `argv`: The array of command-line arguments.
- **Logic and Control Flow**:
    - Calls `fd_boot` to initialize the environment with command-line arguments.
    - Extracts `--iter-max` and `--diag-int` from command-line arguments with default values of 10000 and 100, respectively.
    - Determines the number of available threads using `fd_tile_cnt`.
    - Initializes a random number generator `rng`.
    - Creates a thread pool `tpool` using all available threads and logs the creation details.
    - Pushes worker threads into the thread pool for all threads except the main thread.
    - Logs the start of the sorting test with the iteration and diagnostic interval parameters.
    - Iterates over `iter_max` iterations, performing the following steps in each iteration:
    - Randomly selects a range of threads `[t0, t1)` and a count `cnt` of elements to sort.
    - Logs diagnostic information at intervals specified by `diag_int`.
    - Initializes reference and test arrays with monotonically increasing, decreasing, and shuffled values.
    - Tests various parallel sorting functions (`mysort_inplace_para`, `mysort_stable_fast_para`, `mysort_stable_para`, `mysort_fast_para`) to ensure they sort correctly.
    - Logs the completion of the sorting test and cleans up resources.
    - Finalizes the thread pool and deletes the random number generator.
    - Logs a 'pass' message and halts the program.
- **Output**: Returns 0 to indicate successful execution.



---
Made with ❤️ by [Driver](https://www.driver.ai/)