<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Tests interleavings of concurrent algorithms with structures and functions for managing async tasks.

# Purpose
The `fd_racesan_weave.h` file is a C header file that provides functionality for testing interleavings of concurrent algorithms. It includes the `fd_racesan_async.h` header and defines a structure `fd_racesan_weave` that manages arrays of `fd_racesan_async_t` pointers, with a maximum capacity defined by `FD_RACESAN_WEAVE_MAX`. The structure keeps track of the count of active and remaining asynchronous operations. The file declares several functions: `fd_racesan_weave_new` to initialize a new weave structure, [`fd_racesan_weave_delete`](<#fd_racesan_weave_delete>) to delete it, [`fd_racesan_weave_add`](<#fd_racesan_weave_add>) to add an asynchronous operation to the weave, and [`fd_racesan_weave_exec_rand`](<#fd_racesan_weave_exec_rand>) to execute the operations in a random order based on a given seed and maximum steps.
# Imports and Dependencies

---
- `fd_racesan_async.h`


# Data Structures

---
### fd\_racesan\_weave
- **Type**: ``struct fd_racesan_weave``
- **Members**:
    - ``async``: An array of pointers to `fd_racesan_async_t` with a maximum size defined by `FD_RACESAN_WEAVE_MAX`.
    - ``async_cnt``: A counter for the number of active elements in the `async` array.
    - ``rem``: An array of pointers to `fd_racesan_async_t` for removed elements, with a maximum size defined by `FD_RACESAN_WEAVE_MAX`.
    - ``rem_cnt``: A counter for the number of active elements in the `rem` array.
- **Description**: Manages arrays of asynchronous operations and their counts, facilitating the testing of interleavings in concurrent algorithms.


---
### fd\_racesan\_weave\_t
- **Type**: ``struct``
- **Members**:
    - ``async``: An array of pointers to `fd_racesan_async_t` with a maximum size defined by `FD_RACESAN_WEAVE_MAX`.
    - ``async_cnt``: An unsigned integer that tracks the number of active `async` elements.
    - ``rem``: An array of pointers to `fd_racesan_async_t` for removed elements, with a maximum size defined by `FD_RACESAN_WEAVE_MAX`.
    - ``rem_cnt``: An unsigned integer that tracks the number of active `rem` elements.
- **Description**: Manages and tests interleavings of concurrent algorithms by maintaining arrays of active and removed asynchronous operations, with counters to track their counts.


# Function Declarations (Public API)

---
### fd\_racesan\_weave\_delete<!-- {{#callable_declaration:fd_racesan_weave_delete}} -->
[View Source →](<../../../../../src/util/racesan/fd_racesan_weave.h#L25>)

Deletes a race condition weave.
- **Description**: Use this function to delete a race condition weave object. This function is typically called when the weave is no longer needed, to clean up resources. The function does not perform any operations on the weave and always returns NULL. Ensure that the weave is not used after calling this function.
- **Inputs**:
    - `weave`: A pointer to a `fd_racesan_weave_t` object. The function does not modify or use this parameter, but it should not be null to avoid undefined behavior.
- **Output**: Always returns NULL.
- **See Also**: [`fd_racesan_weave_delete`](<fd_racesan_weave.c.md#fd_racesan_weave_delete>)  (Implementation)


---
### fd\_racesan\_weave\_add<!-- {{#callable_declaration:fd_racesan_weave_add}} -->
[View Source →](<../../../../../src/util/racesan/fd_racesan_weave.h#L28>)

Adds an asynchronous operation to the weave.
- **Description**: Use this function to add an asynchronous operation to a weave structure. This function must be called only when the weave has been initialized and has not reached its maximum capacity of asynchronous operations. If the maximum capacity is exceeded, the function logs an error and does not add the operation. Ensure that the weave structure is properly managed to avoid exceeding the limit.
- **Inputs**:
    - `weave`: A pointer to an `fd_racesan_weave_t` structure where the asynchronous operation will be added. Must not be null and must be initialized before use.
    - `async`: A pointer to an `fd_racesan_async_t` structure representing the asynchronous operation to add. Must not be null.
- **Output**: None
- **See Also**: [`fd_racesan_weave_add`](<fd_racesan_weave.c.md#fd_racesan_weave_add>)  (Implementation)


---
### fd\_racesan\_weave\_exec\_rand<!-- {{#callable_declaration:fd_racesan_weave_exec_rand}} -->
[View Source →](<../../../../../src/util/racesan/fd_racesan_weave.h#L32>)

Executes a random sequence of asynchronous operations in a weave.
- **Description**: Use this function to execute a series of asynchronous operations in a random order within a given weave. This function is useful for testing interleavings of concurrent algorithms. It initializes the random number generator with the provided seed and executes up to `step_max` steps or until all operations are complete. Ensure that the weave is properly initialized and populated with asynchronous operations before calling this function. The function does not handle the condition where `step_max` is reached gracefully, so ensure that `step_max` is set appropriately for the intended use case.
- **Inputs**:
    - `weave`: A pointer to an `fd_racesan_weave_t` structure that contains the asynchronous operations to execute. Must not be null and should be properly initialized.
    - `seed`: An unsigned long integer used to seed the random number generator. Provides randomness to the execution order.
    - `step_max`: An unsigned long integer specifying the maximum number of steps to execute. Must be a positive value to ensure any operations are performed.
- **Output**: None
- **See Also**: [`fd_racesan_weave_exec_rand`](<fd_racesan_weave.c.md#fd_racesan_weave_exec_rand>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)