<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Vector double API for SIMD operations on double precision floating point values using SSE instructions.

# Purpose
The code defines a set of macros and inline functions for handling vector operations on double-precision floating-point numbers using SIMD (Single Instruction, Multiple Data) instructions specific to the SSE (Streaming SIMD Extensions) architecture. The primary data type used is `vd_t`, which represents a vector of two double-precision floating-point numbers. The code provides a comprehensive API for constructing, manipulating, and performing arithmetic operations on these vectors. It includes constructors for creating vectors, predefined constants, memory operations for loading and storing vectors, and a variety of arithmetic and logical operations.

The code also includes conversion operations to transform vector doubles into other vector types, such as integer and float vectors, and vice versa. Additionally, it provides reduction operations to compute the sum, minimum, and maximum of vector elements, as well as miscellaneous operations like gathering elements from memory and transposing matrices. The code is intended to be included indirectly through a header file (`fd_sse.h`) and assumes that input values are not exotic (e.g., no NaNs or infinities). The use of macros and inline functions aims to optimize performance by leveraging the underlying hardware capabilities of the SSE architecture.
# Functions

---
### vd\_extract<!-- {{#callable:vd_extract}} -->
[View Source →](<../../../../../src/util/simd/fd_sse_vd.h#L87>)

Extracts a double from a specified lane of a vector double.
- **Inputs**:
    - ``a``: A vector double (`vd_t`) containing two double precision floating point values.
    - ``imm``: An integer index (0 or 1) specifying which double to extract from the vector.
- **Logic and Control Flow**:
    - Declare an array `d` of two doubles with the attribute `V_ATTR`.
    - Store the contents of the vector double `a` into the array `d` using `_mm_store_pd`.
    - Return the double at index `imm` from the array `d`.
- **Output**: A double precision floating point value extracted from the specified lane of the vector double.


---
### vd\_insert<!-- {{#callable:vd_insert}} -->
[View Source →](<../../../../../src/util/simd/fd_sse_vd.h#L94>)

Replaces a specified element in a vector of doubles with a new value and returns the modified vector.
- **Inputs**:
    - ``a``: A vector of doubles (`vd_t`) from which an element will be replaced.
    - ``imm``: An integer index (0 or 1) indicating which element in the vector `a` to replace.
    - ``v``: A double value to insert into the vector `a` at the specified index `imm`.
- **Logic and Control Flow**:
    - Store the elements of vector `a` into a local array `d` of two doubles.
    - Replace the element at index `imm` in the array `d` with the value `v`.
    - Load the modified array `d` back into a vector and return it.
- **Output**: Returns a vector of doubles (`vd_t`) with the specified element replaced by the new value.


---
### vd\_extract\_variable<!-- {{#callable:vd_extract_variable}} -->
[View Source →](<../../../../../src/util/simd/fd_sse_vd.h#L102>)

Extracts a double value from a vector double at a specified index.
- **Inputs**:
    - ``a``: A `vd_t` type representing a vector double containing two double precision floating point values.
    - ``n``: An integer index (0 or 1) specifying which double value to extract from the vector.
- **Logic and Control Flow**:
    - Store the contents of the vector double `a` into a local array `d` of two doubles using `_mm_store_pd`.
    - Return the double value at index `n` from the array `d`.
- **Output**: Returns the double value at the specified index `n` from the vector double `a`.


---
### vd\_insert\_variable<!-- {{#callable:vd_insert_variable}} -->
[View Source →](<../../../../../src/util/simd/fd_sse_vd.h#L109>)

Replaces a specified element in a vector double with a new double value.
- **Inputs**:
    - ``a``: A vector double (`vd_t`) containing two double precision floating point values.
    - ``n``: An integer index (0 or 1) indicating which element of the vector to replace.
    - ``v``: A double precision floating point value to insert into the vector.
- **Logic and Control Flow**:
    - Store the elements of vector `a` into a local array `d` of two doubles.
    - Replace the element at index `n` in array `d` with the value `v`.
    - Load the modified array `d` back into a vector double and return it.
- **Output**: A vector double (`vd_t`) with the specified element replaced by the new value.


---
### vd\_to\_vf<!-- {{#callable:vd_to_vf}} -->
[View Source →](<../../../../../src/util/simd/fd_sse_vd.h#L260>)

Converts a vector of double-precision floating-point values to a vector of single-precision floating-point values and optionally shuffles the result with another vector.
- **Inputs**:
    - ``d``: A vector of double-precision floating-point values (`vd_t`).
    - ``f``: A vector of single-precision floating-point values (`vf_t`).
    - ``imm_hi``: An integer flag that determines the shuffle operation; if non-zero, a different shuffle pattern is applied.
- **Logic and Control Flow**:
    - Convert the double-precision vector `d` to a single-precision vector `_d` using `_mm_cvtpd_ps`.
    - Check the value of `imm_hi`.
    - If `imm_hi` is non-zero, shuffle `_d` with `f` using `_mm_shuffle_ps` with the pattern `_MM_SHUFFLE(1,0,1,0)`.
    - If `imm_hi` is zero, shuffle `_d` with `f` using `_mm_shuffle_ps` with the pattern `_MM_SHUFFLE(3,2,1,0)`.
    - Return the resulting vector `_d`.
- **Output**: A vector of single-precision floating-point values (`vf_t`) that is a combination of the converted values from `d` and the values from `f`, shuffled according to `imm_hi`.


---
### vd\_to\_vi\_fast<!-- {{#callable:vd_to_vi_fast}} -->
[View Source →](<../../../../../src/util/simd/fd_sse_vd.h#L270>)

Converts a vector of double-precision floating-point values to a vector of integers using fast rounding and shuffling based on a control flag.
- **Inputs**:
    - ``d``: A vector of double-precision floating-point values (`vd_t`).
    - ``i``: A vector of integers (`vi_t`).
    - ``imm_hi``: An integer flag that determines the shuffling pattern.
- **Logic and Control Flow**:
    - Convert the double-precision vector `d` to a vector of integers using `_mm_cvtpd_epi32` and cast it to a single-precision float vector `vf_t`.
    - Cast the integer vector `i` to a single-precision float vector `vf_t`.
    - If `imm_hi` is true, shuffle the vectors using `_mm_shuffle_ps` with the pattern `_MM_SHUFFLE(1,0,1,0)`.
    - If `imm_hi` is false, shuffle the vectors using `_mm_shuffle_ps` with the pattern `_MM_SHUFFLE(3,2,1,0)`.
    - Return the shuffled vector cast back to an integer vector `vi_t`.
- **Output**: A vector of integers (`vi_t`) resulting from the conversion and shuffling of the input vectors.


---
### vd\_to\_vu\_fast<!-- {{#callable:vd_to_vu_fast}} -->
[View Source →](<../../../../../src/util/simd/fd_sse_vd.h#L278>)

Converts a vector of double-precision floating-point values to a vector of unsigned integers, using different methods based on hardware support and an immediate flag to determine the output order.
- **Inputs**:
    - `d`: A vector of double-precision floating-point values (`vd_t`).
    - `u`: A vector of unsigned integers (`vu_t`).
    - `imm_hi`: An integer flag that determines the order of the output vector.
- **Logic and Control Flow**:
    - Checks if the hardware supports AVX-512F and AVX-512VL; if so, uses `_mm_cvtpd_epu32` to convert `d` to unsigned integers directly.
    - If AVX-512F and AVX-512VL are not supported, emulates the conversion by subtracting 2^31 from `d`, converting the result to signed integers, and then adjusting the result using two's complement arithmetic.
    - Uses a conditional operation to select between the original and adjusted values based on whether `d` is less than 2^31.
    - Returns the result of a shuffle operation that interleaves the converted vector `v` with the input vector `u` based on the value of `imm_hi`.
- **Output**: A vector of unsigned integers (`vu_t`) with the converted values from `d`, interleaved with `u` based on `imm_hi`.


---
### vd\_to\_vl<!-- {{#callable:vd_to_vl}} -->
[View Source →](<../../../../../src/util/simd/fd_sse_vd.h#L312>)

Converts a vector of two double-precision floating-point values to a vector of two long integers.
- **Inputs**:
    - ``d``: A vector of type `vd_t` containing two double-precision floating-point values.
- **Logic and Control Flow**:
    - Store the double-precision values from `d` into a temporary union `t` using `_mm_store_pd`.
    - Convert the stored double values in `t` to long integers and store them in another union `u`.
    - Load the long integers from `u` and return them as a vector of type `__m128i` using `_mm_load_si128`.
- **Output**: A vector of type `__m128i` containing two long integers converted from the input double-precision values.


---
### vd\_to\_vv<!-- {{#callable:vd_to_vv}} -->
[View Source →](<../../../../../src/util/simd/fd_sse_vd.h#L321>)

Converts a vector of two double-precision floating-point values to a vector of two unsigned long integers.
- **Inputs**:
    - ``d``: A `vd_t` type representing a vector of two double-precision floating-point values.
- **Logic and Control Flow**:
    - Store the double-precision values from `d` into a temporary union `t` using `_mm_store_pd`.
    - Convert each double value in `t` to an unsigned long and store them in another union `u`.
    - Load the unsigned long values from `u` into a `__m128i` vector using `_mm_load_si128`.
- **Output**: Returns a `__m128i` vector containing the converted unsigned long integer values.


---
### vd\_sum\_all<!-- {{#callable:vd_sum_all}} -->
[View Source →](<../../../../../src/util/simd/fd_sse_vd.h#L339>)

Computes the sum of the elements in a vector double and broadcasts the result across the vector.
- **Inputs**:
    - ``x``: A vector double (`vd_t`) containing two double-precision floating-point values.
- **Logic and Control Flow**:
    - Uses the `_mm_hadd_pd` intrinsic to horizontally add the two double-precision values in the vector `x`.
    - Returns the result of the addition, broadcasted across the vector.
- **Output**: A vector double (`vd_t`) where both elements are the sum of the elements in the input vector `x`.


---
### vd\_min\_all<!-- {{#callable:vd_min_all}} -->
[View Source →](<../../../../../src/util/simd/fd_sse_vd.h#L344>)

Computes the minimum of two double-precision floating-point values in a vector and returns a vector with both lanes set to this minimum value.
- **Inputs**:
    - ``a``: A vector of type `vd_t` containing two double-precision floating-point values.
- **Logic and Control Flow**:
    - Use `_mm_permute_pd` to swap the two lanes of the input vector `a`.
    - Use `_mm_min_pd` to compute the minimum of the original and permuted vectors.
    - Return the result, which is a vector with both lanes set to the minimum value.
- **Output**: A vector of type `vd_t` where both lanes contain the minimum value of the input vector's lanes.


---
### vd\_max\_all<!-- {{#callable:vd_max_all}} -->
[View Source →](<../../../../../src/util/simd/fd_sse_vd.h#L349>)

Computes the maximum value of two double-precision floating-point numbers in a vector and returns a vector with both lanes set to this maximum value.
- **Inputs**:
    - ``a``: A vector of type `vd_t` containing two double-precision floating-point numbers.
- **Logic and Control Flow**:
    - Permutes the input vector `a` to swap its two elements using `_mm_permute_pd` with an immediate value of 1.
    - Computes the element-wise maximum of the original vector `a` and the permuted vector using `_mm_max_pd`.
- **Output**: A vector of type `vd_t` where both elements are set to the maximum value found in the input vector `a`.



---
Made with ❤️ by [Driver](https://www.driver.ai/)