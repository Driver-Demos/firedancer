<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Tests the functionality of workspace free treap operations with random partition manipulations.

# Purpose
The code is an executable C program designed to test the functionality of a workspace management system. It includes headers `fd_util.h` and `fd_wksp_private.h`, which suggest that it relies on utility functions and private workspace management functions. The program initializes a random number generator and processes command-line arguments to configure parameters such as `scratch_sz`, `name`, `seed`, `part_max`, and `data_max`. These parameters are used to set up a workspace with a specified size and configuration.

The main functionality of the program involves creating and manipulating partitions within the workspace. It performs operations such as querying, inserting, and removing partitions in a randomized manner to test the integrity and performance of the workspace's partition management system. The program uses a treap data structure to manage these partitions and includes checks to ensure that operations are performed correctly. The program logs its progress and results, and it concludes by cleaning up the workspace and random number generator resources before exiting.
# Imports and Dependencies

---
- `../fd_util.h`
- `fd_wksp_private.h`


# Global Variables

---
### scratch
- **Type**: ``uchar[]``
- **Description**: An array of unsigned characters with a maximum size defined by `SCRATCH_MAX`, which is 16384 bytes. The array is aligned according to the `FD_WKSP_ALIGN` attribute.
- **Use**: Used as a memory buffer for workspace operations in the program.


# Functions

---
### main<!-- {{#callable:main}} -->
[View Source →](<../../../../../src/util/wksp/test_wksp_free_treap.c#L6>)

Initializes and tests a workspace with random operations on partitions using command-line parameters.
- **Inputs**:
    - `argc`: The number of command-line arguments.
    - `argv`: An array of command-line arguments.
- **Logic and Control Flow**:
    - Calls `fd_boot` to initialize the environment with command-line arguments.
    - Initializes a random number generator `rng`.
    - Parses command-line arguments to set `scratch_sz`, `name`, `seed`, `part_max`, and `data_max`.
    - Checks if `scratch_sz` exceeds `SCRATCH_MAX` and logs an error if true.
    - Estimates `part_max` and `data_max` if they are not provided.
    - Logs the testing parameters.
    - Creates and joins a workspace `wksp` with the specified parameters.
    - Logs an error if the workspace creation fails.
    - Initializes partition information `pinfo` for the workspace.
    - Sets `part_free_cidx` to indicate no free partitions initially.
    - Creates non-conflicting partitions within the workspace using a loop.
    - Performs 100 million iterations of random operations (query, insert, remove) on the partitions using a switch statement.
    - Queries check for suitable partitions and validate results.
    - Inserts add partitions to the treap and validate success or corruption.
    - Removes partitions from the treap and validate success or corruption.
    - Deletes and leaves the workspace and random number generator.
    - Logs a success message and halts the program.
- **Output**: Returns 0 to indicate successful execution.
- **Functions Called**:
    - [`fd_wksp_part_max_est`](<fd_wksp_admin.c.md#fd_wksp_part_max_est>)
    - [`fd_wksp_data_max_est`](<fd_wksp_admin.c.md#fd_wksp_data_max_est>)
    - [`fd_wksp_join`](<fd_wksp_admin.c.md#fd_wksp_join>)
    - [`fd_wksp_new`](<fd_wksp_admin.c.md#fd_wksp_new>)
    - [`fd_wksp_private_pinfo`](<fd_wksp_private.h.md#fd_wksp_private_pinfo>)
    - [`fd_wksp_private_pinfo_cidx`](<fd_wksp_private.h.md#fd_wksp_private_pinfo_cidx>)
    - [`fd_wksp_private_free_treap_query`](<fd_wksp_free_treap.c.md#fd_wksp_private_free_treap_query>)
    - [`fd_wksp_private_pinfo_idx_is_null`](<fd_wksp_private.h.md#fd_wksp_private_pinfo_idx_is_null>)
    - [`fd_wksp_private_pinfo_sz`](<fd_wksp_private.h.md#fd_wksp_private_pinfo_sz>)
    - [`fd_wksp_private_free_treap_insert`](<fd_wksp_free_treap.c.md#fd_wksp_private_free_treap_insert>)
    - [`fd_wksp_private_free_treap_remove`](<fd_wksp_free_treap.c.md#fd_wksp_private_free_treap_remove>)
    - [`fd_wksp_delete`](<fd_wksp_admin.c.md#fd_wksp_delete>)
    - [`fd_wksp_leave`](<fd_wksp_admin.c.md#fd_wksp_leave>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)