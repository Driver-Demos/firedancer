<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

A Bash script for testing various operations of the `fd_wksp_ctl` utility in the Firedancer codebase.

# Purpose
The Bash script is a test suite for the `fd_wksp_ctl` command-line utility, which manages workspace operations. It performs a series of tests to verify the functionality of `fd_wksp_ctl` commands such as `new`, `alloc`, `checkpt`, `info`, `memset`, `check`, `verify`, `rebuild`, `usage`, `query`, `tag-query`, `tag-free`, `free`, `reset`, `restore`, and `delete`. The script sets up test parameters, cleans up any previous test artifacts, and executes the commands with various arguments to ensure they behave as expected. It uses a `fail` function to handle unexpected exit codes and logs the results of each test. The script is intended to be executed in a Unix-like environment where the `fd_wksp_ctl` binary is available.
# Global Variables

---
### UNIT\_TEST
- **Type**: ``string``
- **Description**: `UNIT_TEST` is a global variable that stores the directory path of the script's source file. It is determined using the `dirname` command on the `$BASH_SOURCE` variable, which contains the path of the script being executed.
- **Use**: Used to determine the location of binaries relative to the script's directory.


---
### BUILD
- **Type**: ``string``
- **Description**: Represents the directory path where the binaries are located. It is determined by getting the directory name of the `UNIT_TEST` variable, which itself is derived from the script's source path.
- **Use**: Used to construct the path to the `bin` directory, which is stored in the `BIN` variable.


---
### BIN
- **Type**: `string`
- **Description**: `BIN` is a global variable that stores the path to the 'bin' directory within the build directory. It is constructed by appending '/bin' to the `BUILD` variable, which itself is derived from the directory of the unit test script.
- **Use**: Used to specify the location of the binary files for executing various commands in the script.


---
### WKSP
- **Type**: ``string``
- **Description**: The variable `WKSP` is a string that holds the name of a workspace file, specifically 'test_fd_wksp_ctl.wksp'. This file is used in various operations throughout the script, such as creating, deleting, and managing workspace-related tasks.
- **Use**: Used as the name of the workspace file in commands executed by the `fd_wksp_ctl` binary.


---
### PAGE\_CNT
- **Type**: `integer`
- **Description**: Specifies the number of pages to use in the workspace operations. It is set to 1, indicating that the operations will use a single page.
- **Use**: Used as an argument in the `fd_wksp_ctl` command to define the number of pages for workspace operations.


---
### PAGE\_SZ
- **Type**: ``string``
- **Description**: The `PAGE_SZ` variable is a global variable defined as a string with the value 'gigantic'. It is used in the script to specify the size of a page when creating a new workspace.
- **Use**: Used to define the page size parameter in workspace creation commands.


---
### CPU\_IDX
- **Type**: ``integer``
- **Description**: Represents the index of the CPU to use for operations. It is set to 0, indicating the first CPU.
- **Use**: Used as a parameter in the `fd_wksp_ctl` command to specify the CPU index for workspace operations.


---
### MODE
- **Type**: ``int``
- **Description**: `MODE` is a global variable that is set to the integer value `0600`. This value represents file permissions in octal notation, commonly used in Unix-like systems to define read and write permissions for the owner of a file.
- **Use**: Used as a parameter for file operations to set permissions when creating or modifying files.


---
### CHECKPT
- **Type**: ``string``
- **Description**: The `CHECKPT` variable is a string that holds the name of a checkpoint file, `test_fd_wksp_ctl.checkpt`. This file is used in various test operations to store and retrieve workspace states during the execution of the script.
- **Use**: Used to specify the checkpoint file name for operations that involve saving and restoring workspace states.


---
### INFO
- **Type**: ``string``
- **Description**: A string variable that contains the text 'The quick brown fox jumps over the lazy dog'. This is a well-known pangram, a sentence that includes every letter of the alphabet at least once.
- **Use**: Used as a placeholder or test string in the script, particularly in the context of the `checkpt` command.


---
### FD\_LOG\_PATH
- **Type**: `string`
- **Description**: The `FD_LOG_PATH` variable is a global environment variable that specifies the path to the log file for the application. In this script, it is set to an empty string, which effectively disables logging by not specifying a log file path.
- **Use**: Used to control the logging behavior of the application by setting the log file path.


---
### GADDR
- **Type**: ``string``
- **Description**: Stores the result of the `alloc` command executed by the `fd_wksp_ctl` binary. This command allocates a workspace with specified parameters and returns an address or identifier for the allocated space.
- **Use**: Used to store the address or identifier of the allocated workspace for further operations.


---
### GADDR1
- **Type**: `string`
- **Description**: `GADDR1` is a global variable that stores the result of a command execution. It captures the output of the `fd_wksp_ctl` command when it is used to allocate a workspace with a specific tag and size parameters.
- **Use**: Stores the output of a tagged allocation command for further use in the script.


---
### GADDR2
- **Type**: ``string``
- **Description**: `GADDR2` is a global variable that stores the result of executing the command `$BIN/fd_wksp_ctl tag 1234 alloc "$WKSP" 4096 4096`. This command allocates a workspace with a specific tag and size, and `GADDR2` holds the address or identifier of this allocation.
- **Use**: Stores the address or identifier of a workspace allocation with a specific tag and size.


---
### GADDR3
- **Type**: ``string``
- **Description**: `GADDR3` is a global variable that stores the result of executing the command `$BIN/fd_wksp_ctl tag 2345 alloc "$WKSP" 4096 4096`. This command allocates a workspace with a specific tag and size, and `GADDR3` holds the address or identifier of this allocation.
- **Use**: Stores the address or identifier of a workspace allocation with a specific tag.


---
### SUPPORTED\_STYLES
- **Type**: ``string``
- **Description**: Contains the output of the command `fd_wksp_ctl supported-styles`. This output is a list of supported styles for the workspace control operations.
- **Use**: Used in a loop to test various workspace control operations with each supported style.


# Functions

---
### fail
Handles failure by removing a checkpoint file, printing an error message, and exiting with status 1.
- **Inputs**:
    - `$1`: The description of the operation that failed.
    - `$2`: The unexpected exit code of the operation.
- **Logic and Control Flow**:
    - Remove the file specified by the `CHECKPT` variable using `rm -fv` to forcefully and verbosely delete it.
    - Print an error message to standard output indicating the failure, including the operation description (`$1`) and the unexpected exit code (`$2`).
    - Print 'Log N/A' to indicate that no log is available.
    - Exit the script with status code 1 to indicate failure.
- **Output**: There is no return value; the function exits the script with status code 1.



---
Made with ❤️ by [Driver](https://www.driver.ai/)