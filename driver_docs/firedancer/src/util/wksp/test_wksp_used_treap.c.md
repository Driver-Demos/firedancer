<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Tests the functionality of workspace used treap operations with random partition manipulations.

# Purpose
The code is an executable C program designed to test the functionality of a workspace management system. It includes several header files, such as `fd_util.h`, `fd_sqrt.h`, and `fd_wksp_private.h`, which provide utility functions, mathematical operations, and private workspace management functions, respectively. The program initializes a random number generator and processes command-line arguments to configure parameters like `scratch_sz`, `name`, `seed`, `part_max`, and `data_max`. These parameters are used to set up a workspace with specific characteristics.

The main functionality of the program involves creating and manipulating partitions within the workspace. It performs a series of operations on a data structure called a "treap," which is used to manage non-conflicting partitions. The program executes random operations such as querying, inserting, and removing partitions in the treap, ensuring that the operations maintain the integrity of the workspace. The program logs the results of these operations and concludes by cleaning up the workspace and random number generator resources before exiting.
# Imports and Dependencies

---
- `../fd_util.h`
- `../math/fd_sqrt.h`
- `fd_wksp_private.h`


# Global Variables

---
### scratch
- **Type**: ``uchar[]``
- **Description**: An array of unsigned characters with a maximum size defined by `SCRATCH_MAX`, which is 16384 bytes. The array is aligned according to the `FD_WKSP_ALIGN` attribute.
- **Use**: Used as a memory buffer for workspace operations in the program.


# Functions

---
### main<!-- {{#callable:main}} -->
[View Source →](<../../../../../src/util/wksp/test_wksp_used_treap.c#L7>)

Initializes and tests a workspace with random operations on partitions using command-line parameters.
- **Inputs**:
    - `argc`: The number of command-line arguments.
    - `argv`: An array of command-line argument strings.
- **Logic and Control Flow**:
    - Calls `fd_boot` to initialize the environment with command-line arguments.
    - Initializes a random number generator `rng` using `fd_rng_new` and `fd_rng_join`.
    - Parses command-line arguments to set `scratch_sz`, `name`, `seed`, `part_max`, and `data_max` with default values if not provided.
    - Checks if `scratch_sz` exceeds `SCRATCH_MAX` and logs an error if true.
    - Estimates `part_max` and `data_max` if they are not set using [`fd_wksp_part_max_est`](<fd_wksp_admin.c.md#fd_wksp_part_max_est>) and [`fd_wksp_data_max_est`](<fd_wksp_admin.c.md#fd_wksp_data_max_est>).
    - Logs the testing parameters using `FD_LOG_NOTICE`.
    - Creates and joins a workspace `wksp` using [`fd_wksp_new`](<fd_wksp_admin.c.md#fd_wksp_new>) and [`fd_wksp_join`](<fd_wksp_admin.c.md#fd_wksp_join>), logging an error if creation fails.
    - Initializes `pinfo` with private partition information from the workspace.
    - Sets `wksp->part_used_cidx` to a null index using [`fd_wksp_private_pinfo_cidx`](<fd_wksp_private.h.md#fd_wksp_private_pinfo_cidx>).
    - Creates non-conflicting partitions in the workspace and assigns tags to them.
    - Performs 100 million random operations (query, insert, remove) on the workspace partitions using a switch-case structure.
    - Deletes the workspace and random number generator using [`fd_wksp_delete`](<fd_wksp_admin.c.md#fd_wksp_delete>) and `fd_rng_delete`.
    - Logs a success message and calls `fd_halt` before returning 0.
- **Output**: Returns 0 to indicate successful execution.
- **Functions Called**:
    - [`fd_wksp_part_max_est`](<fd_wksp_admin.c.md#fd_wksp_part_max_est>)
    - [`fd_wksp_data_max_est`](<fd_wksp_admin.c.md#fd_wksp_data_max_est>)
    - [`fd_wksp_join`](<fd_wksp_admin.c.md#fd_wksp_join>)
    - [`fd_wksp_new`](<fd_wksp_admin.c.md#fd_wksp_new>)
    - [`fd_wksp_private_pinfo`](<fd_wksp_private.h.md#fd_wksp_private_pinfo>)
    - [`fd_wksp_private_pinfo_cidx`](<fd_wksp_private.h.md#fd_wksp_private_pinfo_cidx>)
    - [`fd_wksp_private_used_treap_query`](<fd_wksp_used_treap.c.md#fd_wksp_private_used_treap_query>)
    - [`fd_wksp_private_pinfo_idx_is_null`](<fd_wksp_private.h.md#fd_wksp_private_pinfo_idx_is_null>)
    - [`fd_wksp_private_used_treap_insert`](<fd_wksp_used_treap.c.md#fd_wksp_private_used_treap_insert>)
    - [`fd_wksp_private_used_treap_remove`](<fd_wksp_used_treap.c.md#fd_wksp_private_used_treap_remove>)
    - [`fd_wksp_delete`](<fd_wksp_admin.c.md#fd_wksp_delete>)
    - [`fd_wksp_leave`](<fd_wksp_admin.c.md#fd_wksp_leave>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)