<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

API for creating and managing NUMA-aware, TLB-efficient shared memory workspaces for inter-thread and inter-process communication.

# Purpose
The code defines a C header file for managing NUMA-aware and TLB-efficient workspaces, which are used for complex inter-thread and inter-process shared memory communication patterns. The file provides a comprehensive API for creating, managing, and interacting with these workspaces. It includes functions for allocating and freeing memory, converting between global and local addresses, and managing workspace metadata. The code also supports operations like attaching and detaching workspaces, verifying and rebuilding workspace integrity, and handling workspace checkpoints for persistence and recovery.

The header file defines several constants and data structures to facilitate workspace management, such as `fd_wksp_t` for workspace handles and `fd_wksp_usage_t` for usage statistics. It provides both administrative and user-level APIs, allowing for the creation of shared or anonymous workspaces, memory allocation with specific alignment requirements, and memory management operations. The file also includes helper functions for converting workspace addresses to strings and vice versa, as well as functions for managing workspace checkpoints and restoring workspace states. The code is designed to minimize fragmentation and ensure efficient memory usage, with a focus on larger allocations and persistent usage scenarios.
# Imports and Dependencies

---
- `../tpool/fd_tpool.h`
- `../checkpt/fd_checkpt.h`


# Data Structures

---
### fd\_wksp\_t
- **Type**: ``struct``
- **Members**:
    - ``fd_wksp_private``: An opaque structure representing the internal details of the workspace.
- **Description**: `fd_wksp_t` is a typedef for a structure used to manage NUMA-aware and TLB-efficient workspaces for shared memory communication between threads and processes. It is an opaque handle, meaning its internal structure is not exposed, allowing for abstraction and encapsulation of the workspace's implementation details. This data structure is part of an API designed to facilitate memory allocation and management in complex inter-thread and inter-process communication scenarios.


---
### fd\_wksp\_usage
- **Type**: ``struct``
- **Members**:
    - ``total_max``: Maximum number of partitions the workspace can have.
    - ``total_cnt``: Current number of partitions in the workspace.
    - ``total_sz``: Total size in bytes available for partitioning in the workspace.
    - ``free_cnt``: Number of free partitions currently available in the workspace.
    - ``free_sz``: Total size in bytes of free partitions in the workspace.
    - ``used_cnt``: Number of partitions currently in use in the workspace.
    - ``used_sz``: Total size in bytes of partitions currently in use in the workspace.
- **Description**: Represents usage statistics for a workspace, including maximum, current, free, and used partition counts and sizes.


---
### fd\_wksp\_usage\_t
- **Type**: ``struct``
- **Members**:
    - ``total_max``: Maximum number of partitions the workspace can have.
    - ``total_cnt``: Current number of partitions in the workspace.
    - ``total_sz``: Total size in bytes available for partitioning in the workspace.
    - ``free_cnt``: Number of free partitions currently available in the workspace.
    - ``free_sz``: Total size in bytes of free partitions in the workspace.
    - ``used_cnt``: Number of partitions currently used in the workspace.
    - ``used_sz``: Total size in bytes of used partitions in the workspace.
- **Description**: Used to return statistics about workspace usage, including the maximum, current, free, and used partitions and their respective sizes.


---
### fd\_wksp\_tag\_query\_info
- **Type**: ``struct``
- **Members**:
    - `gaddr_lo`: The lower bound of the global address range covered by the partition.
    - `gaddr_hi`: The upper bound of the global address range covered by the partition, exclusive.
    - `tag`: The tag associated with the partition.
- **Description**: Defines a structure that holds information about a partition in a workspace, including the range of global addresses it covers and its associated tag.


---
### fd\_wksp\_tag\_query\_info\_t
- **Type**: ``struct``
- **Members**:
    - `gaddr_lo`: The lower bound of the global address range covered by the partition.
    - `gaddr_hi`: The upper bound of the global address range covered by the partition.
    - `tag`: The tag associated with the partition.
- **Description**: Defines a structure used to store information about a partition in a workspace, including the range of global addresses it covers and its associated tag.


---
### fd\_wksp\_preview
- **Type**: ``struct``
- **Members**:
    - `style`: An integer representing the checkpoint style used for the workspace.
    - `seed`: An unsigned integer used to seed the heap priorities.
    - `part_max`: An unsigned long representing the maximum number of partitions in the workspace.
    - `data_max`: An unsigned long representing the maximum size of the data region in the workspace.
    - `name`: A character array holding the original workspace name, with a maximum size defined by `FD_SHMEM_NAME_MAX`.
- **Description**: Holds metadata for previewing a workspace checkpoint, including style, seed, partition and data limits, and the original workspace name.


---
### fd\_wksp\_preview\_t
- **Type**: ``struct``
- **Members**:
    - ``style``: Holds the style of the workspace checkpoint.
    - ``seed``: Stores the seed value used for the workspace.
    - ``part_max``: Indicates the maximum number of partitions in the workspace.
    - ``data_max``: Specifies the maximum size of the data region in the workspace.
    - ``name``: Contains the original name of the workspace as a C string.
- **Description**: Defines a structure used to preview the checkpoint of a workspace, providing essential information such as style, seed, partition limits, data size, and the original workspace name.


# Functions

---
### fd\_wksp\_gaddr\_fast<!-- {{#callable:fd_wksp_gaddr_fast}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L377>)

Converts a local address to a global address in a workspace by subtracting the base address of the workspace from the local address.
- **Inputs**:
    - `wksp`: A pointer to a `fd_wksp_t` structure representing the workspace.
    - `laddr`: A pointer to a local address within the workspace.
- **Logic and Control Flow**:
    - Cast `laddr` to `ulong` to get its numerical value.
    - Cast `wksp` to `ulong` to get the base address of the workspace as a numerical value.
    - Subtract the base address of the workspace from the local address to compute the global address.
- **Output**: Returns the global address as an `ulong`.


---
### fd\_wksp\_laddr\_fast<!-- {{#callable:fd_wksp_laddr_fast}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L386>)

Converts a global address (`gaddr`) into a local address within a workspace (`wksp`).
- **Inputs**:
    - `wksp`: A pointer to a constant `fd_wksp_t` structure representing the workspace.
    - `gaddr`: An unsigned long integer representing the global address to convert.
- **Logic and Control Flow**:
    - Cast the `wksp` pointer to an unsigned long integer.
    - Add the `gaddr` to the casted `wksp` value.
    - Cast the result back to a void pointer and return it.
- **Output**: Returns a void pointer representing the local address corresponding to the given global address in the workspace.


---
### fd\_wksp\_alloc<!-- {{#callable:fd_wksp_alloc}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L497>)

Allocates memory from a workspace with specified alignment, size, and tag, using a simplified interface.
- **Inputs**:
    - `wksp`: A pointer to the `fd_wksp_t` workspace from which to allocate memory.
    - `align`: The alignment requirement for the allocation, which must be a non-negative power of two or zero to use the default alignment.
    - `sz`: The size of the memory to allocate in bytes.
    - `tag`: A positive value used to tag the allocation for identification purposes.
- **Logic and Control Flow**:
    - Initializes a dummy array of two `ulong` elements to store allocation range information.
    - Calls [`fd_wksp_alloc_at_least`](<fd_wksp_user.c.md#fd_wksp_alloc_at_least>) with the workspace, alignment, size, tag, and dummy array to perform the allocation.
    - Returns the result of [`fd_wksp_alloc_at_least`](<fd_wksp_user.c.md#fd_wksp_alloc_at_least>), which is the global address of the allocated memory or 0UL on failure.
- **Output**: Returns the global address of the allocated memory on success or 0UL on failure.
- **Functions Called**:
    - [`fd_wksp_alloc_at_least`](<fd_wksp_user.c.md#fd_wksp_alloc_at_least>)


---
### fd\_wksp\_new\_anonymous<!-- {{#callable:fd_wksp_new_anonymous}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L712>)

Creates a new anonymous workspace with specified parameters.
- **Inputs**:
    - `page_sz`: The size of each page in the workspace.
    - `page_cnt`: The number of pages in the workspace.
    - `cpu_idx`: The index of the CPU to associate with the workspace.
    - `name`: The name of the workspace.
    - `opt_part_max`: The optional maximum number of partitions in the workspace.
- **Logic and Control Flow**:
    - Calls the [`fd_wksp_new_anon`](<fd_wksp_helper.c.md#fd_wksp_new_anon>) function with the provided `name`, `page_sz`, a fixed sub-count of 1, and pointers to `page_cnt` and `cpu_idx`, along with a seed of 0 and `opt_part_max`.
- **Output**: Returns a pointer to the newly created anonymous workspace (`fd_wksp_t *`).
- **Functions Called**:
    - [`fd_wksp_new_anon`](<fd_wksp_helper.c.md#fd_wksp_new_anon>)


---
### fd\_wksp\_delete\_anonymous<!-- {{#callable:fd_wksp_delete_anonymous}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L721>)

Deletes an anonymous workspace by calling [`fd_wksp_delete_anon`](<fd_wksp_helper.c.md#fd_wksp_delete_anon>) with the given workspace pointer.
- **Inputs**:
    - `wksp`: A pointer to the `fd_wksp_t` structure representing the anonymous workspace to delete.
- **Logic and Control Flow**:
    - Calls the function [`fd_wksp_delete_anon`](<fd_wksp_helper.c.md#fd_wksp_delete_anon>) with the `wksp` argument.
- **Output**: No return value; the function performs the deletion operation.
- **Functions Called**:
    - [`fd_wksp_delete_anon`](<fd_wksp_helper.c.md#fd_wksp_delete_anon>)


---
### fd\_wksp\_checkpt<!-- {{#callable:fd_wksp_checkpt}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L1006>)

Calls [`fd_wksp_checkpt_tpool`](<fd_wksp_io.c.md#fd_wksp_checkpt_tpool>) to write the state of a workspace to a file using default thread pool settings.
- **Inputs**:
    - `wksp`: A pointer to the `fd_wksp_t` structure representing the workspace to checkpoint.
    - `path`: A constant character pointer to the file path where the checkpoint will be saved.
    - `mode`: An unsigned long integer representing the UNIX style permissions for the checkpoint file.
    - `style`: An integer specifying the checkpoint style, which should be a `FD_WKSP_CHECKPT_STYLE_*` value or 0 for default.
    - `uinfo`: A constant character pointer to a user information string, which can be NULL or a string up to 16384 bytes.
- **Logic and Control Flow**:
    - Calls [`fd_wksp_checkpt_tpool`](<fd_wksp_io.c.md#fd_wksp_checkpt_tpool>) with `NULL` for the thread pool, `0UL` for the starting thread, and `1UL` for the ending thread, indicating a single-threaded operation.
    - Passes the provided `wksp`, `path`, `mode`, `style`, and `uinfo` parameters directly to [`fd_wksp_checkpt_tpool`](<fd_wksp_io.c.md#fd_wksp_checkpt_tpool>).
- **Output**: Returns an integer indicating success (`FD_WKSP_SUCCESS`) or an error code (`FD_WKSP_ERR_*`) from [`fd_wksp_checkpt_tpool`](<fd_wksp_io.c.md#fd_wksp_checkpt_tpool>).
- **Functions Called**:
    - [`fd_wksp_checkpt_tpool`](<fd_wksp_io.c.md#fd_wksp_checkpt_tpool>)


---
### fd\_wksp\_restore<!-- {{#callable:fd_wksp_restore}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L1051>)

Restores a workspace from a checkpoint file using a specified seed.
- **Inputs**:
    - ``wksp``: A pointer to the `fd_wksp_t` structure representing the workspace to restore.
    - ``path``: A constant character pointer to the path of the checkpoint file.
    - ``seed``: An unsigned integer used as the seed for the restoration process.
- **Logic and Control Flow**:
    - Calls the [`fd_wksp_restore_tpool`](<fd_wksp_io.c.md#fd_wksp_restore_tpool>) function with `NULL` for the thread pool, `0UL` for the starting thread index, `1UL` for the ending thread index, and the provided `wksp`, `path`, and `seed` arguments.
    - Returns the result of the [`fd_wksp_restore_tpool`](<fd_wksp_io.c.md#fd_wksp_restore_tpool>) function call.
- **Output**: Returns an integer indicating success (`FD_WKSP_SUCCESS`) or an error code (`FD_WKSP_ERR_*`) if the restoration fails.
- **Functions Called**:
    - [`fd_wksp_restore_tpool`](<fd_wksp_io.c.md#fd_wksp_restore_tpool>)


# Function Declarations (Public API)

---
### fd\_wksp\_part\_max\_est<!-- {{#callable_declaration:fd_wksp_part_max_est}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L179>)

Estimates the maximum number of partitions for a workspace.
- **Description**: Use this function to estimate the maximum number of partitions that can fit within a given workspace footprint, assuming typical allocation sizes. This is useful for planning how to pack a workspace efficiently. The function returns zero if the footprint is too small, if the typical size is zero, or if the typical size is too large to allow for any metadata. Ensure that the footprint and typical size are positive and reasonable to avoid a zero return value.
- **Inputs**:
    - `footprint`: The total size in bytes of the workspace. Must be a positive multiple of `FD_WKSP_ALIGN`. If zero or not aligned, the function returns zero.
    - `sz_typical`: The typical size of allocations in the workspace. Must be a positive value. If zero or larger than the space available for metadata, the function returns zero.
- **Output**: Returns the estimated maximum number of partitions as a positive unsigned long on success, or zero on failure.
- **See Also**: [`fd_wksp_part_max_est`](<fd_wksp_admin.c.md#fd_wksp_part_max_est>)  (Implementation)


---
### fd\_wksp\_data\_max\_est<!-- {{#callable_declaration:fd_wksp_data_max_est}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L209>)

Estimates the maximum data region size for a workspace.
- **Description**: Use this function to calculate an estimated maximum size for the data region of a workspace given a specific footprint and number of partitions. This is useful for determining how to efficiently pack a workspace within a known footprint. The function returns 0 if the footprint is too small, if the number of partitions is zero, or if the number of partitions exceeds implementation limits or results in a non-zero sized data region.
- **Inputs**:
    - `footprint`: The total size in bytes of the workspace. Must be a positive value and aligned to `FD_WKSP_ALIGN`. If zero, the function returns 0.
    - `part_max`: The maximum number of partitions in the workspace. Must be a positive value and not exceed `FD_WKSP_PRIVATE_PINFO_IDX_NULL` or the maximum allowed by the implementation. If zero or too large, the function returns 0.
- **Output**: Returns the estimated maximum size of the data region in bytes, or 0 if the input conditions are not met.
- **See Also**: [`fd_wksp_data_max_est`](<fd_wksp_admin.c.md#fd_wksp_data_max_est>)  (Implementation)


---
### fd\_wksp\_align<!-- {{#callable_declaration:fd_wksp_align}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L222>)

Returns the required alignment for a workspace.
- **Description**: Use this function to obtain the alignment requirement for a workspace, which is necessary when setting up memory regions for shared memory communication. This function is useful when you need to ensure that memory allocations meet the alignment constraints of the workspace system. It is a constant function and does not require any parameters or preconditions.
- **Inputs**: None
- **Output**: Returns an unsigned long integer representing the alignment requirement, which is a positive power of two.
- **See Also**: [`fd_wksp_align`](<fd_wksp_admin.c.md#fd_wksp_align>)  (Implementation)


---
### fd\_wksp\_footprint<!-- {{#callable_declaration:fd_wksp_footprint}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L225>)

Calculates the memory footprint for a workspace.
- **Description**: Use this function to determine the required memory footprint for a workspace that can support a specified number of partitions and a data region of a given size. This function is useful when planning memory allocation for workspaces. It returns zero if the input parameters are invalid, such as when the number of partitions or data size is zero, or when the required footprint exceeds the maximum allowable size.
- **Inputs**:
    - `part_max`: The maximum number of partitions the workspace should support. Must be greater than zero and not exceed `FD_WKSP_PRIVATE_PINFO_IDX_NULL`. If invalid, the function returns zero.
    - `data_max`: The size of the data region in bytes. Must be greater than zero. If invalid, the function returns zero.
- **Output**: Returns the calculated memory footprint in bytes, or zero if the inputs are invalid or the footprint calculation overflows.
- **See Also**: [`fd_wksp_footprint`](<fd_wksp_admin.c.md#fd_wksp_footprint>)  (Implementation)


---
### fd\_wksp\_new<!-- {{#callable_declaration:fd_wksp_new}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L238>)

Formats a memory region as a workspace.
- **Description**: Use this function to initialize a memory region as a workspace with a specified name, seed, and capacity for partitions and data. The memory region must be properly aligned and non-null. The function returns a pointer to the initialized workspace on success or NULL on failure, logging details of any issues encountered. This function does not join the caller to the workspace.
- **Inputs**:
    - `shmem`: Pointer to the memory region to format as a workspace. Must not be null and must be aligned according to workspace requirements.
    - `name`: String representing the name of the workspace. Must be a valid shared memory name.
    - `seed`: Unsigned integer used to seed the heap priorities within the workspace.
    - `part_max`: Maximum number of partitions the workspace can support. Must be a positive value.
    - `data_max`: Maximum size of the data region in bytes. Must be a positive value.
- **Output**: Returns a pointer to the formatted workspace on success, or NULL on failure.
- **See Also**: [`fd_wksp_new`](<fd_wksp_admin.c.md#fd_wksp_new>)  (Implementation)


---
### fd\_wksp\_join<!-- {{#callable_declaration:fd_wksp_join}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L254>)

Joins a workspace mapped into the caller's address space.
- **Description**: Use this function to obtain a local handle to a workspace that has been mapped into the caller's address space. This function checks if the provided pointer is valid, properly aligned, and corresponds to a valid workspace by verifying a magic number. If any of these checks fail, it logs a warning and returns NULL. This function is essential for accessing and manipulating the memory within the workspace. Ensure that the workspace is correctly mapped before calling this function.
- **Inputs**:
    - `shwksp`: A pointer to the location where the workspace is mapped in the caller's address space. Must not be null, must be aligned to `FD_WKSP_ALIGN`, and must point to a valid workspace with the correct magic number. If these conditions are not met, the function logs a warning and returns NULL.
- **Output**: Returns a pointer to `fd_wksp_t` on success, or NULL if the input is invalid or the workspace is not properly aligned or initialized.
- **See Also**: [`fd_wksp_join`](<fd_wksp_admin.c.md#fd_wksp_join>)  (Implementation)


---
### fd\_wksp\_leave<!-- {{#callable_declaration:fd_wksp_leave}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L262>)

Leaves a workspace and returns its shared memory pointer.
- **Description**: Use this function to leave a workspace when it is no longer needed by the caller. This function should be called after all operations on the workspace are complete. The workspace will continue to exist, but it is not safe to access it in the caller's address space after this function returns. Ensure that the workspace pointer is not null before calling this function.
- **Inputs**:
    - `wksp`: A pointer to the workspace to leave. Must not be null. If null, the function logs a warning and returns null.
- **Output**: Returns the shared memory pointer of the workspace on success, or null if the input is invalid.
- **See Also**: [`fd_wksp_leave`](<fd_wksp_admin.c.md#fd_wksp_leave>)  (Implementation)


---
### fd\_wksp\_delete<!-- {{#callable_declaration:fd_wksp_delete}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L270>)

Unformats a memory region used as a workspace.
- **Description**: Use this function to delete a workspace that is no longer needed. It returns the shared memory pointer on success and NULL on failure. Ensure that no other processes are joined to the workspace when calling this function, as it assumes exclusive access to the workspace for deletion. This function logs details of any issues encountered during the operation.
- **Inputs**:
    - `shwksp`: A pointer to the shared memory region representing the workspace. Must not be NULL, must be properly aligned, and must have a valid magic number. If these conditions are not met, the function returns NULL and logs a warning.
- **Output**: Returns the shared memory pointer on success, or NULL on failure.
- **See Also**: [`fd_wksp_delete`](<fd_wksp_admin.c.md#fd_wksp_delete>)  (Implementation)


---
### fd\_wksp\_name<!-- {{#callable_declaration:fd_wksp_name}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L287>)

Returns the name of the workspace.
- **Description**: Use this function to obtain the name of a workspace. It is important to ensure that the workspace is a valid and current join before calling this function. The returned string is constant and its lifetime is tied to the duration of the join. This function is useful when you need to identify or log the workspace being used.
- **Inputs**:
    - `wksp`: A pointer to a constant `fd_wksp_t` structure representing the workspace. It must not be null and must point to a valid, currently joined workspace.
- **Output**: A constant character pointer to the workspace's name, which is a valid region name.
- **See Also**: [`fd_wksp_name`](<fd_wksp_admin.c.md#fd_wksp_name>)  (Implementation)


---
### fd\_wksp\_seed<!-- {{#callable_declaration:fd_wksp_seed}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L288>)

Returns the seed value of a workspace.
- **Description**: Use this function to obtain the seed value that was used during the creation or most recent rebuild of a workspace. This function requires that the workspace is currently joined locally. It is useful for applications that need to verify or utilize the seed value for operations related to the workspace.
- **Inputs**:
    - `wksp`: A pointer to a constant `fd_wksp_t` structure representing the workspace. It must not be null and must be a valid local join of the workspace.
- **Output**: The function returns an unsigned integer representing the seed value of the workspace.
- **See Also**: [`fd_wksp_seed`](<fd_wksp_admin.c.md#fd_wksp_seed>)  (Implementation)


---
### fd\_wksp\_part\_max<!-- {{#callable_declaration:fd_wksp_part_max}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L289>)

Returns the maximum number of partitions for a workspace.
- **Description**: Use this function to obtain the maximum number of partitions that a workspace can support. This is useful for understanding the capacity of a workspace in terms of partitioning. Ensure that the workspace is a valid and current local join before calling this function.
- **Inputs**:
    - `wksp`: A pointer to a constant `fd_wksp_t` structure representing the workspace. It must not be null and should be a valid current local join.
- **Output**: The function returns an unsigned long integer representing the maximum number of partitions the workspace can support.
- **See Also**: [`fd_wksp_part_max`](<fd_wksp_admin.c.md#fd_wksp_part_max>)  (Implementation)


---
### fd\_wksp\_data\_max<!-- {{#callable_declaration:fd_wksp_data_max}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L290>)

Returns the maximum data region size of a workspace.
- **Description**: Use this function to obtain the maximum size of the data region for a given workspace. This is useful for understanding the capacity of the workspace's data storage. Ensure that the workspace is a valid and current local join before calling this function.
- **Inputs**:
    - `wksp`: A pointer to a constant `fd_wksp_t` structure representing the workspace. It must not be null and should be a valid current local join.
- **Output**: The function returns an unsigned long integer representing the maximum size of the data region in the workspace.
- **See Also**: [`fd_wksp_data_max`](<fd_wksp_admin.c.md#fd_wksp_data_max>)  (Implementation)


---
### fd\_wksp\_owner<!-- {{#callable_declaration:fd_wksp_owner}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L299>)

Returns the current owner of a workspace operation.
- **Description**: Use this function to determine the thread group ID that is currently performing an operation on a workspace. It is useful for monitoring or debugging purposes to check which thread group is interacting with the workspace. The function assumes that the workspace is a current local join. If no operation is in progress, it returns `ULONG_MAX`. If the workspace is in the process of being constructed, it returns 0.
- **Inputs**:
    - `wksp`: A pointer to a `fd_wksp_t` structure representing the workspace. It must not be null and should be a valid current local join.
- **Output**: Returns the ID of the thread group currently operating on the workspace, 0 if the workspace is being constructed, or `ULONG_MAX` if no operation is in progress.
- **See Also**: [`fd_wksp_owner`](<fd_wksp_admin.c.md#fd_wksp_owner>)  (Implementation)


---
### fd\_wksp\_strerror<!-- {{#callable_declaration:fd_wksp_strerror}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L307>)

Converts an error code to a human-readable string.
- **Description**: Use this function to obtain a human-readable description of an error code returned by other workspace-related functions. This is useful for logging or displaying error messages to users. The function will always return a non-null string, even if the error code is not recognized.
- **Inputs**:
    - `err`: An integer representing the error code. Valid values include `FD_WKSP_SUCCESS`, `FD_WKSP_ERR_INVAL`, `FD_WKSP_ERR_FAIL`, and `FD_WKSP_ERR_CORRUPT`. If the error code is not recognized, the function returns "unknown".
- **Output**: A constant character pointer to a string describing the error. The string is valid for the lifetime of the program.
- **See Also**: [`fd_wksp_strerror`](<fd_wksp_admin.c.md#fd_wksp_strerror>)  (Implementation)


---
### fd\_wksp\_verify<!-- {{#callable_declaration:fd_wksp_verify}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L322>)

Verifies the integrity of a workspace.
- **Description**: Use this function to check the integrity of a workspace when you suspect that another operation may have left it in an inconsistent state. It performs extensive checks on the workspace's metadata and structure to ensure there are no issues. This function should be called when there are no concurrent operations on the workspace to avoid race conditions. It is primarily used for debugging and testing purposes.
- **Inputs**:
    - `wksp`: A pointer to a `fd_wksp_t` structure representing the workspace to verify. This must be a valid, currently joined workspace. If the pointer is null or the workspace is invalid, the function will return an error code.
- **Output**: Returns `FD_WKSP_SUCCESS` (0) if the workspace is verified successfully, or `FD_WKSP_ERR_CORRUPT` (-3) if corruption is detected.
- **See Also**: [`fd_wksp_verify`](<fd_wksp_admin.c.md#fd_wksp_verify>)  (Implementation)


---
### fd\_wksp\_rebuild<!-- {{#callable_declaration:fd_wksp_rebuild}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L349>)

Rebuilds a workspace to resolve inconsistencies.
- **Description**: Use this function to rebuild a workspace when it is in an inconsistent state, typically due to a previous operation being interrupted. This function attempts to restore the workspace to a consistent state without affecting completed allocations. It should be called when no other operations are being performed on the workspace. If the workspace metadata is corrupt or overlapping allocations are detected, the rebuild will fail and return an error code.
- **Inputs**:
    - `wksp`: A pointer to the workspace to rebuild. Must not be null. If null, the function logs a warning and returns an error code indicating corruption.
    - `seed`: An unsigned integer used to seed the rebuilding process. This can be used to introduce variability in the rebuild.
- **Output**: Returns 0 on successful rebuild or a negative error code if the workspace is corrupt and cannot be rebuilt.
- **See Also**: [`fd_wksp_rebuild`](<fd_wksp_admin.c.md#fd_wksp_rebuild>)  (Implementation)


---
### fd\_wksp\_laddr<!-- {{#callable_declaration:fd_wksp_laddr}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L360>)

Maps a global address to a local address in the workspace.
- **Description**: Use this function to convert a global address within a workspace to a local address in the caller's address space. This is useful when you need to access memory allocated in a shared workspace from your local context. The function requires that the workspace is currently joined locally. If the workspace pointer is null or the global address is invalid or zero, the function returns null and logs a warning. This function is typically used in environments where multiple processes or threads share memory, and it is important to ensure that the global address is within the valid range of the workspace.
- **Inputs**:
    - `wksp`: A pointer to a `fd_wksp_t` structure representing the workspace. Must not be null, and the workspace must be a current local join.
    - `gaddr`: An unsigned long representing the global address to map. Must be within the valid range of the workspace's global address space. A value of zero is treated as invalid and results in a null return.
- **Output**: Returns a pointer to the local address corresponding to the given global address, or null if the input is invalid.
- **See Also**: [`fd_wksp_laddr`](<fd_wksp_user.c.md#fd_wksp_laddr>)  (Implementation)


---
### fd\_wksp\_gaddr<!-- {{#callable_declaration:fd_wksp_gaddr}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L369>)

Maps a local address to a global address in a workspace.
- **Description**: Use this function to convert a local address within a workspace to its corresponding global address, which is consistent across all joiners of the workspace. This function should be called only when the workspace is a current local join. If the workspace pointer is null or the local address is invalid, the function returns 0UL and logs a warning. This function is useful for applications that need to share memory addresses across different processes or threads.
- **Inputs**:
    - `wksp`: A pointer to a `fd_wksp_t` structure representing the workspace. Must not be null. If null, the function returns 0UL and logs a warning.
    - `laddr`: A pointer to a local address within the workspace. If null, the function returns 0UL. The address must be valid within the workspace's address range.
- **Output**: Returns the global address corresponding to the local address if valid, or 0UL if the input is invalid.
- **See Also**: [`fd_wksp_gaddr`](<fd_wksp_user.c.md#fd_wksp_gaddr>)  (Implementation)


---
### fd\_wksp\_alloc\_at\_least<!-- {{#callable_declaration:fd_wksp_alloc_at_least}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L489>)

Allocates at least a specified number of bytes from a workspace with alignment and tagging.
- **Description**: Use this function to allocate memory from a workspace with a specified alignment and size, tagging the allocation for identification. It is important to ensure that the workspace is properly initialized and joined before calling this function. The function will return a global address aligned as requested, and the actual allocated range will be provided through the `lo` and `hi` pointers. If the allocation fails, the function returns 0 and sets `lo` and `hi` to 0. This function is suitable for allocations where the exact size of the allocated region is not critical, as it guarantees at least the requested size.
- **Inputs**:
    - `wksp`: A pointer to a valid and joined `fd_wksp_t` workspace. Must not be null.
    - `align`: The alignment for the allocation, which must be a non-negative power of two or 0. If 0, the default alignment `FD_WKSP_ALIGN_DEFAULT` is used.
    - `sz`: The minimum size in bytes to allocate. Must be greater than 0. If 0, the function returns 0 silently.
    - `tag`: A positive value used to tag the allocation for identification. Must not be 0.
    - `lo`: A pointer to a `ulong` where the lower bound of the allocated range will be stored. Must not be null.
    - `hi`: A pointer to a `ulong` where the upper bound of the allocated range will be stored. Must not be null.
- **Output**: Returns the aligned global address of the allocated memory on success, or 0 on failure. The allocated range is stored in `lo` and `hi`.
- **See Also**: [`fd_wksp_alloc_at_least`](<fd_wksp_user.c.md#fd_wksp_alloc_at_least>)  (Implementation)


---
### fd\_wksp\_free<!-- {{#callable_declaration:fd_wksp_free}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L513>)

Frees a workspace allocation.
- **Description**: Use this function to release a previously allocated memory block in a workspace. It is important to ensure that the global address provided is valid and points to a current allocation within the workspace. If the global address is zero, the function will return immediately without any action. Similarly, if the workspace pointer is null, the function will log a warning and return without freeing any memory. This function can be called by any join to free an allocation, regardless of which join originally allocated it.
- **Inputs**:
    - `wksp`: A pointer to the workspace from which the allocation should be freed. Must not be null; otherwise, a warning is logged and the function returns without action.
    - `gaddr`: A global address pointing to any byte within the allocation to be freed. If zero, the function returns immediately without action. Must be a valid address within the workspace's current allocations.
- **Output**: None
- **See Also**: [`fd_wksp_free`](<fd_wksp_user.c.md#fd_wksp_free>)  (Implementation)


---
### fd\_wksp\_tag<!-- {{#callable_declaration:fd_wksp_tag}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L525>)

Returns the tag associated with a workspace allocation.
- **Description**: Use this function to retrieve the tag of a memory allocation within a workspace. It is useful for identifying or categorizing allocations. The function requires a valid workspace handle and a global address pointing to any byte within the allocation. If the workspace is null or the global address is invalid, the function returns 0, indicating no valid allocation was found. This function is silent and does not log errors, making it suitable for use in analysis tools.
- **Inputs**:
    - `wksp`: A pointer to a `fd_wksp_t` workspace. Must not be null. If null, the function returns 0.
    - `gaddr`: A global address within the workspace. Must point to a valid allocation. If invalid or 0, the function returns 0.
- **Output**: Returns the tag associated with the allocation if successful, or 0 if the workspace is null or the global address is invalid.
- **See Also**: [`fd_wksp_tag`](<fd_wksp_user.c.md#fd_wksp_tag>)  (Implementation)


---
### fd\_wksp\_tag\_query<!-- {{#callable_declaration:fd_wksp_tag_query}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L547>)

Queries the workspace for partitions matching specified tags.
- **Description**: Use this function to find and retrieve information about workspace partitions that have tags matching any of the specified tags. It is useful for identifying and analyzing specific allocations within a workspace. Ensure that the workspace pointer is valid and that the tag array is not null. If no tags are provided, the function returns immediately with zero. The function can return detailed information about the matching partitions if the `info` parameter is provided and `info_max` is greater than zero.
- **Inputs**:
    - `wksp`: A pointer to a valid `fd_wksp_t` workspace. Must not be null. If null, the function logs a warning and returns zero.
    - `tag`: A pointer to an array of tags to query. Must not be null. If null, the function logs a warning and returns zero.
    - `tag_cnt`: The number of tags in the `tag` array. If zero, the function returns immediately with zero.
    - `info`: A pointer to an array of `fd_wksp_tag_query_info_t` structures to store information about matching partitions. Can be null if `info_max` is zero.
    - `info_max`: The maximum number of entries that can be stored in the `info` array. If greater than zero, `info` must not be null. If `info` is null and `info_max` is greater than zero, the function logs a warning and returns zero.
- **Output**: Returns the number of matching partitions found. If `info` is provided and `info_max` is greater than zero, it populates the `info` array with details of up to `info_max` matching partitions.
- **See Also**: [`fd_wksp_tag_query`](<fd_wksp_user.c.md#fd_wksp_tag_query>)  (Implementation)


---
### fd\_wksp\_tag\_free<!-- {{#callable_declaration:fd_wksp_tag_free}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L560>)

Frees all allocations in a workspace that match specified tags.
- **Description**: Use this function to free all memory allocations in a workspace that have tags matching any of those specified in the provided array. This function is useful for batch deallocation based on tags, which can help in managing memory efficiently. It is important to ensure that the workspace pointer is valid and that the tag array is not null. If the tag count is zero, the function will return immediately without performing any operations. The function logs warnings if the workspace pointer or tag array is null, or if any corruption is detected in the workspace.
- **Inputs**:
    - `wksp`: A pointer to the workspace from which allocations will be freed. Must not be null. If null, the function logs a warning and returns without performing any operations.
    - `tag`: A pointer to an array of tags. Each tag in the array is used to identify allocations to be freed. Must not be null. If null, the function logs a warning and returns without performing any operations.
    - `tag_cnt`: The number of tags in the array. Must be greater than zero. If zero, the function returns immediately without performing any operations.
- **Output**: None
- **See Also**: [`fd_wksp_tag_free`](<fd_wksp_user.c.md#fd_wksp_tag_free>)  (Implementation)


---
### fd\_wksp\_memset<!-- {{#callable_declaration:fd_wksp_memset}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L572>)

Sets all bytes in a workspace allocation to a specified character.
- **Description**: Use this function to fill an entire workspace allocation with a specific character. This is useful for initializing or resetting memory regions within a workspace. The function requires a valid workspace pointer and a global address pointing to any byte within the allocation. If the workspace pointer is null or the global address is invalid, the function logs a warning and returns without making changes. This operation is atomic with respect to other operations on the workspace.
- **Inputs**:
    - `wksp`: A pointer to a valid `fd_wksp_t` workspace. Must not be null. If null, the function logs a warning and returns without performing any operation.
    - `gaddr`: A global address within the workspace that points to any byte in the allocation to be set. Must be a valid address within the workspace's current allocations. If invalid, the function logs a warning and returns without performing any operation.
    - `c`: The character to set each byte of the allocation to. Any integer value is valid, as it will be cast to an unsigned char.
- **Output**: None
- **See Also**: [`fd_wksp_memset`](<fd_wksp_user.c.md#fd_wksp_memset>)  (Implementation)


---
### fd\_wksp\_reset<!-- {{#callable_declaration:fd_wksp_reset}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L580>)

Frees all allocations in the workspace.
- **Description**: Use this function to clear all memory allocations in a workspace, effectively resetting it. This operation is useful when you want to start fresh with a workspace without deleting and recreating it. Ensure that no allocations are in use before calling this function, as it will invalidate all existing allocations. The function logs a warning if the workspace is corrupt or if the workspace pointer is null.
- **Inputs**:
    - `wksp`: A pointer to the workspace to reset. Must not be null. If null, the function logs a warning and returns without making changes.
    - `seed`: An unsigned integer used to seed the workspace's internal structures. This can be any valid unsigned integer.
- **Output**: None
- **See Also**: [`fd_wksp_reset`](<fd_wksp_user.c.md#fd_wksp_reset>)  (Implementation)


---
### fd\_wksp\_new\_named<!-- {{#callable_declaration:fd_wksp_new_named}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L653>)

Creates a shared memory region and formats it as a workspace.
- **Description**: Use this function to create a shared memory region with a specified name and format it as a workspace for inter-thread and inter-process communication. Ensure that the `name` is valid, `page_sz` is supported, and `sub_cnt` is non-zero. The function requires valid pointers for `sub_page_cnt` and `sub_cpu_idx`. It returns a success code if the operation is successful, or an error code if it fails due to invalid inputs or shared memory limitations. This function is typically used during application startup to set up shared memory resources.
- **Inputs**:
    - `name`: A string representing the name of the shared memory region. It must be a valid shared memory name and not null.
    - `page_sz`: The size of each page in the shared memory region. It must be a supported page size.
    - `sub_cnt`: The number of subregions to create. It must be greater than zero.
    - `sub_page_cnt`: A pointer to an array specifying the number of pages for each subregion. It must not be null.
    - `sub_cpu_idx`: A pointer to an array specifying the CPU index for each subregion. It must not be null.
    - `mode`: The mode for creating the shared memory region, typically specifying access permissions.
    - `seed`: An arbitrary value used to seed the heap priorities within the workspace.
    - `part_max`: The maximum number of partitions in the workspace. If zero, it will be estimated based on the footprint.
- **Output**: Returns 0 on success, or a negative error code on failure, indicating invalid inputs or shared memory limitations.
- **See Also**: [`fd_wksp_new_named`](<fd_wksp_helper.c.md#fd_wksp_new_named>)  (Implementation)


---
### fd\_wksp\_delete\_named<!-- {{#callable_declaration:fd_wksp_delete_named}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L668>)

Deletes a named workspace.
- **Description**: Use this function to delete a workspace that was previously created with `fd_wksp_new_named`. Ensure that there are no active joins or attachments to the workspace before calling this function. This function returns a success or error code, and logs details of any issues encountered during the operation.
- **Inputs**:
    - `name`: A pointer to a constant character string representing the name of the workspace to delete. The string must be a valid workspace name. The function will return an error if the name is invalid or if the workspace cannot be deleted.
- **Output**: Returns `FD_WKSP_SUCCESS` (0) on successful deletion, or an `FD_WKSP_ERR_*` (negative) code on failure.
- **See Also**: [`fd_wksp_delete_named`](<fd_wksp_helper.c.md#fd_wksp_delete_named>)  (Implementation)


---
### fd\_wksp\_new\_anon<!-- {{#callable_declaration:fd_wksp_new_anon}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L693>)

Creates a local anonymous workspace for shared memory operations.
- **Description**: Use this function to create a workspace that is local to the calling thread group, enabling shared memory operations with specific NUMA and TLB properties. This function is useful when you need a workspace that behaves like a shared one but is confined to the local thread group. Ensure that no current shared memory joins exist for the given name, as this will shadow any preexisting shared memory region with the same name. The function returns a pointer to the joined workspace on success or NULL on failure, logging details of any issues encountered.
- **Inputs**:
    - `name`: A constant character pointer representing the name of the workspace. It must be a valid shared memory name and must not be null or empty.
    - `page_sz`: An unsigned long representing the size of each page. It must be a supported page size.
    - `sub_cnt`: An unsigned long indicating the number of subregions. It must be greater than zero.
    - `sub_page_cnt`: A constant pointer to an array of unsigned longs, each representing the number of pages in a subregion. It must not be null.
    - `sub_cpu_idx`: A constant pointer to an array of unsigned longs, each representing the CPU index for a subregion. It must not be null.
    - `seed`: An unsigned integer used to seed the heap priorities. It can be any valid unsigned integer.
    - `opt_part_max`: An unsigned long representing the optional maximum number of partitions. If zero, the function estimates a suitable value.
- **Output**: Returns a pointer to the joined workspace on success, or NULL on failure.
- **See Also**: [`fd_wksp_new_anon`](<fd_wksp_helper.c.md#fd_wksp_new_anon>)  (Implementation)


---
### fd\_wksp\_delete\_anon<!-- {{#callable_declaration:fd_wksp_delete_anon}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L707>)

Deletes an anonymous workspace.
- **Description**: Use this function to delete a workspace that was created anonymously using `fd_wksp_new_anon`. Ensure that no other joins or attachments to the workspace exist before calling this function. This function does not return a value and cannot fail from the caller's perspective, but it logs details if any issues are detected during the deletion process.
- **Inputs**:
    - `wksp`: A pointer to the `fd_wksp_t` workspace to delete. Must not be null and should not have any active joins or attachments.
- **Output**: None
- **See Also**: [`fd_wksp_delete_anon`](<fd_wksp_helper.c.md#fd_wksp_delete_anon>)  (Implementation)


---
### fd\_wksp\_attach<!-- {{#callable_declaration:fd_wksp_attach}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L732>)

Attaches to a shared memory workspace by name.
- **Description**: Use this function to attach to a shared memory workspace identified by a given name. This is useful for accessing shared memory regions that have been previously created and formatted as workspaces. The function returns a handle to the workspace on success, which can be used for further operations. If the attachment fails, it returns NULL and logs the details of the failure. Ensure that the workspace name is valid and that the shared memory region is accessible before calling this function.
- **Inputs**:
    - `name`: A constant character pointer representing the name of the shared memory region to attach to. The name must be a valid identifier for an existing shared memory workspace. The caller retains ownership of the string, and it must not be null.
- **Output**: Returns a pointer to an `fd_wksp_t` structure on success, or NULL on failure.
- **See Also**: [`fd_wksp_attach`](<fd_wksp_helper.c.md#fd_wksp_attach>)  (Implementation)


---
### fd\_wksp\_detach<!-- {{#callable_declaration:fd_wksp_detach}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L739>)

Detaches from a workspace.
- **Description**: Use this function to detach from a workspace when it is no longer needed. This function should be called after all operations on the workspace are complete. It is important to ensure that the workspace pointer is not null before calling this function, as passing a null pointer will result in a warning and a failure return code. This function logs details of the detachment process and returns a non-zero value if the detachment fails.
- **Inputs**:
    - `wksp`: A pointer to the workspace to detach from. Must not be null. If null, the function logs a warning and returns 1.
- **Output**: Returns 0 on successful detachment, or 1 if the workspace pointer is null.
- **See Also**: [`fd_wksp_detach`](<fd_wksp_helper.c.md#fd_wksp_detach>)  (Implementation)


---
### fd\_wksp\_containing<!-- {{#callable_declaration:fd_wksp_containing}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L749>)

Finds the workspace containing a given local address.
- **Description**: Use this function to determine which workspace a specific local address belongs to. This is useful when you need to verify if a pointer is part of a workspace that has been joined locally. The function returns a pointer to the workspace if the address is valid and belongs to a joined workspace, or NULL if the address is invalid or not part of any joined workspace. This function is silent and does not log any errors, making it suitable for pointer validation checks.
- **Inputs**:
    - `laddr`: A constant pointer to a local address. It must not be NULL. If the address is invalid or not part of a joined workspace, the function returns NULL.
- **Output**: Returns a pointer to the `fd_wksp_t` workspace containing the local address, or NULL if the address is not part of any joined workspace.
- **See Also**: [`fd_wksp_containing`](<fd_wksp_helper.c.md#fd_wksp_containing>)  (Implementation)


---
### fd\_wksp\_alloc\_laddr<!-- {{#callable_declaration:fd_wksp_alloc_laddr}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L759>)

Allocates memory from a workspace and returns a local address.
- **Description**: Use this function to allocate memory from a workspace with a specified alignment and size, and receive a pointer to the allocated memory in the local address space. This function is useful when you need to work with memory directly in the local address space rather than using global addresses. Ensure that the workspace is properly initialized and joined before calling this function. If the allocation fails, the function returns NULL.
- **Inputs**:
    - `wksp`: A pointer to a `fd_wksp_t` workspace from which memory is to be allocated. Must be a valid, joined workspace.
    - `align`: The alignment for the allocation. Must be a non-negative power of two or 0, which defaults to `FD_WKSP_ALIGN_DEFAULT`.
    - `sz`: The size of the memory to allocate in bytes. Must be greater than zero.
    - `tag`: A positive value used to tag the allocation for identification purposes. Can be used for debugging or analytics.
- **Output**: Returns a pointer to the allocated memory in the local address space, or NULL if the allocation fails.
- **See Also**: [`fd_wksp_alloc_laddr`](<fd_wksp_helper.c.md#fd_wksp_alloc_laddr>)  (Implementation)


---
### fd\_wksp\_free\_laddr<!-- {{#callable_declaration:fd_wksp_free_laddr}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L775>)

Frees a workspace allocation using a local address.
- **Description**: Use this function to free a memory allocation in a workspace when you have a local address pointing to it. This function is useful when you do not have the global address of the allocation. It checks if the local address is valid and belongs to a workspace before attempting to free it. If the local address is null or does not belong to a workspace, the function logs a warning and returns without performing any action. Ensure that the workspace is properly initialized and the local address is valid before calling this function.
- **Inputs**:
    - `laddr`: A pointer to the local address of the memory allocation to free. Must not be null and should point to a valid allocation within a workspace. If null or invalid, the function logs a warning and returns without freeing any memory.
- **Output**: None
- **See Also**: [`fd_wksp_free_laddr`](<fd_wksp_helper.c.md#fd_wksp_free_laddr>)  (Implementation)


---
### fd\_wksp\_cstr<!-- {{#callable_declaration:fd_wksp_cstr}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L789>)

Formats a workspace global address into a string.
- **Description**: Use this function to convert a workspace global address into a string format that includes the workspace name and the address. This is useful for logging or debugging purposes where a human-readable representation of the address is needed. Ensure that the workspace pointer and the string buffer are not null before calling this function. The function will return null if the workspace pointer, the string buffer, or the global address is invalid.
- **Inputs**:
    - `wksp`: A pointer to a constant `fd_wksp_t` structure representing the workspace. Must not be null.
    - `gaddr`: An unsigned long representing the global address within the workspace. Must be within the valid range of the workspace's address space.
    - `cstr`: A pointer to a character array where the formatted string will be stored. Must not be null and should have space for at least `FD_WKSP_CSTR_MAX` bytes.
- **Output**: Returns a pointer to the `cstr` on success, or null if any input is invalid.
- **See Also**: [`fd_wksp_cstr`](<fd_wksp_helper.c.md#fd_wksp_cstr>)  (Implementation)


---
### fd\_wksp\_cstr\_laddr<!-- {{#callable_declaration:fd_wksp_cstr_laddr}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L805>)

Converts a local address to a workspace global address string.
- **Description**: Use this function to convert a local address within a workspace to a string representation of its global address. This is useful for logging or debugging purposes where a human-readable format of the address is needed. The function requires a valid local address and a non-null character buffer to store the result. If the local address does not belong to a workspace or the character buffer is null, the function returns null and logs a warning.
- **Inputs**:
    - `laddr`: A pointer to a local address within a workspace. It must be a valid address from a workspace; otherwise, the function returns null.
    - `cstr`: A character buffer where the resulting string will be stored. It must not be null and should have enough space to hold the resulting string. If null, the function returns null.
- **Output**: Returns the character buffer containing the global address string on success, or null if the input is invalid.
- **See Also**: [`fd_wksp_cstr_laddr`](<fd_wksp_helper.c.md#fd_wksp_cstr_laddr>)  (Implementation)


---
### fd\_wksp\_cstr\_alloc<!-- {{#callable_declaration:fd_wksp_cstr_alloc}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L830>)

Allocates memory from a workspace and returns a formatted string.
- **Description**: Use this function to allocate a specified amount of memory from a workspace identified by its name, with a given alignment and tag. The function returns a formatted string containing the workspace name and the global address of the allocated memory. Ensure that the `cstr` parameter is not null and has enough space to store the result. If the allocation fails, the function returns null and logs the error details. This function is suitable for use when you need a quick allocation and a formatted string for further operations.
- **Inputs**:
    - `name`: A constant character pointer representing the name of the workspace. It must be a valid workspace name that the function can attach to.
    - `align`: An unsigned long specifying the alignment of the memory allocation. It should be a power of two or zero, where zero indicates the default alignment.
    - `sz`: An unsigned long representing the size of the memory to allocate. If zero, the function will return null without logging.
    - `tag`: An unsigned long used to tag the allocation. It is an application-specific identifier.
    - `cstr`: A character pointer where the function will store the formatted string. It must not be null and should have space for up to `FD_WKSP_CSTR_MAX` bytes.
- **Output**: Returns the `cstr` pointer on successful allocation and formatting, or null if the allocation fails.
- **See Also**: [`fd_wksp_cstr_alloc`](<fd_wksp_helper.c.md#fd_wksp_cstr_alloc>)  (Implementation)


---
### fd\_wksp\_cstr\_free<!-- {{#callable_declaration:fd_wksp_cstr_free}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L850>)

Frees a workspace allocation specified by a string.
- **Description**: Use this function to free a workspace allocation that is specified by a string in the format '[name]:[gaddr]'. This function is useful when you have a string representation of a workspace allocation and need to release the associated resources. It is important to ensure that the string is correctly formatted and that the workspace is not in use by other operations when calling this function. The function will log details if any issues are encountered during the operation.
- **Inputs**:
    - `cstr`: A constant character pointer representing the workspace allocation in the format '[name]:[gaddr]'. The string must be correctly formatted and must not be null. If the string is invalid or the workspace cannot be attached, the function will log details and return without freeing any resources.
- **Output**: None
- **See Also**: [`fd_wksp_cstr_free`](<fd_wksp_helper.c.md#fd_wksp_cstr_free>)  (Implementation)


---
### fd\_wksp\_cstr\_tag<!-- {{#callable_declaration:fd_wksp_cstr_tag}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L866>)

Retrieves the tag of a workspace allocation specified by a string.
- **Description**: Use this function to obtain the tag associated with a workspace allocation identified by a string in the format '[name]:[gaddr]'. This function is useful when you need to query the tag of an allocation without directly interacting with the workspace. It is important to ensure that the input string is correctly formatted and that the workspace is accessible. The function will return 0 if the allocation cannot be found or if any error occurs during the process.
- **Inputs**:
    - `cstr`: A constant character pointer representing the string '[name]:[gaddr]'. The string must be correctly formatted and non-null. If the format is invalid or the workspace cannot be accessed, the function will return 0.
- **Output**: Returns the tag as an unsigned long integer if successful, or 0 if the allocation is not found or an error occurs.
- **See Also**: [`fd_wksp_cstr_tag`](<fd_wksp_helper.c.md#fd_wksp_cstr_tag>)  (Implementation)


---
### fd\_wksp\_cstr\_memset<!-- {{#callable_declaration:fd_wksp_cstr_memset}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L882>)

Sets all bytes in a workspace allocation to a specified character.
- **Description**: Use this function to fill a workspace allocation with a specific character. The function requires a valid cstr that specifies the workspace and global address. It is important to ensure that the cstr is correctly formatted and points to a valid allocation. The function will log details if any issues occur during the operation. This function is useful for initializing or resetting memory regions within a workspace.
- **Inputs**:
    - `cstr`: A constant character string specifying the workspace and global address in the format '[name]:[gaddr]'. It must not be null and should be correctly formatted to point to a valid allocation.
    - `c`: An integer representing the character to set in the workspace allocation. It is used to fill the entire allocation.
- **Output**: None
- **See Also**: [`fd_wksp_cstr_memset`](<fd_wksp_helper.c.md#fd_wksp_cstr_memset>)  (Implementation)


---
### fd\_wksp\_map<!-- {{#callable_declaration:fd_wksp_map}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L904>)

Maps a workspace global address to a local address.
- **Description**: Use this function to convert a workspace global address, specified in a string format, into a local address in the caller's address space. This is useful for accessing shared memory regions by name and address. The function expects a valid string containing the workspace name and global address. If the input is invalid or the mapping fails, the function returns NULL. Ensure that the workspace is properly initialized and accessible before calling this function.
- **Inputs**:
    - `cstr`: A string containing the workspace name and global address in the format '[name]:[gaddr]'. The string must not be null and should represent a valid workspace and address. If the string is invalid or the workspace cannot be accessed, the function returns NULL.
- **Output**: Returns a pointer to the local address corresponding to the specified global address on success, or NULL if the mapping fails.
- **See Also**: [`fd_wksp_map`](<fd_wksp_helper.c.md#fd_wksp_map>)  (Implementation)


---
### fd\_wksp\_unmap<!-- {{#callable_declaration:fd_wksp_unmap}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L919>)

Unmaps a pointer previously mapped by `fd_wksp_map`.
- **Description**: Use this function to unmap a pointer that was previously mapped using `fd_wksp_map`. This function is necessary to release resources associated with the mapped pointer. It is important to ensure that the pointer provided is currently mapped by `fd_wksp_map`, as undefined behavior will occur if it is not. The function handles a `NULL` pointer silently, assuming it is not an error case. This function is efficient and should be used when the mapped workspace is no longer needed in the caller's address space.
- **Inputs**:
    - `laddr`: A pointer to the local address space that was previously mapped using `fd_wksp_map`. The pointer must not be `NULL` unless it was intentionally mapped as such. The caller retains ownership of the pointer, and the function will log a warning if the pointer does not appear to be from `fd_wksp_map`.
- **Output**: None
- **See Also**: [`fd_wksp_unmap`](<fd_wksp_helper.c.md#fd_wksp_unmap>)  (Implementation)


---
### fd\_wksp\_pod\_attach<!-- {{#callable_declaration:fd_wksp_pod_attach}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L934>)

Attaches to a workspace pod using a global address.
- **Description**: Use this function to attach to a workspace pod by providing a global address string. This function maps the pod into the local address space and joins it. It is important to ensure that the global address is valid and non-null before calling this function. If the function encounters any issues, it will terminate the calling thread group with an error message. This function should be paired with a corresponding detach function when the pod is no longer needed.
- **Inputs**:
    - `gaddr`: A non-null string representing the global address of the workspace pod. The caller must ensure the address is valid. If null, the function logs an error and terminates the thread group.
- **Output**: Returns a pointer to the attached pod in the local address space. The pointer is non-null if the operation is successful.
- **See Also**: [`fd_wksp_pod_attach`](<fd_wksp_helper.c.md#fd_wksp_pod_attach>)  (Implementation)


---
### fd\_wksp\_pod\_detach<!-- {{#callable_declaration:fd_wksp_pod_detach}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L946>)

Detaches a POD from a workspace.
- **Description**: Use this function to safely detach a POD from a workspace when it is no longer needed. This function must be called after a successful attachment of a POD using `fd_wksp_pod_attach`. It ensures that the resources associated with the POD are properly released. If the `pod` parameter is null or if the detachment process fails, the function will log an error and terminate the calling thread group.
- **Inputs**:
    - `pod`: A pointer to the POD to detach. Must not be null. If null, the function logs an error and terminates the calling thread group.
- **Output**: None
- **See Also**: [`fd_wksp_pod_detach`](<fd_wksp_helper.c.md#fd_wksp_pod_detach>)  (Implementation)


---
### fd\_wksp\_pod\_map<!-- {{#callable_declaration:fd_wksp_pod_map}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L959>)

Maps a POD path to a local address space.
- **Description**: Use this function to map a path within a POD to the local address space. This function requires valid non-null pointers for both the POD and the path. It will terminate the calling thread group with an error message if the POD or path is null, or if the path is not found within the POD. This function is useful for accessing specific data within a POD by its path.
- **Inputs**:
    - `pod`: A pointer to the POD data structure. Must not be null. The function will terminate with an error if this is null.
    - `path`: A string representing the path within the POD to map. Must not be null. The function will terminate with an error if this is null or if the path is not found in the POD.
- **Output**: Returns a pointer to the mapped object in the local address space. Terminates with an error if mapping fails.
- **See Also**: [`fd_wksp_pod_map`](<fd_wksp_helper.c.md#fd_wksp_pod_map>)  (Implementation)


---
### fd\_wksp\_pod\_unmap<!-- {{#callable_declaration:fd_wksp_pod_unmap}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L972>)

Unmaps a previously mapped workspace object.
- **Description**: Use this function to unmap a workspace object that was previously mapped using `fd_wksp_pod_map`. This function must be called to release the mapping when the object is no longer needed. The input must not be null, and if it is, the function will log an error and terminate the thread group. Ensure that the object was mapped using `fd_wksp_pod_map` before calling this function.
- **Inputs**:
    - `obj`: A pointer to the workspace object to unmap. Must not be null. If null, the function logs an error and terminates the thread group.
- **Output**: None
- **See Also**: [`fd_wksp_pod_unmap`](<fd_wksp_helper.c.md#fd_wksp_pod_unmap>)  (Implementation)


---
### fd\_wksp\_checkpt\_tpool<!-- {{#callable_declaration:fd_wksp_checkpt_tpool}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L996>)

Writes the workspace's state to a file using specified threads.
- **Description**: Use this function to save the current state of a workspace to a file, utilizing a range of threads for parallel processing. Ensure that the workspace and file path are valid before calling. The function requires a valid thread pool and a range of threads specified by `t0` and `t1`. The file will be created at the specified path with the given UNIX permissions. The checkpoint style can be specified, or the default will be used if set to 0. An optional user information string can be provided, which will be truncated if it exceeds 16383 characters. The function returns an error code if any input is invalid or if an unsupported style is specified.
- **Inputs**:
    - `tpool`: A pointer to a thread pool (`fd_tpool_t`). Must not be null.
    - `t0`: The starting index of the thread range. Must be less than `t1`.
    - `t1`: The ending index of the thread range. Must be greater than `t0`.
    - `wksp`: A pointer to the workspace (`fd_wksp_t`). Must not be null.
    - `path`: A constant character pointer to the file path. Must not be null.
    - `mode`: An unsigned long representing UNIX file permissions. Must be a valid mode.
    - `style`: An integer specifying the checkpoint style. Use 0 for default style.
    - `uinfo`: A constant character pointer to user information. Can be null, which is treated as an empty string.
- **Output**: Returns 0 on success or a negative error code on failure, indicating the type of error.
- **See Also**: [`fd_wksp_checkpt_tpool`](<fd_wksp_io.c.md#fd_wksp_checkpt_tpool>)  (Implementation)


---
### fd\_wksp\_restore\_tpool<!-- {{#callable_declaration:fd_wksp_restore_tpool}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L1043>)

Restores a workspace from a checkpoint file using a thread pool.
- **Description**: Use this function to restore a workspace from a checkpoint file, utilizing a specified range of threads from a thread pool. Ensure that the workspace (`wksp`) and the path to the checkpoint file (`path`) are not null before calling this function. The function will attempt to restore the workspace using the checkpoint data, and it will use the provided seed for the restoration process. If the checkpoint file is invalid or the workspace is incompatible, the function will log a warning and return an error code. The function assumes that the caller is the first thread in the specified range and that the other threads in the range are available for use.
- **Inputs**:
    - `tpool`: A pointer to a thread pool (`fd_tpool_t`). The caller must ensure that this is a valid thread pool and that the specified threads are available.
    - `t0`: The starting index of the thread range in the thread pool. Must be less than `t1`.
    - `t1`: The ending index of the thread range in the thread pool. Must be greater than `t0`.
    - `wksp`: A pointer to the workspace (`fd_wksp_t`) to restore. Must not be null.
    - `path`: A constant character pointer to the path of the checkpoint file. Must not be null.
    - `new_seed`: An unsigned integer used as the seed for the restoration process. The value is arbitrary and can be any valid unsigned integer.
- **Output**: Returns 0 on success or a negative error code on failure. Error codes include `FD_WKSP_ERR_INVAL` for invalid inputs and `FD_WKSP_ERR_CORRUPT` for corrupted checkpoint data.
- **See Also**: [`fd_wksp_restore_tpool`](<fd_wksp_io.c.md#fd_wksp_restore_tpool>)  (Implementation)


---
### fd\_wksp\_printf<!-- {{#callable_declaration:fd_wksp_printf}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L1097>)

Prints information about a workspace checkpoint to a file descriptor.
- **Description**: Use this function to output details about a workspace checkpoint located at the specified path to the given file descriptor. The verbosity level controls the amount of detail printed, ranging from no output for negative values to detailed metadata and data dumps for higher values. This function is useful for debugging or logging workspace states. Ensure that the file descriptor is valid and open for writing, and that the path points to a valid workspace checkpoint.
- **Inputs**:
    - `fd`: A valid file descriptor open for writing. The function will write output to this descriptor.
    - `path`: A non-null string representing the path to the workspace checkpoint. Must point to a valid checkpoint file.
    - `verbose`: An integer specifying the verbosity level of the output. Negative values result in no output, while higher values increase the detail level of the printed information.
- **Output**: Returns an integer indicating the total number of characters written to the file descriptor, or a negative error code if an error occurs.
- **See Also**: [`fd_wksp_printf`](<fd_wksp_io.c.md#fd_wksp_printf>)  (Implementation)


---
### fd\_wksp\_mprotect<!-- {{#callable_declaration:fd_wksp_mprotect}} -->
[View Source →](<../../../../../src/util/wksp/fd_wksp.h#L1106>)

Sets the memory protection of a workspace to read-only or read-write.
- **Description**: Use this function to change the memory protection settings of a workspace. It can set the workspace memory to be read-only or read-write based on the provided flag. This function must be called with a valid workspace pointer that is properly aligned and initialized. If the workspace pointer is null, not aligned, or has an incorrect magic number, the function will log a warning and return without making changes. This function is useful for controlling access to shared memory regions, preventing unintended writes when set to read-only.
- **Inputs**:
    - `wksp`: A pointer to a `fd_wksp_t` structure representing the workspace. Must not be null, must be aligned to `FD_WKSP_ALIGN`, and must have a valid magic number (`FD_WKSP_MAGIC`).
    - `flag`: An integer indicating the desired memory protection. A non-zero value sets the workspace to read-only, while zero sets it to read-write.
- **Output**: None
- **See Also**: [`fd_wksp_mprotect`](<fd_wksp_admin.c.md#fd_wksp_mprotect>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)