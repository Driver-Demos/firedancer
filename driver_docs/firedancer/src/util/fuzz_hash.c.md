<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Fuzz testing for hash functions with initialization and input processing.

# Purpose
The code is a fuzz testing module designed to work with LLVM's libFuzzer. It includes two main functions: [`LLVMFuzzerInitialize`](<#llvmfuzzerinitialize>) and [`LLVMFuzzerTestOneInput`](<#llvmfuzzertestoneinput>). The [`LLVMFuzzerInitialize`](<#llvmfuzzerinitialize>) function sets up the environment for fuzz testing by disabling backtraces, initializing the application with `fd_boot`, registering `fd_halt` to be called at program exit, and setting the core log level. This function is called once at the start of the fuzzing process to prepare the environment.

The [`LLVMFuzzerTestOneInput`](<#llvmfuzzertestoneinput>) function is the core of the fuzz testing process. It takes a pointer to input data and its size, then performs a series of operations to test the robustness of the hashing functions. It extracts a seed from the input data, allocates memory for a copy of the remaining data, and computes two hashes using `fd_hash_memcpy` and `fd_hash`. If the hashes do not match, it logs a critical error. This function is repeatedly called by the fuzzer with different inputs to identify potential issues in the hashing logic.
# Imports and Dependencies

---
- `fd_util.h`
- `stdlib.h`
- `stdint.h`


# Functions

---
### LLVMFuzzerInitialize<!-- {{#callable:LLVMFuzzerInitialize}} -->
[View Source →](<../../../../src/util/fuzz_hash.c#L6>)

Initializes the fuzzer environment by setting environment variables, bootstrapping the system, registering an exit function, and setting the log level.
- **Inputs**:
    - `argc`: A pointer to the argument count, typically passed to the program's main function.
    - `argv`: A pointer to the argument vector, typically passed to the program's main function.
- **Logic and Control Flow**:
    - Set the environment variable `FD_LOG_BACKTRACE` to `0` to disable backtracing in logs.
    - Call [`fd_boot`](<fd_util.c.md#fd_boot>) with `argc` and `argv` to perform system bootstrapping.
    - Register the `fd_halt` function to be called at program exit using `atexit`.
    - Set the core log level to `1` using `fd_log_level_core_set`.
    - Return `0` to indicate successful initialization.
- **Output**: Returns `0` to indicate successful initialization.
- **Functions Called**:
    - [`fd_boot`](<fd_util.c.md#fd_boot>)


---
### LLVMFuzzerTestOneInput<!-- {{#callable:LLVMFuzzerTestOneInput}} -->
[View Source →](<../../../../src/util/fuzz_hash.c#L16>)

Processes input data by extracting a seed, copying content, and verifying hash consistency.
- **Inputs**:
    - `data`: A pointer to the input data of type `uchar const *`.
    - `size`: The size of the input data in bytes, of type `ulong`.
- **Logic and Control Flow**:
    - Calculate `metadata_size` as the size of `ulong`.
    - Check if `size` is less than `metadata_size`; if true, return 0.
    - Load a `ulong` seed from `data` using `FD_LOAD`.
    - Decrease `size` by `metadata_size`.
    - Set `content` to point to the data after the seed.
    - Allocate memory for `dst` with the remaining `size`; if allocation fails, return 0.
    - Compute `hash0` by copying `content` to `dst` using `fd_hash_memcpy`.
    - Compute `hash1` directly from `content` using `fd_hash`.
    - Log a critical error if `hash0` does not equal `hash1`.
    - Free the allocated memory for `dst`.
- **Output**: Always returns 0.



---
Made with ❤️ by [Driver](https://www.driver.ai/)