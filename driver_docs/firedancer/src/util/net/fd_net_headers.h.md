<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines structures and functions to construct and deconstruct Ethernet, IPv4, and UDP network headers.

# Purpose
The code defines a C header file that provides functionality for constructing and deconstructing network packet headers, specifically Ethernet, IPv4, and UDP headers. It includes the necessary header files `fd_udp.h` and `fd_eth.h` to work with UDP and Ethernet headers, respectively. The primary data structure is a union `fd_ip4_udp_hdrs`, which encapsulates the Ethernet, IPv4, and UDP headers in a single 42-byte array. This union allows for easy manipulation and access to the individual headers within a network packet.

The file provides two main functions: `fd_ip4_udp_hdr_init` and [`fd_ip4_udp_hdr_strip`](<#fd_ip4_udp_hdr_strip>). The `fd_ip4_udp_hdr_init` function initializes a header template with specified source IP and port, setting the IPv4 and UDP header checksums to zero. It prepares the headers for a packet with a given payload size. The [`fd_ip4_udp_hdr_strip`](<#fd_ip4_udp_hdr_strip>) function deconstructs a network packet, extracting pointers to the Ethernet, IPv4, and UDP headers, as well as the payload and its size. It performs basic integrity checks on the packet to ensure the headers and payload are valid. The file defines public APIs for constructing and deconstructing network headers, making it suitable for use in network communication applications.
# Imports and Dependencies

---
- `fd_udp.h`
- `fd_eth.h`


# Data Structures

---
### fd\_ip4\_udp\_hdrs
- **Type**: ``union``
- **Members**:
    - ``uc``: An array of 42 unsigned characters representing the raw data of the headers.
    - ``eth``: An array of one `fd_eth_hdr_t` structure representing the Ethernet header.
    - ``ip4``: An array of one `fd_ip4_hdr_t` structure representing the IPv4 header.
    - ``udp``: An array of one `fd_udp_hdr_t` structure representing the UDP header.
- **Description**: Facilitates the construction of Ethernet, IPv4, and UDP network headers in a single data structure, assuming the IPv4 header has no options (IHL=5).


---
### fd\_ip4\_udp\_hdrs\_t
- **Type**: `union`
- **Members**:
    - ``uc``: An array of 42 unsigned characters representing the raw bytes of the headers.
    - ``eth``: An array of one `fd_eth_hdr_t` structure representing the Ethernet header.
    - ``ip4``: An array of one `fd_ip4_hdr_t` structure representing the IPv4 header.
    - ``udp``: An array of one `fd_udp_hdr_t` structure representing the UDP header.
- **Description**: Facilitates the construction of network headers for Ethernet, IPv4, and UDP protocols, assuming no options in the IPv4 header (IHL=5).


---
### fd\_ip4\_port\_t
- **Type**: ``union``
- **Members**:
    - ``addr``: 32-bit unsigned integer representing an IPv4 address in network byte order.
    - ``port``: 16-bit unsigned integer representing a port number in network byte order.
    - ``l``: 48-bit field combining the `addr` and `port` into a single value.
- **Description**: The `fd_ip4_port_t` union is a data structure that encapsulates an IPv4 address and a port number, both in network byte order. It provides a convenient way to handle these two related pieces of information together, either as separate fields or as a combined 48-bit value. This structure is useful in network programming where both an IP address and a port are needed to identify a network endpoint.


# Functions

---
### fd\_ip4\_udp\_hdr\_strip<!-- {{#callable:fd_ip4_udp_hdr_strip}} -->
[View Source →](<../../../../../src/util/net/fd_net_headers.h#L79>)

Extracts and validates Ethernet, IPv4, and UDP headers from a network packet, providing pointers to these headers and the payload if specified.
- **Inputs**:
    - ``data``: A pointer to the start of the network packet data.
    - ``data_sz``: The size of the network packet data in bytes.
    - ``opt_payload``: A pointer to store the address of the payload, if not NULL.
    - ``opt_payload_sz``: A pointer to store the size of the payload, if not NULL.
    - ``opt_eth``: A pointer to store the address of the Ethernet header, if not NULL.
    - ``opt_ip4``: A pointer to store the address of the IPv4 header, if not NULL.
    - ``opt_udp``: A pointer to store the address of the UDP header, if not NULL.
- **Logic and Control Flow**:
    - Cast `data` to an Ethernet header pointer `eth`.
    - Calculate the IPv4 header pointer `ip4` by adding the size of the Ethernet header to `eth`.
    - Calculate the UDP header pointer `udp` by adding the length of the IPv4 header to `ip4`.
    - Check if the combined size of headers exceeds `data_sz`; return 0 if true.
    - Retrieve the UDP header length `udp_sz` and check if it is less than the minimum UDP header size; return 0 if true.
    - Calculate the payload size `payload_sz_` and pointer `payload_`.
    - Check if the payload exceeds the total packet size; return 0 if true.
    - Store the addresses of the headers and payload in the provided pointers if they are not NULL.
    - Return 1 to indicate success.
- **Output**: Returns 1 on successful extraction and validation of headers and payload, or 0 on failure.



---
Made with ❤️ by [Driver](https://www.driver.ai/)