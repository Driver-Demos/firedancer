<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines data structures and constants for handling PCAP Next Generation (pcapng) file blocks.

# Purpose
The code is a C header file that defines data structures and constants for handling PCAP Next Generation (PCAPNG) file format blocks. PCAPNG is a format used for storing network packet capture data. The file provides definitions for various block types such as Section Header Block (`fd_pcapng_shb_t`), Interface Description Block (`fd_pcapng_idb_t`), Simple Packet Block (`fd_pcapng_spb_t`), Enhanced Packet Block (`fd_pcapng_epb_t`), and Decryption Secrets Block (`fd_pcapng_dsb_t`). Each block type has a corresponding structure that includes fields for block type, block size, and other relevant data specific to the block type.

The header file also defines constants for block type identifiers, byte order magic numbers, and option codes used within the PCAPNG format. It includes a structure for handling options (`fd_pcapng_option_t`) that can be associated with blocks, allowing for additional metadata to be stored. The file is intended to be included in other C source files that need to read, write, or manipulate PCAPNG data, providing a foundation for working with this file format in a structured manner. The file does not define any public APIs or external interfaces directly but provides the necessary components to build such functionality.
# Imports and Dependencies

---
- `fd_pcapng.h`


# Data Structures

---
### fd\_pcapng\_option
- **Type**: ``struct``
- **Members**:
    - `type`: A `ushort` that specifies the type of the option, using predefined constants like `FD_PCAPNG_*_OPT_*`.
    - `sz`: A `ushort` that indicates the byte size of the option data pointed to by `value`.
    - `value`: A pointer to the first byte of the option data, which is variable-length.
- **Description**: Defines a structure for handling options in the PCAP Next Generation (pcapng) file format, where each option has a type, a size, and a pointer to its data.


---
### fd\_pcapng\_option\_t
- **Type**: ``struct``
- **Members**:
    - `type`: A `ushort` that specifies the type of the option.
    - `sz`: A `ushort` that indicates the byte size of the option data at `value`.
    - `value`: A pointer to the first byte of the option data.
- **Description**: Represents a variable-length option value in a PCAP Next Generation (pcapng) file format, where the type and size of the option data are specified, and the data itself is pointed to by `value`. The option type determines the kind of data stored, and strings are UTF-8 encoded without a null terminator.


---
### fd\_pcapng\_block\_hdr
- **Type**: ``struct``
- **Members**:
    - `block_type`: Specifies the type of the block.
    - `block_sz`: Indicates the size of the block.
- **Description**: Defines a packed structure for a block header in the PCAP Next Generation (pcapng) file format, containing fields for the block type and block size.


---
### fd\_pcapng\_block\_hdr\_t
- **Type**: ``struct``
- **Members**:
    - `block_type`: Specifies the type of the block.
    - `block_sz`: Indicates the size of the block in bytes.
- **Description**: Defines a common block header used in the PCAP Next Generation (pcapng) file format, which includes fields for the block type and block size.


---
### fd\_pcapng\_shb
- **Type**: ``struct``
- **Members**:
    - `block_type`: Specifies the block type, set to `FD_PCAPNG_BLOCK_TYPE_SHB`.
    - `block_sz`: Indicates the size of the block, equal to `sizeof(fd_pcapng_shb_t)`.
    - `byte_order_magic`: Contains the byte order magic number, set to `FD_PCAPNG_BYTE_ORDER_MAGIC`.
    - `version_major`: Specifies the major version number, set to 1.
    - `version_minor`: Specifies the minor version number, set to 0.
    - `section_sz`: Represents the section size, set to `ULONG_MAX` indicating it is undefined.
- **Description**: Defines the Section Header Block (SHB) structure used in the PCAP Next Generation (pcapng) file format, which includes metadata such as block type, size, byte order, version, and section size.


---
### fd\_pcapng\_shb\_t
- **Type**: ``struct``
- **Members**:
    - `block_type`: Holds the block type identifier, which is equal to `FD_PCAPNG_BLOCK_TYPE_SHB`.
    - `block_sz`: Specifies the size of the block, which is equal to the size of `fd_pcapng_shb_t`.
    - `byte_order_magic`: Contains the byte order magic number, which is equal to `FD_PCAPNG_BYTE_ORDER_MAGIC`.
    - `version_major`: Indicates the major version number, which is 1.
    - `version_minor`: Indicates the minor version number, which is 0.
    - `section_sz`: Represents the section size, which is set to `ULONG_MAX` (undefined).
- **Description**: Defines the Section Header Block (SHB) in the PCAP Next Generation (pcapng) file format, which includes metadata such as block type, size, byte order, version, and section size.


---
### fd\_pcapng\_idb
- **Type**: ``struct``
- **Members**:
    - `block_type`: Specifies the block type, set to `FD_PCAPNG_BLOCK_TYPE_IDB`.
    - `block_sz`: Indicates the size of the block, set to the size of `fd_pcapng_idb_t`.
    - `link_type`: Defines the link type, set to `FD_PCAPNG_LINKTYPE_ETHERNET`.
    - `_pad_0a`: A padding field set to 0.
    - `snap_len`: Specifies the packet payload size limit, where 0 indicates unlimited.
- **Description**: Defines an Interface Description Block (IDB) in the PCAP Next Generation (pcapng) file format, which describes the characteristics of a network interface used in packet capture.


---
### fd\_pcapng\_idb\_t
- **Type**: ``struct``
- **Members**:
    - `block_type`: Holds the block type identifier, which is equal to `FD_PCAPNG_BLOCK_TYPE_IDB`.
    - `block_sz`: Specifies the size of the block, which is equal to the size of `fd_pcapng_idb_t`.
    - `link_type`: Indicates the link type, which is equal to `FD_PCAPNG_LINKTYPE_ETHERNET`.
    - `_pad_0a`: A padding field set to 0 to align the structure.
    - `snap_len`: Defines the packet payload size limit, where 0 indicates unlimited size.
- **Description**: Defines the structure for an Interface Description Block (IDB) in the PCAP Next Generation (pcapng) file format, which describes the properties of a network interface used in capturing packets.


---
### fd\_pcapng\_spb
- **Type**: ``struct``
- **Members**:
    - `block_type`: Identifies the block type as a Simple Packet Block (SPB).
    - `block_sz`: Specifies the size of the block, which must be greater than or equal to the size of the `fd_pcapng_spb_t` structure.
    - `orig_len`: Indicates the original size of the packet in bytes.
- **Description**: Represents a Simple Packet Block (SPB) in the PCAP Next Generation (pcapng) file format, which is used to store packet data with a fixed block type, block size, and original packet length.


---
### fd\_pcapng\_spb\_t
- **Type**: ``struct``
- **Members**:
    - `block_type`: Identifies the block as a Simple Packet Block with a specific type code.
    - `block_sz`: Specifies the size of the block, which must be greater than or equal to the size of the `fd_pcapng_spb_t` structure.
    - `orig_len`: Indicates the original size of the packet in bytes.
- **Description**: Defines a Simple Packet Block (SPB) used in the PCAP Next Generation (pcapng) file format to store packet data. The structure includes fields for the block type, block size, and the original length of the packet, which helps in reconstructing the packet data from the capture file.


---
### fd\_pcapng\_epb
- **Type**: ``struct``
- **Members**:
    - `block_type`: Specifies the block type, which is equal to `FD_PCAPNG_BLOCK_TYPE_EPB`.
    - `block_sz`: Indicates the size of the block, which is greater than or equal to the size of `fd_pcapng_epb_t`.
    - `if_idx`: Holds the index of the related Interface Description Block (IDB) in the section.
    - `ts_hi`: Contains the high 32 bits of the timestamp.
    - `ts_lo`: Contains the low 32 bits of the timestamp.
    - `cap_len`: Represents the size of the captured packet in bytes.
    - `orig_len`: Represents the original size of the packet in bytes.
- **Description**: The `fd_pcapng_epb` structure defines an Enhanced Packet Block (EPB) used in the PCAP Next Generation (pcapng) file format. It stores metadata about a captured network packet, including its block type, size, interface index, timestamp, and both captured and original packet sizes. This structure is packed to ensure no padding is added between its fields, which is crucial for accurate data representation in network packet capture files.


---
### fd\_pcapng\_epb\_t
- **Type**: ``struct``
- **Members**:
    - `block_type`: Identifies the block type as an Enhanced Packet Block with a specific constant value.
    - `block_sz`: Specifies the size of the block, which must be greater than or equal to the size of the `fd_pcapng_epb_t` structure.
    - `if_idx`: Indicates the index of the related Interface Description Block (IDB) within the section.
    - `ts_hi`: Contains the high 32 bits of the timestamp for the packet.
    - `ts_lo`: Contains the low 32 bits of the timestamp for the packet.
    - `cap_len`: Represents the size of the captured packet in bytes.
    - `orig_len`: Represents the original size of the packet in bytes.
- **Description**: Defines the structure for an Enhanced Packet Block (EPB) in the PCAP Next Generation (pcapng) file format, which includes metadata such as block type, block size, interface index, timestamp, and packet size information.


---
### fd\_pcapng\_dsb
- **Type**: ``struct``
- **Members**:
    - `block_type`: Identifies the block type and must equal `FD_PCAPNG_BLOCK_TYPE_DSB`.
    - `block_sz`: Specifies the size of the block, which must be greater than or equal to the size of `fd_pcapng_dsb_t`.
    - `secret_type`: Indicates the type of secret, which must match `FD_PCAPNG_SECRET_TYPE_*`.
    - `secret_sz`: Represents the size in bytes of the secrets data.
- **Description**: Defines a Decryption Secrets Block (DSB) used in the PCAP Next Generation (pcapng) file format to store decryption secrets. The structure includes fields for the block type, block size, secret type, and the size of the secret data, facilitating the storage and identification of decryption information within a pcapng file.


---
### fd\_pcapng\_dsb\_t
- **Type**: ``struct``
- **Members**:
    - `block_type`: Identifies the block type as a Decryption Secrets Block with a specific constant value.
    - `block_sz`: Specifies the size of the block, which must be greater than or equal to the size of the `fd_pcapng_dsb_t` structure.
    - `secret_type`: Indicates the type of secret, such as TLS, using a predefined constant.
    - `secret_sz`: Defines the size in bytes of the secret data contained within the block.
- **Description**: Defines a Decryption Secrets Block (DSB) used in the PCAP Next Generation (pcapng) file format to store decryption secrets, such as TLS keys, with specific fields for block type, size, secret type, and secret size.


---
### fd\_pcapng\_idb\_desc
- **Type**: ``struct``
- **Members**:
    - ``link_type``: Specifies the type of link layer for the interface.
    - ``opts``: Holds options related to the interface description.
- **Description**: Describes an interface in a PCAP Next Generation (pcapng) file, including the link type and associated options.


---
### fd\_pcapng\_idb\_desc\_t
- **Type**: ``struct``
- **Members**:
    - ``link_type``: Stores the type of link layer for the interface.
    - ``opts``: Holds the options related to the interface description.
- **Description**: Defines a structure for describing an Interface Description Block (IDB) in the PCAP Next Generation (pcapng) file format, which includes the link type and associated options for network interface configuration.


---
### fd\_pcapng\_iter
- **Type**: ``struct``
- **Members**:
    - `stream`: A pointer to a data stream.
    - `error`: An integer to store error codes.
    - `iface`: An array of `fd_pcapng_idb_desc_t` structures with a fixed size of 16.
    - `iface_cnt`: An unsigned integer to count the number of interfaces.
- **Description**: Aligns to `FD_PCAPNG_ITER_ALIGN` and manages a data stream with error handling and interface descriptions.



---
Made with ❤️ by [Driver](https://www.driver.ai/)