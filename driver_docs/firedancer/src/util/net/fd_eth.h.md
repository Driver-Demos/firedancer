<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Header file for Ethernet protocol utilities, including structures, constants, and functions for handling Ethernet headers, MAC addresses, and VLAN tags.

# Purpose
The code is a C header file that provides definitions and functions related to Ethernet protocol handling. It includes structures and macros for working with Ethernet headers and VLAN tags, as well as utility functions for manipulating and interpreting MAC addresses. The file defines constants for Ethernet header types, such as `FD_ETH_HDR_TYPE_IP`, `FD_ETH_HDR_TYPE_ARP`, and `FD_ETH_HDR_TYPE_VLAN`, which indicate the type of packet encapsulated. It also provides macros for calculating payload size limits, such as `FD_ETH_PAYLOAD_MAX` and `FD_ETH_PAYLOAD_MIN`.

The file includes structures like `fd_eth_hdr` and [`fd_vlan_tag`](<#fd_vlan_tag>) to represent Ethernet headers and VLAN tags, respectively. It provides functions to check MAC address properties, such as [`fd_eth_mac_is_mcast`](<#fd_eth_mac_is_mcast>) for multicast addresses and [`fd_eth_mac_is_bcast`](<#fd_eth_mac_is_bcast>) for broadcast addresses. Additionally, the file includes functions for computing and appending Frame Check Sequence (FCS) values, such as [`fd_eth_fcs`](<#fd_eth_fcs>) and [`fd_eth_fcs_append`](<#fd_eth_fcs_append>). The header file is intended to be included in other C source files to facilitate Ethernet packet processing and manipulation, providing a set of utilities for applications that need to handle Ethernet frames and related network protocols.
# Imports and Dependencies

---
- `../bits/fd_bits.h`


# Data Structures

---
### fd\_eth\_hdr
- **Type**: ``struct``
- **Members**:
    - ``dst``: An array of 6 unsigned characters representing the destination MAC address.
    - ``src``: An array of 6 unsigned characters representing the source MAC address.
    - ``net_type``: An unsigned short indicating the type of packet encapsulated, in network byte order.
- **Description**: Defines an Ethernet header structure with fields for destination and source MAC addresses, each 6 bytes long, and a 2-byte field for the network type, which specifies the type of packet encapsulated within the Ethernet frame.


---
### fd\_eth\_hdr\_t
- **Type**: ``struct``
- **Members**:
    - ``dst``: Destination MAC address as an array of 6 unsigned characters.
    - ``src``: Source MAC address as an array of 6 unsigned characters.
    - ``net_type``: Type of packet encapsulated, stored in network byte order as an unsigned short.
- **Description**: Defines an Ethernet header structure with fields for destination and source MAC addresses, and a network type field indicating the type of packet encapsulated. This structure is used to represent the header of an Ethernet frame, which is a fundamental component in network communication over Ethernet.


---
### fd\_vlan\_tag
- **Type**: ``struct``
- **Members**:
    - ``net_vid``: A 16-bit unsigned short representing the VLAN ID with priority and CFI, in network byte order.
    - ``net_type``: A 16-bit unsigned short representing the ethertype, in network byte order.
- **Description**: Represents a VLAN tag in an Ethernet frame, containing fields for VLAN ID, priority, CFI, and ethertype, all stored in network byte order.


---
### fd\_vlan\_tag\_t
- **Type**: ``struct``
- **Members**:
    - ``net_vid``: A 16-bit field that includes a 3-bit priority, a 1-bit CFI, and a 12-bit VLAN tag, stored in network byte order.
    - ``net_type``: A 16-bit field representing the ethertype, stored in network byte order.
- **Description**: Defines a VLAN tag structure used in Ethernet networking, which includes fields for VLAN identification and packet type information, both stored in network byte order for compatibility with network protocols.


# Functions

---
### fd\_eth\_mac\_is\_mcast<!-- {{#callable:fd_eth_mac_is_mcast}} -->
[View Source →](<../../../../../src/util/net/fd_eth.h#L163>)

Determines if a given MAC address is a multicast address.
- **Inputs**:
    - `mac`: A pointer to an array of unsigned characters representing a MAC address.
- **Logic and Control Flow**:
    - Retrieve the first byte of the MAC address using `mac[0]`.
    - Perform a bitwise AND operation between the first byte and `1U`.
    - Convert the result to a boolean value using the double negation `!!` operator.
    - Return the boolean result indicating if the MAC address is multicast.
- **Output**: Returns an integer value of 1 if the MAC address is multicast, otherwise returns 0.


---
### fd\_eth\_mac\_is\_local<!-- {{#callable:fd_eth_mac_is_local}} -->
[View Source →](<../../../../../src/util/net/fd_eth.h#L173>)

Determines if a given MAC address is locally administered.
- **Inputs**:
    - `mac`: A pointer to an array of unsigned characters representing a MAC address.
- **Logic and Control Flow**:
    - Retrieve the first byte of the MAC address using `mac[0]`.
    - Perform a bitwise AND operation between the first byte and `2U` to isolate the locally administered bit.
    - Convert the result to a boolean value using the double negation `!!` to return either 0 or 1.
- **Output**: Returns 1 if the MAC address is locally administered, otherwise returns 0.


---
### fd\_eth\_mac\_is\_bcast<!-- {{#callable:fd_eth_mac_is_bcast}} -->
[View Source →](<../../../../../src/util/net/fd_eth.h#L175>)

Checks if a given MAC address is an Ethernet broadcast address.
- **Inputs**:
    - `mac`: A pointer to a 6-byte MAC address to check.
- **Logic and Control Flow**:
    - Loads the first 4 bytes of the MAC address using `fd_ulong_load_4_fast` and the last 2 bytes using `fd_ulong_load_2_fast`.
    - Adds the loaded values together.
    - Compares the sum to the constant value `0xffffffffUL + 0xffffUL`.
    - Returns 1 if the sum matches the constant, indicating a broadcast address, otherwise returns 0.
- **Output**: Returns an integer: 1 if the MAC address is a broadcast address, 0 otherwise.


---
### fd\_eth\_mac\_is\_ip4\_mcast<!-- {{#callable:fd_eth_mac_is_ip4_mcast}} -->
[View Source →](<../../../../../src/util/net/fd_eth.h#L180>)

Checks if a given MAC address is an IPv4 multicast address.
- **Inputs**:
    - `mac`: A pointer to a 6-byte MAC address.
- **Logic and Control Flow**:
    - Loads the first 3 bytes of the MAC address using `fd_ulong_load_3_fast` function.
    - Compares the loaded value to the constant `0x5e0001UL`.
    - Returns 1 if the comparison is true, indicating the MAC address is an IPv4 multicast address.
    - Returns 0 if the comparison is false, indicating the MAC address is not an IPv4 multicast address.
- **Output**: Returns an integer: 1 if the MAC address is an IPv4 multicast address, 0 otherwise.


---
### fd\_eth\_fcs<!-- {{#callable:fd_eth_fcs}} -->
[View Source →](<../../../../../src/util/net/fd_eth.h#L223>)

Computes the Frame Check Sequence (FCS) for an Ethernet frame using a given buffer and size.
- **Inputs**:
    - ``buf``: A pointer to the buffer containing the Ethernet frame data.
    - ``sz``: The size of the buffer in bytes.
- **Logic and Control Flow**:
    - Calls the [`fd_eth_fcs_append`](<fd_eth.c.md#fd_eth_fcs_append>) function with the initial FCS seed `FD_ETH_FCS_APPEND_SEED`, the buffer `buf`, and the size `sz`.
- **Output**: Returns the computed FCS as an unsigned integer.
- **Functions Called**:
    - [`fd_eth_fcs_append`](<fd_eth.c.md#fd_eth_fcs_append>)


---
### fd\_eth\_mac\_ip4\_mcast<!-- {{#callable:fd_eth_mac_ip4_mcast}} -->
[View Source →](<../../../../../src/util/net/fd_eth.h#L237>)

Populates a 6-byte MAC address for a given IPv4 multicast address.
- **Inputs**:
    - `mac`: A pointer to a 6-byte memory region where the MAC address will be stored.
    - `ip4_addr_mcast`: A 32-bit unsigned integer representing the IPv4 multicast address.
- **Logic and Control Flow**:
    - Calculate the first 4 bytes of the MAC address by combining the constant `0x5e0001U` with the upper 7 bits of the `ip4_addr_mcast` shifted into the correct position.
    - Store the calculated 4-byte value into the memory location pointed to by `mac`.
    - Calculate the last 2 bytes of the MAC address by extracting the appropriate bits from `ip4_addr_mcast`.
    - Store the calculated 2-byte value into the memory location starting at `mac+4`.
    - Return the pointer `mac`.
- **Output**: Returns the pointer to the populated MAC address.


---
### fd\_eth\_mac\_bcast<!-- {{#callable:fd_eth_mac_bcast}} -->
[View Source →](<../../../../../src/util/net/fd_eth.h#L249>)

Populates a 6-byte memory region with the Ethernet MAC address for LAN broadcast.
- **Inputs**:
    - `mac`: A pointer to a 6-byte memory region where the broadcast MAC address will be stored.
- **Logic and Control Flow**:
    - Store the value `0xffffffffU` into the first 4 bytes of the memory region pointed to by `mac`.
    - Store the value `(ushort)0xffff` into the next 2 bytes of the memory region pointed to by `mac`.
    - Return the pointer `mac`.
- **Output**: Returns the pointer `mac` after populating it with the broadcast MAC address.


---
### fd\_eth\_mac\_cpy<!-- {{#callable:fd_eth_mac_cpy}} -->
[View Source →](<../../../../../src/util/net/fd_eth.h#L261>)

Copies a 6-byte MAC address from source to destination memory.
- **Inputs**:
    - `mac`: A pointer to the destination memory where the MAC address will be copied.
    - `_mac`: A pointer to the source memory containing the MAC address to copy.
- **Logic and Control Flow**:
    - Load the first 4 bytes of the MAC address from the source `_mac` using `FD_LOAD` and store them into the destination `mac` using `FD_STORE`.
    - Load the remaining 2 bytes of the MAC address from the source `_mac+4` using `FD_LOAD` and store them into the destination `mac+4` using `FD_STORE`.
    - Return the pointer to the destination `mac`.
- **Output**: Returns a pointer to the destination memory `mac` where the MAC address is copied.


---
### fd\_vlan\_tag<!-- {{#callable:fd_vlan_tag}} -->
[View Source →](<../../../../../src/util/net/fd_eth.h#L275>)

Populates a VLAN tag structure with network byte order values for VLAN ID and type.
- **Inputs**:
    - `_tag`: Pointer to a memory region where the VLAN tag will be stored.
    - `vid`: VLAN ID in host byte order, assumed to be in the range [0, 4095].
    - `type`: Type of the packet that follows this VLAN tag, in host byte order.
- **Logic and Control Flow**:
    - Cast `_tag` to a pointer of type `fd_vlan_tag_t`.
    - Swap the byte order of `vid` using `fd_ushort_bswap` and assign it to `tag->net_vid`.
    - Swap the byte order of `type` using `fd_ushort_bswap` and assign it to `tag->net_type`.
    - Return the pointer `tag`.
- **Output**: Returns a pointer to the populated `fd_vlan_tag_t` structure.


# Function Declarations (Public API)

---
### fd\_eth\_fcs\_append<!-- {{#callable_declaration:fd_eth_fcs_append}} -->
[View Source →](<../../../../../src/util/net/fd_eth.h#L218>)

Computes or updates the frame check sequence (FCS) for an Ethernet frame.
- **Description**: Use this function to compute or incrementally update the FCS of an Ethernet frame. It is useful when you need to manually compute or validate an Ethernet FCS, especially in applications that require precise control over Ethernet frame construction or validation. The function can be used to process the frame in parts, allowing for incremental FCS calculation. Ensure that the buffer provided contains the bytes of the Ethernet frame from the first byte of the Ethernet header to the last byte of the Ethernet payload.
- **Inputs**:
    - `seed`: An initial FCS value to start the calculation. Typically, use `FD_ETH_FCS_APPEND_SEED` for a new calculation.
    - `buf`: A pointer to the buffer containing the Ethernet frame data. Must not be null and should point to a valid memory region of at least `sz` bytes.
    - `sz`: The size of the buffer in bytes. Must be a non-negative value.
- **Output**: Returns the computed FCS as an unsigned integer.
- **See Also**: [`fd_eth_fcs_append`](<fd_eth.c.md#fd_eth_fcs_append>)  (Implementation)


---
### fd\_cstr\_to\_mac\_addr<!-- {{#callable_declaration:fd_cstr_to_mac_addr}} -->
[View Source →](<../../../../../src/util/net/fd_eth.h#L292>)

Parses a MAC address from a string and stores it in a buffer.
- **Description**: Use this function to convert a MAC address in string format to its binary representation. The input string must follow the format specified by `FD_ETH_MAC_FMT`, which is a colon-separated hexadecimal format (e.g., "01:23:45:67:89:ab"). The function writes the parsed MAC address into the provided buffer. It returns the buffer on success or `NULL` if the input string is invalid or if either input parameter is `NULL`. The function processes exactly 17 characters from the input string.
- **Inputs**:
    - `s`: A pointer to a null-terminated string containing the MAC address in colon-separated hexadecimal format. Must not be null. The function returns `NULL` if the string does not match the expected format.
    - `mac`: A pointer to a buffer where the parsed MAC address will be stored. Must not be null. The buffer must be large enough to hold 6 bytes.
- **Output**: Returns a pointer to the `mac` buffer on success, or `NULL` if the input string is invalid or if any input parameter is `NULL`.
- **See Also**: [`fd_cstr_to_mac_addr`](<fd_eth.c.md#fd_cstr_to_mac_addr>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)