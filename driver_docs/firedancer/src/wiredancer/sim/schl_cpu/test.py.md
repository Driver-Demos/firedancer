<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Tests for a CPU simulation using cocotb, including mathematical operations and input/output monitoring.

# Purpose
The code is a test suite for a digital design verification environment using the Cocotb framework. It is designed to test a hardware module, likely a digital signal processor (DSP) or a similar computational unit, by simulating its behavior and verifying its outputs against expected results. The code imports several modules from Cocotb, which is a coroutine-based co-simulation library for writing testbenches in Python. It defines several utility functions and classes to facilitate the testing process.

The `MathMonitor` and `OutMonitor` classes are central components of the test suite. `MathMonitor` is responsible for monitoring and verifying the internal state and memory operations of the device under test (DUT). It checks the results of arithmetic operations and ensures they match expected values. `OutMonitor` tracks the output of the DUT, ensuring that the results are produced correctly and in a timely manner. The [`run_test`](<#run_test>) function orchestrates the test by initializing the DUT, sending random input data, and coordinating the monitors to validate the DUT's behavior. The test suite uses asynchronous coroutines to simulate clock cycles and manage the timing of operations, ensuring that the DUT is tested under realistic conditions.
# Imports and Dependencies

---
- `cocotb`
- `os`
- `copy`
- `sys`
- `struct`
- `hashlib`
- `random`
- `cocotb.clock.Clock`
- `cocotb.triggers.Timer`
- `cocotb.triggers.RisingEdge`
- `cocotb.triggers.ReadOnly`
- `cocotb.regression.TestFactory`
- `cocotb.binary.BinaryValue`
- `ref_ed25519`
- `ref_ed25519.point_decompress`
- `ed25519_lib.Expr`
- `ref_ed25519.p`


# Global Variables

---
### sent\_in
- **Type**: ``list``
- **Description**: A global list variable that is initially empty. It is intended to store input values that are sent during the execution of the `send_rand_input` function.
- **Use**: Used to append input values (`in_vals`) that are sent to the device under test (DUT) during the `send_rand_input` function.


# Classes

---
### MathMonitor<!-- {{#class:firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L86>)

- **Members**:
    - `dut`: Stores the device under test (DUT) object.
    - `total_tags`: Holds the total number of tags from the DUT's CPU.
    - `mem`: Stores memory values with addresses as keys.
    - `verbose`: Indicates if verbose logging is enabled.
- **Description**: Monitors and manages memory operations and tag-based calculations for a device under test (DUT). It initializes memory with constants, checks results against expected values, and logs operations if verbose mode is enabled. The class also runs an asynchronous loop to handle input and output operations based on the DUT's state and clock signals.
- **Methods**:
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.__init__`](<#mathmonitor__init__>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.check`](<#mathmonitorcheck>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.setIn`](<#mathmonitorsetin>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.setMem`](<#mathmonitorsetmem>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.getPhyAddr`](<#mathmonitorgetphyaddr>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.getMem`](<#mathmonitorgetmem>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.run`](<#mathmonitorrun>)

**Methods**

---
#### MathMonitor\.\_\_init\_\_<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.__init__}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L88>)

Initializes the `MathMonitor` object with a given device under test (DUT) and sets up memory and constants.
- **Inputs**:
    - `dut`: The device under test (DUT) object that the `MathMonitor` will monitor.
- **Logic and Control Flow**:
    - Assigns the `dut` parameter to the instance variable `self.dut`.
    - Calculates the total number of tags from the DUT's CPU and assigns it to `self.total_tags`.
    - Initializes an empty dictionary `self.mem` to store memory values.
    - Sets the `self.verbose` flag to `True` for logging purposes.
    - Initializes memory addresses from 0 to 0x3FE with a value of 0 in `self.mem`.
    - Sets specific memory addresses from 0x04 to 0x0F with constant values obtained from the [`get_const`](<#get_const>) function.
- **Output**: No return value; initializes the `MathMonitor` instance.
- **Functions Called**:
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.setMem`](<#mathmonitorsetmem>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.get_const`](<#get_const>)
- **See also**: [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor`](<#mathmonitor>)  (Base Class)


---
#### MathMonitor\.check<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.check}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L98>)

Compares expected and observed values and logs a failure if they do not match.
- **Inputs**:
    - `tag`: An identifier for the operation being checked.
    - `errstr`: A string describing the error context.
    - `expected`: The expected value for comparison.
    - `observed`: The observed value to compare against the expected value.
- **Logic and Control Flow**:
    - Convert both `expected` and `observed` to integers and compare them.
    - If they are equal, return from the function without any action.
    - If they are not equal, log a failure message with the `tag`, `errstr`, `expected`, and `observed` values.
    - Call the [`FAIL`](<#fail>) function to assert a failure.
- **Output**: No output is returned if the values match; otherwise, it logs a failure and asserts.
- **Functions Called**:
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.FAIL`](<#fail>)
- **See also**: [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor`](<#mathmonitor>)  (Base Class)


---
#### MathMonitor\.setIn<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.setIn}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L105>)

Writes a value to a specific memory address calculated from a tag and address.
- **Inputs**:
    - `tag`: An identifier used to calculate the physical memory address.
    - `addr`: The address used in conjunction with the tag to determine the physical memory address.
    - `val`: The value to write to the calculated memory address.
- **Logic and Control Flow**:
    - Calls [`getPhyAddr`](<#mathmonitorgetphyaddr>) with `tag` and `addr` to calculate the physical memory address `wr_addr`.
    - Writes the value `val` to the memory location `self.mem[wr_addr]`.
    - If `self.verbose` is `True`, logs the write operation with the tag, address, and value.
- **Output**: No return value; the function modifies the memory dictionary `self.mem`.
- **Functions Called**:
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.getPhyAddr`](<#mathmonitorgetphyaddr>)
- **See also**: [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor`](<#mathmonitor>)  (Base Class)


---
#### MathMonitor\.setMem<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.setMem}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L111>)

Writes a value to a specific memory address after calculating the physical address.
- **Inputs**:
    - `tag`: An identifier used to calculate the physical address.
    - `addr`: The address offset used to calculate the physical address.
    - `val`: The value to write to the calculated memory address.
- **Logic and Control Flow**:
    - Calculate the physical address using [`getPhyAddr`](<#mathmonitorgetphyaddr>) with `tag` and `addr` as inputs.
    - Convert `val` to an integer and store it in the memory dictionary at the calculated address.
    - If `verbose` is True, log the write operation with details of the tag, address, and value.
- **Output**: None
- **Functions Called**:
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.getPhyAddr`](<#mathmonitorgetphyaddr>)
- **See also**: [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor`](<#mathmonitor>)  (Base Class)


---
#### MathMonitor\.getPhyAddr<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.getPhyAddr}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L116>)

Calculates a physical memory address based on a given tag and address.
- **Inputs**:
    - `tag`: An integer representing the tag used in address calculation.
    - `addr`: An integer representing the address to be converted to a physical address.
- **Logic and Control Flow**:
    - If `addr` is 0x00, return `tag + 0x000`.
    - If `addr` is 0x01, return `tag + 0x020`.
    - If `addr` is 0x02, return `tag + 0x040`.
    - If `addr` is 0x03, return `tag + 0x060`.
    - If `addr` is between 0x04 and 0x23 inclusive, return `0x080 + addr - 0x04`.
    - For all other values of `addr`, return `0x0A0 + scratch_offset(tag) + addr - 0x24`.
- **Output**: An integer representing the calculated physical memory address.
- **Functions Called**:
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.scratch_offset`](<#scratch_offset>)
- **See also**: [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor`](<#mathmonitor>)  (Base Class)


---
#### MathMonitor\.getMem<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.getMem}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L124>)

Retrieves a value from memory using a physical address derived from a tag and address.
- **Inputs**:
    - `tag`: An identifier used to calculate the physical memory address.
    - `addr`: The address used in conjunction with the tag to calculate the physical memory address.
- **Logic and Control Flow**:
    - Calculate the physical address by calling [`getPhyAddr`](<#mathmonitorgetphyaddr>) with `tag` and `addr` as arguments.
    - Retrieve the value from the memory dictionary `mem` using the calculated physical address as the key.
    - If `verbose` is True, log the read operation with the tag, physical address, and retrieved value.
    - Return the retrieved value.
- **Output**: The value stored in memory at the calculated physical address.
- **Functions Called**:
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.getPhyAddr`](<#mathmonitorgetphyaddr>)
- **See also**: [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor`](<#mathmonitor>)  (Base Class)


---
#### MathMonitor\.run<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.run}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L130>)

Executes a continuous loop to monitor and process CPU states, manage memory operations, and validate results based on CPU instructions.
- **Decorators**: `@cocotb.test`
- **Inputs**: None
- **Logic and Control Flow**:
    - Initialize variables and lists to store instruction data, addresses, values, and expected results for each tag.
    - Enter an infinite loop that waits for a rising edge of the clock signal.
    - Iterate over each tag to check the CPU state and perform operations based on the state.
    - If the CPU state is 1 and conditions are met, call [`setIn`](<#mathmonitorsetin>) to insert data and update `init_vals` and `next_tag`.
    - If the CPU state is 3, retrieve and calculate expected results using memory addresses and operations, and log the expected result if verbose mode is enabled.
    - If the CPU state is 5, check the result and output address against expected values, update memory if necessary, and mark the result as checked.
- **Output**: No explicit return value; operates asynchronously and performs logging and memory updates.
- **Functions Called**:
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.setIn`](<#mathmonitorsetin>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.getMemAAddr`](<#getmemaaddr>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.getMemBAddr`](<#getmembaddr>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.getMemTAddr`](<#getmemtaddr>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.getMemOAddr`](<#getmemoaddr>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.getMem`](<#mathmonitorgetmem>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.evalOp`](<#evalop>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.getOP`](<#getop>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.check`](<#mathmonitorcheck>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.getPhyAddr`](<#mathmonitorgetphyaddr>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.setMem`](<#mathmonitorsetmem>)
- **See also**: [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor`](<#mathmonitor>)  (Base Class)



---
### OutMonitor<!-- {{#class:firedancer/src/wiredancer/sim/schl_cpu/test.OutMonitor}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L193>)

- **Members**:
    - `dut`: Stores the device under test (DUT) object.
    - `done`: Indicates if the monitoring process is complete.
    - `in_vals`: Holds a list of input values received.
    - `out_vals`: Holds a list of output values observed.
    - `expected`: Holds a list of expected output values.
    - `inout_match`: Stores a dictionary mapping input values to output values.
- **Description**: Monitors the output of a device under test (DUT) by tracking input and output values, and logs the results. It waits for a specified number of outputs to be processed before marking the monitoring as complete.
- **Methods**:
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.OutMonitor.__init__`](<#outmonitor__init__>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.OutMonitor.is_done`](<#outmonitoris_done>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.OutMonitor.run`](<#outmonitorrun>)

**Methods**

---
#### OutMonitor\.\_\_init\_\_<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.OutMonitor.__init__}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L194>)

Initializes an instance of the `OutMonitor` class with a given device under test (DUT) and sets the `done` attribute to `False`.
- **Inputs**:
    - `dut`: The device under test (DUT) that the `OutMonitor` instance will monitor.
- **Logic and Control Flow**:
    - Assigns the provided `dut` to the instance's `dut` attribute.
    - Sets the `done` attribute of the instance to `False`.
- **Output**: None (constructor method).
- **See also**: [`firedancer/src/wiredancer/sim/schl_cpu/test.OutMonitor`](<#outmonitor>)  (Base Class)


---
#### OutMonitor\.is\_done<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.OutMonitor.is_done}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L198>)

Waits for the `done` attribute to become `True` by repeatedly awaiting a rising edge on the `dut.clk` signal.
- **Inputs**:
    - `self`: Instance of the `OutMonitor` class.
- **Logic and Control Flow**:
    - Enter a loop that continues while `self.done` is `False`.
    - Await a rising edge on the `dut.clk` signal using `RisingEdge(self.dut.clk)`.
- **Output**: No explicit return value; the method completes when `self.done` becomes `True`.
- **See also**: [`firedancer/src/wiredancer/sim/schl_cpu/test.OutMonitor`](<#outmonitor>)  (Base Class)


---
#### OutMonitor\.run<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.OutMonitor.run}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L202>)

Monitors input and output signals of a device under test (DUT) and logs results until a specified number of outputs are collected.
- **Decorators**: `@cocotb.test`
- **Inputs**:
    - `self`: Reference to the current instance of the class.
    - `total`: The total number of input sets to process, default is 3.
- **Logic and Control Flow**:
    - Initialize variables `tic`, `start`, `in_vals`, `out_vals`, `expected`, and `inout_match` to track the state and data.
    - Enter an infinite loop that waits for a rising edge on the DUT's clock signal.
    - Increment the `tic` counter on each clock cycle.
    - Check if the input signal `i_valid` is high; if so, read the input hash value `i_hash` and store it in `in_vals` and `start` if `i_cnt` is 0.
    - Increment `i_cnt` and reset it to 0 after reaching 2.
    - Check if the output signal `o_valid` is high; if so, read the output hash value `o_hash` and store it in `out_vals`.
    - Log the output result, start tick, stop tick, and elapsed time using the DUT's logging mechanism.
    - Break the loop when the number of collected outputs reaches `total * 8`.
    - Set `self.done` to True to indicate completion.
- **Output**: No return value; the method sets `self.done` to True when complete.
- **See also**: [`firedancer/src/wiredancer/sim/schl_cpu/test.OutMonitor`](<#outmonitor>)  (Base Class)



# Functions

---
### FAIL<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.FAIL}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L21>)

Always raises an AssertionError when called.
- **Inputs**: None
- **Logic and Control Flow**:
    - Executes an assert statement with a condition that is always false.
- **Output**: Raises an AssertionError.


---
### clamp<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.clamp}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L24>)

Performs a bitwise AND operation on the integer representation of the input value with a 256-bit mask.
- **Inputs**:
    - `val`: The input value to be clamped, which can be any type that can be converted to an integer.
- **Logic and Control Flow**:
    - Convert the input `val` to an integer using `int(val)`.
    - Create a 256-bit mask by computing `(1<<256)-1`.
    - Perform a bitwise AND operation between the integer value and the 256-bit mask.
- **Output**: Returns the result of the bitwise AND operation, effectively clamping the input value to a 256-bit integer.


---
### getTern<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.getTern}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L27>)

Extracts the top 4 bits from a 32-bit integer by right-shifting the input value by 28 bits.
- **Inputs**:
    - `val`: A 32-bit integer from which the top 4 bits will be extracted.
- **Logic and Control Flow**:
    - Right-shift the input integer `val` by 28 bits to move the top 4 bits to the least significant position.
    - Convert the result to an integer.
- **Output**: An integer representing the top 4 bits of the input `val`.


---
### getOP<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.getOP}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L30>)

Extracts a 4-bit operation code from a 32-bit integer by shifting and masking.
- **Inputs**:
    - `val`: A 32-bit integer from which to extract the operation code.
- **Logic and Control Flow**:
    - Shift the input integer `val` right by 24 bits to isolate the operation code in the least significant bits.
    - Apply a bitwise AND operation with `0xF` to extract the 4-bit operation code.
- **Output**: Returns the extracted 4-bit operation code as an integer.


---
### getMemAAddr<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.getMemAAddr}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L33>)

Extracts a 6-bit memory address from a given integer by shifting and masking operations.
- **Inputs**:
    - `val`: An integer from which to extract the memory address.
- **Logic and Control Flow**:
    - Shift the input integer `val` right by 18 bits.
    - Apply a bitwise AND operation with `0x3F` to extract the lower 6 bits of the shifted value.
- **Output**: An integer representing the extracted 6-bit memory address.


---
### getMemBAddr<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.getMemBAddr}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L36>)

Calculates the memory B address from a given integer value by extracting specific bits.
- **Inputs**:
    - `val`: An integer value from which to extract the memory B address.
- **Logic and Control Flow**:
    - Shifts the input integer `val` 12 bits to the right.
    - Applies a bitwise AND operation with `0x3F` to extract the relevant bits for the memory B address.
    - Converts the result to an integer.
- **Output**: An integer representing the memory B address extracted from the input value.


---
### getMemTAddr<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.getMemTAddr}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L39>)

Extracts a 6-bit memory address from a given integer value by shifting and masking operations.
- **Inputs**:
    - `val`: An integer value from which to extract the memory address.
- **Logic and Control Flow**:
    - Shift the input integer `val` right by 6 bits.
    - Apply a bitwise AND operation with `0x3F` to extract the lower 6 bits of the shifted value.
    - Convert the result to an integer.
- **Output**: An integer representing the extracted 6-bit memory address.


---
### getMemOAddr<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.getMemOAddr}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L42>)

Extracts the lower 6 bits from the input value.
- **Inputs**:
    - `val`: An integer value from which to extract the lower 6 bits.
- **Logic and Control Flow**:
    - Performs a bitwise AND operation between the input `val` and the hexadecimal value `0x3F` to isolate the lower 6 bits.
    - Converts the result of the bitwise operation to an integer.
- **Output**: An integer representing the lower 6 bits of the input value.


---
### scratch\_offset<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.scratch_offset}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L45>)

Returns a predefined offset value from a list based on the input tag index.
- **Inputs**:
    - `tag`: An integer index used to access the corresponding offset value from the predefined list.
- **Logic and Control Flow**:
    - Defines a list `a` containing predefined offset values.
    - Returns the offset value at the index specified by `tag` from the list `a`.
- **Output**: The offset value from the list `a` at the index specified by `tag`.


---
### get\_const<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.get_const}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L50>)

Retrieves a constant value from a predefined list based on the given address index.
- **Inputs**:
    - `addr`: An integer index used to access a specific constant from the predefined list.
- **Logic and Control Flow**:
    - Defines a list of constant hexadecimal values.
    - Returns the constant value at the index specified by the input `addr`.
- **Output**: The constant value from the list at the specified index `addr`.


---
### evalOp<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.evalOp}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L67>)

Evaluates a specified operation on two input values and an optional ternary value, returning the result after clamping.
- **Inputs**:
    - `op`: An integer representing the operation to perform.
    - `valA`: The first integer value for the operation.
    - `valB`: The second integer value for the operation.
    - `valT`: An integer used as a ternary condition for certain operations.
- **Logic and Control Flow**:
    - Checks the value of `op` to determine which operation to perform.
    - For `op` values 0 to 10, performs bitwise, comparison, shift, or arithmetic operations on `valA` and `valB`, then clamps the result.
    - For `op` value 11, returns `valA` if `valT` is true, otherwise returns `valB`.
    - For `op` value 12, returns 0.
    - If `op` does not match any specified case, returns 0.
- **Output**: Returns the result of the operation after clamping, or 0 if the operation is not defined.
- **Functions Called**:
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.clamp`](<#clamp>)


---
### send\_rand\_input<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.send_rand_input}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L237>)

Sends a sequence of predefined input values to a device under test (DUT) when the DUT is ready.
- **Inputs**:
    - `dut`: The device under test (DUT) to which the input values are sent.
    - `i`: An optional integer index, defaulting to 0, used to track the current input value being sent.
- **Logic and Control Flow**:
    - Imports the constant `p` from the `ref_ed25519` module.
    - Defines a list `in_tmp` with three predefined hexadecimal values.
    - Assigns the first three values of `in_tmp` to the tuple `in_vals`.
    - Sets `total` to 3 and initializes `i` to 0.
    - Enters a while loop that continues until `i` is less than `total`.
    - Checks if `dut.i_ready` is 1; if true, assigns the current value from `in_vals` to `dut.i_hash` and sets `dut.i_valid` to 1, then increments `i`.
    - If `dut.i_ready` is not 1, sets `dut.i_hash` and `dut.i_valid` to 0.
    - Awaits a rising edge on `dut.clk` in each iteration of the loop.
    - After the loop, sets `dut.i_hash` and `dut.i_valid` to 0.
    - Appends the tuple `in_vals` to the global list `sent_in`.
- **Output**: None, but it modifies the state of the DUT and appends input values to the global list `sent_in`.


---
### run\_test<!-- {{#callable:firedancer/src/wiredancer/sim/schl_cpu/test.run_test}} -->
[View Source →](<../../../../../../src/wiredancer/sim/schl_cpu/test.py#L262>)

Executes a test for a digital design using the cocotb framework.
- **Decorators**: `@cocotb.test`
- **Inputs**:
    - `dut`: The device under test (DUT) object, representing the digital design to test.
- **Logic and Control Flow**:
    - Initialize `num_sent` to 0 and `num_inputs` to 64.
    - Create instances of [`OutMonitor`](<#outmonitor>) and [`MathMonitor`](<#mathmonitor>) with `dut`.
    - Start the clock with a period of 4000 time units and run the [`OutMonitor`](<#outmonitor>) and [`MathMonitor`](<#mathmonitor>).
    - Set `dut.i_hash` and `dut.i_valid` to 0, then apply a reset by setting `dut.rst` to 1 and then to 0 after a few clock cycles.
    - Wait for `dut.i_ready` to become 1, indicating readiness to receive inputs.
    - Allow the DSPs to warm up by waiting for 2048 clock cycles.
    - In a loop, while `num_sent` is less than `num_inputs`, check if `dut.i_ready` is 1, then send random input using [`send_rand_input`](<#send_rand_input>) and increment `num_sent`. Wait for a random number of clock cycles between 0 and 10 after each input.
    - After sending all inputs, set `dut.i_hash` and `dut.i_valid` to 0 and wait for 100 clock cycles.
    - Wait for the [`OutMonitor`](<#outmonitor>) to signal completion using `om.is_done()`.
    - Wait for one more rising edge of the clock.
- **Output**: No direct output is returned, but the function performs a test on the DUT and logs results.
- **Functions Called**:
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.OutMonitor`](<#outmonitor>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor`](<#mathmonitor>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.MathMonitor.run`](<#mathmonitorrun>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.send_rand_input`](<#send_rand_input>)
    - [`firedancer/src/wiredancer/sim/schl_cpu/test.OutMonitor.is_done`](<#outmonitoris_done>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)