<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Header file for replaying data from a pcap file into a tango fragment stream with flow control diagnostics.

# Purpose
The code is a C header file that defines the interface for a module responsible for replaying data from a pcap file into a tango fragment stream. It is designed to work within a specific environment that supports hosted execution and x86 architecture. The module provides functionality to replay packets from a pcap file, managing flow control and diagnostics through a command-and-control (CNC) system. It defines several constants and macros for managing CNC signals and diagnostics, such as `FD_REPLAY_CNC_SIGNAL_ACK` and various diagnostic counters like `FD_REPLAY_CNC_DIAG_PCAP_PUB_CNT`.

The header file declares functions such as [`fd_replay_tile`](<#fd_replay_tile>) and [`fd_replay_tile_loop`](<#fd_replay_tile_loop>), which are responsible for executing the replay process. These functions handle the initialization and execution of the replay tile, managing resources like memory caches (`mcache` and `dcache`), flow control credits, and consumer sequences. The module also specifies requirements for memory alignment and footprint for the replay tile's scratch memory, ensuring efficient operation. The functions are designed to handle reliable and unreliable consumers, with specific parameters to control flow and performance, such as `cr_max` for flow control credits and `lazy` for credit reception intervals.
# Imports and Dependencies

---
- `../../disco/fd_disco_base.h`


# Function Declarations (Public API)

---
### fd\_replay\_tile\_scratch\_align<!-- {{#callable_declaration:fd_replay_tile_scratch_align}} -->
[View Source →](<../../../../../src/wiredancer/test/fd_replay_loop.h#L66>)

Returns the alignment requirement for a replay tile scratch region.
- **Description**: Use this function to obtain the alignment requirement for a replay tile scratch region. This alignment is necessary to ensure proper memory access and performance when the replay tile operates. The function is constant and does not depend on any input parameters, making it straightforward to use when setting up memory for replay tiles.
- **Inputs**: None
- **Output**: Returns an unsigned long integer representing the alignment requirement, which is a power of 2.
- **See Also**: [`fd_replay_tile_scratch_align`](<fd_replay_loop.c.md#fd_replay_tile_scratch_align>)  (Implementation)


---
### fd\_replay\_tile\_scratch\_footprint<!-- {{#callable_declaration:fd_replay_tile_scratch_footprint}} -->
[View Source →](<../../../../../src/wiredancer/test/fd_replay_loop.h#L141>)

Calculates the memory footprint for a replay tile scratch region.
- **Description**: Use this function to determine the required memory footprint for a replay tile scratch region that supports a specified number of outputs. This function is useful when setting up memory allocations for replay tiles. It returns zero if the specified number of outputs exceeds the maximum allowed, enabling callers to detect configuration issues.
- **Inputs**:
    - `out_cnt`: Specifies the number of reliable consumers the replay tile will support. Must be a non-negative value and not exceed `FD_REPLAY_TILE_OUT_MAX`. If `out_cnt` is greater than this maximum, the function returns zero.
- **Output**: Returns the calculated memory footprint in bytes for the scratch region if `out_cnt` is valid; otherwise, returns zero.
- **See Also**: [`fd_replay_tile_scratch_footprint`](<fd_replay_loop.c.md#fd_replay_tile_scratch_footprint>)  (Implementation)


---
### fd\_replay\_tile\_loop<!-- {{#callable_declaration:fd_replay_tile_loop}} -->
[View Source →](<../../../../../src/wiredancer/test/fd_replay_loop.h#L158>)

Replays packets from a pcap file as a fragment stream.
- **Description**: Use this function to replay packets from a specified pcap file into a fragment stream, managing flow control and diagnostics. Ensure the command-and-control structure is in the BOOT state before calling. The function transitions the state from BOOT to RUN, processes packets, and handles signals until a HALT signal is received, at which point it transitions back to BOOT. It requires valid memory regions for command-and-control, fragment metadata, and data cache, as well as a random number generator and scratch memory. The function supports multiple reliable consumers and manages flow control credits. It returns 0 on successful execution or a non-zero error code if initialization fails.
- **Inputs**:
    - `cnc`: Local join to the command-and-control structure. Must not be null and should be in the BOOT state before calling.
    - `pcap_path`: Pointer to a string with the path to the pcap file. Must not be null.
    - `pkt_max`: Upper bound of packet size in the pcap. Must be positive.
    - `orig`: Origin for the fragment stream, in the range [0, FD_FRAG_META_ORIG_MAX).
    - `mcache`: Local join to the fragment stream output metadata cache. Must not be null.
    - `dcache`: Local join to the fragment stream output data cache. Must not be null.
    - `out_cnt`: Number of reliable consumers, indexed from 0 to out_cnt-1. Must not exceed FD_REPLAY_TILE_OUT_MAX.
    - `out_fseq`: Array of pointers to sequence numbers for each reliable consumer. Must not be null if out_cnt is greater than 0.
    - `cr_max`: Maximum number of flow control credits. If 0, a default value based on mcache depth is used.
    - `lazy`: Interval in nanoseconds for receiving credits from consumers. If <=0, a default value is used.
    - `rng`: Local join to the random number generator. Must not be null and should be uniquely seeded.
    - `scratch`: Pointer to scratch memory for the tile. Must be aligned and have sufficient footprint as defined by fd_replay_tile_scratch_align and fd_replay_tile_scratch_footprint.
- **Output**: Returns 0 on successful execution, or a non-zero error code if initialization fails.
- **See Also**: [`fd_replay_tile_loop`](<fd_replay_loop.c.md#fd_replay_tile_loop>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)