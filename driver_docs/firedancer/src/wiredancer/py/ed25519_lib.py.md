<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Implements an expression tracking class for generating machine instructions for the ed25519 verification process, including optimizations like constant propagation and dead code elimination.

# Purpose
The code defines a Python module that implements a system for generating and optimizing sequences of machine instructions to compute the `ed25519` verification procedure. The primary class, `Expr`, is used to track and optimize the sequence of Python expressions executed during the evaluation of arbitrary Python code. The optimizations include constant propagation, dead code elimination, and minimal register allocation. The `Expr` class does not support traditional `if` statements; instead, it uses a ternary operator to track both branches of the data path, ensuring all paths are executed and the correct data is selected using multiplexing.

The module also includes several functions for modular arithmetic operations, such as [`mul_modp`](<#mul_modp>), [`add_modp`](<#add_modp>), and [`sub_modp`](<#sub_modp>), which are essential for cryptographic computations. Additionally, the module provides functions for generating hexadecimal representations of constants and instructions, which are useful for hardware implementations. The code is structured to be used as a library, with the `Expr` class and associated functions forming the core components. The module does not define a public API or external interfaces but is intended to be used internally for generating and optimizing instruction sequences for cryptographic operations.
# Imports and Dependencies

---
- `random`
- `numbers`
- `ref_ed25519`
- `ref_ed25519.p`


# Classes

---
### Expr<!-- {{#class:firedancer/src/wiredancer/py/ed25519_lib.Expr}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L7>)

- **Members**:
    - `trace_q`: Tracks the sequence of expressions executed.
    - `op_hist`: Stores the history of operations performed.
    - `op_args`: Stores the arguments for each operation.
    - `func_const_prop`: Indicates if constant propagation is enabled.
    - `v`: Holds the evaluated value of the expression.
    - `t`: Tracks the type of the expression.
    - `c`: Indicates if the expression is a constant.
    - `func`: Stores the function name if the expression is a function call.
    - `op`: Stores the operator if the expression is an operation.
    - `args`: Holds the arguments for the expression.
    - `addr`: Stores the memory address of the expression.
    - `out`: Indicates if the expression is an output.
- **Description**: Generates machine instructions for the ed25519 verify procedure and tracks Python expressions during code evaluation. Supports optimizations like constant propagation, dead code elimination, and register allocation. Does not support if statements but uses ternary operators to track both branches of the datapath.
- **Methods**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.reset`](<#exprreset>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.outputs`](<#exproutputs>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__init__`](<#expr__init__>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.copy`](<#exprcopy>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.eval`](<#expreval>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__add__`](<#expr__add__>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__sub__`](<#expr__sub__>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__rshift__`](<#expr__rshift__>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__lshift__`](<#expr__lshift__>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__and__`](<#expr__and__>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__eq__`](<#expr__eq__>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__ne__`](<#expr__ne__>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__ge__`](<#expr__ge__>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__int__`](<#expr__int__>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__repr__`](<#expr__repr__>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.__hash__`](<#expr__hash__>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.mem`](<#exprmem>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.opt_trace`](<#expropt_trace>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.dump_const_hex`](<#exprdump_const_hex>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.dump_instr_hex`](<#exprdump_instr_hex>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.eval_hex`](<#expreval_hex>)

**Methods**

---
#### Expr\.reset<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.reset}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L39>)

Resets the static attributes of the `Expr` class to their initial states.
- **Inputs**: None
- **Logic and Control Flow**:
    - Sets `Expr.func_const_prop` to `False`.
    - Initializes `Expr.maddr` and `Expr.caddr` to `0`.
    - Resets `Expr.trace_q` to an empty list.
    - Resets `Expr.op_hist` to an empty dictionary.
    - Resets `Expr.op_args` to an empty dictionary.
    - Resets `Expr.outs` to an empty list.
- **Output**: No output is returned.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)  (Base Class)


---
#### Expr\.outputs<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.outputs}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L48>)

Sets the output expressions for the `Expr` class and marks them as outputs.
- **Inputs**:
    - `outs`: An expression or a list of expressions to be set as outputs.
- **Logic and Control Flow**:
    - Check if `outs` is an instance of `Expr`; if so, convert it to a list containing `outs`.
    - Assign the list of outputs to `Expr.outputs`.
    - Iterate over each expression in `Expr.outputs`, set its `out` attribute to `True`, and append it to `Expr.outs`.
    - Call the `Expr.opt_trace()` method to optimize the trace.
- **Output**: No explicit return value; modifies class-level attributes of `Expr`.
- **Functions Called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.opt_trace`](<#expropt_trace>)
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)  (Base Class)


---
#### Expr\.\_\_init\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__init__}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L57>)

Initializes an `Expr` object with specified parameters and sets up its internal state based on the provided arguments.
- **Inputs**:
    - `left`: The left operand for the expression, default is `None`.
    - `op`: The operator for the expression, default is `None`.
    - `right`: The right operand for the expression, default is `None`.
    - `cond`: The condition for ternary operations, default is `None`.
    - `func`: The function to apply, default is `None`.
    - `args`: The arguments for the function, default is `None`.
    - `var`: A boolean indicating if the expression is a variable input, default is `False`.
    - `out`: A boolean indicating if the expression is an output, default is `False`.
- **Logic and Control Flow**:
    - Initialize instance variables `v`, `t`, `c`, `func`, `op`, `args`, `addr`, and `out` to default values.
    - If `func` is not `None`, set `func`, `args`, and `c` based on `Expr.func_const_prop`. Convert `args` to `Expr` objects if necessary.
    - If `c` is `True`, evaluate the expression, reset `func`, and set `args` to the evaluated result.
    - If `op` is `None` and `var` is `True`, set `func` to 'input' and `args` to an empty list.
    - If `op` is `None` and `var` is `False`, check if `left` is an integer. If so, set `c` to `True` and `args` to `[left]`. Otherwise, print the type of `left`.
    - If `op` is 'if', evaluate `cond` and copy the result of `left` or `right` based on `cond`. If `cond` is not constant, set `func` to 'ternary' and `args` to `[e_left, e_right, e_cond]`.
    - For other operators, convert `left` and `right` to `Expr` objects if necessary, set `func` to 'op', `op` to the provided operator, and `args` to `(e_left, e_right)`. If both `e_left` and `e_right` are constant, evaluate the expression and update `func`, `op`, `c`, and `args`.
    - If `c` is `False`, append the current instance to `Expr.trace_q`.
    - Call `eval()` to evaluate the expression.
- **Output**: An initialized `Expr` object with its internal state set based on the provided arguments.
- **Functions Called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.eval`](<#expreval>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.copy`](<#exprcopy>)
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)  (Base Class)


---
#### Expr\.copy<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.copy}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L137>)

Copies the attributes from another `Expr` instance to the current instance.
- **Inputs**:
    - `r`: An instance of the `Expr` class from which to copy attributes.
- **Logic and Control Flow**:
    - Assigns the value of `r.v` to `self.v`.
    - Assigns the value of `r.t` to `self.t`.
    - Assigns the value of `r.c` to `self.c`.
    - Assigns the value of `r.op` to `self.op`.
    - Assigns the value of `r.func` to `self.func`.
    - Assigns the value of `r.args` to `self.args`.
    - Assigns the value of `r.addr` to `self.addr`.
- **Output**: None
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)  (Base Class)


---
#### Expr\.eval<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.eval}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L146>)

Evaluates the expression represented by the current instance of the `Expr` class and assigns the result to the instance variable `v`.
- **Inputs**: None
- **Logic and Control Flow**:
    - Checks if `self.v` is `None` to determine if evaluation is necessary.
    - If `self.c` is `True`, assigns the first argument in `self.args` to `self.v`.
    - If `self.func` is 'input', assigns 0 to `self.v`.
    - If `self.func` is 'if', evaluates a ternary operation using the first three arguments in `self.args` and assigns the result to `self.v`.
    - If `self.func` is 'op', evaluates a binary operation using the first two arguments in `self.args` and the operator `self.op`, then assigns the result to `self.v`.
    - If `self.func` is not `None`, evaluates a function call with `self.func` and the evaluated arguments in `self.args`, then assigns the result to `self.v`.
    - Converts `self.v` to an integer.
    - Returns `self.v`.
- **Output**: The evaluated integer value of the expression, stored in `self.v`.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)  (Base Class)


---
#### Expr\.\_\_add\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__add__}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L171>)

Creates a new `Expr` object representing the addition of the current expression with another value.
- **Inputs**:
    - `v`: The value to add to the current expression, which can be another `Expr` object or a compatible type.
- **Logic and Control Flow**:
    - Calls the `Expr` constructor with the current expression (`self`), the addition operator ('+'), and the value `v`.
- **Output**: A new `Expr` object representing the addition operation.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)  (Base Class)


---
#### Expr\.\_\_sub\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__sub__}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L174>)

Performs subtraction between two `Expr` objects and returns a new `Expr` object representing the subtraction operation.
- **Inputs**:
    - `v`: The right operand for the subtraction, which can be an `Expr` object or a value that can be converted to an `Expr` object.
- **Logic and Control Flow**:
    - Creates a new `Expr` object with the current object as the left operand, '-' as the operator, and `v` as the right operand.
- **Output**: A new `Expr` object representing the subtraction operation between the current object and `v`.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)  (Base Class)


---
#### Expr\.\_\_rshift\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__rshift__}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L177>)

Performs a right shift operation on an `Expr` object and returns a new `Expr` object representing the operation.
- **Inputs**:
    - `v`: The value to shift the current `Expr` object by, which can be another `Expr` object or a numeric value.
- **Logic and Control Flow**:
    - Creates a new `Expr` object with the current `Expr` object as the left operand, the right shift operator '>>' as the operation, and `v` as the right operand.
    - Returns the newly created `Expr` object.
- **Output**: A new `Expr` object representing the right shift operation.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)  (Base Class)


---
#### Expr\.\_\_lshift\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__lshift__}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L180>)

Performs a left shift operation on an `Expr` object and returns a new `Expr` object representing the operation.
- **Inputs**:
    - `v`: The value to shift the current `Expr` object by, which can be another `Expr` object or a numeric value.
- **Logic and Control Flow**:
    - Creates a new `Expr` object with the current object as the left operand, the '<<' operator, and `v` as the right operand.
    - Returns the newly created `Expr` object.
- **Output**: A new `Expr` object representing the left shift operation.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)  (Base Class)


---
#### Expr\.\_\_and\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__and__}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L183>)

Performs a bitwise AND operation between two `Expr` objects and returns a new `Expr` object representing the result.
- **Inputs**:
    - `v`: An `Expr` object or a value that can be converted to an `Expr` object, representing the right operand of the AND operation.
- **Logic and Control Flow**:
    - Creates a new `Expr` object with the current object as the left operand, '&' as the operator, and `v` as the right operand.
    - Returns the newly created `Expr` object.
- **Output**: A new `Expr` object representing the result of the bitwise AND operation.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)  (Base Class)


---
#### Expr\.\_\_eq\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__eq__}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L186>)

Compares two `Expr` objects for equality by creating a new `Expr` object with the '==' operator.
- **Inputs**:
    - `v`: The value to compare with the current `Expr` object.
- **Logic and Control Flow**:
    - Creates a new `Expr` object using the current object as the left operand, '==' as the operator, and `v` as the right operand.
    - Returns the newly created `Expr` object.
- **Output**: A new `Expr` object representing the equality comparison between the current object and `v`.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)  (Base Class)


---
#### Expr\.\_\_ne\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__ne__}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L189>)

Implements the inequality comparison operation for `Expr` objects.
- **Inputs**:
    - `v`: The value to compare with the current `Expr` instance.
- **Logic and Control Flow**:
    - Creates a new `Expr` instance with the current instance as the left operand, the '!=' operator, and `v` as the right operand.
    - Returns the newly created `Expr` instance.
- **Output**: A new `Expr` instance representing the inequality comparison between the current instance and `v`.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)  (Base Class)


---
#### Expr\.\_\_ge\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__ge__}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L192>)

Implements the greater than or equal to comparison for `Expr` objects.
- **Inputs**:
    - `v`: The right-hand side operand for the '>=' operation, which can be an `Expr` object or a value that can be converted to an `Expr`.
- **Logic and Control Flow**:
    - Creates a new `Expr` object with the current instance as the left operand, the '>=' operator, and `v` as the right operand.
    - Returns the newly created `Expr` object.
- **Output**: A new `Expr` object representing the '>=' operation between the current instance and `v`.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)  (Base Class)


---
#### Expr\.\_\_int\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__int__}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L195>)

Converts the `Expr` object to an integer by evaluating its expression.
- **Inputs**: None
- **Logic and Control Flow**:
    - Calls the [`eval`](<#expreval>) method of the `Expr` object.
    - Returns the result of the [`eval`](<#expreval>) method.
- **Output**: The integer result of evaluating the expression represented by the `Expr` object.
- **Functions Called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.eval`](<#expreval>)
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)  (Base Class)


---
#### Expr\.\_\_repr\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__repr__}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L198>)

Formats the representation of an `Expr` object as a string showing its function, operation, argument addresses, constant flag, and address.
- **Inputs**: None
- **Logic and Control Flow**:
    - Uses the `format` method to create a string representation of the `Expr` object.
    - Includes the `func`, `op`, a list comprehension for `args` to get their `addr`, `c`, and `addr` attributes in the formatted string.
- **Output**: A string that represents the `Expr` object in a specific format.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)  (Base Class)


---
#### Expr\.\_\_hash\_\_<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.__hash__}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L207>)

Returns the unique identifier for the instance of the `Expr` class.
- **Inputs**: None
- **Logic and Control Flow**:
    - Calls the built-in `id` function with `self` as the argument.
    - Returns the result of the `id` function call.
- **Output**: The unique identifier (hash) for the instance, which is the memory address of the object.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)  (Base Class)


---
#### Expr\.mem<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.mem}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L210>)

Formats and returns a string representation of the memory address or constant address of an expression.
- **Inputs**: None
- **Logic and Control Flow**:
    - Checks if `self.addr` is `None` and returns a formatted string of the first element in `self.expr` in hexadecimal format.
    - If `self.c` is `True`, returns a formatted string with the prefix 'c' followed by `self.caddr`.
    - Otherwise, returns a formatted string with the prefix 'm' followed by `self.addr`.
- **Output**: A string representing the memory or constant address of the expression.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)  (Base Class)


---
#### Expr\.opt\_trace<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.opt_trace}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L291>)

Optimizes the trace of expressions by allocating memory for inputs, outputs, and constants, and tracks operation usage.
- **Inputs**: None
- **Logic and Control Flow**:
    - Initialize empty lists and dictionaries for memory management and expression tracking.
    - Define `tmap` function to map expressions to memory addresses, either as constants or variables.
    - Define `tfree` function to free memory addresses of expressions that are no longer needed.
    - Iterate over `Expr.trace_q` to allocate memory for inputs and constants using `tmap`.
    - Iterate over `Expr.outputs` to allocate memory for outputs using `tmap`.
    - Iterate over `Expr.trace_q` in reverse to process each expression, freeing destination memory and allocating argument memory.
    - Update operation and argument histograms for each expression processed.
    - Print operation usage statistics and memory allocation summary.
- **Output**: Prints operation usage statistics and memory allocation summary.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)  (Base Class)


---
#### Expr\.dump\_const\_hex<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.dump_const_hex}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L405>)

Generates a hexadecimal or COE formatted string representation of constants from the `Expr` class.
- **Inputs**:
    - `n`: The number of copies to generate.
    - `r`: The number of rows per copy.
    - `format`: The format of the output string, either 'hex' or 'coe'.
- **Logic and Control Flow**:
    - Initialize an empty string `hex_st` and a counter `h_i`.
    - Iterate `n` times to generate the required number of copies.
    - For each iteration, check the `format` parameter.
    - If `format` is 'hex', append a formatted string with a fixed value to `hex_st`.
    - If `format` is 'coe', append initialization strings to `hex_st`.
    - Iterate over the constants in `Expr.consts`.
    - For each constant, format it as a 64-character hexadecimal string and append it to `hex_st`.
    - If `format` is 'coe', append a comma before each constant except the first one and increment `h_i`.
    - After processing all constants, append a semicolon to `hex_st` if `format` is 'coe'.
- **Output**: A string containing the formatted constants in either hexadecimal or COE format.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)  (Base Class)


---
#### Expr\.dump\_instr\_hex<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.dump_instr_hex}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L430>)

Generates a hexadecimal representation of machine instructions based on the format specified.
- **Inputs**:
    - `format`: Specifies the output format of the hexadecimal representation, which can be 'hex', 'coe', or 'mif'.
- **Logic and Control Flow**:
    - Initialize `hex_st` based on the specified `format` ('hex', 'coe', or 'mif').
    - Create a memory map `mmap` for registers and constants.
    - Iterate over `Expr.trace_q` to process each trace item `t`.
    - For each trace item, determine the operation and operands based on `t.func` and `t.op`.
    - Map the operands `a`, `b`, `c`, and `d` using `mmap`.
    - Determine the operation code `op` based on the function and operator of `t`.
    - Calculate the instruction `h` using bitwise operations on `op`, `a`, `b`, `c`, and `d`.
    - Append the formatted instruction `h` to `hex_st` based on the `format`.
    - Iterate over `Expr.outputs` to process each output `t` and append the corresponding instruction to `hex_st`.
    - If the format is 'coe', append a semicolon to `hex_st` at the end.
- **Output**: Returns a string `hex_st` containing the formatted hexadecimal representation of the instructions.
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)  (Base Class)


---
#### Expr\.eval\_hex<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.Expr.eval_hex}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L535>)

Evaluates hexadecimal constants and instructions to perform operations and return results as a tuple.
- **Inputs**:
    - `const_hex`: A string containing hexadecimal constants, formatted with specific initialization directives.
    - `instr_hex`: A string containing hexadecimal instructions, formatted with specific initialization directives.
    - `inputs`: A list of input values to initialize memory.
- **Logic and Control Flow**:
    - Initialize an empty dictionary `mem` and an empty list `rs`.
    - Store each input value from `inputs` into `mem` with its index as the key.
    - Parse `const_hex` line by line to initialize memory with constants, skipping empty lines and specific initialization directives.
    - Parse `instr_hex` line by line, skipping the first line and specific initialization directives, to execute instructions.
    - For each instruction, extract operation and operand indices using the [`bits`](<#bits>) function.
    - Retrieve operand values from `mem` and perform operations based on the operation code `o`.
    - Store the result of each operation back into `mem` at the index specified by `d`.
    - Append results to `rs` if the operation code indicates an output operation.
    - Return the results as a tuple.
- **Output**: A tuple containing the results of executed instructions.
- **Functions Called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.bits`](<#bits>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.add_modp`](<#add_modp>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.sub_modp`](<#sub_modp>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.mul_modp3`](<#mul_modp3>)
- **See also**: [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)  (Base Class)



# Functions

---
### bits<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.bits}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L615>)

Extracts a specified number of bits from an integer after shifting it right by a given number of positions.
- **Inputs**:
    - `n`: The integer from which to extract bits.
    - `b`: The number of bits to extract.
    - `s`: The number of positions to shift the integer to the right before extracting bits.
- **Logic and Control Flow**:
    - Shift the integer `n` to the right by `s` positions.
    - Create a bitmask by shifting 1 left by `b` positions and subtracting 1.
    - Apply the bitmask to the shifted integer using a bitwise AND operation to extract the desired bits.
- **Output**: An integer representing the extracted bits.


---
### rand\_int<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.rand_int}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L618>)

Generates a random integer with a specified number of bits.
- **Inputs**:
    - `w`: The number of bits for the random integer, default is 256.
- **Logic and Control Flow**:
    - Initialize variable `n` to 0.
    - Iterate over a range of `w` (default 256) to generate each bit of the random integer.
    - In each iteration, generate a random bit (0 or 1) using `random.randint(0, 1)`.
    - Shift the random bit to the left by `i` positions and combine it with `n` using bitwise OR.
    - Return the final value of `n` after the loop completes.
- **Output**: A random integer with `w` bits.


---
### ternary<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.ternary}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L624>)

Implements a ternary operation that returns an [`Expr`](<#expr>) object representing a conditional expression.
- **Inputs**:
    - `c`: A condition that determines which of the two values, `x` or `y`, to select.
    - `x`: The value to return if the condition `c` is true.
    - `y`: The value to return if the condition `c` is false.
- **Logic and Control Flow**:
    - Evaluates the condition `c` to decide whether to select `x` or `y`.
    - Creates and returns an [`Expr`](<#expr>) object with `x`, `y`, and `c` as arguments, representing a conditional expression.
- **Output**: An [`Expr`](<#expr>) object that represents a conditional expression using the ternary operator.
- **Functions Called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)


---
### ternary\_p<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.ternary_p}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L628>)

Selects between two values based on a condition using a ternary operation.
- **Inputs**:
    - `c`: A condition that determines which of the two values to select.
    - `x`: The value to return if the condition `c` is true.
    - `y`: The value to return if the condition `c` is false.
- **Logic and Control Flow**:
    - Evaluate the condition `c` to determine which value to select.
    - If `c` is true, assign `x` to `r`.
    - If `c` is false, assign `y` to `r`.
    - Return the value of `r`.
- **Output**: The selected value, either `x` or `y`, based on the condition `c`.


---
### mul\_modp<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.mul_modp}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L632>)

Performs modular multiplication of two integers under a given modulus.
- **Inputs**:
    - `x`: The first integer to multiply.
    - `y`: The second integer to multiply.
    - `p`: The modulus to use for the operation.
- **Logic and Control Flow**:
    - Calculate `p2` as twice the modulus `p`.
    - Compute the product `xy` of `x` and `y`.
    - Extract the lower 256 bits `l` and the higher 256 bits `h` from `xy`.
    - Initialize `m` with `l` and iteratively adjust `m` using [`ternary_p`](<#ternary_p>) to ensure it is less than `p2`.
    - Calculate `mm` as a scaled version of `h` and iteratively adjust `mm` using [`ternary_p`](<#ternary_p>) to ensure it is less than `p2`.
    - Add `mm` to `m` and iteratively adjust `m` using [`ternary_p`](<#ternary_p>) to ensure it is less than `p`.
- **Output**: The result of the modular multiplication of `x` and `y` under modulus `p`.
- **Functions Called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.bits`](<#bits>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.ternary_p`](<#ternary_p>)


---
### mul\_modp2<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.mul_modp2}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L659>)

Performs modular multiplication of two large integers using a specific algorithm and returns the result modulo a given prime.
- **Inputs**:
    - `x`: The first integer to multiply, expected to be a large number.
    - `y`: The second integer to multiply, expected to be a large number.
    - `p`: The prime number to use as the modulus for the operation.
- **Logic and Control Flow**:
    - Split `x` into two parts: `x0` (lower 128 bits) and `x1` (upper 127 bits).
    - Split `y` into two parts: `y0` (lower 128 bits) and `y1` (upper 127 bits).
    - Calculate `x0y0` as the product of `x0` and `y0`.
    - Calculate `x1y1` as the product of `x1` and `y1`.
    - Calculate `x0x1` as the sum of `x0` and `x1`, and `y0y1` as the sum of `y0` and `y1`.
    - Calculate `xy` as the product of `x0x1` and `y0y1`, considering only the lower 129 bits of each.
    - Calculate `C0`, `C1`, and `C2` as the lower 256, 258, and 256 bits of `x0y0`, `xy`, and `x1y1` respectively.
    - Calculate `C0C2` as the sum of `C0` and `C2`.
    - Calculate `C` by adding `C0`, a shifted and scaled version of `C2`, and a shifted version of the difference between `C1` and `C0C2`.
    - Split `C` into `Cl` (lower 255 bits) and `Ch` (upper 132 bits).
    - Calculate `Ch19` as a scaled version of `Ch` and add it to `Cl` to get `Cp`.
    - If `Cp` is greater than or equal to `p`, subtract `p` from `Cp`.
- **Output**: The result of the modular multiplication, which is an integer less than the prime `p`.
- **Functions Called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.bits`](<#bits>)


---
### mul\_modp3<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.mul_modp3}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L708>)

Performs modular multiplication of two large integers with a modulus, using bit manipulation and arithmetic operations.
- **Inputs**:
    - `x`: The first integer operand for multiplication.
    - `y`: The second integer operand for multiplication.
    - `p`: The modulus for the operation.
- **Logic and Control Flow**:
    - Extracts lower and upper bits of `x` and `y` using the [`bits`](<#bits>) function.
    - Calculates partial products `A`, `B`, `C`, and `D` using bit manipulation and multiplication.
    - Combines these partial products into `E` using bit shifts and additions.
    - Splits `E` into lower and higher parts `El` and `Eh`.
    - Combines `El` and `Eh` into `F` using bit shifts and additions.
    - Subtracts `p` from `F` if `F` is greater than or equal to `p` to ensure the result is within the modulus.
- **Output**: The result of the modular multiplication, which is an integer less than `p`.
- **Functions Called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.bits`](<#bits>)


---
### flip<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.flip}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L740>)

Flips the bits of a given integer `n` for a specified number of bits `b`.
- **Inputs**:
    - `n`: The integer whose bits will be flipped.
    - `b`: The number of bits to consider for flipping.
- **Logic and Control Flow**:
    - Initialize `nn` to 0 to store the result of the flipped bits.
    - Iterate over the range of `b` to process each bit position.
    - For each bit position, check if the least significant bit of `n` is 1 or 0.
    - If the least significant bit of `n` is 1, set `_` to 0; otherwise, set `_` to 1.
    - Shift `_` left by `i` positions and perform a bitwise OR with `nn` to update the result.
    - Right shift `n` by 1 to process the next bit in the next iteration.
    - Return the final value of `nn` after processing all `b` bits.
- **Output**: An integer representing the flipped bits of `n` for the specified number of bits `b`.


---
### mul\_modp4<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.mul_modp4}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L748>)

Performs modular multiplication of two large integers with a modulus, using a specific bit manipulation technique.
- **Inputs**:
    - `x`: The first integer operand for the multiplication.
    - `y`: The second integer operand for the multiplication.
    - `p`: The modulus for the operation.
- **Logic and Control Flow**:
    - Extracts lower and upper 128 bits of `x` and `y` into `x0`, `x1`, `y0`, and `y1` respectively.
    - Calculates `A` and `B` as the sum of `x0` with `x1` and `y0` with `y1`, respectively, and extracts 129 bits.
    - Calculates `C` as the product of `x0` and `y0`, and `D` as the product of `x1` and `y1`, extracting 256 and 254 bits respectively.
    - Calculates `M` as the product of `A` and `B`, extracting 258 bits.
    - Calculates `N` as a bit-shifted and summed version of `D`, extracting 260 bits.
    - Prints intermediate values `A`, `B`, `C`, `D`, `M`, and `N` for debugging purposes.
    - Calculates `E` using a combination of `C`, `N`, `M`, `C`, and `D` with bit shifts and arithmetic operations.
    - Prints the intermediate value `E` for debugging purposes.
    - Extracts lower 255 bits of `E` into `El` and upper bits into `Eh`.
    - Calculates `F` by adding `El` and a bit-shifted version of `Eh`.
    - Calculates `G` by subtracting `p` from `F` if `F` is greater than or equal to `p`.
- **Output**: Returns the result of the modular multiplication as an integer.
- **Functions Called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.bits`](<#bits>)


---
### kpow\_2k<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.kpow_2k}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L795>)

Computes the result of raising `x` to the power of `2^y` modulo `p` using repeated squaring.
- **Inputs**:
    - `x`: The base number to be exponentiated.
    - `y`: The exponent, which determines how many times `x` is squared.
    - `p`: The modulus used for the operation.
- **Logic and Control Flow**:
    - Iterates `y` times, squaring `x` in each iteration and applying the modulus `p` using the [`Expr`](<#expr>) class with the function 'mul_modp'.
    - Updates `x` with the result of each squaring operation.
- **Output**: Returns the final value of `x` after `y` squaring operations, each followed by a modulus `p` operation.
- **Functions Called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)


---
### kpow\_ed250<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.kpow_ed250}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L800>)

Computes a series of modular exponentiations and multiplications using the [`Expr`](<#expr>) class and returns specific intermediate results.
- **Inputs**:
    - `x`: The base integer for the exponentiation and multiplication operations.
    - `p`: The modulus integer used in the modular arithmetic operations.
- **Logic and Control Flow**:
    - Initialize `t0` as the result of `x` squared modulo `p`.
    - Compute `t00` as `t0` squared modulo `p`.
    - Compute `t1` as `t00` squared modulo `p`.
    - Compute `t2` as `x` multiplied by `t1` modulo `p`.
    - Compute `t3` as `t0` multiplied by `t2` modulo `p`.
    - Compute `t4` as `t3` squared modulo `p`.
    - Compute `t5` as `t2` multiplied by `t4` modulo `p`.
    - Compute `t6` by raising `t5` to the power of `2^5` modulo `p` using [`kpow_2k`](<#kpow_2k>).
    - Compute `t7` as `t6` multiplied by `t5` modulo `p`.
    - Compute `t8` by raising `t7` to the power of `2^10` modulo `p` using [`kpow_2k`](<#kpow_2k>).
    - Compute `t9` as `t8` multiplied by `t7` modulo `p`.
    - Compute `t10` by raising `t9` to the power of `2^20` modulo `p` using [`kpow_2k`](<#kpow_2k>).
    - Compute `t11` as `t10` multiplied by `t9` modulo `p`.
    - Compute `t12` by raising `t11` to the power of `2^10` modulo `p` using [`kpow_2k`](<#kpow_2k>).
    - Compute `t13` as `t12` multiplied by `t7` modulo `p`.
    - Compute `t14` by raising `t13` to the power of `2^50` modulo `p` using [`kpow_2k`](<#kpow_2k>).
    - Compute `t15` as `t14` multiplied by `t13` modulo `p`.
    - Compute `t16` by raising `t15` to the power of `2^100` modulo `p` using [`kpow_2k`](<#kpow_2k>).
    - Compute `t17` as `t16` multiplied by `t15` modulo `p`.
    - Compute `t18` by raising `t17` to the power of `2^50` modulo `p` using [`kpow_2k`](<#kpow_2k>).
    - Compute `t19` as `t18` multiplied by `t13` modulo `p`.
    - Return the tuple `(t0, t3, t19)` as the result.
- **Output**: A tuple containing three [`Expr`](<#expr>) objects: `t0`, `t3`, and `t19`, representing specific intermediate results of the computation.
- **Functions Called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.kpow_2k`](<#kpow_2k>)


---
### kpow\_ed255192<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.kpow_ed255192}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L825>)

Computes a specific power of an input using modular arithmetic and returns the result as an expression.
- **Inputs**:
    - `x`: The base value for the power computation.
    - `p`: The modulus value for the modular arithmetic operations.
- **Logic and Control Flow**:
    - Calls [`kpow_ed250`](<#kpow_ed250>) with `x` and `p` to compute intermediate values `t0`, `t3`, and `t19`.
    - Uses [`kpow_2k`](<#kpow_2k>) to raise `t19` to the power of 2^5 modulo `p`, resulting in `t20`.
    - Creates an [`Expr`](<#expr>) object `t21` to multiply `t20` and `t3` modulo `p`.
- **Output**: Returns an [`Expr`](<#expr>) object representing the result of the modular multiplication.
- **Functions Called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.kpow_ed250`](<#kpow_ed250>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.kpow_2k`](<#kpow_2k>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)


---
### kpow\_ed2551938<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.kpow_ed2551938}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L831>)

Computes a modular exponentiation using a specific sequence of operations for the Ed25519 curve.
- **Inputs**:
    - `x`: The base integer for the exponentiation.
    - `p`: The modulus for the modular arithmetic operations.
- **Logic and Control Flow**:
    - Calls the [`kpow_ed250`](<#kpow_ed250>) function with `x` and `p` to compute intermediate values `t0`, `t3`, and `t19`.
    - Uses the [`kpow_2k`](<#kpow_2k>) function to raise `t19` to the power of 2 modulo `p`, resulting in `t20`.
    - Creates an [`Expr`](<#expr>) object to compute the modular multiplication of `t20` and `t0` modulo `p`, resulting in `t21`.
- **Output**: Returns the result of the modular multiplication as an [`Expr`](<#expr>) object.
- **Functions Called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.kpow_ed250`](<#kpow_ed250>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.kpow_2k`](<#kpow_2k>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)


---
### kpow<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.kpow}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L838>)

Computes the modular exponentiation of `x` raised to the power `y` modulo `p` using a binary exponentiation method.
- **Inputs**:
    - `x`: The base number to be exponentiated.
    - `y`: The exponent to which the base `x` is raised.
    - `p`: The modulus used for the operation.
- **Logic and Control Flow**:
    - Initialize `a` as an [`Expr`](<#expr>) object with value 1, which will hold the result of the exponentiation.
    - Convert `y` into an [`Expr`](<#expr>) object and calculate its bit length `wy`.
    - Iterate over each bit of `y` from least significant to most significant (total `wy` iterations).
    - In each iteration, use a ternary operation to decide whether to multiply `a` by `x` or 1, based on the current bit of `y`.
    - Update `a` by multiplying it with the result of the ternary operation, using modular multiplication.
    - Square `x` and update it for the next iteration, using modular multiplication.
    - Right shift `y` by one bit to process the next bit in the next iteration.
    - Return the final value of `a` as the result of the modular exponentiation.
- **Output**: An [`Expr`](<#expr>) object representing the result of `x` raised to the power `y` modulo `p`.
- **Functions Called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr`](<#expr>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.Expr.eval`](<#expreval>)
    - [`firedancer/src/wiredancer/py/ed25519_lib.ternary`](<#ternary>)


---
### add\_modp<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.add_modp}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L849>)

Computes the sum of two integers modulo a third integer.
- **Inputs**:
    - `a`: The first integer to add.
    - `b`: The second integer to add.
    - `p`: The modulus to apply to the sum of a and b.
- **Logic and Control Flow**:
    - Calculate the sum of `a` and `b`.
    - Compute the result of the sum modulo `p`.
- **Output**: The result of `(a + b) % p`, which is the sum of `a` and `b` modulo `p`.


---
### sub\_modp<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.sub_modp}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L853>)

Computes the result of subtracting two numbers modulo a given modulus.
- **Inputs**:
    - `a`: The first integer operand.
    - `b`: The second integer operand.
    - `p`: The modulus to apply if the result of the subtraction is negative.
- **Logic and Control Flow**:
    - Check if `a` is greater than or equal to `b`.
    - If true, return the result of `a - b`.
    - If false, return the result of `a - b + p`.
- **Output**: The result of the subtraction `a - b`, adjusted by adding `p` if the result is negative.


---
### dsdp\_sel<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.dsdp_sel}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L859>)

Selects a value based on the bitwise AND operation of specific bits from two input integers.
- **Inputs**:
    - `sh2`: An integer from which the function extracts a specific bit for comparison.
    - `h`: An integer from which the function extracts a specific bit for comparison.
- **Logic and Control Flow**:
    - Extracts the 255th bit from `sh2` and assigns it to `b0`.
    - Extracts the 255th bit from `h` and assigns it to `b1`.
    - Performs a bitwise AND operation on `b0` and `b1`, storing the result in `b0b1`.
    - If `b0b1` is non-zero, returns 3.
    - If `b1` is non-zero, returns 2.
    - If `b0` is non-zero, returns 1.
    - If none of the above conditions are met, returns 0.
- **Output**: An integer value (0, 1, 2, or 3) based on the evaluation of the extracted bits.
- **Functions Called**:
    - [`firedancer/src/wiredancer/py/ed25519_lib.bits`](<#bits>)


---
### ternary\_dsdp\_x<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.ternary_dsdp_x}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L871>)

Selects and returns a value based on the input `sel` parameter.
- **Inputs**:
    - `sel`: An integer that determines which value to return.
    - `A`: A value to return if `sel` is 2.
    - `T`: A value to return if `sel` is not 0, 1, or 2.
- **Logic and Control Flow**:
    - Check if `sel` is 0; if true, return 0.
    - Check if `sel` is 1; if true, return the first element of `ref_ed25519.G`.
    - Check if `sel` is 2; if true, return `A`.
    - If none of the above conditions are met, return `T`.
- **Output**: Returns an integer or value based on the `sel` parameter.


---
### ternary\_dsdp\_y<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.ternary_dsdp_y}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L880>)

Selects and returns a value based on the input selector `sel`.
- **Inputs**:
    - `sel`: An integer selector that determines which value to return.
    - `A`: A value to return if `sel` is 2.
    - `T`: A value to return if `sel` is not 0, 1, or 2.
- **Logic and Control Flow**:
    - Check if `sel` is 0; if true, return 1.
    - Check if `sel` is 1; if true, return the second element of `ref_ed25519.G`.
    - Check if `sel` is 2; if true, return `A`.
    - If none of the above conditions are met, return `T`.
- **Output**: Returns an integer or value based on the input selector `sel`.


---
### ternary\_dsdp\_z<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.ternary_dsdp_z}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L889>)

Selects and returns a value based on the input selection parameter `sel`.
- **Inputs**:
    - `sel`: An integer that determines which value to return.
    - `A`: A value to return if `sel` is 2.
    - `T`: A value to return if `sel` is not 0, 1, or 2.
- **Logic and Control Flow**:
    - Check if `sel` is 0; if true, return 1.
    - Check if `sel` is 1; if true, return the third element of `ref_ed25519.G`.
    - Check if `sel` is 2; if true, return `A`.
    - If none of the above conditions are met, return `T`.
- **Output**: Returns an integer or a value from the inputs `A` or `T` based on the value of `sel`.


---
### ternary\_dsdp\_t<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.ternary_dsdp_t}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L898>)

Selects and returns a value based on the input selector `sel`.
- **Inputs**:
    - `sel`: An integer selector that determines which value to return.
    - `A`: A value to return if `sel` is 2.
    - `T`: A value to return if `sel` is not 0, 1, or 2.
- **Logic and Control Flow**:
    - Check if `sel` is 0; if true, return 0.
    - Check if `sel` is 1; if true, return the fourth element of `ref_ed25519.G`.
    - Check if `sel` is 2; if true, return `A`.
    - If none of the above conditions are met, return `T`.
- **Output**: Returns an integer or value based on the input selector `sel`.


---
### ed25519\_dsdp\_mul<!-- {{#callable:firedancer/src/wiredancer/py/ed25519_lib.ed25519_dsdp_mul}} -->
[View Source →](<../../../../../src/wiredancer/py/ed25519_lib.py#L912>)

Performs a double-scalar multiplication on elliptic curve points using the Ed25519 curve.
- **Inputs**:
    - `A`: A tuple representing a point on the Ed25519 curve.
    - `As`: An integer representing a scalar multiplier for point A.
    - `Gs`: An integer representing a scalar multiplier for the base point G.
    - `W_S`: An integer representing the number of iterations, default is 256.
- **Logic and Control Flow**:
    - Initialize Z as a point (0, 1, 1, 0) and double it using `ref_ed25519.point_add`.
    - Set G as the base point from `ref_ed25519` and compute T as the sum of A and G.
    - Iterate W_S times to perform the scalar multiplication.
    - In each iteration, compute the least significant bit of As and Gs to determine b0 and b1.
    - Shift As and Gs left by one bit to prepare for the next iteration.
    - Select the appropriate coordinates for Q based on the values of b0, b1, and b0b1 using ternary logic.
    - Add Z to itself and then add Q to Z using `ref_ed25519.point_add`.
- **Output**: Returns a tuple representing the resulting point on the Ed25519 curve after the double-scalar multiplication.
- **Functions Called**:
    - [`firedancer/src/wiredancer/py/ref_ed25519.point_add`](<ref_ed25519.py.md#point_add>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)