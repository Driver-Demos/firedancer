<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Memory-mapped I/O operations for the Vinyl streaming system, including read, write, and synchronization functions.

# Purpose
The code defines a memory-mapped I/O interface for a vinyl data stream, which is part of a larger system for handling data streams in a memory-efficient manner. The primary structure, `fd_vinyl_io_mm_t`, represents a memory-mapped I/O object that manages a block of memory used for reading and writing data in a cyclic manner. This structure includes fields for managing the memory-mapped region, such as `dev`, `dev_base`, and `dev_sz`, which define the memory region and its size. It also includes a queue for read operations, managed by `rd_head` and `rd_tail_next`.

The code provides several static functions that implement operations on the memory-mapped I/O object. These include [`fd_vinyl_io_mm_read_imm`](<#fd_vinyl_io_mm_read_imm>) and [`fd_vinyl_io_mm_read`](<#fd_vinyl_io_mm_read>) for reading data, [`fd_vinyl_io_mm_append`](<#fd_vinyl_io_mm_append>) for appending data, and [`fd_vinyl_io_mm_commit`](<#fd_vinyl_io_mm_commit>) for committing changes. Other functions like [`fd_vinyl_io_mm_poll`](<#fd_vinyl_io_mm_poll>), [`fd_vinyl_io_mm_hint`](<#fd_vinyl_io_mm_hint>), and [`fd_vinyl_io_mm_alloc`](<#fd_vinyl_io_mm_alloc>) provide additional functionality for managing the I/O operations. The [`fd_vinyl_io_mm_init`](<#fd_vinyl_io_mm_init>) function initializes the memory-mapped I/O object, setting up the necessary memory regions and validating input parameters. The code also includes mechanisms for handling errors and ensuring data alignment, which are critical for maintaining the integrity of the data stream.
# Imports and Dependencies

---
- `fd_vinyl_io.h`


# Global Variables

---
### fd\_vinyl\_io\_mm\_impl
- **Type**: ``fd_vinyl_io_impl_t` array`
- **Description**: Contains function pointers for memory-mapped I/O operations in the `fd_vinyl_io_mm` structure. These functions handle various operations such as reading, writing, polling, and managing memory for a memory-mapped I/O system.
- **Use**: Used to implement the memory-mapped I/O interface by providing specific function implementations for each operation.


# Data Structures

---
### fd\_vinyl\_io\_mm\_rd\_t
- **Type**: ``struct``
- **Members**:
    - ``ctx``: Must mirror `fd_vinyl_io_rd_t`.
    - ``seq``: Must mirror `fd_vinyl_io_rd_t`.
    - ``dst``: Must mirror `fd_vinyl_io_rd_t`.
    - ``sz``: Must mirror `fd_vinyl_io_rd_t`.
    - ``next``: Next element in mm rd queue.
- **Description**: Defines a structure for managing read operations in a memory-mapped I/O queue, with fields that mirror those in `fd_vinyl_io_rd_t` and a pointer to the next element in the queue.


---
### fd\_vinyl\_io\_mm\_rd
- **Type**: ``struct``
- **Members**:
    - ``ctx``: Mirrors the context of `fd_vinyl_io_rd_t`.
    - ``seq``: Mirrors the sequence number of `fd_vinyl_io_rd_t`.
    - ``dst``: Mirrors the destination pointer of `fd_vinyl_io_rd_t`.
    - ``sz``: Mirrors the size of `fd_vinyl_io_rd_t`.
    - ``next``: Points to the next element in the memory-mapped read queue.
- **Description**: Defines a node in a memory-mapped read queue for the `fd_vinyl_io_mm` structure, with fields that mirror those in `fd_vinyl_io_rd_t` and a pointer to the next node in the queue.


---
### fd\_vinyl\_io\_mm
- **Type**: ``struct``
- **Members**:
    - ``base``: An array of one `fd_vinyl_io_t` structure, serving as the base for the memory-mapped I/O operations.
    - ``dev``: A pointer to the memory-mapped I/O memory region.
    - ``dev_sync``: An offset to the bstream's sync block, aligned to a multiple of `BLOCK_SZ`.
    - ``dev_base``: An offset to the first block, aligned to a multiple of `BLOCK_SZ`.
    - ``dev_sz``: The byte size of the block store, aligned to a multiple of `BLOCK_SZ`.
    - ``rd_head``: A pointer to the head of the read queue.
    - ``rd_tail_next``: A pointer to the next element of the queue tail or to `rd_head` if the queue is empty.
    - ``sync``: An array of one `fd_vinyl_bstream_block_t` structure used for synchronization.
- **Description**: Manages memory-mapped I/O operations for a block stream, including synchronization, queue management, and memory offsets. It uses a base structure for I/O operations, a memory region for data storage, and maintains offsets and sizes for block management. The structure also handles a read queue with pointers to manage the queue's head and tail.


---
### fd\_vinyl\_io\_mm\_t
- **Type**: ``struct``
- **Members**:
    - ``base``: An array of `fd_vinyl_io_t` that serves as the base structure.
    - ``dev``: A pointer to the memory-mapped I/O memory region.
    - ``dev_sync``: An offset to the bstream's sync block, aligned to a block size multiple.
    - ``dev_base``: An offset to the first block, aligned to a block size multiple.
    - ``dev_sz``: The byte size of the block store, aligned to a block size multiple.
    - ``rd_head``: A pointer to the head of the read queue.
    - ``rd_tail_next``: A pointer to the next element in the read queue or the head if the queue is empty.
    - ``sync``: An array of `fd_vinyl_bstream_block_t` used for synchronization.
- **Description**: `fd_vinyl_io_mm_t` is a structure that represents a memory-mapped I/O interface for handling vinyl data streams. It includes pointers and offsets for managing memory regions, synchronization blocks, and read queues. The structure is designed to facilitate efficient data streaming and synchronization in a block-aligned manner.


# Functions

---
### fd\_vinyl\_io\_mm\_read\_imm<!-- {{#callable:fd_vinyl_io_mm_read_imm}} -->
[View Source →](<../../../../../src/vinyl/io/fd_vinyl_io_mm.c#L28>)

Reads a specified number of bytes from a memory-mapped I/O region into a destination buffer, handling alignment and boundary conditions.
- **Inputs**:
    - ``io``: A pointer to an `fd_vinyl_io_t` structure, which must be non-NULL.
    - ``seq0``: The starting sequence number for the read operation.
    - ``_dst``: A pointer to the destination buffer where the data will be read into.
    - ``sz``: The size in bytes of the data to read.
- **Logic and Control Flow**:
    - Check if `sz` is zero; if so, return immediately as there is nothing to read.
    - Cast `io` to `fd_vinyl_io_mm_t` and initialize local variables for sequence numbers and destination buffer.
    - Check for alignment and validity of `seq0`, `dst`, and `sz`. Also, ensure the read request is within the valid sequence range (`seq_past` to `seq_present`).
    - If any checks fail, log a critical error and return.
    - Calculate the offset in the device memory (`dev_off`) using `seq0` and the device size (`dev_sz`).
    - Determine the number of bytes to read (`rsz`) as the minimum of `sz` and the remaining bytes in the device from `dev_off`.
    - Copy `rsz` bytes from the device memory to the destination buffer.
    - If there are remaining bytes to read after reaching the end of the device memory, wrap around and copy the remaining bytes from the start of the device memory.
- **Output**: No return value; the function writes the read data directly into the provided destination buffer.


---
### fd\_vinyl\_io\_mm\_read<!-- {{#callable:fd_vinyl_io_mm_read}} -->
[View Source →](<../../../../../src/vinyl/io/fd_vinyl_io_mm.c#L76>)

Processes a read request from a memory-mapped I/O stream, ensuring alignment and sequence validity, and performs the read operation with potential wrap-around handling.
- **Inputs**:
    - ``io``: A pointer to an `fd_vinyl_io_t` structure, representing the I/O context.
    - ``_rd``: A pointer to an `fd_vinyl_io_rd_t` structure, representing the read request details.
- **Logic and Control Flow**:
    - Cast `io` to `fd_vinyl_io_mm_t` and `_rd` to `fd_vinyl_io_mm_rd_t` to access memory-mapped I/O specific fields.
    - Initialize the read request by setting `rd->next` to `NULL` and updating the read queue pointers in `mm`.
    - Extract `seq0`, `dst`, and `sz` from the read request structure `rd`.
    - If `sz` is zero, return immediately as there is nothing to read.
    - Calculate `seq1` as the end of the read sequence and retrieve `seq_past` and `seq_present` from the base structure.
    - Check for alignment and sequence validity using helper functions and log a critical error if any checks fail.
    - Calculate the device offset `dev_off` using `seq0` and the device size `dev_sz`.
    - Determine the read size `rsz` as the minimum of `sz` and the remaining space in the device from `dev_off`.
    - Perform the read operation using `memcpy` from the device memory to `dst`, handling potential wrap-around if `sz` exceeds `rsz`.
- **Output**: No explicit return value; the function modifies the read request structure and performs the read operation.


---
### fd\_vinyl\_io\_mm\_poll<!-- {{#callable:fd_vinyl_io_mm_poll}} -->
[View Source →](<../../../../../src/vinyl/io/fd_vinyl_io_mm.c#L130>)

Polls the memory-mapped I/O read queue and retrieves the next read request if available.
- **Inputs**:
    - ``io``: A pointer to a `fd_vinyl_io_t` structure, which must be non-NULL.
    - ``_rd``: A pointer to a pointer of type `fd_vinyl_io_rd_t`, where the function will store the next read request if available.
    - ``flags``: An integer representing flags, which is currently unused in the function.
- **Logic and Control Flow**:
    - Cast `io` to a `fd_vinyl_io_mm_t` pointer and assign it to `mm`.
    - Retrieve the head of the read queue from `mm->rd_head` and assign it to `rd`.
    - Check if `rd` is NULL; if so, set `*_rd` to NULL and return `FD_VINYL_ERR_EMPTY`.
    - Retrieve the next read request from `rd->next` and update `mm->rd_head` to this next request.
    - Update `mm->rd_tail_next` to point to the next tail or the head if the queue is empty.
    - Set `*_rd` to the current read request `rd` and return `FD_VINYL_SUCCESS`.
- **Output**: Returns `FD_VINYL_SUCCESS` if a read request is available and `FD_VINYL_ERR_EMPTY` if the queue is empty.


---
### fd\_vinyl\_io\_mm\_append<!-- {{#callable:fd_vinyl_io_mm_append}} -->
[View Source →](<../../../../../src/vinyl/io/fd_vinyl_io_mm.c#L154>)

Appends data to a memory-mapped I/O device, updating sequence numbers and handling wrap-around if necessary.
- **Inputs**:
    - ``io``: A pointer to an `fd_vinyl_io_t` structure, which must be non-NULL.
    - ``_src``: A pointer to the source data to append, which must be non-NULL and aligned to `FD_VINYL_BSTREAM_BLOCK_SZ`.
    - ``sz``: The size of the data to append, which must be aligned to `FD_VINYL_BSTREAM_BLOCK_SZ` and not exceed the available capacity.
- **Logic and Control Flow**:
    - Cast `io` to `fd_vinyl_io_mm_t` and `_src` to `uchar const *`.
    - Retrieve and validate sequence numbers and device parameters from `mm`.
    - Check for invalid input conditions: NULL source, misaligned source or size, or insufficient device capacity.
    - Log a critical error if any input validation fails.
    - Calculate the offset in the device where the data will be written, updating `seq_future`.
    - Write data to the device, handling wrap-around if the end of the device is reached.
    - Return the initial sequence number before the append operation.
- **Output**: Returns the sequence number at which the append operation starts.


---
### fd\_vinyl\_io\_mm\_commit<!-- {{#callable:fd_vinyl_io_mm_commit}} -->
[View Source →](<../../../../../src/vinyl/io/fd_vinyl_io_mm.c#L199>)

Commits the current state by updating the sequence present to match the sequence future and resets the scratchpad usage.
- **Inputs**:
    - ``io``: A pointer to a `fd_vinyl_io_t` structure, which must be non-NULL.
    - ``flags``: An integer representing flags, which is not used in this function.
- **Logic and Control Flow**:
    - Cast the `io` pointer to a `fd_vinyl_io_mm_t` pointer named `mm`.
    - Set `mm->base->seq_present` to `mm->base->seq_future`, effectively committing the future sequence as the present sequence.
    - Reset `mm->base->spad_used` to 0, indicating no scratchpad space is currently used.
    - Return `FD_VINYL_SUCCESS` to indicate successful completion.
- **Output**: Returns `FD_VINYL_SUCCESS`, indicating the commit operation was successful.


---
### fd\_vinyl\_io\_mm\_hint<!-- {{#callable:fd_vinyl_io_mm_hint}} -->
[View Source →](<../../../../../src/vinyl/io/fd_vinyl_io_mm.c#L211>)

Checks if a given size is aligned and fits within the available device capacity, returning the future sequence number if valid.
- **Inputs**:
    - ``io``: A pointer to an `fd_vinyl_io_t` structure, which must be non-NULL.
    - ``sz``: The size to check for alignment and capacity constraints.
- **Logic and Control Flow**:
    - Cast `io` to `fd_vinyl_io_mm_t` and store it in `mm`.
    - Retrieve `seq_future`, `seq_ancient`, and `dev_sz` from `mm`.
    - If `sz` is zero, return `seq_future`.
    - Check if `sz` is aligned to `FD_VINYL_BSTREAM_BLOCK_SZ` and if it fits within the available device capacity (`dev_sz - (seq_future - seq_ancient)`).
    - If `sz` is misaligned or exceeds capacity, log a critical error and terminate.
    - Return `seq_future`.
- **Output**: Returns the future sequence number (`seq_future`) from the `fd_vinyl_io_mm_t` structure.


---
### fd\_vinyl\_io\_mm\_alloc<!-- {{#callable:fd_vinyl_io_mm_alloc}} -->
[View Source →](<../../../../../src/vinyl/io/fd_vinyl_io_mm.c#L228>)

Allocates memory from a scratchpad within a memory-mapped I/O context, ensuring alignment and size constraints are met.
- **Inputs**:
    - ``io``: A pointer to an `fd_vinyl_io_t` structure, which must be non-NULL.
    - ``sz``: The size of the memory to allocate, in bytes.
    - ``flags``: Flags that may influence the allocation behavior, passed to [`fd_vinyl_io_mm_commit`](<#fd_vinyl_io_mm_commit>) if needed.
- **Logic and Control Flow**:
    - Cast `io` to `fd_vinyl_io_mm_t` and check if `sz` is zero; if so, return the current position in the scratchpad.
    - Check if `sz` is aligned to `FD_VINYL_BSTREAM_BLOCK_SZ` and if `sz` is less than or equal to `spad_max`; log a critical error if not.
    - Check if there is enough space in the scratchpad for `sz`; if not, commit the current scratchpad and reset `spad_used` to zero.
    - Update `spad_used` to reflect the newly allocated space.
    - Return a pointer to the allocated memory within the scratchpad.
- **Output**: A pointer to the allocated memory within the scratchpad, or `NULL` if allocation fails due to insufficient space after a commit.
- **Functions Called**:
    - [`fd_vinyl_io_mm_commit`](<#fd_vinyl_io_mm_commit>)


---
### fd\_vinyl\_io\_mm\_copy<!-- {{#callable:fd_vinyl_io_mm_copy}} -->
[View Source →](<../../../../../src/vinyl/io/fd_vinyl_io_mm.c#L252>)

Copies a specified size of data from a source sequence to a destination sequence in a memory-mapped I/O device, handling alignment and capacity constraints.
- **Inputs**:
    - ``io``: A pointer to an `fd_vinyl_io_t` structure, which must be non-NULL.
    - ``seq_src0``: The starting sequence number of the source data to copy.
    - ``sz``: The size of the data to copy, in bytes.
- **Logic and Control Flow**:
    - Cast `io` to `fd_vinyl_io_mm_t` and retrieve various sequence and device parameters.
    - Check if `sz` is zero; if so, return `seq_future`.
    - Calculate `seq_src1` as `seq_src0 + sz`.
    - Validate input arguments for alignment, sequence range, and capacity constraints.
    - If any validation fails, log a critical error and exit.
    - If `sz` exceeds available scratch pad space, commit current data and reset `spad_used`.
    - Allocate buffer space from the scratch pad.
    - Update `seq_future` to reflect the new data size.
    - Iteratively copy data from the source to the destination, handling device wrap-around and buffer space constraints.
    - Return the updated sequence number `seq`.
- **Output**: Returns the updated sequence number after the copy operation.
- **Functions Called**:
    - [`fd_vinyl_io_mm_commit`](<#fd_vinyl_io_mm_commit>)


---
### fd\_vinyl\_io\_mm\_forget<!-- {{#callable:fd_vinyl_io_mm_forget}} -->
[View Source →](<../../../../../src/vinyl/io/fd_vinyl_io_mm.c#L323>)

Updates the `seq_past` field of the `fd_vinyl_io_mm_t` structure to the specified sequence number after validating the input.
- **Inputs**:
    - ``io``: A pointer to an `fd_vinyl_io_t` structure, which must be non-NULL.
    - ``seq``: The sequence number to which the `seq_past` field should be updated.
- **Logic and Control Flow**:
    - Cast the `io` pointer to an `fd_vinyl_io_mm_t` pointer named `mm`.
    - Retrieve `seq_past`, `seq_present`, and `seq_future` from `mm->base`.
    - Check if `seq` is aligned with `FD_VINYL_BSTREAM_BLOCK_SZ` and within the bounds of `seq_past` and `seq_present`.
    - Ensure there are no ongoing reads (`mm->rd_head` is NULL) and no uncommitted blocks (`seq_present` equals `seq_future`).
    - If any validation fails, log a critical error with details about the failure.
    - If all checks pass, update `mm->base->seq_past` to `seq`.
- **Output**: No return value; the function updates the `seq_past` field of the `fd_vinyl_io_mm_t` structure.


---
### fd\_vinyl\_io\_mm\_rewind<!-- {{#callable:fd_vinyl_io_mm_rewind}} -->
[View Source →](<../../../../../src/vinyl/io/fd_vinyl_io_mm.c#L355>)

Adjusts the sequence numbers in the `fd_vinyl_io_mm_t` structure to rewind the sequence to a specified point, ensuring alignment and checking for ongoing operations.
- **Inputs**:
    - ``io``: A pointer to a `fd_vinyl_io_t` structure, which must be non-NULL.
    - ``seq``: The sequence number to which the operation should rewind.
- **Logic and Control Flow**:
    - Cast `io` to `fd_vinyl_io_mm_t` and ensure it is non-NULL.
    - Retrieve current sequence numbers: `seq_ancient`, `seq_past`, `seq_present`, and `seq_future`.
    - Check for misalignment of `seq`, if `seq` is greater than `seq_present`, if there are ongoing reads (`rd_head`), or if `seq_present` is not equal to `seq_future`.
    - Log a critical error and exit if any of the above checks fail.
    - Update `seq_ancient`, `seq_past`, `seq_present`, and `seq_future` to the new `seq` value, ensuring they do not exceed their previous values.
- **Output**: No return value; modifies the sequence numbers in the `fd_vinyl_io_mm_t` structure.


---
### fd\_vinyl\_io\_mm\_sync<!-- {{#callable:fd_vinyl_io_mm_sync}} -->
[View Source →](<../../../../../src/vinyl/io/fd_vinyl_io_mm.c#L387>)

Synchronizes the memory-mapped I/O state by updating sequence numbers and computing a hash for the sync block.
- **Inputs**:
    - ``io``: A pointer to a `fd_vinyl_io_t` structure, which must be non-NULL.
    - ``flags``: An integer representing flags, which is not used in this function.
- **Logic and Control Flow**:
    - Cast `io` to `fd_vinyl_io_mm_t` and store it in `mm`.
    - Retrieve `seed`, `seq_past`, `seq_present`, `dev`, and `dev_sync` from `mm->base` and `mm`.
    - Assign `mm->sync` to `block`.
    - Update `block->sync.seq_past` and `block->sync.seq_present` with `seq_past` and `seq_present`.
    - Set `block->sync.hash_trail` and `block->sync.hash_blocks` to 0.
    - Call `fd_vinyl_bstream_block_hash` with `seed` and `block` to compute the hash, which updates `block->sync.hash_trail`.
    - Copy the contents of `block` to the memory location `dev + dev_sync`.
    - Update `mm->base->seq_ancient` to `seq_past`.
    - Return `FD_VINYL_SUCCESS`.
- **Output**: Returns `FD_VINYL_SUCCESS` to indicate successful synchronization.


---
### fd\_vinyl\_io\_mm\_fini<!-- {{#callable:fd_vinyl_io_mm_fini}} -->
[View Source →](<../../../../../src/vinyl/io/fd_vinyl_io_mm.c#L418>)

Finalizes the memory-mapped I/O operations for a `fd_vinyl_io_t` object, logging warnings if there are outstanding reads or uncommitted blocks.
- **Inputs**:
    - `io`: A pointer to a `fd_vinyl_io_t` object, which must be non-NULL.
- **Logic and Control Flow**:
    - Cast the `io` pointer to a `fd_vinyl_io_mm_t` pointer.
    - Retrieve `seq_present` and `seq_future` from the `base` structure of `mm`.
    - Check if `rd_head` is non-NULL, indicating outstanding reads, and log a warning if true.
    - Check if `seq_present` is not equal to `seq_future`, indicating uncommitted blocks, and log a warning if true.
    - Return the `io` pointer.
- **Output**: Returns the original `io` pointer.


---
### fd\_vinyl\_io\_mm\_align<!-- {{#callable:fd_vinyl_io_mm_align}} -->
[View Source →](<../../../../../src/vinyl/io/fd_vinyl_io_mm.c#L448>)

Returns the alignment requirement of the `fd_vinyl_io_mm_t` structure.
- **Inputs**: None
- **Logic and Control Flow**:
    - Calls the `alignof` operator on the `fd_vinyl_io_mm_t` type to determine its alignment requirement.
    - Returns the result of the `alignof` operation.
- **Output**: The function returns an `ulong` representing the alignment requirement of the `fd_vinyl_io_mm_t` structure.


---
### fd\_vinyl\_io\_mm\_footprint<!-- {{#callable:fd_vinyl_io_mm_footprint}} -->
[View Source →](<../../../../../src/vinyl/io/fd_vinyl_io_mm.c#L453>)

Calculates the memory footprint required for a `fd_vinyl_io_mm_t` structure and a specified scratchpad size.
- **Inputs**:
    - `spad_max`: The maximum size of the scratchpad memory in bytes, which must be greater than 0, less than 2^63, and aligned to `FD_VINYL_BSTREAM_BLOCK_SZ`.
- **Logic and Control Flow**:
    - Checks if `spad_max` is greater than 0, less than 2^63, and aligned to `FD_VINYL_BSTREAM_BLOCK_SZ` using `fd_ulong_is_aligned`.
    - If any of the conditions are not met, returns 0.
    - If all conditions are met, calculates and returns the sum of the size of `fd_vinyl_io_mm_t` and `spad_max`.
- **Output**: Returns the total memory footprint in bytes as an unsigned long integer, or 0 if the input conditions are not met.


---
### fd\_vinyl\_io\_mm\_init<!-- {{#callable:fd_vinyl_io_mm_init}} -->
[View Source →](<../../../../../src/vinyl/io/fd_vinyl_io_mm.c#L460>)

Initializes a memory-mapped I/O structure for a vinyl bstream, handling both new and existing streams.
- **Inputs**:
    - `mem`: Pointer to the memory region to initialize as a `fd_vinyl_io_mm_t` structure.
    - `spad_max`: Maximum size of the scratchpad memory in bytes.
    - `dev`: Pointer to the device memory region for the bstream.
    - `dev_sz`: Size of the device memory region in bytes.
    - `reset`: Flag indicating whether to reset and start a new bstream (non-zero) or resume an existing one (zero).
    - `info`: Pointer to additional information to store in the sync block, used only if `reset` is non-zero.
    - `info_sz`: Size of the additional information in bytes, used only if `reset` is non-zero.
    - `io_seed`: Seed value for initializing the I/O structure, used only if `reset` is non-zero.
- **Logic and Control Flow**:
    - Check if `mem` is NULL or misaligned, and return NULL if so.
    - Calculate the footprint using [`fd_vinyl_io_mm_footprint`](<#fd_vinyl_io_mm_footprint>) and return NULL if it is zero.
    - Check if `dev` is NULL or misaligned, and return NULL if so.
    - Validate `dev_sz` against minimum size, maximum size, and alignment, returning NULL if invalid.
    - If `reset` is non-zero, validate `info` and `info_sz`, returning NULL if invalid.
    - Zero out the memory region pointed to by `mem` using `memset`.
    - Initialize the `fd_vinyl_io_mm_t` structure fields, including setting up the sync block and sequence numbers.
    - If `reset` is non-zero, write the initial sync block and call [`fd_vinyl_io_mm_sync`](<#fd_vinyl_io_mm_sync>) to synchronize.
    - If `reset` is zero, read and validate the existing sync block, updating fields accordingly.
    - Log the configuration details using `FD_LOG_NOTICE`.
    - Return a pointer to the base of the initialized `fd_vinyl_io_mm_t` structure.
- **Output**: Returns a pointer to the initialized `fd_vinyl_io_t` structure, or NULL if initialization fails.
- **Functions Called**:
    - [`fd_vinyl_io_mm_align`](<#fd_vinyl_io_mm_align>)
    - [`fd_vinyl_io_mm_footprint`](<#fd_vinyl_io_mm_footprint>)
    - [`fd_vinyl_io_mm_sync`](<#fd_vinyl_io_mm_sync>)


---
### fd\_vinyl\_mmio<!-- {{#callable:fd_vinyl_mmio}} -->
[View Source →](<../../../../../src/vinyl/io/fd_vinyl_io_mm.c#L640>)

Returns a pointer to the memory-mapped I/O region if the I/O type is `FD_VINYL_IO_TYPE_MM`, otherwise returns `NULL`.
- **Inputs**:
    - ``io``: A pointer to an `fd_vinyl_io_t` structure, which represents the I/O context.
- **Logic and Control Flow**:
    - Check if the `type` field of the `io` structure is equal to `FD_VINYL_IO_TYPE_MM`.
    - If the type is not `FD_VINYL_IO_TYPE_MM`, return `NULL`.
    - Cast the `io` pointer to an `fd_vinyl_io_mm_t` pointer.
    - Return the sum of the `dev` pointer and `dev_base` offset from the `fd_vinyl_io_mm_t` structure.
- **Output**: A pointer to the memory-mapped I/O region, or `NULL` if the I/O type is not `FD_VINYL_IO_TYPE_MM`.


---
### fd\_vinyl\_mmio\_sz<!-- {{#callable:fd_vinyl_mmio_sz}} -->
[View Source →](<../../../../../src/vinyl/io/fd_vinyl_io_mm.c#L647>)

Returns the size of the memory-mapped I/O region if the I/O type is memory-mapped, otherwise returns 0.
- **Inputs**:
    - ``io``: A pointer to an `fd_vinyl_io_t` structure, which represents the I/O context.
- **Logic and Control Flow**:
    - Check if the `type` field of the `io` structure is equal to `FD_VINYL_IO_TYPE_MM` (indicating a memory-mapped I/O type).
    - If the type is not `FD_VINYL_IO_TYPE_MM`, return 0.
    - If the type is `FD_VINYL_IO_TYPE_MM`, cast `io` to `fd_vinyl_io_mm_t` and return the `dev_sz` field, which represents the size of the memory-mapped I/O region.
- **Output**: Returns an `ulong` representing the size of the memory-mapped I/O region, or 0 if the I/O type is not memory-mapped.



---
Made with ❤️ by [Driver](https://www.driver.ai/)