<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines a seccomp filter policy for XDP tiles, generated by a script, to control system call access.

# Purpose
The code is a C header file that defines a seccomp (secure computing mode) filter policy for a specific application environment. It is generated automatically and should not be edited manually. The file includes necessary headers for seccomp and BPF (Berkeley Packet Filter) operations, and it defines architecture-specific constants to ensure compatibility with the runtime environment. The primary function, [`populate_sock_filter_policy_fd_xdp_tile`](<#populate_sock_filter_policy_fd_xdp_tile>), initializes a BPF filter array with 45 instructions. These instructions enforce security policies by allowing or denying specific system calls based on predefined conditions.

The filter checks the architecture and various system calls such as `write`, `fsync`, `sendto`, `recvmsg`, and `getsockopt`. It uses BPF statements and jumps to evaluate syscall numbers and arguments, allowing or killing processes based on the evaluation. The filter is designed to allow certain operations only if they meet specific criteria, such as matching file descriptors or message flags. The function `fd_memcpy` is used to copy the filter instructions into the provided output buffer. This header file is intended to be included in other C source files where the seccomp policy is applied to enhance security by restricting the system calls that a process can make.
# Imports and Dependencies

---
- `../../../../../src/util/fd_util_base.h`
- `linux/audit.h`
- `linux/capability.h`
- `linux/filter.h`
- `linux/seccomp.h`
- `linux/bpf.h`
- `sys/syscall.h`
- `signal.h`
- `stddef.h`


# Global Variables

---
### sock\_filter\_policy\_fd\_xdp\_tile\_instr\_cnt
- **Type**: ``unsigned int``
- **Description**: Defines the number of instructions in the socket filter policy for XDP (eXpress Data Path) tile. This constant is used to ensure that the filter array has the correct number of elements.
- **Use**: Used to verify the size of the filter array in the `populate_sock_filter_policy_fd_xdp_tile` function.


# Functions

---
### populate\_sock\_filter\_policy\_fd\_xdp\_tile<!-- {{#callable:populate_sock_filter_policy_fd_xdp_tile}} -->
[View Source →](<../../../../../../../src/disco/net/xdp/generated/fd_xdp_tile_seccomp.h#L26>)

Populates a `sock_filter` array with a predefined set of BPF instructions to enforce a seccomp policy for specific system calls.
- **Inputs**:
    - `out_cnt`: The number of elements in the `out` array, which must be at least 45.
    - `out`: A pointer to a `sock_filter` array where the BPF instructions will be copied.
    - `logfile_fd`: The file descriptor for the log file, used in syscall checks.
    - `xsk_fd`: The file descriptor for the XDP socket, used in syscall checks.
    - `lo_xsk_fd`: The file descriptor for the loopback XDP socket, used in syscall checks.
- **Logic and Control Flow**:
    - Check if `out_cnt` is at least 45 using `FD_TEST` macro.
    - Define a `sock_filter` array `filter` with 45 BPF instructions.
    - The BPF instructions check the architecture and syscall numbers, allowing or killing processes based on specific conditions.
    - For each syscall, load the syscall number and arguments, then perform conditional jumps to allow or kill the process.
    - Copy the `filter` array to the `out` array using `fd_memcpy`.
- **Output**: The function does not return a value; it modifies the `out` array in place.



---
Made with ❤️ by [Driver](https://www.driver.ai/)