<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Builder for `fd_topo` with functions to create and manage topology components like tiles and links.

# Purpose
The code is a C header file that defines a set of functions and macros for building and managing a topology using the `fd_topo` structure. It provides a collection of functions to create and manipulate various components of a topology, such as workspaces, objects, tiles, and links. The header file includes definitions for constants like `FD_TOPOB_UNPOLLED`, `FD_TOPOB_POLLED`, `FD_TOPOB_UNRELIABLE`, and `FD_TOPOB_RELIABLE`, which are used to specify the polling and reliability characteristics of links within the topology.

The primary functions in this header file include [`fd_topob_new`](<#fd_topob_new>) for initializing a new topology, [`fd_topob_wksp`](<#fd_topob_wksp>) for adding workspaces, [`fd_topob_obj`](<#fd_topob_obj>) for adding objects, and [`fd_topob_tile`](<#fd_topob_tile>) for adding tiles. It also includes functions for defining relationships between tiles and objects, such as [`fd_topob_tile_uses`](<#fd_topob_tile_uses>), and for managing links with [`fd_topob_link`](<#fd_topob_link>), [`fd_topob_tile_in`](<#fd_topob_tile_in>), and [`fd_topob_tile_out`](<#fd_topob_tile_out>). The [`fd_topob_auto_layout`](<#fd_topob_auto_layout>) function attempts to automatically assign tiles to CPUs, and [`fd_topob_finish`](<#fd_topob_finish>) finalizes the topology setup. This header file is intended to be included in other C source files to provide a structured way to build and manage complex topologies.
# Imports and Dependencies

---
- `../../disco/topo/fd_topo.h`


# Function Declarations (Public API)

---
### fd\_topob\_new<!-- {{#callable_declaration:fd_topob_new}} -->
[View Source →](<../../../../../src/disco/topo/fd_topob.h#L25>)

Initialize a new topology at a specified memory location.
- **Description**: Use this function to create a new, empty topology structure at a specified memory address. The function requires a valid memory address and an application name. The topology will be initialized with default settings and no tiles, objects, or links. Ensure the memory address is properly aligned for `fd_topo_t` and that the application name does not exceed the maximum allowed length. If these conditions are not met, the function will return `NULL` and log a warning.
- **Inputs**:
    - `mem`: A pointer to the memory location where the topology will be initialized. Must not be null and must be aligned to the requirements of `fd_topo_t`. If invalid, the function returns `NULL`.
    - `app_name`: A string representing the application name. Must not exceed the maximum length defined for `app_name` in `fd_topo_t`. If the length is exceeded, the function logs an error and returns `NULL`.
- **Output**: Returns a pointer to the initialized `fd_topo_t` structure at the specified memory location, or `NULL` if initialization fails due to invalid input.
- **See Also**: [`fd_topob_new`](<fd_topob.c.md#fd_topob_new>)  (Implementation)


---
### fd\_topob\_wksp<!-- {{#callable_declaration:fd_topob_wksp}} -->
[View Source →](<../../../../../src/disco/topo/fd_topob.h#L39>)

Add a workspace with a unique name to the topology.
- **Description**: Use this function to add a new workspace to an existing topology. The workspace name must be unique within the topology, and the function will return an error if the name is too long or if the maximum number of workspaces has been reached. Ensure that the `topo` parameter is a valid pointer to an initialized topology and that `name` is a non-empty string. This function increments the workspace count in the topology and assigns an ID to the new workspace.
- **Inputs**:
    - `topo`: A pointer to an `fd_topo_t` structure representing the topology. Must not be null and must point to a valid, initialized topology.
    - `name`: A constant character pointer representing the name of the workspace. Must not be null, must not be an empty string, and must be unique within the topology. The length of the name must be less than the maximum allowed size for workspace names.
- **Output**: Returns a pointer to the newly added `fd_topo_wksp_t` structure representing the workspace. If the input is invalid or constraints are violated, the function logs an error and does not return.
- **See Also**: [`fd_topob_wksp`](<fd_topob.c.md#fd_topob_wksp>)  (Implementation)


---
### fd\_topob\_obj<!-- {{#callable_declaration:fd_topob_obj}} -->
[View Source →](<../../../../../src/disco/topo/fd_topob.h#L51>)

Add an object to the topology with a specified name and workspace.
- **Description**: Use this function to add an object to a topology, associating it with a specific workspace. The workspace must already exist in the topology. This function is useful when you need to allocate space for an object in memory without mapping it to any tiles. Ensure that the topology, object name, and workspace name are valid and not null. The function will log an error if the object name is too long, if there are too many objects, or if the workspace is not found.
- **Inputs**:
    - `topo`: A pointer to an `fd_topo_t` structure representing the topology. Must not be null.
    - `obj_name`: A string representing the name of the object to add. Must not be null and must be shorter than the maximum allowed length for object names.
    - `wksp_name`: A string representing the name of the workspace to associate with the object. Must not be null and the workspace must exist in the topology.
- **Output**: Returns a pointer to the newly added `fd_topo_obj_t` object. Logs an error and does not return if any input is invalid or if constraints are violated.
- **See Also**: [`fd_topob_obj`](<fd_topob.c.md#fd_topob_obj>)  (Implementation)


---
### fd\_topob\_tile\_uses<!-- {{#callable_declaration:fd_topob_tile_uses}} -->
[View Source →](<../../../../../src/disco/topo/fd_topob.h#L64>)

Add a relationship indicating a tile uses a specific object.
- **Description**: Use this function to specify that a tile in the topology uses a particular object, which affects how memory mapping is handled for the tile. The function should be called after the object and tile have been added to the topology. The mode parameter determines the access level (read-only or read-write) for the object when mapped to the tile. Ensure that the tile does not exceed the maximum number of objects it can use, as this will result in an error.
- **Inputs**:
    - `topo`: Pointer to the topology structure. The function does not use this parameter, so it can be null.
    - `tile`: Pointer to the tile structure that will use the object. Must not be null. The tile must have been previously added to the topology.
    - `obj`: Pointer to the object structure that the tile will use. Must not be null. The object must have been previously added to the topology.
    - `mode`: Integer indicating the access mode for the object. Must be either `FD_SHMEM_JOIN_MODE_READ_ONLY` or `FD_SHMEM_JOIN_MODE_READ_WRITE`. Invalid values may lead to undefined behavior.
- **Output**: None
- **See Also**: [`fd_topob_tile_uses`](<fd_topob.c.md#fd_topob_tile_uses>)  (Implementation)


---
### fd\_topob\_link<!-- {{#callable_declaration:fd_topob_link}} -->
[View Source →](<../../../../../src/disco/topo/fd_topob.h#L75>)

Add a link to the topology.
- **Description**: Use this function to add a new link to the topology. The link will not have any producer or consumer by default, and these must be added separately. The function requires a valid topology object and unique link and workspace names. It initializes the link with specified depth, MTU, and burst values. Ensure that the topology has not exceeded the maximum number of links and that the link name is within the allowed length.
- **Inputs**:
    - `topo`: A pointer to an `fd_topo_t` object representing the topology. Must not be null.
    - `link_name`: A string representing the name of the link. Must not be null and must be unique within the topology. The length must be less than the maximum allowed size for link names.
    - `wksp_name`: A string representing the name of the workspace. Must not be null and must correspond to an existing workspace in the topology.
    - `depth`: An unsigned long representing the depth of the link. Must be a valid non-negative value.
    - `mtu`: An unsigned long representing the maximum transmission unit of the link. Must be a valid non-negative value.
    - `burst`: An unsigned long representing the burst size of the link. Must be a valid non-negative value.
- **Output**: Returns a pointer to the newly added `fd_topo_link_t` object representing the link in the topology.
- **See Also**: [`fd_topob_link`](<fd_topob.c.md#fd_topob_link>)  (Implementation)


---
### fd\_topob\_tile<!-- {{#callable_declaration:fd_topob_tile}} -->
[View Source →](<../../../../../src/disco/topo/fd_topob.h#L89>)

Add a tile to the topology with specified properties and workspaces.
- **Description**: Use this function to add a new tile to an existing topology. The function requires the topology to be initialized and not exceed the maximum number of tiles. It assigns a unique identifier to the tile and links it to specified workspaces for tile and metrics. Optionally, it can link a keyswitch workspace if specified. Ensure that the tile name is unique within the topology and does not exceed the maximum allowed length. This function increments the tile count in the topology.
- **Inputs**:
    - `topo`: Pointer to an initialized `fd_topo_t` structure. Must not be null.
    - `tile_name`: String representing the name of the tile. Must not be null and must be shorter than the maximum allowed length for tile names.
    - `tile_wksp`: String representing the name of the workspace for the tile. Must not be null.
    - `metrics_wksp`: String representing the name of the workspace for metrics. Must not be null.
    - `cpu_idx`: Unsigned long representing the CPU index to assign to the tile.
    - `is_agave`: Integer flag indicating if the tile is an Agave tile. Non-zero for true, zero for false.
    - `uses_keyswitch`: Integer flag indicating if the tile uses a keyswitch. Non-zero for true, zero for false.
- **Output**: Returns a pointer to the newly added `fd_topo_tile_t` structure representing the tile.
- **See Also**: [`fd_topob_tile`](<fd_topob.c.md#fd_topob_tile>)  (Implementation)


---
### fd\_topob\_tile\_in<!-- {{#callable_declaration:fd_topob_tile_in}} -->
[View Source →](<../../../../../src/disco/topo/fd_topob.h#L108>)

Add an input link to a tile in the topology.
- **Description**: Use this function to add an input link to a specified tile within a topology. This function requires that the topology, tile, and link are already defined. It associates the link with the tile, specifying whether the link is reliable and whether it should be polled. The function also manages flow control by using a sequence workspace. Ensure that the tile and link names are valid and that the tile has not exceeded its maximum number of input links.
- **Inputs**:
    - `topo`: A pointer to an `fd_topo_t` structure representing the topology. Must not be null.
    - `tile_name`: A string representing the name of the tile. Must not be null.
    - `tile_kind_id`: An unsigned long representing the kind ID of the tile. Used to identify the tile uniquely.
    - `fseq_wksp`: A string representing the name of the sequence workspace. Must not be null.
    - `link_name`: A string representing the name of the link. Must not be null.
    - `link_kind_id`: An unsigned long representing the kind ID of the link. Used to identify the link uniquely.
    - `reliable`: An integer indicating if the link is reliable (1) or unreliable (0).
    - `polled`: An integer indicating if the link is polled (1) or unpolled (0).
- **Output**: None
- **See Also**: [`fd_topob_tile_in`](<fd_topob.c.md#fd_topob_tile_in>)  (Implementation)


---
### fd\_topob\_tile\_out<!-- {{#callable_declaration:fd_topob_tile_out}} -->
[View Source →](<../../../../../src/disco/topo/fd_topob.h#L123>)

Add an output link to a tile in the topology.
- **Description**: Use this function to associate an output link with a specified tile in the topology. This operation allows the tile to write to the link, which is mapped as writable for the tile. Ensure that the tile and link names are valid and that the tile does not exceed the maximum number of output links allowed. This function should be called after the tile and link have been added to the topology.
- **Inputs**:
    - `topo`: A pointer to the `fd_topo_t` structure representing the topology. Must not be null.
    - `tile_name`: A string representing the name of the tile. Must not be null and should correspond to an existing tile in the topology.
    - `tile_kind_id`: An unsigned long representing the kind identifier for the tile. Must match the kind of the existing tile.
    - `link_name`: A string representing the name of the link. Must not be null and should correspond to an existing link in the topology.
    - `link_kind_id`: An unsigned long representing the kind identifier for the link. Must match the kind of the existing link.
- **Output**: None
- **See Also**: [`fd_topob_tile_out`](<fd_topob.c.md#fd_topob_tile_out>)  (Implementation)


---
### fd\_topob\_auto\_layout<!-- {{#callable_declaration:fd_topob_auto_layout}} -->
[View Source →](<../../../../../src/disco/topo/fd_topob.h#L133>)

Automatically assign tiles to CPU cores in a topology.
- **Description**: Use this function to automatically assign tiles to CPU cores in a given topology. It assigns tiles in a sequential order based on NUMA nodes, except for specific tiles that should remain unassigned (floating). This function should be called after all tiles are added to the topology and before finalizing it. If `reserve_agave_cores` is set, it reserves additional CPU cores for Agave-specific tasks. Ensure that the topology is properly initialized before calling this function.
- **Inputs**:
    - `topo`: A pointer to an `fd_topo_t` structure representing the topology. Must not be null and should be initialized before calling this function.
    - `reserve_agave_cores`: An integer flag indicating whether to reserve additional CPU cores for Agave-specific tasks. Non-zero values enable reservation.
- **Output**: None
- **See Also**: [`fd_topob_auto_layout`](<fd_topob.c.md#fd_topob_auto_layout>)  (Implementation)


---
### fd\_topob\_finish<!-- {{#callable_declaration:fd_topob_finish}} -->
[View Source →](<../../../../../src/disco/topo/fd_topob.h#L143>)

Finalize the topology creation and validate it.
- **Description**: Use this function to complete the setup of a topology after all tiles, objects, and links have been added. It arranges all objects within their respective workspaces, calculates necessary sizes, and performs validation checks on the topology. This function must be called to ensure the topology is correctly configured and ready for use.
- **Inputs**:
    - `topo`: A pointer to an `fd_topo_t` structure representing the topology to finalize. Must not be null and should be properly initialized with all necessary components added.
    - `callbacks`: An array of pointers to `fd_topo_obj_callbacks_t` structures, providing necessary callbacks for each object in the topology. The array must be null-terminated, and each object in the topology must have a corresponding callback entry. If a callback is missing for an object, the function will log an error.
- **Output**: None
- **See Also**: [`fd_topob_finish`](<fd_topob.c.md#fd_topob_finish>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)