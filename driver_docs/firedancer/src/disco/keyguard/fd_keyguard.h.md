<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Header file for digital signature creation and authorization for validator components, defining roles, payload types, and sign types.

# Purpose
This C header file defines constants, structures, and function prototypes for a digital signature service called `fd_keyguard`. The service is designed to create digital signatures for validator components, with a focus on handling different roles and payload types within a distributed system. The file specifies maximum payload sizes, role definitions, payload types, and sign types, which are used to categorize and manage signing requests. It includes the [`fd_keyguard_payload_match`](<#fd_keyguard_payload_match>) function to determine the type of payload based on its data and size, and the [`fd_keyguard_payload_authorize`](<#fd_keyguard_payload_authorize>) function to verify if a signing request is authorized based on the role and authority. The file also defines a structure `fd_keyguard_authority_t` to represent the identity of an authority using a public key.
# Imports and Dependencies

---
- `../fd_disco_base.h`


# Data Structures

---
### fd\_keyguard\_authority
- **Type**: ``struct``
- **Members**:
    - `identity_pubkey`: An array of 32 unsigned characters representing a public key.
- **Description**: Defines a structure that holds a public key used for identity verification in digital signature operations within the keyguard system.


---
### fd\_keyguard\_authority\_t
- **Type**: ``struct``
- **Members**:
    - `identity_pubkey`: An array of 32 unsigned characters representing the public key identity.
- **Description**: Defines a structure that holds a public key identity used for authorization in digital signature processes. The `identity_pubkey` member stores the public key, which is essential for verifying the identity of the entity requesting a signature.


# Function Declarations (Public API)

---
### fd\_keyguard\_payload\_match<!-- {{#callable_declaration:fd_keyguard_payload_match}} -->
[View Source →](<../../../../../src/disco/keyguard/fd_keyguard.h#L71>)

Identifies the type of a payload for signing.
- **Description**: Use this function to determine the type of a payload that is requested to be signed. It analyzes the payload data and returns a bitwise OR of constants representing different payload types. The function requires the payload data, its size, and the signing type as inputs. It returns 0 if the payload does not match any known type. If the payload matches exactly one type, the function returns a value with a single bit set, indicating the specific type. This function is useful for ensuring that a payload is unambiguously identified before proceeding with signing operations.
- **Inputs**:
    - `data`: Pointer to the payload data to be analyzed. Must not be null. The data is read-only and the caller retains ownership.
    - `sz`: Size of the payload data in bytes. Must be a non-negative value and should not exceed `FD_KEYGUARD_SIGN_REQ_MTU`.
    - `sign_type`: Specifies the signing type. Must be one of the defined `FD_KEYGUARD_SIGN_TYPE_{...}` constants.
- **Output**: Returns a bitwise OR of `FD_KEYGUARD_PAYLOAD_{...}` constants indicating the matched payload types, or 0 if none matched.
- **See Also**: [`fd_keyguard_payload_match`](<fd_keyguard_match.c.md#fd_keyguard_payload_match>)  (Implementation)


---
### fd\_keyguard\_payload\_authorize<!-- {{#callable_declaration:fd_keyguard_payload_authorize}} -->
[View Source →](<../../../../../src/disco/keyguard/fd_keyguard.h#L97>)

Decides if a signing request is authorized based on role and payload.
- **Description**: Use this function to check if a signing request is authorized for a specific role and payload. The function requires a payload, its size, a role, and a signing type. It returns 1 if the request is authorized and 0 otherwise. The payload size must not exceed `FD_KEYGUARD_SIGN_REQ_MTU`. The role must be one of the predefined roles, and the payload must match the expected type for that role. The function is more restrictive than `fd_keyguard_payload_match` and assumes the request origin was previously authorized for the given role.
- **Inputs**:
    - `authority`: A pointer to a `fd_keyguard_authority_t` structure containing the identity public key. Must not be null.
    - `data`: A pointer to the payload data to be signed. Must not be null.
    - `sz`: The size of the payload data. Must be less than or equal to `FD_KEYGUARD_SIGN_REQ_MTU`.
    - `role`: An integer representing the role, which must be one of the `FD_KEYGUARD_ROLE_{...}` constants.
    - `sign_type`: An integer representing the signing type, which must be one of the `FD_KEYGUARD_SIGN_TYPE_{...}` constants.
- **Output**: Returns 1 if the signing request is authorized, otherwise returns 0.
- **See Also**: [`fd_keyguard_payload_authorize`](<fd_keyguard_authorize.c.md#fd_keyguard_payload_authorize>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)