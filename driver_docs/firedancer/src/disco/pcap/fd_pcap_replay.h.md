<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Header file for replaying packets from a pcap file into a tango fragment stream with flow control diagnostics.

# Purpose
The `fd_pcap_replay` header file defines the interface for replaying packet capture (pcap) data into a tango fragment stream. It provides constants, macros, and function prototypes necessary for configuring and executing a pcap replay operation. The primary function, [`fd_pcap_replay_tile`](<#fd_pcap_replay_tile>), is responsible for reading packets from a specified pcap file and publishing them to a fragment stream, which can be consumed by multiple reliable and unreliable consumers. The file includes definitions for managing flow control and diagnostics, such as counters for published and filtered packets, and provides mechanisms for handling command-and-control signals during the replay process.

Key components include macros for signal handling (`FD_PCAP_REPLAY_CNC_SIGNAL_ACK`) and diagnostics (`FD_PCAP_REPLAY_CNC_DIAG_*`), as well as configuration parameters for the replay tile's scratch memory alignment and footprint. The header specifies the maximum number of outputs a replay tile can support and provides guidelines for managing flow control credits and consumer interaction. The [`fd_pcap_replay_tile`](<#fd_pcap_replay_tile>) function is designed to handle the lifecycle of the replay operation, including initialization, execution, and termination, while ensuring proper synchronization and resource management across the involved components.
# Imports and Dependencies

---
- `../fd_disco_base.h`


# Function Declarations (Public API)

---
### fd\_pcap\_replay\_tile\_scratch\_align<!-- {{#callable_declaration:fd_pcap_replay_tile_scratch_align}} -->
[View Source →](<../../../../../src/disco/pcap/fd_pcap_replay.h#L64>)

Returns the required alignment for a pcap replay tile scratch region.
- **Description**: Use this function to obtain the alignment requirement for a scratch memory region used by a pcap replay tile. This alignment is necessary to ensure proper memory access and performance. The function is constant and does not depend on any input parameters, making it straightforward to use when setting up the memory layout for a pcap replay tile.
- **Inputs**: None
- **Output**: Returns an unsigned long representing the alignment requirement, which is a power of 2.
- **See Also**: [`fd_pcap_replay_tile_scratch_align`](<fd_pcap_replay.c.md#fd_pcap_replay_tile_scratch_align>)  (Implementation)


---
### fd\_pcap\_replay\_tile\_scratch\_footprint<!-- {{#callable_declaration:fd_pcap_replay_tile_scratch_footprint}} -->
[View Source →](<../../../../../src/disco/pcap/fd_pcap_replay.h#L139>)

Calculates the memory footprint for a pcap replay tile scratch region.
- **Description**: Use this function to determine the required memory footprint for a scratch region that supports a specified number of reliable consumers in a pcap replay tile. This function is useful for allocating the correct amount of memory for the scratch region before initializing a pcap replay tile. The function returns zero if the specified number of outputs exceeds the maximum allowed, indicating an invalid configuration.
- **Inputs**:
    - `out_cnt`: Specifies the number of reliable consumers the pcap replay tile will support. Must be a non-negative integer not exceeding `FD_PCAP_REPLAY_TILE_OUT_MAX`. If `out_cnt` is greater than this maximum, the function returns zero, indicating an invalid configuration.
- **Output**: Returns the memory footprint in bytes required for the scratch region if `out_cnt` is valid. Returns zero if `out_cnt` exceeds the maximum allowed value.
- **See Also**: [`fd_pcap_replay_tile_scratch_footprint`](<fd_pcap_replay.c.md#fd_pcap_replay_tile_scratch_footprint>)  (Implementation)


---
### fd\_pcap\_replay\_tile<!-- {{#callable_declaration:fd_pcap_replay_tile}} -->
[View Source →](<../../../../../src/disco/pcap/fd_pcap_replay.h#L142>)

Replays packets from a pcap file into a fragment stream.
- **Description**: Use this function to replay packets from a specified pcap file into a fragment stream, managing flow control and diagnostics. Ensure the command-and-control structure is in the BOOT state before calling. The function transitions the state from BOOT to RUN, processes the pcap file, and handles signals during execution. It returns to the BOOT state after receiving a HALT signal. The function requires exclusive access to the provided resources during its execution.
- **Inputs**:
    - `cnc`: Local join to the command-and-control structure for the replay. Must not be null and should be in the BOOT state.
    - `pcap_path`: Path to the pcap file as a null-terminated string. Must not be null.
    - `pkt_max`: Maximum size of a packet in the pcap file. Must be a positive value.
    - `orig`: Origin for the fragment stream, in the range [0, FD_FRAG_META_ORIG_MAX).
    - `mcache`: Local join to the output fragment stream's metadata cache. Must not be null.
    - `dcache`: Local join to the output fragment stream's data cache. Must not be null.
    - `out_cnt`: Number of reliable consumers, indexed from 0 to out_cnt-1. Must not exceed FD_PCAP_REPLAY_TILE_OUT_MAX.
    - `out_fseq`: Array of local joins to the sequence numbers of reliable consumers. Must not be null if out_cnt is greater than 0.
    - `cr_max`: Maximum number of flow control credits. If zero, a default value based on mcache depth is used.
    - `lazy`: Interval in nanoseconds for receiving credits. If less than or equal to zero, a default value is used.
    - `rng`: Local join to the random number generator for the replay. Must not be null.
    - `scratch`: Pointer to scratch memory for the tile. Must be aligned and have sufficient footprint as specified by fd_pcap_replay_tile_scratch_align and fd_pcap_replay_tile_scratch_footprint.
- **Output**: Returns 0 on successful execution, transitioning states as expected. Returns a non-zero error code if initialization fails.
- **See Also**: [`fd_pcap_replay_tile`](<fd_pcap_replay.c.md#fd_pcap_replay_tile>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)