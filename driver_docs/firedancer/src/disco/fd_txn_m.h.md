<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines the structure and functions for handling parsed meta transactions, including payload management and source identification.

# Purpose
The code is a C header file that defines a structure and related functions for handling parsed meta transactions, specifically in the context of a transaction processing unit (TPU). The primary structure defined is `fd_txn_m_t`, which represents a parsed meta transaction. This structure includes fields such as `reference_slot`, `payload_sz`, `txn_t_sz`, `source_ipv4`, and `source_tpu`, which store information about the transaction's reference slot, payload size, transaction size, source IP address, and source TPU, respectively. Additionally, the `block_engine` sub-structure contains fields related to transaction bundles, such as `bundle_id`, `bundle_txn_cnt`, `commission`, and `commission_pubkey`.

The file also defines several constants and inline functions to manage memory alignment and calculate the footprint of the `fd_txn_m_t` structure. These functions include [`fd_txn_m_align`](<#fd_txn_m_align>), [`fd_txn_m_footprint`](<#fd_txn_m_footprint>), [`fd_txn_m_payload`](<#fd_txn_m_payload>), [`fd_txn_m_txn_t`](<#fd_txn_m_txn_t>), and [`fd_txn_m_alut`](<#fd_txn_m_alut>), among others. The constants `FD_TPU_RAW_MTU`, `FD_TPU_PARSED_MTU`, and `FD_TPU_RESOLVED_MTU` are defined to represent maximum transmission unit sizes for different stages of transaction processing. The header file is intended to be included in other C source files, providing a structured way to handle and process meta transactions within a larger transaction processing system.
# Imports and Dependencies

---
- `../ballet/txn/fd_txn.h`


# Data Structures

---
### fd\_txn\_m
- **Type**: ``struct``
- **Members**:
    - ``reference_slot``: Stores the computed slot number that the transaction references.
    - ``payload_sz``: Indicates the size of the transaction payload.
    - ``txn_t_sz``: Stores the size of the transaction type, avoiding the need to parse it again.
    - ``source_ipv4``: Holds the source IP address in big endian format.
    - ``source_tpu``: Indicates the source TPU type for the transaction.
    - ``block_engine``: Contains information about transaction bundles, including `bundle_id`, `bundle_txn_cnt`, `commission`, and `commission_pubkey`.
- **Description**: Represents a parsed meta transaction structure that includes metadata such as the reference slot, payload size, transaction type size, source IP and TPU, and bundle-related information. The `block_engine` sub-structure provides details about transaction bundles, including bundle identification and commission information. The structure also accounts for variable-length fields like `payload`, `txn_t`, and `alut`, which are not included in the static size of the structure.


---
### fd\_txn\_m\_t
- **Type**: ``struct``
- **Members**:
    - ``reference_slot``: The computed slot number that the transaction references.
    - ``payload_sz``: The size of the payload in bytes.
    - ``txn_t_sz``: The size of the transaction type, stored redundantly for efficiency.
    - ``source_ipv4``: The source IP address in big endian format.
    - ``source_tpu``: The source TPU identifier.
    - ``block_engine``: A nested structure containing bundle and commission information.
- **Description**: Represents a parsed meta transaction, including details such as the reference slot, payload size, transaction size, source information, and block engine data. The `block_engine` sub-structure contains fields related to transaction bundles and commission details. The structure also includes variable-length fields at the end, which are not part of the fixed-size structure.


# Functions

---
### fd\_txn\_m\_align<!-- {{#callable:fd_txn_m_align}} -->
[View Source →](<../../../../src/disco/fd_txn_m.h#L73>)

Returns the alignment requirement of the `fd_txn_m_t` structure.
- **Inputs**: None
- **Logic and Control Flow**:
    - Calls `alignof` operator on `fd_txn_m_t` to determine its alignment requirement.
    - Returns the result of the `alignof` operator.
- **Output**: The alignment requirement of the `fd_txn_m_t` structure as an `ulong`.


---
### fd\_txn\_m\_footprint<!-- {{#callable:fd_txn_m_footprint}} -->
[View Source →](<../../../../src/disco/fd_txn_m.h#L78>)

Calculates the memory footprint required for a parsed meta transaction structure and its associated components.
- **Inputs**:
    - `payload_sz`: The size of the payload in bytes.
    - `instr_cnt`: The number of instructions in the transaction.
    - `addr_table_lookup_cnt`: The number of address table lookups required.
    - `addr_table_adtl_cnt`: The number of additional address table entries.
- **Logic and Control Flow**:
    - Initialize `l` with `FD_LAYOUT_INIT`.
    - Append the size of `fd_txn_m_t` aligned to its alignment requirement to `l`.
    - Append the `payload_sz` to `l` with an alignment of 1 byte.
    - Append the footprint of the transaction, calculated using `fd_txn_footprint`, aligned to the alignment requirement of `fd_txn_align()`, to `l`.
    - Append the size of additional address table entries, calculated as `addr_table_adtl_cnt` multiplied by the size of `fd_acct_addr_t`, aligned to its alignment requirement, to `l`.
    - Finalize the layout with `FD_LAYOUT_FINI` using the alignment of `fd_txn_m_t` and return the result.
- **Output**: The total memory footprint in bytes as an unsigned long integer.
- **Functions Called**:
    - [`fd_txn_m_align`](<#fd_txn_m_align>)


---
### fd\_txn\_m\_payload<!-- {{#callable:fd_txn_m_payload}} -->
[View Source →](<../../../../src/disco/fd_txn_m.h#L91>)

Returns a pointer to the payload section of a `fd_txn_m_t` structure.
- **Inputs**:
    - `txnm`: A pointer to a `fd_txn_m_t` structure, which represents a parsed meta transaction.
- **Logic and Control Flow**:
    - Calculate the memory address immediately following the `fd_txn_m_t` structure pointed to by `txnm`.
    - Cast this address to a `uchar *` type and return it.
- **Output**: A pointer to the payload section of the `fd_txn_m_t` structure, represented as a `uchar *`.


---
### fd\_txn\_m\_payload\_const<!-- {{#callable:fd_txn_m_payload_const}} -->
[View Source →](<../../../../src/disco/fd_txn_m.h#L96>)

Returns a pointer to the payload section of a `fd_txn_m_t` structure.
- **Inputs**:
    - `txnm`: A pointer to a constant `fd_txn_m_t` structure, which represents a parsed meta transaction.
- **Logic and Control Flow**:
    - The function takes a pointer to a `fd_txn_m_t` structure as input.
    - It calculates the address immediately following the `fd_txn_m_t` structure by incrementing the pointer by one unit of `fd_txn_m_t`.
    - It casts this address to a pointer to a constant unsigned character (`uchar const *`).
    - The function returns this pointer, which points to the start of the payload section.
- **Output**: A pointer to a constant unsigned character (`uchar const *`) that points to the payload section of the `fd_txn_m_t` structure.


---
### fd\_txn\_m\_txn\_t<!-- {{#callable:fd_txn_m_txn_t}} -->
[View Source →](<../../../../src/disco/fd_txn_m.h#L101>)

Calculates the aligned memory address for the `fd_txn_t` structure following a `fd_txn_m_t` structure.
- **Inputs**:
    - `txnm`: A pointer to a `fd_txn_m_t` structure, which contains metadata about a transaction.
- **Logic and Control Flow**:
    - Calculate the starting address of the memory immediately after the `fd_txn_m_t` structure by adding 1 to the `txnm` pointer.
    - Add the `payload_sz` from the `fd_txn_m_t` structure to this address to account for the payload size.
    - Align the resulting address to the alignment requirements of the `fd_txn_t` structure using `fd_ulong_align_up`.
    - Return the aligned address cast to a pointer of type `fd_txn_t`.
- **Output**: A pointer to the aligned `fd_txn_t` structure following the `fd_txn_m_t` structure.


---
### fd\_txn\_m\_txn\_t\_const<!-- {{#callable:fd_txn_m_txn_t_const}} -->
[View Source →](<../../../../src/disco/fd_txn_m.h#L106>)

Returns a pointer to a `fd_txn_t` structure aligned after the payload of a `fd_txn_m_t` structure.
- **Inputs**:
    - `txnm`: A pointer to a constant `fd_txn_m_t` structure, which contains metadata about a transaction.
- **Logic and Control Flow**:
    - Calculate the address immediately after the `fd_txn_m_t` structure by adding 1 to the `txnm` pointer.
    - Add the `payload_sz` from the `txnm` structure to this address to account for the payload size.
    - Align the resulting address to the alignment requirements of a `fd_txn_t` structure using `fd_ulong_align_up`.
    - Cast the aligned address to a pointer to a constant `fd_txn_t` structure and return it.
- **Output**: A pointer to a constant `fd_txn_t` structure, aligned according to its alignment requirements.


---
### fd\_txn\_m\_alut<!-- {{#callable:fd_txn_m_alut}} -->
[View Source →](<../../../../src/disco/fd_txn_m.h#L111>)

Calculates the aligned memory address for the `alut` field in a `fd_txn_m_t` structure.
- **Inputs**:
    - `txnm`: A pointer to a `fd_txn_m_t` structure, which contains transaction metadata.
- **Logic and Control Flow**:
    - Calculate the starting address of the `payload` by adding 1 to the `txnm` pointer and casting it to `ulong`.
    - Add `txnm->payload_sz` to the starting address to account for the payload size.
    - Align the result to the alignment of `fd_txn_t` using `fd_ulong_align_up`.
    - Add `txnm->txn_t_sz` to the aligned address to account for the transaction size.
    - Align the final result to the alignment of `fd_acct_addr_t` using `fd_ulong_align_up`.
- **Output**: Returns a pointer to the aligned memory address for the `alut` field, cast to `fd_acct_addr_t *`.


---
### fd\_txn\_m\_realized\_footprint<!-- {{#callable:fd_txn_m_realized_footprint}} -->
[View Source →](<../../../../src/disco/fd_txn_m.h#L116>)

Calculates the memory footprint of a parsed meta transaction, optionally including transaction and address lookup table sizes.
- **Inputs**:
    - ``txnm``: A pointer to a constant `fd_txn_m_t` structure representing the parsed meta transaction.
    - ``include_txn_t``: An integer flag indicating whether to include the transaction size in the footprint calculation.
    - ``include_alut``: An integer flag indicating whether to include the address lookup table size in the footprint calculation.
- **Logic and Control Flow**:
    - Check if `include_txn_t` is true using `FD_LIKELY` macro.
    - If true, initialize `l` with `FD_LAYOUT_INIT` and append the size of `fd_txn_m_t`, the payload size, the aligned transaction footprint, and the optional address lookup table size to `l`.
    - Return `l` without finalizing the layout to exclude extra padding.
    - If `include_txn_t` is false, initialize `l` with `FD_LAYOUT_INIT`, append the size of `fd_txn_m_t` and the payload size to `l`, and return `l`.
- **Output**: Returns an `ulong` representing the calculated memory footprint of the transaction.
- **Functions Called**:
    - [`fd_txn_m_txn_t_const`](<#fd_txn_m_txn_t_const>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)