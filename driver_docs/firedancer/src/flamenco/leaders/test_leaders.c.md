<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Tests the functionality of epoch leader data import and validation for Solana's Mainnet-beta epoch 454.

# Purpose
This code is an executable C program that tests the functionality of epoch leader scheduling for a blockchain network, specifically using data from Solana's Mainnet-beta epoch 454. The program imports binary data files that contain information about stakes, leader public keys, and leader indices for the specified epoch. It verifies the integrity and correctness of the leader schedule by comparing the expected leader public keys for each slot with the actual data derived from the imported files.

The program initializes and configures the leader schedule using the `fd_epoch_leaders_new` function, and then it performs a series of tests to ensure that the leader schedule matches the expected results. It checks the leader public keys for the first 10,000 slots directly and verifies the rest by index. Additionally, the program tests the leader schedule with a subset of validators, excluding the last half of the validators from the stake calculation, and verifies the results. The code uses assertions (`FD_TEST`) to validate the correctness of the operations and logs a notice upon successful completion.
# Imports and Dependencies

---
- `fd_leaders.h`


# Global Variables

---
### leaders\_buf
- **Type**: `static uchar array`
- **Description**: A static unsigned character array that is aligned according to `FD_EPOCH_LEADERS_ALIGN`. The size of the array is determined by the macro `FD_EPOCH_LEADERS_FOOTPRINT` with parameters `3373UL` and `432000UL`. This array is used to store data related to epoch leaders.
- **Use**: Used to store and manage epoch leader data for processing within the program.


---
### vote\_keyed\_lsched
- **Type**: ``const ulong``
- **Description**: A constant unsigned long integer initialized to zero.
- **Use**: Used as a parameter in the `fd_epoch_leaders_new` function to specify a schedule related to vote keys.


# Functions

---
### main<!-- {{#callable:main}} -->
[View Source →](<../../../../../src/flamenco/leaders/test_leaders.c#L20>)

Initializes and tests the epoch leader schedule for a specific Solana epoch using imported binary data.
- **Inputs**:
    - `argc`: The number of command-line arguments.
    - `argv`: An array of command-line arguments.
- **Logic and Control Flow**:
    - Call `fd_boot` to initialize the environment with command-line arguments.
    - Calculate `pub_cnt` and `slot_cnt` based on the sizes of imported binary data.
    - Set `slot0` to a specific starting slot number and verify `slot_cnt` and `pub_cnt` with `FD_TEST`.
    - Convert `e454_stakes` to `id_based_e454_stakes` and initialize `vote_based_e454_stakes` with stake and key data.
    - Assign pointers `stakes`, `leaders_pubkeys`, and `leaders_idx` to respective binary data arrays.
    - Create and join an epoch leader schedule using [`fd_epoch_leaders_new`](<fd_leaders.c.md#fd_epoch_leaders_new>) and [`fd_epoch_leaders_join`](<fd_leaders.c.md#fd_epoch_leaders_join>), and verify the result with `FD_TEST`.
    - Verify the leader schedule by comparing the expected and actual leader public keys for each slot using `FD_TEST`.
    - Check boundary conditions by verifying that slots outside the valid range return `NULL`.
    - Delete the leader schedule using [`fd_epoch_leaders_delete`](<fd_leaders.c.md#fd_epoch_leaders_delete>) after leaving it with [`fd_epoch_leaders_leave`](<fd_leaders.c.md#fd_epoch_leaders_leave>).
    - Repeat the leader schedule creation and verification process with half of the validators excluded, using `excluded_stake`.
    - Log a success message with `FD_LOG_NOTICE` and call `fd_halt` to terminate the program.
- **Output**: Returns 0 to indicate successful execution.
- **Functions Called**:
    - [`fd_epoch_leaders_new`](<fd_leaders.c.md#fd_epoch_leaders_new>)
    - [`fd_epoch_leaders_join`](<fd_leaders.c.md#fd_epoch_leaders_join>)
    - [`fd_epoch_leaders_get`](<fd_leaders.h.md#fd_epoch_leaders_get>)
    - [`fd_epoch_leaders_delete`](<fd_leaders.c.md#fd_epoch_leaders_delete>)
    - [`fd_epoch_leaders_leave`](<fd_leaders.c.md#fd_epoch_leaders_leave>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)