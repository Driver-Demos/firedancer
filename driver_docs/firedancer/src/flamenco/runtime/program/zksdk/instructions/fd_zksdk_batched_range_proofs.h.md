<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines structures and functions for batched range proofs in zero-knowledge proofs.

# Purpose
The code is a C header file that defines data structures and functions for handling batched range proofs in a zero-knowledge proof (ZKP) system. It includes definitions for three types of range proofs: `fd_zksdk_range_proof_u64_proof`, `fd_zksdk_range_proof_u128_proof`, and `fd_zksdk_range_proof_u256_proof`, each corresponding to different bit lengths (64, 128, and 256 bits). These structures are packed and include components such as `range_proof`, `ipp_lr_vec`, and scalars `ipp_a` and `ipp_b`. The header also defines a context structure, `fd_zksdk_batched_range_proof_context`, which holds arrays for commitments and bit lengths, used in the batched range proof process.

The file provides inline functions for initializing and validating batched range proofs. The [`batched_range_proof_transcript_init`](<#batched_range_proof_transcript_init>) function initializes a transcript with the context's commitments and bit lengths. The [`batched_range_proof_init_and_validate`](<#batched_range_proof_init_and_validate>) function validates the context, initializes the transcript, and determines the size of the batch by identifying the first all-zero commitment. This function is critical for ensuring compatibility with the Agave ZKP system. The header file is intended to be included in other C files that require batched range proof functionality, and it does not define a public API or external interface directly.
# Imports and Dependencies

---
- `../../../../fd_flamenco_base.h`


# Data Structures

---
### fd\_zksdk\_range\_proof\_u64\_proof
- **Type**: ``struct``
- **Members**:
    - `range_proof`: Contains the range proof data.
    - `ipp_lr_vec`: An array of six `fd_rangeproofs_ipp_vecs_t` elements representing logarithmic points.
    - `ipp_a`: A 32-byte scalar value.
    - `ipp_b`: A 32-byte scalar value.
- **Description**: Represents a packed structure for a 64-bit range proof, containing a range proof, an array of logarithmic points, and two scalar values.


---
### fd\_zksdk\_range\_proof\_u64\_proof\_t
- **Type**: ``struct``
- **Members**:
    - `range_proof`: Contains the range proof data.
    - `ipp_lr_vec`: Array of `fd_rangeproofs_ipp_vecs_t` with 6 elements for logarithmic points.
    - `ipp_a`: 32-byte scalar value.
    - `ipp_b`: 32-byte scalar value.
- **Description**: Represents a packed structure for a 64-bit range proof, containing a range proof, an array of logarithmic points, and two scalar values.


---
### fd\_zksdk\_range\_proof\_u128\_proof
- **Type**: ``struct``
- **Members**:
    - `range_proof`: Contains the range proof data of type `fd_rangeproofs_range_proof_t`.
    - `ipp_lr_vec`: An array of 7 `fd_rangeproofs_ipp_vecs_t` elements representing log(bit_length) points.
    - `ipp_a`: A 32-byte scalar value.
    - `ipp_b`: A 32-byte scalar value.
- **Description**: Represents a packed data structure for a 128-bit range proof, containing a range proof, an array of inner product proof vectors, and two scalar values.


---
### fd\_zksdk\_range\_proof\_u128\_proof\_t
- **Type**: ``struct``
- **Members**:
    - `range_proof`: Contains the range proof data.
    - `ipp_lr_vec`: Array of 7 `fd_rangeproofs_ipp_vecs_t` elements representing log(bit_length) points.
    - `ipp_a`: 32-byte scalar value.
    - `ipp_b`: 32-byte scalar value.
- **Description**: Defines a packed structure for a range proof with 128-bit values, including a range proof, an array of inner product proof vectors, and two scalar values.


---
### fd\_zksdk\_range\_proof\_u256\_proof
- **Type**: ``struct``
- **Members**:
    - `range_proof`: Contains the range proof data of type `fd_rangeproofs_range_proof_t`.
    - `ipp_lr_vec`: An array of 8 `fd_rangeproofs_ipp_vecs_t` elements representing log(bit_length) points.
    - `ipp_a`: A 32-byte scalar value.
    - `ipp_b`: A 32-byte scalar value.
- **Description**: Represents a packed data structure for a 256-bit range proof, containing a range proof, an array of inner product proof vectors, and two scalar values.


---
### fd\_zksdk\_range\_proof\_u256\_proof\_t
- **Type**: ``struct``
- **Members**:
    - `range_proof`: Contains the range proof data.
    - `ipp_lr_vec`: Array of 8 `fd_rangeproofs_ipp_vecs_t` elements representing log(bit_length) points.
    - `ipp_a`: 32-byte scalar value.
    - `ipp_b`: 32-byte scalar value.
- **Description**: Represents a range proof structure for 256-bit values, containing a range proof, an array of inner product proof vectors, and two scalar values.


---
### fd\_zksdk\_batched\_range\_proof\_context
- **Type**: ``struct``
- **Members**:
    - `commitments`: An array of `uchar` that stores commitment points, with a maximum size defined by `FD_ZKSDK_MAX_COMMITMENTS * 32`.
    - `bit_lengths`: An array of `uchar` that stores the bit lengths of each commitment, with a maximum size defined by `FD_ZKSDK_MAX_COMMITMENTS`.
- **Description**: The `fd_zksdk_batched_range_proof_context` structure is used to manage a batch of range proofs in a zero-knowledge proof system. It contains arrays for storing commitment points and their corresponding bit lengths, allowing for efficient handling and validation of multiple range proofs in a single batch. The structure is packed to ensure memory alignment and efficient data access.


---
### fd\_zksdk\_batched\_range\_proof\_context\_t
- **Type**: ``struct``
- **Members**:
    - `commitments`: An array of points with a maximum size defined by `FD_ZKSDK_MAX_COMMITMENTS`, each point being 32 bytes.
    - `bit_lengths`: An array of bit lengths corresponding to each commitment, with a maximum size defined by `FD_ZKSDK_MAX_COMMITMENTS`.
- **Description**: Facilitates the management of batched range proofs by storing an array of commitments and their corresponding bit lengths, allowing for efficient validation and initialization of range proof transcripts.


# Functions

---
### batched\_range\_proof\_transcript\_init<!-- {{#callable:batched_range_proof_transcript_init}} -->
[View Source →](<../../../../../../../../src/flamenco/runtime/program/zksdk/instructions/fd_zksdk_batched_range_proofs.h#L37>)

Initializes a transcript for a batched range proof with specific context data.
- **Inputs**:
    - `transcript`: A pointer to an `fd_zksdk_transcript_t` structure that will be initialized.
    - `context`: A pointer to a constant `fd_zksdk_batched_range_proof_context_t` structure containing commitments and bit lengths.
- **Logic and Control Flow**:
    - Calls `fd_zksdk_transcript_init` to initialize the `transcript` with the literal "batched-range-proof-instruction".
    - Appends the `commitments` from `context` to the `transcript` using `fd_merlin_transcript_append_message`.
    - Appends the `bit_lengths` from `context` to the `transcript` using `fd_merlin_transcript_append_message`.
- **Output**: No return value; the function modifies the `transcript` in place.


---
### batched\_range\_proof\_init\_and\_validate<!-- {{#callable:batched_range_proof_init_and_validate}} -->
[View Source →](<../../../../../../../../src/flamenco/runtime/program/zksdk/instructions/fd_zksdk_batched_range_proofs.h#L54>)

Initializes and validates a batched range proof context and transcript, determining the batch size based on non-zero commitments.
- **Inputs**:
    - ``len``: A pointer to an `uchar` where the function will store the length of valid commitments.
    - ``context``: A constant pointer to a `fd_zksdk_batched_range_proof_context_t` structure containing commitments and bit lengths.
    - ``transcript``: A pointer to a `fd_zksdk_transcript_t` structure that will be initialized with the context data.
- **Logic and Control Flow**:
    - Initialize `i` to 0.
    - Iterate over the maximum number of commitments (`FD_ZKSDK_MAX_COMMITMENTS`).
    - For each commitment, check if it is equal to a zero commitment using `fd_memeq`.
    - If a zero commitment is found, break the loop.
    - Set `*len` to the current value of `i`, representing the number of non-zero commitments.
    - Call [`batched_range_proof_transcript_init`](<#batched_range_proof_transcript_init>) to initialize the `transcript` with the `context`.
    - Return `FD_EXECUTOR_INSTR_SUCCESS` to indicate successful execution.
- **Output**: Returns an integer status code `FD_EXECUTOR_INSTR_SUCCESS` indicating successful initialization and validation.
- **Functions Called**:
    - [`batched_range_proof_transcript_init`](<#batched_range_proof_transcript_init>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)