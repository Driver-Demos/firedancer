<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Functions for initializing and verifying the validity of batched grouped ciphertexts with three handles.

# Purpose
The code provides functionality for verifying the validity of a proof related to batched grouped ciphertexts with three handles. It is part of a cryptographic library and is intended to be used as a verification mechanism for zero-knowledge proofs. The code defines two main functions: [`batched_grouped_ciphertext_validity_transcript_init`](<#batched_grouped_ciphertext_validity_transcript_init>) and [`fd_zksdk_verify_proof_batched_grouped_ciphertext_3_handles_validity`](<#fd_zksdk_verify_proof_batched_grouped_ciphertext_3_handles_validity>). The first function initializes a transcript for the verification process, appending public keys and messages related to the grouped ciphertexts. The second function performs the actual verification by validating inputs, computing necessary scalars, and performing a multi-scalar multiplication to check if the computed result matches the expected value.

The code is structured to handle both batched and non-batched scenarios, with specific logic to compute additional values when the `batched` flag is true. It uses cryptographic operations such as scalar multiplication and point decompression on the Ristretto255 curve, which is a prime-order group based on Curve25519. The code also includes a function [`fd_zksdk_instr_verify_proof_batched_grouped_ciphertext_3_handles_validity`](<#fd_zksdk_instr_verify_proof_batched_grouped_ciphertext_3_handles_validity>), which acts as an interface to initialize the transcript and call the verification function with the appropriate context and proof data. This code is part of a larger system that deals with cryptographic proofs and is designed to be integrated into applications requiring secure verification of complex cryptographic statements.
# Imports and Dependencies

---
- `../fd_zksdk_private.h`


# Functions

---
### batched\_grouped\_ciphertext\_validity\_transcript\_init<!-- {{#callable:batched_grouped_ciphertext_validity_transcript_init}} -->
[View Source →](<../../../../../../../../src/flamenco/runtime/program/zksdk/instructions/fd_zksdk_batched_grouped_ciphertext_3_handles_validity.c#L3>)

Initializes a transcript for batched grouped ciphertext validity with three public keys and two grouped ciphertexts.
- **Inputs**:
    - `transcript`: A pointer to an `fd_zksdk_transcript_t` structure that will be initialized.
    - `context`: A pointer to a constant `fd_zksdk_batched_grp_ciph_3h_val_context_t` structure containing public keys and grouped ciphertexts.
- **Logic and Control Flow**:
    - Call `fd_zksdk_transcript_init` to initialize the `transcript` with a specific literal string.
    - Append the first public key from `context->pubkey1` to the `transcript` using `fd_zksdk_transcript_append_pubkey`.
    - Append the second public key from `context->pubkey2` to the `transcript`.
    - Append the third public key from `context->pubkey3` to the `transcript`.
    - Append the low grouped ciphertext from `context->grouped_ciphertext_lo` to the `transcript` using `fd_zksdk_transcript_append_message`.
    - Append the high grouped ciphertext from `context->grouped_ciphertext_hi` to the `transcript`.
- **Output**: The function does not return a value; it modifies the `transcript` in place.


---
### fd\_zksdk\_verify\_proof\_batched\_grouped\_ciphertext\_3\_handles\_validity<!-- {{#callable:fd_zksdk_verify_proof_batched_grouped_ciphertext_3_handles_validity}} -->
[View Source →](<../../../../../../../../src/flamenco/runtime/program/zksdk/instructions/fd_zksdk_batched_grouped_ciphertext_3_handles_validity.c#L15>)

Verifies the validity of a batched grouped ciphertext proof with three handles using Ristretto255 points and scalars.
- **Inputs**:
    - `proof`: A pointer to a `fd_zksdk_grp_ciph_3h_val_proof_t` structure containing the proof data.
    - `pubkey1`: A 32-byte array representing the first public key.
    - `pubkey2`: A 32-byte array representing the second public key.
    - `pubkey3`: A 32-byte array representing the third public key.
    - `comm`: A 32-byte array representing the commitment.
    - `handle1`: A 32-byte array representing the first handle.
    - `handle2`: A 32-byte array representing the second handle.
    - `handle3`: A 32-byte array representing the third handle.
    - `comm_hi`: A 32-byte array representing the high commitment, used if `batched` is true.
    - `handle1_hi`: A 32-byte array representing the high first handle, used if `batched` is true.
    - `handle2_hi`: A 32-byte array representing the high second handle, used if `batched` is true.
    - `handle3_hi`: A 32-byte array representing the high third handle, used if `batched` is true.
    - `batched`: A boolean indicating if the proof is batched.
    - `transcript`: A pointer to a `fd_zksdk_transcript_t` structure used for the transcript of the proof.
- **Logic and Control Flow**:
    - Initialize arrays for scalars and points, and set base points `G` and `H`.
    - Validate the scalars `zr` and `zx` from the proof; return error if invalid.
    - Decompress and validate the points `y0`, `comm`, `pubkey1`, `y1`, `handle1`, `pubkey2`, `y2`, `handle2`, `pubkey3`, `y3`, and `handle3`; return error if any decompression fails.
    - If `batched` is true, decompress and validate `comm_hi`, `handle1_hi`, `handle2_hi`, and `handle3_hi`; return error if any decompression fails.
    - Initialize the transcript with domain separation for batched or non-batched proofs.
    - Append and validate points `Y_0`, `Y_1`, and `Y_2` to the transcript; return error if validation fails.
    - Append point `Y_3` to the transcript without validation.
    - Extract challenge scalars `c` and `w` from the transcript.
    - Compute the scalar values for the multi-scalar multiplication (MSM) based on the proof and challenges.
    - Perform the MSM with the computed scalars and points.
    - Check if the result of the MSM equals `y0`; return success if true, otherwise return error.
- **Output**: Returns `FD_EXECUTOR_INSTR_SUCCESS` if the proof is valid, otherwise returns `FD_ZKSDK_VERIFY_PROOF_ERROR`.


---
### fd\_zksdk\_instr\_verify\_proof\_batched\_grouped\_ciphertext\_3\_handles\_validity<!-- {{#callable:fd_zksdk_instr_verify_proof_batched_grouped_ciphertext_3_handles_validity}} -->
[View Source →](<../../../../../../../../src/flamenco/runtime/program/zksdk/instructions/fd_zksdk_batched_grouped_ciphertext_3_handles_validity.c#L178>)

Verifies the validity of a batched grouped ciphertext proof using three handles.
- **Inputs**:
    - `_context`: A pointer to a `fd_zksdk_batched_grp_ciph_3h_val_context_t` structure containing public keys and grouped ciphertext data.
    - `_proof`: A pointer to a `fd_zksdk_batched_grp_ciph_3h_val_proof_t` structure containing the proof data to verify.
- **Logic and Control Flow**:
    - Initialize a `fd_zksdk_transcript_t` object using [`batched_grouped_ciphertext_validity_transcript_init`](<#batched_grouped_ciphertext_validity_transcript_init>) with the provided context.
    - Call [`fd_zksdk_verify_proof_batched_grouped_ciphertext_3_handles_validity`](<#fd_zksdk_verify_proof_batched_grouped_ciphertext_3_handles_validity>) with the proof, public keys, commitments, handles, and the initialized transcript to verify the proof.
    - Return the result of the verification function, which indicates success or failure of the proof verification.
- **Output**: An integer indicating the success or failure of the proof verification process.
- **Functions Called**:
    - [`batched_grouped_ciphertext_validity_transcript_init`](<#batched_grouped_ciphertext_validity_transcript_init>)
    - [`fd_zksdk_verify_proof_batched_grouped_ciphertext_3_handles_validity`](<#fd_zksdk_verify_proof_batched_grouped_ciphertext_3_handles_validity>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)