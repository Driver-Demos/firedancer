<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines structures and functions for verifying batched grouped ciphertext validity proofs.

# Purpose
The code is a C header file that defines data structures and function prototypes for verifying the validity of grouped ciphertexts in a zero-knowledge proof context. It includes definitions for several packed structures, such as `fd_zksdk_grp_ciph_2h_val_proof` and `fd_zksdk_grp_ciph_3h_val_proof`, which represent proofs with two and three handles, respectively. These structures contain arrays of unsigned characters (`uchar`) that represent cryptographic points and scalars. The file also defines context structures like `fd_zksdk_grp_ciph_2h_val_context` and `fd_zksdk_batched_grp_ciph_3h_val_context`, which include public keys and grouped ciphertexts, indicating their role in cryptographic operations.

The header file provides function prototypes for verifying proofs of batched grouped ciphertext validity, specifically [`fd_zksdk_verify_proof_batched_grouped_ciphertext_2_handles_validity`](<#fd_zksdk_verify_proof_batched_grouped_ciphertext_2_handles_validity>) and [`fd_zksdk_verify_proof_batched_grouped_ciphertext_3_handles_validity`](<#fd_zksdk_verify_proof_batched_grouped_ciphertext_3_handles_validity>). These functions take as input the proof structures, public keys, commitments, handles, and a transcript, and they return an integer indicating the result of the verification process. The inclusion of these functions suggests that the file is part of a larger cryptographic library or application that deals with zero-knowledge proofs and secure communication.
# Imports and Dependencies

---
- `../../../../fd_flamenco_base.h`


# Data Structures

---
### fd\_zksdk\_grp\_ciph\_2h\_val\_proof
- **Type**: ``struct``
- **Members**:
    - `y0`: An array of 32 unsigned characters representing a point.
    - `y1`: An array of 32 unsigned characters representing a point.
    - `y2`: An array of 32 unsigned characters representing a point.
    - `zr`: An array of 32 unsigned characters representing a scalar.
    - `zx`: An array of 32 unsigned characters representing a scalar.
- **Description**: Represents a packed data structure used in zero-knowledge proofs for grouped ciphertext validity, containing three points (`y0`, `y1`, `y2`) and two scalars (`zr`, `zx`).


---
### fd\_zksdk\_grp\_ciph\_2h\_val\_proof\_t
- **Type**: ``struct``
- **Members**:
    - ``y0``: An array of 32 unsigned characters representing a point.
    - ``y1``: An array of 32 unsigned characters representing a point.
    - ``y2``: An array of 32 unsigned characters representing a point.
    - ``zr``: An array of 32 unsigned characters representing a scalar.
    - ``zx``: An array of 32 unsigned characters representing a scalar.
- **Description**: Defines a packed structure used to store proof data for grouped ciphertext validity with two handles, consisting of three points (`y0`, `y1`, `y2`) and two scalars (`zr`, `zx`).


---
### fd\_zksdk\_grp\_ciph\_3h\_val\_proof
- **Type**: ``struct``
- **Members**:
    - `y0`: An array of 32 unsigned characters representing a point.
    - `y1`: An array of 32 unsigned characters representing a point.
    - `y2`: An array of 32 unsigned characters representing a point.
    - `y3`: An array of 32 unsigned characters representing a point.
    - `zr`: An array of 32 unsigned characters representing a scalar.
    - `zx`: An array of 32 unsigned characters representing a scalar.
- **Description**: Represents a proof structure used in zero-knowledge proofs for grouped ciphertext validity with three handles, containing four points (`y0`, `y1`, `y2`, `y3`) and two scalars (`zr`, `zx`).


---
### fd\_zksdk\_grp\_ciph\_3h\_val\_proof\_t
- **Type**: ``struct``
- **Members**:
    - `y0`: An array of 32 unsigned characters representing a point.
    - `y1`: An array of 32 unsigned characters representing a point.
    - `y2`: An array of 32 unsigned characters representing a point.
    - `y3`: An array of 32 unsigned characters representing a point.
    - `zr`: An array of 32 unsigned characters representing a scalar.
    - `zx`: An array of 32 unsigned characters representing a scalar.
- **Description**: Defines a packed structure for a proof in a zero-knowledge protocol, containing four points (`y0`, `y1`, `y2`, `y3`) and two scalars (`zr`, `zx`).


---
### grp\_ciph\_handle
- **Type**: ``struct``
- **Members**:
    - `handle`: An array of 32 unsigned characters representing a point.
- **Description**: Defines a packed structure with a single member `handle`, which is an array of 32 unsigned characters. This structure is used to represent a handle in the context of grouped ciphertext validity proofs, where each handle is a point in a cryptographic context.


---
### grp\_ciph\_handle\_t
- **Type**: ``struct``
- **Members**:
    - `handle`: An array of 32 unsigned characters representing a point.
- **Description**: Defines a structure with a single member, `handle`, which is an array of 32 unsigned characters. This structure is used to represent a handle in the context of grouped ciphertext validity proofs, where each handle is a point in a cryptographic context.


---
### grp\_ciph\_2h
- **Type**: ``struct``
- **Members**:
    - `commitment`: An array of 32 unsigned characters representing a point.
    - `handles`: An array of 2 `grp_ciph_handle_t` structures, each representing a point.
- **Description**: Represents a packed structure containing a commitment point and two handle points, used in grouped ciphertext validity proofs.


---
### grp\_ciph\_2h\_t
- **Type**: ``struct``
- **Members**:
    - `commitment`: A 32-byte array representing a point.
    - `handles`: An array of two `grp_ciph_handle_t` structures, each representing a point.
- **Description**: Represents a grouped ciphertext with two handles, where `commitment` is a point and `handles` is an array of two points, each encapsulated in a `grp_ciph_handle_t` structure.


---
### grp\_ciph\_3h
- **Type**: ``struct``
- **Members**:
    - `commitment`: An array of 32 unsigned characters representing a point.
    - `handles`: An array of 3 `grp_ciph_handle_t` structures, each representing a point.
- **Description**: Represents a packed structure containing a commitment point and three handle points, used in grouped ciphertext validity proofs.


---
### grp\_ciph\_3h\_t
- **Type**: ``struct``
- **Members**:
    - `commitment`: An array of 32 unsigned characters representing a point.
    - `handles`: An array of 3 `grp_ciph_handle_t` structures, each representing a point.
- **Description**: Defines a structure that contains a commitment point and three handle points, used in the context of grouped ciphertext validity proofs.


---
### fd\_zksdk\_grp\_ciph\_2h\_val\_context
- **Type**: ``struct``
- **Members**:
    - `pubkey1`: An array of 32 unsigned characters representing a point.
    - `pubkey2`: An array of 32 unsigned characters representing a point.
    - `grouped_ciphertext`: A `grp_ciph_2h_t` structure containing 3 points.
- **Description**: Defines a context for validating grouped ciphertexts with two handles, containing two public keys and a grouped ciphertext structure with three points.


---
### fd\_zksdk\_grp\_ciph\_2h\_val\_context\_t
- **Type**: ``struct``
- **Members**:
    - `pubkey1`: A 32-byte array representing a point.
    - `pubkey2`: A 32-byte array representing a point.
    - `grouped_ciphertext`: A `grp_ciph_2h_t` structure containing 3 points.
- **Description**: Defines a context for grouped ciphertext validity with two handles, including two public keys and a grouped ciphertext structure with two handles.


---
### fd\_zksdk\_batched\_grp\_ciph\_2h\_val\_context
- **Type**: ``struct``
- **Members**:
    - `pubkey1`: An array of 32 unsigned characters representing a point.
    - `pubkey2`: An array of 32 unsigned characters representing a point.
    - `grouped_ciphertext_lo`: A `grp_ciph_2h_t` structure representing a grouped ciphertext with 3 points.
    - `grouped_ciphertext_hi`: A `grp_ciph_2h_t` structure representing a grouped ciphertext with 3 points.
- **Description**: Represents a context for batched grouped ciphertext validity with two public keys and two grouped ciphertexts, each containing three points.


---
### fd\_zksdk\_batched\_grp\_ciph\_2h\_val\_context\_t
- **Type**: ``struct``
- **Members**:
    - `pubkey1`: A 32-byte array representing a point.
    - `pubkey2`: A 32-byte array representing a point.
    - `grouped_ciphertext_lo`: A `grp_ciph_2h_t` structure representing a grouped ciphertext with 3 points.
    - `grouped_ciphertext_hi`: A `grp_ciph_2h_t` structure representing a grouped ciphertext with 3 points.
- **Description**: Represents a context for batched grouped ciphertext validity with two handles, containing two public keys and two grouped ciphertexts, each with two handles.


---
### fd\_zksdk\_grp\_ciph\_3h\_val\_context
- **Type**: ``struct``
- **Members**:
    - `pubkey1`: An array of 32 unsigned characters representing a point.
    - `pubkey2`: An array of 32 unsigned characters representing a point.
    - `pubkey3`: An array of 32 unsigned characters representing a point.
    - `grouped_ciphertext`: A `grp_ciph_3h_t` structure representing 4 points.
- **Description**: Represents a context for validating grouped ciphertexts with three public keys and a grouped ciphertext structure containing four points.


---
### fd\_zksdk\_grp\_ciph\_3h\_val\_context\_t
- **Type**: ``struct``
- **Members**:
    - `pubkey1`: A 32-byte array representing a point.
    - `pubkey2`: A 32-byte array representing a point.
    - `pubkey3`: A 32-byte array representing a point.
    - `grouped_ciphertext`: A `grp_ciph_3h_t` structure containing 4 points.
- **Description**: Defines a context for grouped ciphertext validity with three public keys and a grouped ciphertext structure containing three handles. This structure is used in zero-knowledge proofs to verify the validity of ciphertexts grouped with three handles.


---
### fd\_zksdk\_batched\_grp\_ciph\_3h\_val\_context
- **Type**: ``struct``
- **Members**:
    - `pubkey1`: An array of 32 unsigned characters representing a point.
    - `pubkey2`: An array of 32 unsigned characters representing a point.
    - `pubkey3`: An array of 32 unsigned characters representing a point.
    - `grouped_ciphertext_lo`: A `grp_ciph_3h_t` structure representing 4 points.
    - `grouped_ciphertext_hi`: A `grp_ciph_3h_t` structure representing 4 points.
- **Description**: Represents a context for batched grouped ciphertext validity with three public keys and two sets of grouped ciphertexts, each containing four points.


---
### fd\_zksdk\_batched\_grp\_ciph\_3h\_val\_context\_t
- **Type**: ``struct``
- **Members**:
    - `pubkey1`: A 32-byte array representing a public key point.
    - `pubkey2`: A 32-byte array representing a second public key point.
    - `pubkey3`: A 32-byte array representing a third public key point.
    - `grouped_ciphertext_lo`: A `grp_ciph_3h_t` structure representing the lower grouped ciphertext with 4 points.
    - `grouped_ciphertext_hi`: A `grp_ciph_3h_t` structure representing the higher grouped ciphertext with 4 points.
- **Description**: Represents a context for batched grouped ciphertext validity with three public keys and two sets of grouped ciphertexts, each containing four points.


# Function Declarations (Public API)

---
### fd\_zksdk\_verify\_proof\_batched\_grouped\_ciphertext\_2\_handles\_validity<!-- {{#callable_declaration:fd_zksdk_verify_proof_batched_grouped_ciphertext_2_handles_validity}} -->
[View Source →](<../../../../../../../../src/flamenco/runtime/program/zksdk/instructions/fd_zksdk_batched_grouped_ciphertext_validity.h#L91>)

Verifies the validity of a batched grouped ciphertext proof with two handles.
- **Description**: Use this function to verify the validity of a proof for a batched grouped ciphertext with two handles. It checks the equivalences of the provided proof against the public keys, commitments, and handles. The function requires a valid proof structure and expects the public keys, commitments, and handles to be 32-byte arrays. If the `batched` parameter is true, additional high-order commitments and handles are used in the verification. The function updates the provided transcript with the verification process details. Ensure that the `pubkey2`, `handle2`, and `handle2_hi` are zeroed if `pubkey2` is zero. The function returns an integer indicating success or failure of the verification.
- **Inputs**:
    - `proof`: A pointer to a `fd_zksdk_grp_ciph_2h_val_proof_t` structure containing the proof data. Must not be null.
    - `pubkey1`: A 32-byte array representing the first public key. Must be a valid point.
    - `pubkey2`: A 32-byte array representing the second public key. Must be a valid point or all zeros if not used.
    - `comm`: A 32-byte array representing the commitment. Must be a valid point.
    - `handle1`: A 32-byte array representing the first handle. Must be a valid point.
    - `handle2`: A 32-byte array representing the second handle. Must be a valid point or all zeros if `pubkey2` is zero.
    - `comm_hi`: A 32-byte array representing the high-order commitment. Used only if `batched` is true. Must be a valid point if used.
    - `handle1_hi`: A 32-byte array representing the high-order first handle. Used only if `batched` is true. Must be a valid point if used.
    - `handle2_hi`: A 32-byte array representing the high-order second handle. Used only if `batched` is true and `pubkey2` is not zero. Must be a valid point if used.
    - `batched`: A boolean indicating whether the proof is batched. If true, high-order commitments and handles are used.
    - `transcript`: A pointer to a `fd_zksdk_transcript_t` structure used to store the transcript of the verification process. Must not be null.
- **Output**: Returns an integer indicating the success or failure of the verification. A specific error code is returned if verification fails.
- **See Also**: [`fd_zksdk_verify_proof_batched_grouped_ciphertext_2_handles_validity`](<fd_zksdk_batched_grouped_ciphertext_2_handles_validity.c.md#fd_zksdk_verify_proof_batched_grouped_ciphertext_2_handles_validity>)  (Implementation)


---
### fd\_zksdk\_verify\_proof\_batched\_grouped\_ciphertext\_3\_handles\_validity<!-- {{#callable_declaration:fd_zksdk_verify_proof_batched_grouped_ciphertext_3_handles_validity}} -->
[View Source →](<../../../../../../../../src/flamenco/runtime/program/zksdk/instructions/fd_zksdk_batched_grouped_ciphertext_validity.h#L105>)

Verifies the validity of a batched grouped ciphertext proof with three handles.
- **Description**: Use this function to verify the validity of a proof for a batched grouped ciphertext with three handles. It requires a proof structure, three public keys, a commitment, three handles, and optionally their high parts if batched. The function also needs a transcript for challenge extraction. The `batched` parameter determines if the high parts are used. The function returns an integer indicating success or failure of the verification. Ensure all input arrays are correctly sized and initialized before calling.
- **Inputs**:
    - `proof`: A pointer to a `fd_zksdk_grp_ciph_3h_val_proof_t` structure containing the proof data. Must not be null.
    - `pubkey1`: An array of 32 unsigned characters representing the first public key. Must be a valid point.
    - `pubkey2`: An array of 32 unsigned characters representing the second public key. Must be a valid point.
    - `pubkey3`: An array of 32 unsigned characters representing the third public key. Must be a valid point.
    - `comm`: An array of 32 unsigned characters representing the commitment. Must be a valid point.
    - `handle1`: An array of 32 unsigned characters representing the first handle. Must be a valid point.
    - `handle2`: An array of 32 unsigned characters representing the second handle. Must be a valid point.
    - `handle3`: An array of 32 unsigned characters representing the third handle. Must be a valid point.
    - `comm_hi`: An array of 32 unsigned characters representing the high part of the commitment, used if `batched` is true. Must be a valid point if used.
    - `handle1_hi`: An array of 32 unsigned characters representing the high part of the first handle, used if `batched` is true. Must be a valid point if used.
    - `handle2_hi`: An array of 32 unsigned characters representing the high part of the second handle, used if `batched` is true. Must be a valid point if used.
    - `handle3_hi`: An array of 32 unsigned characters representing the high part of the third handle, used if `batched` is true. Must be a valid point if used.
    - `batched`: A boolean indicating whether the proof is batched. If true, high parts of the commitment and handles are used.
    - `transcript`: A pointer to a `fd_zksdk_transcript_t` structure used for challenge extraction. Must not be null.
- **Output**: Returns an integer indicating success or failure of the proof verification. Returns a specific error code if validation fails.
- **See Also**: [`fd_zksdk_verify_proof_batched_grouped_ciphertext_3_handles_validity`](<fd_zksdk_batched_grouped_ciphertext_3_handles_validity.c.md#fd_zksdk_verify_proof_batched_grouped_ciphertext_3_handles_validity>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)