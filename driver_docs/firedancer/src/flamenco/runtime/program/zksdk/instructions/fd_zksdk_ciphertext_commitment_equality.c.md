<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Implements functions to verify proofs of ciphertext-commitment equality using zero-knowledge protocols.

# Purpose
The code defines functions for verifying a proof of ciphertext-commitment equality within a zero-knowledge proof system. It includes the function [`ciph_comm_eq_transcript_init`](<#ciph_comm_eq_transcript_init>), which initializes a transcript with specific data related to the public key, ciphertext, and commitment. This function is used to prepare the transcript for further operations by appending these elements to it. The main function, [`fd_zksdk_verify_proof_ciphertext_commitment_equality`](<#fd_zksdk_verify_proof_ciphertext_commitment_equality>), performs the verification of the proof by checking the equivalence of several mathematical expressions involving elliptic curve points and scalars. It uses multi-scalar multiplication (MSM) to efficiently verify these expressions in a single operation.

The code also includes the function [`fd_zksdk_instr_verify_proof_ciphertext_commitment_equality`](<#fd_zksdk_instr_verify_proof_ciphertext_commitment_equality>), which serves as an interface to verify the proof using the context and proof data provided. This function initializes the transcript and calls the main verification function. The code is part of a cryptographic library and is intended to be used as part of a larger system that requires verification of zero-knowledge proofs. It does not define a public API but provides internal functionality for proof verification.
# Imports and Dependencies

---
- `../fd_zksdk_private.h`


# Functions

---
### ciph\_comm\_eq\_transcript\_init<!-- {{#callable:ciph_comm_eq_transcript_init}} -->
[View Source →](<../../../../../../../../src/flamenco/runtime/program/zksdk/instructions/fd_zksdk_ciphertext_commitment_equality.c#L3>)

Initializes a transcript for a ciphertext-commitment equality instruction using provided context data.
- **Inputs**:
    - `transcript`: A pointer to an `fd_zksdk_transcript_t` structure that will be initialized.
    - `context`: A pointer to a constant `fd_zksdk_ciph_comm_eq_context_t` structure containing the public key, ciphertext, and commitment data.
- **Logic and Control Flow**:
    - Call `fd_zksdk_transcript_init` to initialize the `transcript` with the literal string 'ciphertext-commitment-equality-instruction'.
    - Call `fd_zksdk_transcript_append_pubkey` to append the public key from `context` to the `transcript` with the label 'pubkey'.
    - Call `fd_zksdk_transcript_append_ciphertext` to append the ciphertext from `context` to the `transcript` with the label 'ciphertext'.
    - Call `fd_zksdk_transcript_append_commitment` to append the commitment from `context` to the `transcript` with the label 'commitment'.
- **Output**: No return value; the function modifies the `transcript` in place.


---
### fd\_zksdk\_verify\_proof\_ciphertext\_commitment\_equality<!-- {{#callable:fd_zksdk_verify_proof_ciphertext_commitment_equality}} -->
[View Source →](<../../../../../../../../src/flamenco/runtime/program/zksdk/instructions/fd_zksdk_ciphertext_commitment_equality.c#L12>)

Verifies the equality of a ciphertext and commitment using a zero-knowledge proof by checking multiple scalar multiplications.
- **Inputs**:
    - `proof`: A pointer to a `fd_zksdk_ciph_comm_eq_proof_t` structure containing the proof data.
    - `pubkey`: A 32-byte array representing the public key.
    - `ciphertext`: A 64-byte array representing the ciphertext.
    - `commitment`: A 32-byte array representing the commitment.
    - `transcript`: A pointer to a `fd_zksdk_transcript_t` structure used for maintaining the transcript of the proof verification process.
- **Logic and Control Flow**:
    - Initialize arrays for scalars and points, and validate the scalar values in the `proof` structure.
    - Decompress points from the `proof`, `pubkey`, `ciphertext`, and `commitment` into the `points` array.
    - Initialize the transcript with domain separation and append points from the `proof` to the transcript.
    - Extract challenge scalars `c` and `w` from the transcript.
    - Compute the scalar values for the multi-scalar multiplication (MSM) using the challenge scalars and proof values.
    - Perform the MSM with the computed scalars and points.
    - Check if the result of the MSM matches the decompressed `y2` point.
    - Return `FD_EXECUTOR_INSTR_SUCCESS` if the points match, otherwise return `FD_ZKSDK_VERIFY_PROOF_ERROR`.
- **Output**: Returns an integer indicating success (`FD_EXECUTOR_INSTR_SUCCESS`) or failure (`FD_ZKSDK_VERIFY_PROOF_ERROR`) of the proof verification.


---
### fd\_zksdk\_instr\_verify\_proof\_ciphertext\_commitment\_equality<!-- {{#callable:fd_zksdk_instr_verify_proof_ciphertext_commitment_equality}} -->
[View Source →](<../../../../../../../../src/flamenco/runtime/program/zksdk/instructions/fd_zksdk_ciphertext_commitment_equality.c#L122>)

Verifies the equality of a ciphertext and commitment using a zero-knowledge proof.
- **Inputs**:
    - `_context`: A pointer to a `fd_zksdk_ciph_comm_eq_context_t` structure containing the public key, ciphertext, and commitment.
    - `_proof`: A pointer to a `fd_zksdk_ciph_comm_eq_proof_t` structure containing the proof data.
- **Logic and Control Flow**:
    - Initialize a `fd_zksdk_transcript_t` object to store the transcript data.
    - Cast `_context` to a `fd_zksdk_ciph_comm_eq_context_t` pointer and `_proof` to a `fd_zksdk_ciph_comm_eq_proof_t` pointer.
    - Call [`ciph_comm_eq_transcript_init`](<#ciph_comm_eq_transcript_init>) to initialize the transcript with the context data.
    - Call [`fd_zksdk_verify_proof_ciphertext_commitment_equality`](<#fd_zksdk_verify_proof_ciphertext_commitment_equality>) with the proof, public key, ciphertext, commitment, and transcript to verify the proof.
    - Return the result of the verification function.
- **Output**: Returns an integer indicating success or failure of the proof verification.
- **Functions Called**:
    - [`ciph_comm_eq_transcript_init`](<#ciph_comm_eq_transcript_init>)
    - [`fd_zksdk_verify_proof_ciphertext_commitment_equality`](<#fd_zksdk_verify_proof_ciphertext_commitment_equality>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)