<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Processes configuration instructions for the Solana Config Program, handling deserialization, validation, and execution.

# Purpose
The code is a C implementation of a configuration program processor for a blockchain system, specifically designed to handle configuration instructions. It is part of a larger system that interacts with accounts and transactions, as indicated by the inclusion of headers such as `fd_borrowed_account.h`, `fd_executor.h`, and `fd_system_ids.h`. The primary function, [`fd_config_program_execute`](<#fd_config_program_execute>), serves as the entry point for executing configuration instructions. It checks for certain conditions, such as whether the program has been migrated to a core BPF, and updates the compute units used by the transaction context.

The core functionality is implemented in the [`_process_config_instr`](<#_process_config_instr>) function, which processes configuration instructions by deserializing instruction data, verifying account ownership and signatures, and ensuring the integrity of the configuration keys. It performs various checks to validate the instruction data, such as ensuring the absence of duplicate keys and verifying that the required signatures are present. The function also handles the borrowing and releasing of account data, ensuring that the configuration account is correctly updated with the new instruction data. The code is structured to handle errors robustly, returning specific error codes when validation checks fail.
# Imports and Dependencies

---
- `fd_config_program.h`
- `../fd_borrowed_account.h`
- `../fd_executor.h`
- `../fd_system_ids.h`
- `../context/fd_exec_instr_ctx.h`


# Functions

---
### \_process\_config\_instr<!-- {{#callable:_process_config_instr}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_config_program.c#L15>)

Processes configuration instructions by deserializing data, verifying account ownership and signatures, and updating account data.
- **Inputs**:
    - `ctx`: A pointer to a `fd_exec_instr_ctx_t` structure that contains the execution context for the instruction.
- **Logic and Control Flow**:
    - Check if the instruction data is NULL and return an error if true.
    - Deserialize the instruction data into a list of configuration keys and check for decoding errors or size issues.
    - Borrow the configuration account and verify its ownership against the expected program ID.
    - Deserialize the current configuration data from the account and check for decoding errors.
    - Drop the borrowed account handle after use.
    - Allocate memory for current signer keys and populate it with keys marked as signers from the current data.
    - Check if there are no signer keys and the configuration account has not signed the transaction, returning an error if true.
    - Iterate over the deserialized key list to verify each signer's presence and signature validity, returning errors for any discrepancies.
    - Check for duplicate keys in the key list and return an error if found.
    - Verify that the number of signers matches the expected count, returning an error if there are too few signers.
    - Re-borrow the configuration account with a writable handle and check if the account data length is sufficient for the instruction data.
    - Copy the instruction data into the account data and return success.
- **Output**: Returns an integer status code indicating success or a specific error condition.


---
### fd\_config\_program\_execute<!-- {{#callable:fd_config_program_execute}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_config_program.c#L233>)

Executes a configuration program instruction within a given execution context, ensuring it is not a migrated native program and updating compute units.
- **Inputs**:
    - `ctx`: A pointer to an `fd_exec_instr_ctx_t` structure that contains the execution context for the instruction.
- **Logic and Control Flow**:
    - Check if the program is a migrated native program using `FD_FEATURE_ACTIVE_BANK`; if true, return `FD_EXECUTOR_INSTR_ERR_UNSUPPORTED_PROGRAM_ID`.
    - Update the compute units in the context using `FD_EXEC_CU_UPDATE` with `DEFAULT_COMPUTE_UNITS`.
    - Begin a frame in the scratchpad memory using `FD_SPAD_FRAME_BEGIN`.
    - Call the [`_process_config_instr`](<#_process_config_instr>) function with the context `ctx` to process the configuration instruction.
    - Return the result of [`_process_config_instr`](<#_process_config_instr>).
    - End the frame in the scratchpad memory using `FD_SPAD_FRAME_END`.
- **Output**: Returns an integer status code, which is the result of the [`_process_config_instr`](<#_process_config_instr>) function or an error code if the program is a migrated native program.
- **Functions Called**:
    - [`_process_config_instr`](<#_process_config_instr>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)