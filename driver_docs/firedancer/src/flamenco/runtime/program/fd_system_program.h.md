<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines error types, instruction handlers, and user APIs for executing system program operations.

# Purpose
The code is a C header file that defines the interface for a system program within a runtime environment, likely related to a blockchain or distributed ledger system. It includes definitions for custom error types, constants, and function prototypes that handle various system program instructions. The file provides a set of error codes, such as `FD_SYSTEM_PROGRAM_ERR_ACCT_ALREADY_IN_USE` and `FD_SYSTEM_PROGRAM_ERR_INVALID_PROGRAM_ID`, which are used to identify specific error conditions that can occur during the execution of system program instructions.

The header file declares several function prototypes for executing system program instructions, such as [`fd_system_program_exec_create_account`](<#fd_system_program_exec_create_account>), [`fd_system_program_exec_transfer`](<#fd_system_program_exec_transfer>), and [`fd_system_program_exec_initialize_nonce_account`](<#fd_system_program_exec_initialize_nonce_account>). These functions are designed to perform operations like creating accounts, transferring lamports (a unit of currency), and managing nonce accounts. Additionally, the file includes user API functions like [`fd_check_transaction_age`](<#fd_check_transaction_age>) and [`fd_get_system_account_kind`](<#fd_get_system_account_kind>), which provide utility functions for checking transaction validity and determining account types. The file is intended to be included in other C source files that implement or utilize the system program's functionality.
# Imports and Dependencies

---
- `../../fd_flamenco_base.h`
- `../../types/fd_types.h`


# Function Declarations (Public API)

---
### fd\_system\_program\_execute<!-- {{#callable_declaration:fd_system_program_execute}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_system_program.h#L26>)

Executes a system program instruction.
- **Description**: Use this function to execute a system program instruction based on the context provided. It processes the instruction data and dispatches it to the appropriate handler function. Ensure that the `ctx` parameter is valid and properly initialized before calling this function. The function returns an error code if the instruction data is invalid or if an error occurs during execution.
- **Inputs**:
    - `ctx`: A pointer to a `fd_exec_instr_ctx_t` structure that contains the execution context for the instruction. Must not be null. The caller retains ownership and must ensure it is properly initialized before calling.
- **Output**: Returns an integer error code indicating the result of the execution. Possible error codes include `FD_EXECUTOR_INSTR_ERR_INVALID_INSTR_DATA` for invalid instruction data and `FD_EXECUTOR_INSTR_ERR_INVALID_ARG` for invalid arguments.
- **See Also**: [`fd_system_program_execute`](<fd_system_program.c.md#fd_system_program_execute>)  (Implementation)


---
### fd\_system\_program\_exec\_create\_account<!-- {{#callable_declaration:fd_system_program_exec_create_account}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_system_program.h#L34>)

Creates a new account in the system program.
- **Description**: Use this function to create a new account within the system program context. It requires a valid execution instruction context and account creation data. Ensure that the context has at least two account keys before calling this function. The function checks for authorization and handles errors related to account creation, such as insufficient account keys or invalid parameters. It is important to provide valid account creation data to avoid errors.
- **Inputs**:
    - `ctx`: A pointer to an `fd_exec_instr_ctx_t` structure representing the execution instruction context. Must not be null and must contain at least two account keys. The caller retains ownership.
    - `create_acc`: A pointer to a constant `fd_system_program_instruction_create_account_t` structure containing the account creation parameters. Must not be null. The caller retains ownership.
- **Output**: Returns an integer indicating success or an error code. Possible errors include insufficient account keys or other account creation errors.
- **See Also**: [`fd_system_program_exec_create_account`](<fd_system_program.c.md#fd_system_program_exec_create_account>)  (Implementation)


---
### fd\_system\_program\_exec\_assign<!-- {{#callable_declaration:fd_system_program_exec_assign}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_system_program.h#L35>)

Assigns a new owner to an account in the execution context.
- **Description**: Use this function to change the owner of an account specified in the execution context. It requires that the context has at least one account key. If the account key count is less than one, the function returns an error. This function should be called when you need to update the ownership of an account within a transaction execution context.
- **Inputs**:
    - `ctx`: A pointer to an `fd_exec_instr_ctx_t` structure representing the execution context. This must not be null and must contain at least one account key.
    - `owner`: A pointer to an `fd_pubkey_t` structure representing the new owner's public key. This must not be null.
- **Output**: Returns 0 on success. If the account key count is less than one, it returns `FD_EXECUTOR_INSTR_ERR_NOT_ENOUGH_ACC_KEYS`. Other non-zero values indicate different errors during execution.
- **See Also**: [`fd_system_program_exec_assign`](<fd_system_program.c.md#fd_system_program_exec_assign>)  (Implementation)


---
### fd\_system\_program\_exec\_transfer<!-- {{#callable_declaration:fd_system_program_exec_transfer}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_system_program.h#L36>)

Transfers a specified amount of lamports between accounts.
- **Description**: Use this function to transfer a specified amount of lamports from one account to another within the system program. Ensure that the `ctx` parameter points to a valid instruction context with at least two account keys. This function is typically called when executing a transfer instruction in the Solana system program. It returns an error code if there are not enough account keys available in the context.
- **Inputs**:
    - `ctx`: A pointer to a `fd_exec_instr_ctx_t` structure representing the execution context for the instruction. It must not be null and must contain at least two account keys. The caller retains ownership.
    - `transfer_amount`: The amount of lamports to transfer. It must be a non-negative value.
- **Output**: Returns an integer error code. If successful, the transfer is executed; otherwise, an error code is returned indicating the failure reason, such as insufficient account keys.
- **See Also**: [`fd_system_program_exec_transfer`](<fd_system_program.c.md#fd_system_program_exec_transfer>)  (Implementation)


---
### fd\_system\_program\_exec\_create\_account\_with\_seed<!-- {{#callable_declaration:fd_system_program_exec_create_account_with_seed}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_system_program.h#L37>)

Creates an account with a seed in the system program.
- **Description**: Use this function to create a new account in the system program using a seed. This function requires a valid execution context and instruction arguments. It checks for the necessary number of account keys and verifies the seed address before creating the account. Ensure that the context has at least two account keys available. The function returns an error code if the operation fails, such as when there are not enough account keys or if the seed address verification fails.
- **Inputs**:
    - `ctx`: A pointer to an `fd_exec_instr_ctx_t` structure representing the execution context. Must not be null and must contain at least two account keys.
    - `args`: A pointer to a `fd_system_program_instruction_create_account_with_seed_t` structure containing the instruction arguments. Must not be null. The structure includes the base public key, seed, seed length, owner public key, lamports, and space for the account.
- **Output**: Returns an integer error code. A non-zero value indicates an error, such as insufficient account keys or seed address verification failure.
- **See Also**: [`fd_system_program_exec_create_account_with_seed`](<fd_system_program.c.md#fd_system_program_exec_create_account_with_seed>)  (Implementation)


---
### fd\_system\_program\_exec\_advance\_nonce\_account<!-- {{#callable_declaration:fd_system_program_exec_advance_nonce_account}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_system_program.h#L38>)

Advances the nonce account in the system program.
- **Description**: Use this function to advance the nonce account within the system program context. It must be called with a valid execution instruction context that contains at least one account key. The function checks for recent blockhashes and logs an error if none are available, returning a custom error code. Ensure that the context is properly initialized and contains the necessary account information before calling this function.
- **Inputs**:
    - `ctx`: A pointer to an `fd_exec_instr_ctx_t` structure representing the execution instruction context. It must not be null and must contain at least one account key. The caller retains ownership of this pointer.
- **Output**: Returns an integer status code. A return value of zero indicates success, while a non-zero value indicates an error, such as insufficient account keys or missing recent blockhashes.
- **See Also**: [`fd_system_program_exec_advance_nonce_account`](<fd_system_program_nonce.c.md#fd_system_program_exec_advance_nonce_account>)  (Implementation)


---
### fd\_system\_program\_exec\_withdraw\_nonce\_account<!-- {{#callable_declaration:fd_system_program_exec_withdraw_nonce_account}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_system_program.h#L39>)

Withdraws lamports from a nonce account.
- **Description**: Use this function to withdraw a specified amount of lamports from a nonce account within the context of a system program execution. Ensure that the context contains at least two account keys before calling this function. The function checks for recent blockhashes and rent information as part of its operation. It returns an error code if there are not enough account keys or if any required conditions are not met.
- **Inputs**:
    - `ctx`: A pointer to a `fd_exec_instr_ctx_t` structure that provides the execution context. This must not be null and must contain at least two account keys.
    - `requested_lamports`: The number of lamports to withdraw. This is an unsigned long integer and should be a valid amount that the account can cover.
- **Output**: Returns an integer error code. A non-zero value indicates an error, such as insufficient account keys or other conditions not being met.
- **See Also**: [`fd_system_program_exec_withdraw_nonce_account`](<fd_system_program_nonce.c.md#fd_system_program_exec_withdraw_nonce_account>)  (Implementation)


---
### fd\_system\_program\_exec\_initialize\_nonce\_account<!-- {{#callable_declaration:fd_system_program_exec_initialize_nonce_account}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_system_program.h#L40>)

Initializes a nonce account in the system program.
- **Description**: Use this function to initialize a nonce account within the system program context. It requires a valid execution instruction context and an authorized public key. The function checks for necessary account keys and recent blockhashes, and it ensures that the account is not already in use. It must be called with a valid context that includes at least one account key. If the recent blockhash list is empty, the function logs an error and returns a custom error code. This function is typically used in blockchain systems where nonce accounts are needed for transaction processing.
- **Inputs**:
    - `ctx`: A pointer to an `fd_exec_instr_ctx_t` structure representing the execution instruction context. It must not be null and must contain at least one account key. The caller retains ownership.
    - `pubkey`: A pointer to an `fd_pubkey_t` structure representing the authorized public key for the nonce account. It must not be null. The caller retains ownership.
- **Output**: Returns an integer status code. A return value of 0 indicates success, while non-zero values indicate various error conditions, such as insufficient account keys or missing recent blockhashes.
- **See Also**: [`fd_system_program_exec_initialize_nonce_account`](<fd_system_program_nonce.c.md#fd_system_program_exec_initialize_nonce_account>)  (Implementation)


---
### fd\_system\_program\_exec\_authorize\_nonce\_account<!-- {{#callable_declaration:fd_system_program_exec_authorize_nonce_account}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_system_program.h#L41>)

Authorizes a nonce account with a specified authority.
- **Description**: Use this function to authorize a nonce account with a given authority. It requires a valid execution instruction context and a public key representing the nonce authority. Ensure that the context contains at least one account key before calling this function. The function returns an error code if the authorization fails or if there are not enough account keys in the context.
- **Inputs**:
    - `ctx`: A pointer to an `fd_exec_instr_ctx_t` structure representing the execution instruction context. Must not be null and must contain at least one account key.
    - `nonce_authority`: A pointer to an `fd_pubkey_t` structure representing the nonce authority. Must not be null.
- **Output**: Returns an integer error code. A non-zero value indicates an error, such as insufficient account keys or failure to authorize the nonce account.
- **See Also**: [`fd_system_program_exec_authorize_nonce_account`](<fd_system_program_nonce.c.md#fd_system_program_exec_authorize_nonce_account>)  (Implementation)


---
### fd\_system\_program\_exec\_allocate<!-- {{#callable_declaration:fd_system_program_exec_allocate}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_system_program.h#L42>)

Allocates space for an account in the system program.
- **Description**: Use this function to allocate a specified amount of space for an account within the system program context. It is necessary to ensure that the instruction context (`ctx`) has at least one account key before calling this function. The function will return an error if there are not enough account keys available. This function is typically used when setting up or modifying accounts in a system program, and it performs necessary authorization checks before allocation.
- **Inputs**:
    - `ctx`: A pointer to an `fd_exec_instr_ctx_t` structure representing the execution context for the instruction. This must not be null and must contain at least one account key. The caller retains ownership.
    - `space`: An unsigned long integer specifying the amount of space to allocate for the account. The value must be a valid size for allocation.
- **Output**: Returns 0 on success. On failure, returns a non-zero error code indicating the type of error encountered, such as insufficient account keys.
- **See Also**: [`fd_system_program_exec_allocate`](<fd_system_program.c.md#fd_system_program_exec_allocate>)  (Implementation)


---
### fd\_system\_program\_exec\_allocate\_with\_seed<!-- {{#callable_declaration:fd_system_program_exec_allocate_with_seed}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_system_program.h#L43>)

Allocates account space with a seed and assigns an owner.
- **Description**: Use this function to allocate space for an account and assign an owner using a seed. It is necessary to provide a valid execution context and instruction arguments. The function checks if there are enough account keys and verifies the seed address before proceeding with allocation and assignment. Ensure that the context has at least one account key before calling this function. The function returns an error code if any validation fails or if the allocation and assignment cannot be completed.
- **Inputs**:
    - `ctx`: A pointer to `fd_exec_instr_ctx_t`, representing the execution context. Must not be null and must contain at least one account key. The caller retains ownership.
    - `args`: A pointer to `fd_system_program_instruction_allocate_with_seed_t`, containing the instruction arguments. Must not be null. The caller retains ownership.
- **Output**: Returns 0 on success or an error code on failure, indicating the type of error encountered.
- **See Also**: [`fd_system_program_exec_allocate_with_seed`](<fd_system_program.c.md#fd_system_program_exec_allocate_with_seed>)  (Implementation)


---
### fd\_system\_program\_exec\_assign\_with\_seed<!-- {{#callable_declaration:fd_system_program_exec_assign_with_seed}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_system_program.h#L44>)

Assigns an account with a seed to a new owner.
- **Description**: Use this function to assign an account, identified by a seed, to a new owner within the context of a system program execution. Ensure that the `ctx` parameter has at least one account key before calling this function. The function verifies the seed address and performs an authorization check before assigning the account. It returns an error code if the seed address verification or assignment fails.
- **Inputs**:
    - `ctx`: A pointer to `fd_exec_instr_ctx_t`, representing the execution context. Must not be null and must contain at least one account key.
    - `args`: A pointer to `fd_system_program_instruction_assign_with_seed_t`, containing the assignment parameters including the base, seed, seed length, and owner. Must not be null.
- **Output**: Returns 0 on success or an error code on failure, indicating the type of error encountered during execution.
- **See Also**: [`fd_system_program_exec_assign_with_seed`](<fd_system_program.c.md#fd_system_program_exec_assign_with_seed>)  (Implementation)


---
### fd\_system\_program\_exec\_transfer\_with\_seed<!-- {{#callable_declaration:fd_system_program_exec_transfer_with_seed}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_system_program.h#L45>)

Transfers lamports between accounts using a derived address.
- **Description**: Use this function to transfer lamports from one account to another, where the source account is identified by a derived address using a seed. This function requires that the source account signs the transaction. It must be called with a valid execution context and appropriate instruction arguments. Ensure that the derived address matches the source account's address, or the function will return an error. This function is part of the system program instruction handlers and is intended for use in environments where account management and lamport transfers are necessary.
- **Inputs**:
    - `ctx`: A pointer to an `fd_exec_instr_ctx_t` structure representing the execution context. Must not be null. The context should have at least three instruction accounts.
    - `args`: A pointer to a `fd_system_program_instruction_transfer_with_seed_t` structure containing the transfer parameters, including the seed and owner for address derivation. Must not be null.
- **Output**: Returns an integer error code. A return value of 0 indicates success, while non-zero values indicate various errors, such as insufficient account keys, missing required signature, or address mismatch.
- **See Also**: [`fd_system_program_exec_transfer_with_seed`](<fd_system_program.c.md#fd_system_program_exec_transfer_with_seed>)  (Implementation)


---
### fd\_system\_program\_exec\_upgrade\_nonce\_account<!-- {{#callable_declaration:fd_system_program_exec_upgrade_nonce_account}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_system_program.h#L46>)

Upgrades a nonce account to the current version.
- **Description**: Use this function to upgrade a nonce account to the latest version. It must be called with a valid execution context that includes at least one account. The function checks if the account is writable and owned by the system program. It also verifies the account's current state and version before performing the upgrade. If any of these conditions are not met, the function returns an error code. This function is typically used in the context of executing system program instructions.
- **Inputs**:
    - `ctx`: A pointer to an `fd_exec_instr_ctx_t` structure that provides the execution context. This context must include at least one account. The caller retains ownership of this pointer, and it must not be null. If the context does not meet the required conditions, the function returns an error code.
- **Output**: Returns an integer status code. `FD_EXECUTOR_INSTR_SUCCESS` indicates success, while other codes indicate specific errors, such as insufficient account keys, invalid account owner, or invalid account data.
- **See Also**: [`fd_system_program_exec_upgrade_nonce_account`](<fd_system_program_nonce.c.md#fd_system_program_exec_upgrade_nonce_account>)  (Implementation)


---
### fd\_check\_transaction\_age<!-- {{#callable_declaration:fd_check_transaction_age}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_system_program.h#L55>)

Checks if the transaction's age is valid.
- **Description**: Use this function to verify the validity of a transaction's age based on the blockhash or nonce provided in the transaction message. It returns a success code if the transaction's age is valid and a specific error code if it is not. This function is essential for ensuring that transactions are processed within an acceptable timeframe and that the nonce is correctly authorized. Call this function before executing a transaction to prevent processing outdated or unauthorized transactions.
- **Inputs**:
    - `txn_ctx`: A pointer to a `fd_exec_txn_ctx_t` structure representing the transaction context. This parameter must not be null, and the context should be properly initialized before calling this function. The caller retains ownership of this context.
- **Output**: Returns 0 if the transaction's age is valid, otherwise returns a non-zero error code indicating the specific reason for invalidity.
- **See Also**: [`fd_check_transaction_age`](<fd_system_program_nonce.c.md#fd_check_transaction_age>)  (Implementation)


---
### fd\_get\_system\_account\_kind<!-- {{#callable_declaration:fd_get_system_account_kind}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_system_program.h#L67>)

Determines the type of a system account.
- **Description**: Use this function to identify if an account is a normal system program account, a nonce account, or an unknown type. It is important to ensure that the `account` parameter is valid and correctly initialized before calling this function. The function checks the account's owner and data length to determine its type. It returns specific constants to indicate the account type, which can be used to handle different account types appropriately in your application.
- **Inputs**:
    - `account`: A pointer to an `fd_txn_account_t` structure representing the account to check. Must not be null and must be properly initialized.
    - `exec_spad`: A pointer to an `fd_spad_t` structure used for decoding. Must not be null and must be properly initialized.
- **Output**: Returns an integer indicating the account type: `FD_SYSTEM_PROGRAM_NONCE_ACCOUNT_KIND_SYSTEM` for a normal system account, `FD_SYSTEM_PROGRAM_NONCE_ACCOUNT_KIND_NONCE` for a nonce account, or `FD_SYSTEM_PROGRAM_NONCE_ACCOUNT_KIND_UNKNOWN` if the account type cannot be determined.
- **See Also**: [`fd_get_system_account_kind`](<fd_system_program.c.md#fd_get_system_account_kind>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)