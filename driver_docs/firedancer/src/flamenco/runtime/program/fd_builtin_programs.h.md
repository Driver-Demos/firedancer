<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines data structures and functions for managing and migrating built-in programs to Core BPF.

# Purpose
The code is a C header file that defines data structures and function prototypes for managing built-in programs within a runtime environment. It includes definitions for several structures such as `fd_core_bpf_migration_config`, `fd_builtin_program`, `fd_stateless_builtin_program`, `fd_precompile_program`, and `fd_tmp_account`. These structures are used to configure and manage the migration of built-in programs to Core BPF (Berkeley Packet Filter) and handle transitions at epoch boundaries when features are activated. The file also includes constants like `FD_CORE_BPF_MIGRATION_TARGET_BUILTIN` and `FD_CORE_BPF_MIGRATION_TARGET_STATELESS` to specify migration targets.

The header file provides function prototypes for initializing and managing built-in program accounts, writing to built-in accounts, and checking the migration status of programs. Functions such as [`fd_builtin_programs_init`](<#fd_builtin_programs_init>), [`fd_write_builtin_account`](<#fd_write_builtin_account>), [`fd_is_migrating_builtin_program`](<#fd_is_migrating_builtin_program>), and [`fd_migrate_builtin_to_core_bpf`](<#fd_migrate_builtin_to_core_bpf>) are declared to facilitate these operations. Additionally, the file includes functions to retrieve information about the number of built-in and stateless built-in programs, as well as precompiled programs. This header file is intended to be included in other C source files to provide a standardized interface for handling built-in program configurations and migrations within the system.
# Imports and Dependencies

---
- `../../fd_flamenco_base.h`
- `../fd_bank.h`
- `../fd_system_ids_pp.h`


# Data Structures

---
### fd\_core\_bpf\_migration\_config
- **Type**: ``struct``
- **Members**:
    - `source_buffer_address`: A pointer to a constant `fd_pubkey_t` representing the source buffer address.
    - `upgrade_authority_address`: A pointer to an `fd_pubkey_t` representing the upgrade authority address.
    - `enable_feature_offset`: An unsigned long integer indicating the offset for enabling a feature.
    - `migration_target`: An unsigned char indicating the migration target, which can be either `FD_CORE_BPF_MIGRATION_TARGET_BUILTIN` or `FD_CORE_BPF_MIGRATION_TARGET_STATELESS`.
    - `builtin_program_id`: A pointer to a constant `fd_pubkey_t` representing the built-in program ID.
    - `verified_build_hash`: A pointer to a constant `fd_hash_t` representing the verified build hash.
- **Description**: Defines the configuration for migrating a built-in program to Core BPF, including addresses, feature offsets, migration targets, and verification details.


---
### fd\_core\_bpf\_migration\_config\_t
- **Type**: ``struct``
- **Members**:
    - `source_buffer_address`: Pointer to the source buffer address of type `fd_pubkey_t`.
    - `upgrade_authority_address`: Pointer to the upgrade authority address of type `fd_pubkey_t`.
    - `enable_feature_offset`: Unsigned long integer representing the offset for enabling a feature.
    - `migration_target`: Unsigned character indicating the migration target, either `FD_CORE_BPF_MIGRATION_TARGET_BUILTIN` or `FD_CORE_BPF_MIGRATION_TARGET_STATELESS`.
    - `builtin_program_id`: Pointer to the built-in program ID of type `fd_pubkey_t`.
    - `verified_build_hash`: Pointer to the verified build hash of type `fd_hash_t`.
- **Description**: Defines the configuration for migrating a built-in program to Core BPF, including addresses for source and upgrade authority, a feature offset, a migration target, a built-in program ID, and a verified build hash.


---
### fd\_builtin\_program
- **Type**: ``struct``
- **Members**:
    - ``pubkey``: A pointer to a constant `fd_pubkey_t` representing the public key associated with the built-in program.
    - ``data``: A pointer to a constant character array containing data related to the built-in program.
    - ``enable_feature_offset``: An unsigned long integer indicating the offset for enabling features.
    - ``core_bpf_migration_config``: A pointer to a constant `fd_core_bpf_migration_config_t` structure for BPF migration configuration.
- **Description**: Defines the structure for a built-in program, including its public key, associated data, feature enablement offset, and configuration for migration to Core BPF.


---
### fd\_builtin\_program\_t
- **Type**: ``struct``
- **Members**:
    - `pubkey`: Pointer to a constant `fd_pubkey_t` representing the public key of the built-in program.
    - `data`: Pointer to a constant character array containing data related to the built-in program.
    - `enable_feature_offset`: Unsigned long integer indicating the offset for enabling a feature.
    - `core_bpf_migration_config`: Pointer to a constant `fd_core_bpf_migration_config_t` structure for BPF migration configuration.
- **Description**: Represents transitions of built-in programs at epoch boundaries when features are activated, containing information about the program's public key, associated data, feature enablement offset, and migration configuration.


---
### fd\_stateless\_builtin\_program
- **Type**: ``struct``
- **Members**:
    - ``pubkey``: A pointer to a constant `fd_pubkey_t` representing the public key of the program.
    - ``core_bpf_migration_config``: A pointer to a constant `fd_core_bpf_migration_config_t` that holds the configuration for migrating the program to Core BPF.
- **Description**: Defines a stateless built-in program with a public key and a configuration for migration to Core BPF. This structure is used to manage transitions of stateless built-in programs at epoch boundaries when features are activated.


---
### fd\_stateless\_builtin\_program\_t
- **Type**: ``struct``
- **Members**:
    - ``pubkey``: A pointer to a constant `fd_pubkey_t` representing the public key of the program.
    - ``core_bpf_migration_config``: A pointer to a constant `fd_core_bpf_migration_config_t` that holds the configuration for migrating the program to Core BPF.
- **Description**: Represents the transitions of stateless built-in programs at epoch boundaries when features are activated. It contains a public key and a configuration for migration to Core BPF, which helps manage the program's lifecycle and migration status.


---
### fd\_precompile\_program
- **Type**: ``struct``
- **Members**:
    - ``pubkey``: A pointer to a constant `fd_pubkey_t` representing the public key associated with the program.
    - ``feature_offset``: An unsigned long integer indicating the offset for feature activation.
    - ``verify_fn``: A pointer to a function that takes a `fd_exec_instr_ctx_t*` and returns an integer, used to verify the program.
- **Description**: Defines a precompiled program with a public key, a feature offset for activation, and a verification function pointer to validate execution context.


---
### fd\_precompile\_program\_t
- **Type**: ``struct``
- **Members**:
    - `pubkey`: A pointer to a constant `fd_pubkey_t` representing the public key of the program.
    - `feature_offset`: An unsigned long integer indicating the offset for the feature.
    - `verify_fn`: A pointer to a function that takes a `fd_exec_instr_ctx_t*` and returns an integer, used to verify the program.
- **Description**: Defines a precompiled program with a public key, a feature offset, and a verification function. This structure is used to manage precompiled programs, which are programs that have been compiled ahead of time and are ready for execution. The `pubkey` identifies the program, `feature_offset` specifies the feature's position, and `verify_fn` is a function pointer used to verify the program's execution context.


---
### fd\_tmp\_account
- **Type**: ``struct``
- **Members**:
    - `addr`: Holds the public key address of the account.
    - `meta`: Stores metadata related to the account.
    - `data`: Contains account data with a maximum size defined by `FD_RUNTIME_ACC_SZ_MAX`, aligned to 8 bytes.
    - `data_sz`: Indicates the size of the data stored in the `data` field.
- **Description**: Represents a temporary account structure used in the context of the Flamenco runtime program. It includes a public key address, metadata, a data buffer with a defined maximum size, and the size of the data currently stored. This structure is likely used to manage account information temporarily during runtime operations.


---
### fd\_tmp\_account\_t
- **Type**: ``struct``
- **Members**:
    - ``addr``: Holds the public key address of the temporary account.
    - ``meta``: Contains metadata associated with the temporary account.
    - ``data``: Stores the account data with a maximum size defined by `FD_RUNTIME_ACC_SZ_MAX`.
    - ``data_sz``: Indicates the size of the data stored in the `data` field.
- **Description**: Represents a temporary account structure used to store account information, including its address, metadata, and data content, with a specified maximum size and alignment.


# Function Declarations (Public API)

---
### fd\_builtin\_programs\_init<!-- {{#callable_declaration:fd_builtin_programs_init}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_builtin_programs.h#L59>)

Initialize the builtin program accounts.
- **Description**: Use this function to set up the accounts for built-in programs in the specified bank. It must be called with valid pointers to a bank, an account database, a transaction ID, and a capture context. This function prepares the bank for operations involving built-in programs by writing necessary account data. It handles different configurations based on the bank's slot and feature activation status. Ensure that the bank and account database are properly initialized before calling this function.
- **Inputs**:
    - `bank`: A pointer to an `fd_bank_t` structure representing the bank where the built-in program accounts will be initialized. Must not be null.
    - `accdb`: A pointer to an `fd_accdb_user_t` structure representing the account database. Must not be null.
    - `xid`: A pointer to a constant `fd_funk_txn_xid_t` structure representing the transaction ID. Must not be null.
    - `capture_ctx`: A pointer to an `fd_capture_ctx_t` structure used for capturing context during initialization. Must not be null.
- **Output**: None
- **See Also**: [`fd_builtin_programs_init`](<fd_builtin_programs.c.md#fd_builtin_programs_init>)  (Implementation)


---
### fd\_write\_builtin\_account<!-- {{#callable_declaration:fd_write_builtin_account}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_builtin_programs.h#L68>)

Writes a built-in account to the bank.
- **Description**: Use this function to write a built-in account to the specified bank. This function updates the account's data, lamports, executable status, and owner. It also updates the hash of the account and adjusts the bank's capitalization. Call this function when you need to modify or initialize a built-in account with specific data and attributes. Ensure that the bank and account database are properly initialized before calling this function.
- **Inputs**:
    - `bank`: A pointer to an `fd_bank_t` structure representing the bank where the account will be written. Must not be null.
    - `accdb`: A pointer to an `fd_accdb_user_t` structure representing the account database. Must not be null.
    - `xid`: A pointer to an `fd_funk_txn_xid_t` structure representing the transaction ID. Must not be null.
    - `capture_ctx`: A pointer to an `fd_capture_ctx_t` structure used for capturing context. Must not be null.
    - `pubkey`: An `fd_pubkey_t` representing the public key of the account. This is a constant input and must be valid.
    - `data`: A pointer to a constant character array containing the data to be written to the account. Must not be null.
    - `sz`: An `ulong` representing the size of the data to be written. Must be a valid size for the data array.
- **Output**: None
- **See Also**: [`fd_write_builtin_account`](<fd_builtin_programs.c.md#fd_write_builtin_account>)  (Implementation)


---
### fd\_builtins<!-- {{#callable_declaration:fd_builtins}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_builtin_programs.h#L77>)

Returns a pointer to the array of built-in programs.
- **Description**: Use this function to obtain a constant pointer to the array of built-in programs available in the system. This function does not require any parameters and can be called at any time to access the built-in programs. The returned pointer provides read-only access to the built-in program data, and the caller must not attempt to modify the data through this pointer. Ensure that the system is properly initialized before calling this function to avoid accessing uninitialized data.
- **Inputs**: None
- **Output**: A constant pointer to an array of `fd_builtin_program_t` structures, representing the built-in programs.
- **See Also**: [`fd_builtins`](<fd_builtin_programs.c.md#fd_builtins>)  (Implementation)


---
### fd\_num\_builtins<!-- {{#callable_declaration:fd_num_builtins}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_builtin_programs.h#L80>)

Returns the number of built-in programs.
- **Description**: Use this function to get the total count of built-in programs available in the system. This function does not require any parameters and can be called at any time to retrieve the current number of built-in programs. It is useful for iterating over built-in programs or for validation purposes.
- **Inputs**: None
- **Output**: Returns an unsigned long integer representing the number of built-in programs.
- **See Also**: [`fd_num_builtins`](<fd_builtin_programs.c.md#fd_num_builtins>)  (Implementation)


---
### fd\_stateless\_builtins<!-- {{#callable_declaration:fd_stateless_builtins}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_builtin_programs.h#L83>)

Provides access to stateless built-in programs.
- **Description**: Use this function to obtain a pointer to the array of stateless built-in programs. This function is useful when you need to access or iterate over the stateless built-in programs available in the system. It does not require any parameters and can be called at any time to retrieve the current list of stateless built-in programs.
- **Inputs**: None
- **Output**: Returns a pointer to a constant array of `fd_stateless_builtin_program_t` structures representing the stateless built-in programs.
- **See Also**: [`fd_stateless_builtins`](<fd_builtin_programs.c.md#fd_stateless_builtins>)  (Implementation)


---
### fd\_num\_stateless\_builtins<!-- {{#callable_declaration:fd_num_stateless_builtins}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_builtin_programs.h#L86>)

Returns the number of stateless built-in programs.
- **Description**: Use this function to get the total count of stateless built-in programs available in the system. This function does not require any parameters and can be called at any time to retrieve the current count. It is useful for applications that need to manage or iterate over stateless built-in programs.
- **Inputs**: None
- **Output**: The function returns an unsigned long integer representing the number of stateless built-in programs.
- **See Also**: [`fd_num_stateless_builtins`](<fd_builtin_programs.c.md#fd_num_stateless_builtins>)  (Implementation)


---
### fd\_is\_migrating\_builtin\_program<!-- {{#callable_declaration:fd_is_migrating_builtin_program}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_builtin_programs.h#L97>)

Checks if a program is a migrating built-in program and if it has migrated to BPF.
- **Description**: Use this function to determine if a given program, identified by its public key, is a migrating built-in program and whether it has been migrated to BPF. This function requires a transaction context and a public key as inputs. It sets the `migrated_yet` output to indicate the migration status. Call this function when you need to verify the migration status of a built-in program within a transaction context. Ensure that the `migrated_yet` pointer is valid and writable before calling.
- **Inputs**:
    - `txn_ctx`: A pointer to a `fd_exec_txn_ctx_t` structure representing the transaction context. Must not be null.
    - `pubkey`: A pointer to a `fd_pubkey_t` structure representing the public key of the program to check. Must not be null.
    - `migrated_yet`: A pointer to an `uchar` where the function will store the migration status. Must not be null and must be writable.
- **Output**: Returns 1 if the program is a migrating built-in program, otherwise returns 0. The `migrated_yet` output is set to 1 if the program has been migrated to BPF, otherwise it is set to 0.
- **See Also**: [`fd_is_migrating_builtin_program`](<fd_builtin_programs.c.md#fd_is_migrating_builtin_program>)  (Implementation)


---
### fd\_is\_non\_migrating\_builtin\_program<!-- {{#callable_declaration:fd_is_non_migrating_builtin_program}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_builtin_programs.h#L102>)

Checks if a program is a non-migrating built-in program.
- **Description**: Use this function to determine if a given program, identified by its public key, is a non-migrating built-in program. This function is useful when you need to verify the migration status of built-in programs in a system. It returns a non-zero value if the program is non-migrating, and zero otherwise. Ensure that the public key provided is valid and not null to avoid unexpected behavior.
- **Inputs**:
    - `pubkey`: A pointer to a `fd_pubkey_t` structure representing the public key of the program to check. Must not be null. The function does not modify the data pointed to by this parameter.
- **Output**: Returns a non-zero value if the program is a non-migrating built-in program, otherwise returns zero.
- **See Also**: [`fd_is_non_migrating_builtin_program`](<fd_builtin_programs.c.md#fd_is_non_migrating_builtin_program>)  (Implementation)


---
### fd\_precompiles<!-- {{#callable_declaration:fd_precompiles}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_builtin_programs.h#L105>)

Provides access to precompiled programs.
- **Description**: Use this function to obtain a pointer to the array of precompiled programs. This function does not take any parameters and can be called at any time to retrieve the current set of precompiled programs. The returned pointer is constant, indicating that the caller must not modify the data it points to. This function is useful when you need to access or iterate over the precompiled programs available in the system.
- **Inputs**: None
- **Output**: A constant pointer to an array of `fd_precompile_program_t` structures, representing the precompiled programs.
- **See Also**: [`fd_precompiles`](<fd_builtin_programs.c.md#fd_precompiles>)  (Implementation)


---
### fd\_num\_precompiles<!-- {{#callable_declaration:fd_num_precompiles}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_builtin_programs.h#L108>)

Returns the number of precompiled programs.
- **Description**: Use this function to get the total count of precompiled programs available in the system. This function does not require any parameters and can be called at any time to retrieve the current number of precompiled programs. It is useful for applications that need to manage or iterate over precompiled programs.
- **Inputs**: None
- **Output**: The function returns an unsigned long integer representing the number of precompiled programs.
- **See Also**: [`fd_num_precompiles`](<fd_builtin_programs.c.md#fd_num_precompiles>)  (Implementation)


---
### fd\_migrate\_builtin\_to\_core\_bpf<!-- {{#callable_declaration:fd_migrate_builtin_to_core_bpf}} -->
[View Source →](<../../../../../../src/flamenco/runtime/program/fd_builtin_programs.h#L111>)

Migrates a built-in program to Core BPF.
- **Description**: Use this function to transition a built-in program to Core BPF as part of a migration process. This function requires a valid configuration and context to perform the migration. Ensure that the `bank`, `accdb`, `xid`, `runtime_stack`, `config`, and `capture_ctx` are correctly initialized and provided. This function does not return a value and does not indicate success or failure through a return code, so ensure that all inputs are valid and correctly configured before calling.
- **Inputs**:
    - `bank`: A pointer to `fd_bank_t`, representing the bank context. Must not be null.
    - `accdb`: A pointer to `fd_accdb_user_t`, representing the account database context. Must not be null.
    - `xid`: A pointer to `fd_funk_txn_xid_t`, representing the transaction ID. Must not be null.
    - `runtime_stack`: A pointer to `fd_runtime_stack_t`, representing the runtime stack. Must not be null.
    - `config`: A pointer to `fd_core_bpf_migration_config_t`, containing the migration configuration. Must not be null and must be correctly configured.
    - `capture_ctx`: A pointer to `fd_capture_ctx_t`, representing the capture context. Must not be null.
- **Output**: None
- **See Also**: [`fd_migrate_builtin_to_core_bpf`](<../fd_core_bpf_migration.c.md#fd_migrate_builtin_to_core_bpf>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)