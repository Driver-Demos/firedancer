<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Tests for the sysvar rent functionality, including boundary checks and exemption calculations.

# Purpose
The code is a test suite for verifying the functionality of rent calculations in a system that uses a binary encoding format. It includes tests for the system variable rent bounds and rent exemption calculations. The function [`test_sysvar_rent_bounds`](<#test_sysvar_rent_bounds>) checks the size and alignment of a binary-encoded system variable against expected constants, ensuring that the encoding and footprint are correct. It uses a static array of bytes to simulate real on-chain data and validates the decoding process with assertions.

The code also defines a structure `fd_rent_exempt_fixture_t` to represent test cases for rent exemption calculations. The `test_rent_exempt_vector` array contains multiple test cases, each specifying input parameters such as data length, lamports per byte-year, and exemption threshold, along with the expected minimum balance output. The [`test_sysvar_rent`](<#test_sysvar_rent>) function iterates over these test cases, calculates the minimum balance using the `fd_rent_exempt_minimum_balance` function, and verifies the result against the expected value. This ensures that the rent exemption logic behaves as intended across a range of scenarios.
# Imports and Dependencies

---
- `fd_sysvar_rent.h`


# Global Variables

---
### test\_rent\_exempt\_vector
- **Type**: ``fd_rent_exempt_fixture_t const[]``
- **Description**: An array of `fd_rent_exempt_fixture_t` structures, each containing test data for rent exemption calculations. Each element in the array specifies the data length, lamports per byte per year, exemption threshold bits, and the expected minimum balance for rent exemption.
- **Use**: Used in the `test_sysvar_rent` function to verify that the calculated minimum balance matches the expected minimum balance for various test cases.


# Data Structures

---
### fd\_rent\_exempt\_fixture
- **Type**: ``struct``
- **Members**:
    - `data_len`: Specifies the length of the data in bytes.
    - `lamports_per_byte_year`: Indicates the number of lamports charged per byte per year.
    - `exemption_threshold`: Represents the threshold for rent exemption as a double value.
    - `exemption_threshold_bits`: Represents the threshold for rent exemption as a bitwise ulong value.
    - `min_balance`: Stores the minimum balance required for rent exemption.
- **Description**: Defines a structure used to calculate the minimum balance required for rent exemption based on data length, lamports per byte per year, and an exemption threshold, which can be represented as either a double or a bitwise ulong.


---
### fd\_rent\_exempt\_fixture\_t
- **Type**: ``struct``
- **Members**:
    - `data_len`: Specifies the length of the data in bytes.
    - `lamports_per_byte_year`: Indicates the number of lamports charged per byte per year.
    - `exemption_threshold`: Represents the threshold for rent exemption as a double.
    - `exemption_threshold_bits`: Represents the threshold for rent exemption as a 64-bit unsigned integer.
    - `min_balance`: Specifies the minimum balance required for rent exemption.
- **Description**: Defines a structure used to calculate the minimum balance required for rent exemption based on data length, lamports per byte per year, and an exemption threshold. The structure includes both input parameters and the resulting minimum balance.


# Functions

---
### test\_sysvar\_rent\_bounds<!-- {{#callable:test_sysvar_rent_bounds}} -->
[View Source →](<../../../../../../src/flamenco/runtime/sysvar/test_sysvar_rent.c#L3>)

Validates the size, footprint, and alignment of a sysvar rent account against expected constants.
- **Inputs**: None
- **Logic and Control Flow**:
    - Defines a static array `data` representing a real sysvar account observed on-chain.
    - Checks if the size of `data` equals `FD_SYSVAR_RENT_BINCODE_SZ` using `FD_TEST`.
    - Initializes a `fd_bincode_decode_ctx_t` structure `ctx` with `data` and its endpoint.
    - Initializes `obj_sz` to zero and checks if `fd_rent_decode_footprint` returns `FD_BINCODE_SUCCESS` and sets `obj_sz` correctly.
    - Verifies that `obj_sz` equals `FD_SYSVAR_RENT_FOOTPRINT` using `FD_TEST`.
    - Checks if `fd_rent_align` equals `FD_SYSVAR_RENT_ALIGN` using `FD_TEST`.
- **Output**: No output is returned; the function performs internal tests using `FD_TEST`.


---
### test\_sysvar\_rent<!-- {{#callable:test_sysvar_rent}} -->
[View Source →](<../../../../../../src/flamenco/runtime/sysvar/test_sysvar_rent.c#L59>)

Validates the rent exemption calculations against predefined test cases.
- **Inputs**: None
- **Logic and Control Flow**:
    - Calls [`test_sysvar_rent_bounds`](<#test_sysvar_rent_bounds>) to perform initial boundary checks.
    - Iterates over `test_rent_exempt_vector` to access each test case.
    - For each test case, initializes a `fd_rent_t` structure with `lamports_per_byte_year` and `exemption_threshold`.
    - Calculates the minimum balance required for rent exemption using [`fd_rent_exempt_minimum_balance`](<fd_sysvar_rent1.c.md#fd_rent_exempt_minimum_balance>).
    - Asserts that the calculated minimum balance matches the expected `min_balance` from the test case.
- **Output**: No output is returned; the function uses assertions to validate conditions.
- **Functions Called**:
    - [`test_sysvar_rent_bounds`](<#test_sysvar_rent_bounds>)
    - [`fd_rent_exempt_minimum_balance`](<fd_sysvar_rent1.c.md#fd_rent_exempt_minimum_balance>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)