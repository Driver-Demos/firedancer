<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines functions and constants for managing and updating slot hashes sysvar in the Firedancer runtime.

# Purpose
This C header file defines the interface for managing a system variable (`sysvar`) related to slot hashes in a blockchain context. It includes function prototypes for creating, joining, leaving, deleting, writing, updating, and reading the slot hashes system variable. The `FD_SYSVAR_SLOT_HASHES_CAP` macro sets the maximum number of entries for the slot hashes. The functions interact with memory and data structures to manage the lifecycle and state of the slot hashes, which are used to track the most recent hashes of a slot's parent bank hashes. The file includes necessary headers for dependencies and provides a mechanism to update the slot hashes at the end of each slot, ensuring the system variable is current before execution begins.
# Imports and Dependencies

---
- `../../../funk/fd_funk_base.h`
- `../../accdb/fd_accdb_user.h`
- `../../types/fd_types.h`


# Function Declarations (Public API)

---
### fd\_sysvar\_slot\_hashes\_footprint<!-- {{#callable_declaration:fd_sysvar_slot_hashes_footprint}} -->
[View Source →](<../../../../../../src/flamenco/runtime/sysvar/fd_sysvar_slot_hashes.h#L17>)

Calculates the memory footprint for slot hashes.
- **Description**: Use this function to determine the amount of memory required to store slot hashes, given a specified capacity. This is useful when allocating memory for slot hashes to ensure sufficient space is available. The function computes the total memory footprint based on the capacity provided and includes any necessary alignment considerations.
- **Inputs**:
    - `slot_hashes_cap`: Specifies the capacity of slot hashes. It must be a non-negative integer. The function uses this value to calculate the required memory footprint. Invalid values may lead to incorrect memory calculations.
- **Output**: Returns the total memory footprint in bytes required for the specified capacity of slot hashes.
- **See Also**: [`fd_sysvar_slot_hashes_footprint`](<fd_sysvar_slot_hashes.c.md#fd_sysvar_slot_hashes_footprint>)  (Implementation)


---
### fd\_sysvar\_slot\_hashes\_new<!-- {{#callable_declaration:fd_sysvar_slot_hashes_new}} -->
[View Source →](<../../../../../../src/flamenco/runtime/sysvar/fd_sysvar_slot_hashes.h#L22>)

Allocates and initializes memory for slot hashes.
- **Description**: Use this function to allocate and initialize memory for storing slot hashes. The memory provided must be aligned according to `FD_SYSVAR_SLOT_HASHES_ALIGN`. This function must be called with a valid memory pointer and a capacity for slot hashes. If the memory is not aligned or the pointer is null, the function logs an error and does not proceed. Ensure that the memory block is large enough to accommodate the required data structures.
- **Inputs**:
    - `mem`: A pointer to the memory block where slot hashes will be stored. Must not be null and must be aligned to `FD_SYSVAR_SLOT_HASHES_ALIGN`. The caller retains ownership of the memory.
    - `slot_hashes_cap`: The capacity for slot hashes, indicating the maximum number of slot hashes that can be stored. Must be a positive number.
- **Output**: Returns a pointer to the initialized `fd_slot_hashes_global_t` structure on success. Logs an error and does not return if the input is invalid.
- **See Also**: [`fd_sysvar_slot_hashes_new`](<fd_sysvar_slot_hashes.c.md#fd_sysvar_slot_hashes_new>)  (Implementation)


---
### fd\_sysvar\_slot\_hashes\_join<!-- {{#callable_declaration:fd_sysvar_slot_hashes_join}} -->
[View Source →](<../../../../../../src/flamenco/runtime/sysvar/fd_sysvar_slot_hashes.h#L26>)

Joins a shared memory region to access slot hash data.
- **Description**: Use this function to join a shared memory region that contains slot hash data, allowing access to the most recent hashes of the slot's parent bank hashes. This function must be called with a valid shared memory pointer that has been previously initialized. It returns a pointer to the global slot hashes structure and updates the provided slot hash pointer to point to the joined slot hash data. Ensure that the shared memory region is correctly aligned and initialized before calling this function.
- **Inputs**:
    - `shmem`: A pointer to the shared memory region containing slot hash data. Must not be null and should be properly initialized and aligned.
    - `slot_hash`: A pointer to a pointer of type `fd_slot_hash_t`. This will be updated to point to the joined slot hash data. Must not be null.
- **Output**: Returns a pointer to `fd_slot_hashes_global_t`, representing the global slot hashes structure.
- **See Also**: [`fd_sysvar_slot_hashes_join`](<fd_sysvar_slot_hashes.c.md#fd_sysvar_slot_hashes_join>)  (Implementation)


---
### fd\_sysvar\_slot\_hashes\_leave<!-- {{#callable_declaration:fd_sysvar_slot_hashes_leave}} -->
[View Source →](<../../../../../../src/flamenco/runtime/sysvar/fd_sysvar_slot_hashes.h#L30>)

Leaves the slot hash context and returns the global slot hashes pointer.
- **Description**: Use this function to exit the context of a specific slot hash and obtain the pointer to the global slot hashes structure. This function is typically called when you have finished working with a particular slot hash and need to return to the broader context of slot hashes. Ensure that the `slot_hash` parameter is valid and has been previously joined with the global slot hashes context.
- **Inputs**:
    - `slot_hashes_global`: A pointer to the global slot hashes structure. The caller must ensure this pointer is valid and represents the current global context.
    - `slot_hash`: A pointer to the specific slot hash to leave. This must be a valid pointer that has been previously joined with the global slot hashes context.
- **Output**: Returns a pointer to the `fd_slot_hashes_global_t` structure, which represents the global slot hashes context.
- **See Also**: [`fd_sysvar_slot_hashes_leave`](<fd_sysvar_slot_hashes.c.md#fd_sysvar_slot_hashes_leave>)  (Implementation)


---
### fd\_sysvar\_slot\_hashes\_delete<!-- {{#callable_declaration:fd_sysvar_slot_hashes_delete}} -->
[View Source →](<../../../../../../src/flamenco/runtime/sysvar/fd_sysvar_slot_hashes.h#L34>)

Deletes the slot hashes from the given memory region.
- **Description**: Use this function to remove the slot hashes data structure from a previously allocated memory region. This function should be called when the slot hashes are no longer needed, and the memory can be reused or freed. Ensure that the memory region was previously initialized with the appropriate slot hashes data structure before calling this function. The function returns the original memory pointer, allowing for further memory management operations.
- **Inputs**:
    - `mem`: A pointer to the memory region containing the slot hashes data structure. Must not be null and should point to a valid memory region previously initialized for slot hashes.
- **Output**: Returns the original memory pointer passed to the function.
- **See Also**: [`fd_sysvar_slot_hashes_delete`](<fd_sysvar_slot_hashes.c.md#fd_sysvar_slot_hashes_delete>)  (Implementation)


---
### fd\_sysvar\_slot\_hashes\_write<!-- {{#callable_declaration:fd_sysvar_slot_hashes_write}} -->
[View Source →](<../../../../../../src/flamenco/runtime/sysvar/fd_sysvar_slot_hashes.h#L38>)

Writes a funk entry for the slot hashes sysvar account.
- **Description**: Use this function to write a funk entry for the slot hashes sysvar account, typically for testing purposes. It encodes the provided slot hashes global data and updates the sysvar account in the bank. This function should be called when you need to manually update the slot hashes sysvar account with specific data. Ensure that all input parameters are valid and initialized before calling this function.
- **Inputs**:
    - `bank`: A pointer to an `fd_bank_t` structure representing the bank where the sysvar account will be updated. Must not be null.
    - `accdb`: A pointer to an `fd_accdb_user_t` structure representing the account database user. Must not be null.
    - `xid`: A pointer to a constant `fd_funk_txn_xid_t` structure representing the transaction ID. Must not be null.
    - `capture_ctx`: A pointer to an `fd_capture_ctx_t` structure used for capturing context during the update. Must not be null.
    - `slot_hashes_global`: A pointer to an `fd_slot_hashes_global_t` structure containing the slot hashes data to be encoded and written. Must not be null.
- **Output**: None
- **See Also**: [`fd_sysvar_slot_hashes_write`](<fd_sysvar_slot_hashes.c.md#fd_sysvar_slot_hashes_write>)  (Implementation)


---
### fd\_sysvar\_slot\_hashes\_update<!-- {{#callable_declaration:fd_sysvar_slot_hashes_update}} -->
[View Source →](<../../../../../../src/flamenco/runtime/sysvar/fd_sysvar_slot_hashes.h#L46>)

Update the slot hashes sysvar account.
- **Description**: Use this function to update the slot hashes sysvar account at the end of every slot, before execution starts. It ensures that the most recent hashes of the slot's parent bank are recorded. This function must be called with valid pointers to the bank, accdb, xid, and capture_ctx structures. It handles cases where the slot hashes do not exist by initializing them. The function does not return a value and does not modify the input parameters directly.
- **Inputs**:
    - `bank`: A pointer to an `fd_bank_t` structure representing the bank. Must not be null.
    - `accdb`: A pointer to an `fd_accdb_user_t` structure representing the account database. Must not be null.
    - `xid`: A pointer to a constant `fd_funk_txn_xid_t` structure representing the transaction ID. Must not be null.
    - `capture_ctx`: A pointer to an `fd_capture_ctx_t` structure used for capturing context. Must not be null.
- **Output**: None
- **See Also**: [`fd_sysvar_slot_hashes_update`](<fd_sysvar_slot_hashes.c.md#fd_sysvar_slot_hashes_update>)  (Implementation)


---
### fd\_sysvar\_slot\_hashes\_read<!-- {{#callable_declaration:fd_sysvar_slot_hashes_read}} -->
[View Source →](<../../../../../../src/flamenco/runtime/sysvar/fd_sysvar_slot_hashes.h#L55>)

Reads the slot hashes sysvar from funk.
- **Description**: Use this function to read the slot hashes sysvar from a funk instance. It returns a pointer to the decoded slot hashes if successful. If the account does not exist in funk or has zero lamports, the function returns NULL. This function is useful for retrieving the most recent hashes of the slot's parent bank hashes. Ensure that the `funk` and `xid` parameters are valid and that `slot_hashes_mem` has sufficient space to store the decoded data.
- **Inputs**:
    - `funk`: A pointer to an `fd_funk_t` instance representing the funk from which to read the slot hashes. Must not be null.
    - `xid`: A pointer to a constant `fd_funk_txn_xid_t` representing the transaction ID. Must not be null.
    - `slot_hashes_mem`: A pointer to a memory location where the decoded slot hashes will be stored. Must have sufficient space to hold the decoded data.
- **Output**: Returns a pointer to `fd_slot_hashes_global_t` containing the decoded slot hashes, or NULL if the account does not exist or has zero lamports.
- **See Also**: [`fd_sysvar_slot_hashes_read`](<fd_sysvar_slot_hashes.c.md#fd_sysvar_slot_hashes_read>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)