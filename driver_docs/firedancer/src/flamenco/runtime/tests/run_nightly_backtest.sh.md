<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

A Bash script to run nightly backtests, configure memory pages, and send status updates to Slack.

# Purpose
This script is a Bash executable designed to automate the process of running a backtest on a specified ledger using the Firedancer development tools. It accepts various command-line arguments to configure the ledger, snapshot, end slot, and other parameters necessary for the backtest. The script configures shared memory pages, generates a configuration file in TOML format, and executes the backtest using the `firedancer-dev` tool. It also integrates with Slack to send notifications about the start and completion status of the backtest, including any mismatches detected during the process. The script logs the results and handles cleanup after the backtest is complete.
# Global Variables

---
### LOG
- **Type**: ``string``
- **Description**: A string variable that stores the path to a temporary log file. The path includes the process ID (`$$`) to ensure uniqueness for each execution.
- **Use**: Used to specify the file path where log messages are written during the script execution.


---
### TRASH\_HASH
- **Type**: `string`
- **Description**: A string variable that stores a command-line option for specifying a trash hash value. It is initialized as an empty string and can be set to a specific value when the `-t` or `--trash` option is used.
- **Use**: Used to append a trash hash option to a command if specified by the user.


---
### THREAD\_MEM\_BOUND
- **Type**: ``string``
- **Description**: Defines a command-line option for setting the memory bound for threads in a backtest operation. The value is set to `--thread-mem-bound 0`, which indicates no memory bound is applied.
- **Use**: Used as a command-line argument in the `firedancer-dev backtest` command to specify memory constraints for threads.


---
### CHECKPT\_PATH
- **Type**: `string`
- **Description**: Defines the file path where mismatch data for a specific ledger is stored. The path is constructed using the `LEDGER` variable to create a unique directory for each ledger's mismatch data.
- **Use**: Used to specify the location for storing mismatch data related to a ledger in the `/data/nightly-mismatches/` directory.


---
### START\_SLACK\_MESSAGE
- **Type**: `string`
- **Description**: Contains a message string that alerts the start of a run for a specific ledger. The message includes the ledger name, commit identifier, and branch name.
- **Use**: Used to send an alert message to Slack indicating the start of a ledger run.


---
### END\_SLACK\_MESSAGE
- **Type**: `string`
- **Description**: `END_SLACK_MESSAGE` is a string variable that holds the final message to be sent to Slack after the completion of a ledger processing task. The message indicates whether the task was successful or failed, and includes details such as the ledger name, commit, branch, and any mismatch information if applicable.
- **Use**: Used to store and send the final status message to Slack after processing a ledger.


# Functions

---
### send\_slack\_message
Sends a message to a Slack channel using a predefined webhook URL.
- **Inputs**:
    - ``MESSAGE``: The message text to send to the Slack channel.
- **Logic and Control Flow**:
    - Assigns the first argument to the variable `MESSAGE`.
    - Creates a JSON payload with the `MESSAGE` text and `link_names` set to 1.
    - Uses the `curl` command to send a POST request with the JSON payload to the Slack webhook URL stored in the `SLACK_WEBHOOK_URL` environment variable.
- **Output**: There is no return value; the function sends a message to a Slack channel.



---
Made with ❤️ by [Driver](https://www.driver.ai/)