<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines the `fd_accdb_user` structure and functions for managing user access to an accdb funk instance.

# Purpose
The code is a C header file that defines the structure and functions for managing a user instance in an "accdb" (presumably an acronym for a specific database or data structure) within the context of the "flamenco" project. The file includes the `fd_funk.h` header, indicating that it relies on the functionalities provided by the `fd_funk` module. The primary structure defined is `fd_accdb_user`, which contains a `fd_funk_t` array, a fork cache, a transaction cache, and reference counting variables. The `FD_ACCDB_DEPTH_MAX` macro defines the maximum depth for the fork cache.

The file provides several inline functions and prototypes for managing `fd_accdb_user` instances. These include functions to determine memory alignment and footprint ([`fd_accdb_user_align`](<#fd_accdb_user_align>) and [`fd_accdb_user_footprint`](<#fd_accdb_user_footprint>)), as well as functions to create and delete user instances ([`fd_accdb_user_new`](<#fd_accdb_user_new>) and [`fd_accdb_user_delete`](<#fd_accdb_user_delete>)). Additionally, the file declares functions for joining and leaving an "accdb" instance ([`fd_accdb_user_join`](<#fd_accdb_user_join>) and [`fd_accdb_user_leave`](<#fd_accdb_user_leave>)). These functions facilitate the management of user instances in the context of the "accdb" system, providing a public API for external modules to interact with user data.
# Imports and Dependencies

---
- `../../funk/fd_funk.h`


# Data Structures

---
### fd\_accdb\_user
- **Type**: ``struct``
- **Members**:
    - `funk`: An array of `fd_funk_t` with a single element.
    - `fork`: An array of `fd_funk_txn_xid_t` with a maximum size defined by `FD_ACCDB_DEPTH_MAX`.
    - `fork_depth`: An `ulong` representing the current depth of the fork cache.
    - `tip_txn_idx`: An `ulong` indicating the index of the current transaction, with `ULONG_MAX` if the tip is the root.
    - `rw_active`: An `ulong` used for reference counting of active read/write operations.
- **Description**: Manages user-specific data for an account database, including a single-element funk array, a fork cache with a defined maximum depth, a transaction index for the current transaction, and a reference count for active operations.


---
### fd\_accdb\_user\_t
- **Type**: ``struct``
- **Members**:
    - ``funk``: An array of one `fd_funk_t` element, representing the funk instance.
    - ``fork``: An array of `fd_funk_txn_xid_t` with a maximum depth defined by `FD_ACCDB_DEPTH_MAX`, representing the current fork cache.
    - ``fork_depth``: An `ulong` indicating the depth of the current fork cache.
    - ``tip_txn_idx``: An `ulong` representing the index of the tip transaction, set to `ULONG_MAX` if the tip is the root.
    - ``rw_active``: An `ulong` used for reference counting of active read/write operations.
- **Description**: Defines a user structure for an accdb funk instance, managing fork and transaction caches, and reference counting for active operations.


# Functions

---
### fd\_accdb\_user\_align<!-- {{#callable:fd_accdb_user_align}} -->
[View Source →](<../../../../../src/flamenco/accdb/fd_accdb_user.h#L24>)

Returns the alignment requirement of the `fd_accdb_user_t` structure.
- **Inputs**: None
- **Logic and Control Flow**:
    - Calls the `alignof` operator on `fd_accdb_user_t` to determine its alignment requirement.
    - Returns the result of the `alignof` operator.
- **Output**: The alignment requirement of the `fd_accdb_user_t` structure as an `ulong`.


---
### fd\_accdb\_user\_footprint<!-- {{#callable:fd_accdb_user_footprint}} -->
[View Source →](<../../../../../src/flamenco/accdb/fd_accdb_user.h#L33>)

Calculates the memory footprint of the `fd_accdb_user_t` structure.
- **Inputs**: None
- **Logic and Control Flow**:
    - Returns the size of the `fd_accdb_user_t` structure using the `sizeof` operator.
- **Output**: The function returns an `ulong` representing the size of the `fd_accdb_user_t` structure in bytes.


---
### fd\_accdb\_user\_new<!-- {{#callable:fd_accdb_user_new}} -->
[View Source →](<../../../../../src/flamenco/accdb/fd_accdb_user.h#L38>)

Returns the input pointer `ljoin` as a `fd_accdb_user_t` pointer.
- **Inputs**:
    - `ljoin`: A pointer to a memory location intended to be used as a `fd_accdb_user_t` object.
- **Logic and Control Flow**:
    - The function takes a single argument `ljoin`.
    - It returns the `ljoin` pointer without modification.
- **Output**: A pointer of type `fd_accdb_user_t *`, which is the same as the input `ljoin`.


---
### fd\_accdb\_user\_delete<!-- {{#callable:fd_accdb_user_delete}} -->
[View Source →](<../../../../../src/flamenco/accdb/fd_accdb_user.h#L43>)

Returns the input pointer `ljoin` without modification.
- **Inputs**:
    - `ljoin`: A pointer to a memory location, intended to be a `fd_accdb_user_t` object.
- **Logic and Control Flow**:
    - Receives a pointer `ljoin` as input.
    - Returns the same pointer `ljoin` without any changes.
- **Output**: The function returns the input pointer `ljoin`.


# Function Declarations (Public API)

---
### fd\_accdb\_user\_join<!-- {{#callable_declaration:fd_accdb_user_join}} -->
[View Source →](<../../../../../src/flamenco/accdb/fd_accdb_user.h#L50>)

Joins a user to an accdb funk instance.
- **Description**: Use this function to associate a user with an accdb funk instance. It requires valid pointers for both the user structure and the shared funk instance. If either pointer is null, the function logs a warning and returns null. The function initializes the user structure and attempts to join the funk instance. If the join operation fails, it logs a critical error. Ensure that the user structure is properly allocated and that the shared funk instance is valid before calling this function.
- **Inputs**:
    - `ljoin`: A pointer to an `fd_accdb_user_t` structure that will be initialized and joined to the funk instance. Must not be null. Caller retains ownership.
    - `shfunk`: A pointer to a shared funk instance. Must not be null. Caller retains ownership.
- **Output**: Returns a pointer to the initialized `fd_accdb_user_t` structure if successful, or null if either input is invalid or the join operation fails.
- **See Also**: [`fd_accdb_user_join`](<fd_accdb_user.c.md#fd_accdb_user_join>)  (Implementation)


---
### fd\_accdb\_user\_leave<!-- {{#callable_declaration:fd_accdb_user_leave}} -->
[View Source →](<../../../../../src/flamenco/accdb/fd_accdb_user.h#L56>)

Detaches a user from an accdb instance.
- **Description**: Use this function to detach a user from an accdb instance when the user no longer needs to interact with it. This function must be called with a valid user object that was previously joined to an accdb. It is important to ensure that the user parameter is not null before calling this function, as passing a null value will result in a critical error. Optionally, a pointer to a shared funk object can be provided to receive additional information during the detachment process.
- **Inputs**:
    - `user`: A pointer to a `fd_accdb_user_t` object representing the user to detach. Must not be null. The user must have been previously joined to an accdb.
    - `opt_shfunk`: An optional pointer to a pointer where additional information about the shared funk object can be stored. Can be null if no additional information is needed.
- **Output**: Returns a pointer to the `fd_accdb_user_t` object that was detached.
- **See Also**: [`fd_accdb_user_leave`](<fd_accdb_user.c.md#fd_accdb_user_leave>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)