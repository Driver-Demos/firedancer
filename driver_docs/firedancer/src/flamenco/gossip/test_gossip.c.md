<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Tests basic functionality of the gossip protocol implementation in the Firedancer codebase.

# Purpose
This code is a C program that tests the basic functionality of a gossip protocol implementation. It includes the necessary headers and defines several static stub functions ([`send_stub`](<#send_stub>), [`sign_stub`](<#sign_stub>), and [`ping_change_stub`](<#ping_change_stub>)) that simulate network operations and cryptographic signing without performing actual operations. These stubs are used to facilitate testing by providing predictable and controlled behavior.

The main function of the program initializes the environment and calls [`test_gossip_new_basic`](<#test_gossip_new_basic>), which sets up a gossip protocol instance. It allocates memory for the gossip structure, initializes a random number generator, and configures a contact information structure with a public key and network address. The function then creates a new gossip instance using `fd_gossip_new`, passing the stubs and other parameters. It verifies the successful creation and joining of the gossip instance with `FD_TEST` assertions. After the test, the allocated memory is freed, and the program logs the success of the test before terminating. This code is intended to be executed as a standalone test suite for the gossip protocol.
# Imports and Dependencies

---
- `../../util/fd_util.h`
- `fd_gossip.h`
- `stdlib.h`


# Functions

---
### send\_stub<!-- {{#callable:send_stub}} -->
[View Source →](<../../../../../src/flamenco/gossip/test_gossip.c#L6>)

Does nothing with its input parameters and serves as a placeholder function.
- **Inputs**:
    - `ctx`: A pointer to a context, which is not used in this function.
    - `stem`: A pointer to an `fd_stem_context_t` structure, which is not used in this function.
    - `data`: A pointer to a constant unsigned character array, which is not used in this function.
    - `sz`: An unsigned long integer representing the size of the data, which is not used in this function.
    - `peer_address`: A pointer to a constant `fd_ip4_port_t` structure representing the peer's address, which is not used in this function.
    - `now`: An unsigned long integer representing the current time, which is not used in this function.
- **Logic and Control Flow**:
    - The function takes six parameters but does not use any of them.
    - Each parameter is explicitly cast to void to indicate that they are intentionally unused.
- **Output**: There is no output from this function as it performs no operations.


---
### sign\_stub<!-- {{#callable:sign_stub}} -->
[View Source →](<../../../../../src/flamenco/gossip/test_gossip.c#L16>)

Produces a deterministic dummy signature by filling the `out_signature` array with sequential byte values from 0 to 63.
- **Inputs**:
    - `ctx`: A pointer to a context, which is not used in this function.
    - `data`: A pointer to the data to be signed, which is not used in this function.
    - `sz`: The size of the data to be signed, which is not used in this function.
    - `sign_type`: An integer representing the type of signature, which is not used in this function.
    - `out_signature`: A pointer to an array where the function will store the generated dummy signature.
- **Logic and Control Flow**:
    - Ignores all input parameters except `out_signature`.
    - Initializes a loop that iterates 64 times, from 0 to 63.
    - In each iteration, assigns the loop index value to the corresponding position in the `out_signature` array.
- **Output**: A 64-byte array in `out_signature` filled with values from 0 to 63, representing a dummy signature.


---
### ping\_change\_stub<!-- {{#callable:ping_change_stub}} -->
[View Source →](<../../../../../src/flamenco/gossip/test_gossip.c#L27>)

Does nothing with the provided arguments, serving as a placeholder function.
- **Inputs**:
    - `ctx`: A pointer to a context, which is not used in the function.
    - `peer_pubkey`: A pointer to the peer's public key, which is not used in the function.
    - `peer_address`: The address and port of the peer, which is not used in the function.
    - `now`: A timestamp, which is not used in the function.
    - `change_type`: An integer representing the type of change, which is not used in the function.
- **Logic and Control Flow**:
    - The function takes five parameters but does not use any of them.
    - Each parameter is explicitly cast to void to indicate that they are intentionally unused.
- **Output**: No output is produced as the function body is empty.


---
### test\_gossip\_new\_basic<!-- {{#callable:test_gossip_new_basic}} -->
[View Source →](<../../../../../src/flamenco/gossip/test_gossip.c#L36>)

Initializes and tests a basic gossip protocol setup with predefined parameters and stubs.
- **Inputs**: None
- **Logic and Control Flow**:
    - Defines `max_values` as 1024 and `entrypoints_len` as 1, with a single entry point at IP address 127.0.0.1 and port 8001.
    - Initializes `fd_contact_info_t my_ci` with a public key, version information, and socket details for gossip communication.
    - Allocates memory for the gossip protocol using `aligned_alloc` with the required alignment and footprint.
    - Initializes a random number generator `rng` using `fd_rng_new` and `fd_rng_join`.
    - Defines static output contexts `gossip_update_out` and `gossip_net_out` for gossip operations.
    - Creates a new gossip instance `shgossip` using [`fd_gossip_new`](<fd_gossip.c.md#fd_gossip_new>) with the allocated memory, RNG, contact info, and stub functions for sending, signing, and ping changes.
    - Joins the gossip instance with [`fd_gossip_join`](<fd_gossip.c.md#fd_gossip_join>) and verifies its success.
    - Frees the allocated memory after the test.
- **Output**: No output is returned; the function performs internal tests and validations.
- **Functions Called**:
    - [`fd_gossip_align`](<fd_gossip.c.md#fd_gossip_align>)
    - [`fd_gossip_footprint`](<fd_gossip.c.md#fd_gossip_footprint>)
    - [`fd_gossip_new`](<fd_gossip.c.md#fd_gossip_new>)
    - [`fd_gossip_join`](<fd_gossip.c.md#fd_gossip_join>)


---
### main<!-- {{#callable:main}} -->
[View Source →](<../../../../../src/flamenco/gossip/test_gossip.c#L91>)

Initializes the program, runs a basic gossip test, logs the result, and then halts the program.
- **Inputs**:
    - `argc`: The number of command-line arguments.
    - `argv`: An array of strings representing the command-line arguments.
- **Logic and Control Flow**:
    - Calls `fd_boot` to initialize the program with command-line arguments.
    - Executes the [`test_gossip_new_basic`](<#test_gossip_new_basic>) function to perform a basic gossip test.
    - Logs a notice message indicating the test passed using `FD_LOG_NOTICE`.
    - Calls `fd_halt` to terminate the program.
    - Returns 0 to indicate successful execution.
- **Output**: Returns an integer 0 to indicate successful execution.
- **Functions Called**:
    - [`test_gossip_new_basic`](<#test_gossip_new_basic>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)