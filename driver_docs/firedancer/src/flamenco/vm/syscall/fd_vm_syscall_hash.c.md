<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Implements syscalls for SHA256, Keccak256, and Blake3 hash functions in a virtual machine.

# Purpose
The code defines a set of system call functions for hashing operations within a virtual machine environment. These functions implement hashing algorithms: SHA-256, Blake3, and Keccak256. Each function, [`fd_vm_syscall_sol_sha256`](<#fd_vm_syscall_sol_sha256>), [`fd_vm_syscall_sol_blake3`](<#fd_vm_syscall_sol_blake3>), and [`fd_vm_syscall_sol_keccak256`](<#fd_vm_syscall_sol_keccak256>), is responsible for processing input data sequences, applying the respective hash function, and storing the result in a specified memory address. The functions check if the number of input sequences exceeds a predefined limit (`FD_VM_SHA256_MAX_SLICES`) and update computational costs using `FD_VM_CU_UPDATE`.

The code is part of a larger system that interacts with a virtual machine (`fd_vm_t`). It uses structures like `fd_vm_haddr_query_t` to manage memory alignment and size for the hash results. The functions are designed to be modular, with each function following a similar structure but differing in the specific hash algorithm used. The implementation avoids using macros to maintain simplicity and ease of future modifications, such as changes in computational unit costs. The code references external resources for implementation details and constraints, ensuring alignment with a broader system architecture.
# Imports and Dependencies

---
- `fd_vm_syscall.h`
- `../../../ballet/keccak256/fd_keccak256.h`


# Functions

---
### fd\_vm\_syscall\_sol\_sha256<!-- {{#callable:fd_vm_syscall_sol_sha256}} -->
[View Source →](<../../../../../../src/flamenco/vm/syscall/fd_vm_syscall_hash.c#L26>)

Computes the SHA-256 hash of a sequence of data slices and stores the result in a specified memory address.
- **Inputs**:
    - `_vm`: A pointer to the virtual machine context (`fd_vm_t`).
    - `vals_addr`: The address of the input data slices in memory.
    - `vals_len`: The number of data slices to hash.
    - `result_addr`: The address where the hash result will be stored.
    - `r4`: Unused parameter.
    - `r5`: Unused parameter.
    - `_ret`: A pointer to store the return status of the function.
- **Logic and Control Flow**:
    - Cast `_vm` to `fd_vm_t` pointer.
    - Check if `vals_len` exceeds `FD_VM_SHA256_MAX_SLICES`; if so, log an error and return `FD_VM_SYSCALL_ERR_TOO_MANY_SLICES`.
    - Update the virtual machine's compute units with `FD_VM_SHA256_BASE_COST`.
    - Prepare a `fd_vm_haddr_query_t` structure for the hash result and translate it using `FD_VM_TRANSLATE_MUT`.
    - Initialize a SHA-256 context using `fd_sha256_init`.
    - If `vals_len` is greater than 0, load the input data slices from memory and iterate over them.
    - For each slice, calculate the cost, update the compute units, and append the data to the SHA-256 context.
    - Finalize the SHA-256 hash and store the result at `result_addr`.
    - Set `_ret` to 0 and return `FD_VM_SUCCESS`.
- **Output**: Returns `FD_VM_SUCCESS` on success, or an error code if the number of slices exceeds the limit.


---
### fd\_vm\_syscall\_sol\_blake3<!-- {{#callable:fd_vm_syscall_sol_blake3}} -->
[View Source →](<../../../../../../src/flamenco/vm/syscall/fd_vm_syscall_hash.c#L91>)

Computes the Blake3 hash for a sequence of input data slices and stores the result in a specified memory address.
- **Inputs**:
    - `_vm`: A pointer to the virtual machine context (`fd_vm_t`).
    - `vals_addr`: The address of the input data slices in memory.
    - `vals_len`: The number of input data slices to process.
    - `result_addr`: The address where the hash result will be stored.
    - `r4`: Unused parameter.
    - `r5`: Unused parameter.
    - `_ret`: A pointer to store the return status of the function.
- **Logic and Control Flow**:
    - Cast `_vm` to `fd_vm_t` type to access the virtual machine context.
    - Check if `vals_len` exceeds `FD_VM_SHA256_MAX_SLICES`; if so, log an error and return `FD_VM_SYSCALL_ERR_TOO_MANY_SLICES`.
    - Update the virtual machine's compute unit cost using `FD_VM_SHA256_BASE_COST`.
    - Prepare a `fd_vm_haddr_query_t` structure for the hash result with specified alignment and size, then translate it to a mutable address.
    - Initialize a `fd_blake3_t` structure for the Blake3 hashing process.
    - If `vals_len` is greater than 0, load the input data slices from memory and iterate over each slice.
    - For each slice, calculate the cost based on its length, update the compute unit cost, and append the slice data to the Blake3 hash context.
    - Finalize the Blake3 hash and store the result at the specified address.
    - Set the return status to 0 and return `FD_VM_SUCCESS`.
- **Output**: Returns `FD_VM_SUCCESS` on successful hash computation and stores the result in the specified memory address. If an error occurs, such as exceeding the maximum number of slices, it returns an error code.


---
### fd\_vm\_syscall\_sol\_keccak256<!-- {{#callable:fd_vm_syscall_sol_keccak256}} -->
[View Source →](<../../../../../../src/flamenco/vm/syscall/fd_vm_syscall_hash.c#L156>)

Computes the Keccak256 hash of a sequence of data slices and stores the result in a specified memory address.
- **Inputs**:
    - `_vm`: A pointer to the virtual machine context (`fd_vm_t`).
    - `vals_addr`: The address of the input data slices in memory.
    - `vals_len`: The number of data slices to hash.
    - `result_addr`: The address where the hash result will be stored.
    - `r4`: Unused parameter.
    - `r5`: Unused parameter.
    - `_ret`: A pointer to store the return status of the function.
- **Logic and Control Flow**:
    - Cast `_vm` to `fd_vm_t` type.
    - Check if `vals_len` exceeds `FD_VM_SHA256_MAX_SLICES`; if so, log an error and return `FD_VM_SYSCALL_ERR_TOO_MANY_SLICES`.
    - Update the virtual machine's computational unit cost with `FD_VM_SHA256_BASE_COST`.
    - Prepare a query for the hash result with specified alignment and size, then translate it for the virtual machine.
    - Initialize a `fd_keccak256_t` structure for hashing.
    - If `vals_len` is greater than 0, load the input data slices from memory and iterate over them.
    - For each slice, calculate the cost, update the computational unit cost, and append the data to the Keccak256 hash context.
    - Finalize the hash computation and store the result at `result_addr`.
    - Set the return status to 0 and return `FD_VM_SUCCESS`.
- **Output**: Returns `FD_VM_SUCCESS` on successful hash computation, or an error code if the number of slices exceeds the limit.



---
Made with ❤️ by [Driver](https://www.driver.ai/)