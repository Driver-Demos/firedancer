<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines custom data types and functions for hash, signature, and stake weight management in the Firedancer codebase.

# Purpose
The code defines a C header file that provides data structures and functions related to cryptographic operations and transaction metadata management. It includes definitions for hash and public key types, using a union `fd_hash` that allows interchangeable use of hash and public key data. The code also defines a `fd_signature` union for handling digital signatures. The file includes several macros and inline functions for operations such as equality checks and zeroing out hash and public key data. These components are essential for cryptographic verification and data integrity within the system.

Additionally, the code defines structures for managing transaction status indices and vote stake weights, which are crucial for handling transaction metadata and voting mechanisms in a distributed system. The `fd_txnstatusidx` structure is used to index transaction status blocks, while the `fd_vote_stake_weight` and `fd_stake_weight` structures manage voting and staking information. The file also includes sorting and red-black tree implementations for managing these data structures efficiently. The header file is intended to be included in other C source files, providing a set of utilities and data types for cryptographic and transaction-related operations.
# Imports and Dependencies

---
- `../fd_flamenco_base.h`
- `fd_types_meta.h`
- `fd_bincode.h`
- `../../ballet/bmtree/fd_bmtree.h`
- `../../ballet/ed25519/fd_ed25519.h`
- `../../util/tmpl/fd_sort.c`
- `../../util/tmpl/fd_redblack.c`


# Data Structures

---
### fd\_hash
- **Type**: `union`
- **Members**:
    - `hash`: An array of unsigned characters with a size defined by `FD_HASH_FOOTPRINT`.
    - `key`: An array of unsigned characters with a size defined by `FD_HASH_FOOTPRINT`, interchangeable with `fd_pubkey`.
    - `ul`: An array of unsigned long integers, sized by dividing `FD_HASH_FOOTPRINT` by the size of `ulong`.
    - `ui`: An array of unsigned integers, sized by dividing `FD_HASH_FOOTPRINT` by the size of `uint`.
    - `uc`: An array of unsigned characters with a size defined by `FD_HASH_FOOTPRINT`.
- **Description**: The `fd_hash` union is a packed data structure that provides multiple ways to access a fixed-size array of bytes, defined by `FD_HASH_FOOTPRINT`. It allows access to the data as an array of unsigned characters, unsigned integers, or unsigned long integers. The `fd_hash` is interchangeable with `fd_pubkey`, facilitating its use in various cryptographic and data integrity operations. The union is used in contexts where different interpretations of the same data footprint are needed, such as cryptographic hash functions or public key representations.


---
### fd\_hash\_t
- **Type**: `union`
- **Members**:
    - ``hash``: An array of unsigned characters with a size defined by `FD_HASH_FOOTPRINT`.
    - ``key``: An array of unsigned characters with a size defined by `FD_HASH_FOOTPRINT`, interchangeable with `hash`.
    - ``ul``: An array of unsigned long integers, sized to fit `FD_HASH_FOOTPRINT`.
    - ``ui``: An array of unsigned integers, sized to fit `FD_HASH_FOOTPRINT`.
    - ``uc``: An array of unsigned characters with a size defined by `FD_HASH_FOOTPRINT`.
- **Description**: The `fd_hash_t` union is a packed data structure that provides multiple ways to access a 32-byte footprint, allowing it to be used interchangeably as a hash or a public key. It includes arrays for different data types (`uchar`, `ulong`, `uint`) to facilitate various operations and comparisons, and is used in the Firedancer codebase for tasks such as representing Merkle roots.


---
### fd\_pubkey\_t
- **Type**: `union`
- **Members**:
    - `hash`: An array of unsigned characters representing a hash with a footprint of 32 bytes.
    - `key`: An array of unsigned characters representing a key, interchangeable with the hash, with a footprint of 32 bytes.
    - `ul`: An array of unsigned long integers for type-specific access, with a size based on the hash footprint.
    - `ui`: An array of unsigned integers for type-specific access, with a size based on the hash footprint.
    - `uc`: An array of unsigned characters for type-specific access, with a size equal to the hash footprint.
- **Description**: `fd_pubkey_t` is a union that allows interchangeable use of hash and public key data, both represented as arrays of unsigned characters with a fixed size of 32 bytes. It provides multiple type-specific accessors, including arrays of unsigned long integers, unsigned integers, and unsigned characters, to facilitate different operations on the data. The union is packed to ensure no padding is added, maintaining a consistent memory footprint.


---
### fd\_signature
- **Type**: `union`
- **Members**:
    - `uc`: An array of 64 unsigned characters.
    - `ul`: An array of 8 unsigned long integers.
- **Description**: The `fd_signature` union provides two different views of a 512-bit data structure, allowing access either as an array of 64 bytes (`uchar`) or as an array of 8 unsigned long integers (`ulong`). This flexibility is useful for operations that require different data representations, such as cryptographic signature processing.


---
### fd\_signature\_t
- **Type**: `union`
- **Members**:
    - ``uc``: An array of 64 unsigned characters.
    - ``ul``: An array of 8 unsigned long integers.
- **Description**: A union that can store a digital signature as either an array of 64 unsigned characters or an array of 8 unsigned long integers, providing flexibility in how the signature data is accessed or manipulated.


---
### fd\_option\_slot
- **Type**: ``struct``
- **Members**:
    - ``is_some``: Indicates if the `slot` field contains a valid value.
    - ``slot``: Stores an unsigned long integer value representing a slot.
- **Description**: Represents an optional slot value, where `is_some` indicates the presence of a valid `slot` value, and `slot` holds the actual slot value if `is_some` is true.


---
### fd\_option\_slot\_t
- **Type**: ``struct``
- **Members**:
    - ``is_some``: Indicates if the option contains a value (1) or is empty (0).
    - ``slot``: Stores the slot value when the option contains a value.
- **Description**: Represents an optional slot value, where `is_some` indicates the presence of a value, and `slot` holds the actual slot value if present.


---
### fd\_txnstatusidx
- **Type**: ``struct``
- **Members**:
    - `sig`: Holds a signature of type `fd_ed25519_sig_t`.
    - `offset`: Stores an unsigned long integer representing an offset.
    - `status_sz`: Stores an unsigned long integer representing the size of the status.
- **Description**: Defines an index structure for transaction status metadata blocks, containing a signature, an offset, and a status size.


---
### fd\_txnstatusidx\_t
- **Type**: ``struct``
- **Members**:
    - `sig`: Holds the signature of the transaction using `fd_ed25519_sig_t`.
    - `offset`: Stores the offset value as an `ulong`.
    - `status_sz`: Represents the size of the status as an `ulong`.
- **Description**: Defines a structure for indexing transaction status metadata blocks, containing a signature, an offset, and a status size.


---
### fd\_rust\_duration\_t
- **Type**: ``struct``
- **Description**: `fd_rust_duration_t` is a typedef for a `struct fd_rust_duration`, but the actual structure definition is not provided in the given code. The typedef suggests that `fd_rust_duration_t` is intended to represent a duration, possibly in the context of Rust language interoperability, but without the structure definition, the specific fields and their purposes cannot be determined.


---
### fd\_vote\_stake\_weight\_t
- **Type**: ``struct``
- **Members**:
    - ``vote_key``: Stores the public key of the vote account.
    - ``id_key``: Stores the public key of the validator identity.
    - ``stake``: Represents the total stake associated with the vote account.
- **Description**: Represents a structure that holds information about a vote account's stake weight, including the public keys for the vote account and validator identity, as well as the total stake amount.


---
### fd\_stake\_weight
- **Type**: ``struct``
- **Members**:
    - ``key``: Validator identity public key.
    - ``stake``: Total stake by identity.
- **Description**: Represents a structure that holds a validator's identity public key and the total stake associated with that identity. This structure is used to track the stake weight of a validator in a blockchain or distributed ledger system.


---
### fd\_stake\_weight\_t
- **Type**: ``struct``
- **Members**:
    - `key`: Validator identity public key.
    - `stake`: Total stake by identity.
- **Description**: Represents a structure that holds information about the stake associated with a validator's identity, including the public key and the total stake amount.


---
### fd\_stake\_weight\_t\_mapnode
- **Type**: ``struct``
- **Members**:
    - `elem`: Holds a `fd_stake_weight_t` element, representing a stake weight with a validator identity public key and total stake.
    - `redblack_parent`: Stores the index of the parent node in a red-black tree.
    - `redblack_left`: Stores the index of the left child node in a red-black tree.
    - `redblack_right`: Stores the index of the right child node in a red-black tree.
    - `redblack_color`: Indicates the color of the node in a red-black tree, typically 0 for black and 1 for red.
- **Description**: Defines a node in a red-black tree structure, where each node contains a `fd_stake_weight_t` element and metadata for maintaining the tree's properties, such as parent, left and right children indices, and node color.


---
### fd\_stake\_weight\_t\_mapnode\_t
- **Type**: ``struct``
- **Members**:
    - ``elem``: Contains a `fd_stake_weight_t` structure representing a validator's identity and total stake.
    - ``redblack_parent``: Stores the index of the parent node in the red-black tree.
    - ``redblack_left``: Stores the index of the left child node in the red-black tree.
    - ``redblack_right``: Stores the index of the right child node in the red-black tree.
    - ``redblack_color``: Indicates the color of the node in the red-black tree, typically red or black.
- **Description**: Defines a node in a red-black tree structure, where each node contains a `fd_stake_weight_t` element representing a validator's identity and stake, along with metadata for maintaining the tree's properties, such as parent, left and right child indices, and node color.


# Functions

---
### fd\_hash\_eq<!-- {{#callable:fd_hash_eq}} -->
[View Source →](<../../../../../src/flamenco/types/fd_types_custom.h#L32>)

Compares two `fd_hash_t` objects for equality by checking if their memory contents are identical.
- **Inputs**:
    - `a`: A pointer to the first `fd_hash_t` object to compare.
    - `b`: A pointer to the second `fd_hash_t` object to compare.
- **Logic and Control Flow**:
    - Uses the `memcmp` function to compare the memory contents of `a` and `b`.
    - Checks if the result of `memcmp` is zero, indicating that the memory contents are identical.
- **Output**: Returns an integer value of 1 if the memory contents of `a` and `b` are identical, otherwise returns 0.


---
### fd\_hash\_eq1<!-- {{#callable:fd_hash_eq1}} -->
[View Source →](<../../../../../src/flamenco/types/fd_types_custom.h#L38>)

Compares two `fd_hash_t` values for equality by checking each of their four `ulong` elements.
- **Inputs**:
    - `a`: An `fd_hash_t` value to compare.
    - `b`: Another `fd_hash_t` value to compare.
- **Logic and Control Flow**:
    - Compares the first `ulong` element of `a` and `b` for equality.
    - Compares the second `ulong` element of `a` and `b` for equality.
    - Compares the third `ulong` element of `a` and `b` for equality.
    - Compares the fourth `ulong` element of `a` and `b` for equality.
    - Uses bitwise AND to combine the results of the four comparisons, resulting in a single integer indicating equality.
- **Output**: Returns an integer that is non-zero if all four `ulong` elements of `a` and `b` are equal, otherwise returns zero.


---
### fd\_signature\_eq<!-- {{#callable:fd_signature_eq}} -->
[View Source →](<../../../../../src/flamenco/types/fd_types_custom.h#L53>)

Compares two `fd_signature_t` objects for equality.
- **Inputs**:
    - `a`: A pointer to the first `fd_signature_t` object to compare.
    - `b`: A pointer to the second `fd_signature_t` object to compare.
- **Logic and Control Flow**:
    - Use `memcmp` to compare the memory content of `a` and `b` for the size of `fd_signature_t`.
    - Return the result of the comparison, which is `0` if the objects are equal.
- **Output**: Returns an integer `0` if the two `fd_signature_t` objects are equal, otherwise returns a non-zero value.


# Function Declarations (Public API)

---
### fd\_rust\_duration\_normalize<!-- {{#callable_declaration:fd_rust_duration_normalize}} -->
[View Source →](<../../../../../src/flamenco/types/fd_types_custom.h#L95>)

Normalizes a duration by adjusting seconds and nanoseconds.
- **Description**: Use this function to adjust the `nanoseconds` and `seconds` fields of a `fd_rust_duration_t` structure so that the `nanoseconds` field is less than one billion. This function should be called when you need to ensure that the duration is in a normalized form, where `nanoseconds` is always less than 1,000,000,000. It modifies the input structure directly and does not return a value. Call this function only when the `fd_rust_duration_t` structure is properly initialized.
- **Inputs**:
    - `self`: A pointer to a `fd_rust_duration_t` structure. The structure must be initialized before calling this function. The function modifies the `seconds` and `nanoseconds` fields of this structure. The pointer must not be null.
- **Output**: None
- **See Also**: [`fd_rust_duration_normalize`](<fd_types_custom.c.md#fd_rust_duration_normalize>)  (Implementation)


---
### fd\_rust\_duration\_footprint\_validator<!-- {{#callable_declaration:fd_rust_duration_footprint_validator}} -->
[View Source →](<../../../../../src/flamenco/types/fd_types_custom.h#L98>)

Validates the footprint of a Rust duration.
- **Description**: Use this function to check if a Rust duration, represented in a binary decode context, has a valid footprint. It verifies that the nanoseconds part of the duration is less than one billion, ensuring it is a valid representation. If the nanoseconds exceed this limit, the function checks for overflow when adding the seconds and nanoseconds (converted to seconds). Call this function when you need to validate the duration's footprint before further processing.
- **Inputs**:
    - `ctx`: A pointer to an `fd_bincode_decode_ctx_t` structure that contains the Rust duration data. Must not be null. The function expects the `data` field of this context to point to a valid `fd_rust_duration_t` structure.
- **Output**: Returns `FD_BINCODE_SUCCESS` if the duration is valid, or `FD_BINCODE_ERR_ENCODING` if there is an overflow when adding seconds and nanoseconds.
- **See Also**: [`fd_rust_duration_footprint_validator`](<fd_types_custom.c.md#fd_rust_duration_footprint_validator>)  (Implementation)


---
### fd\_tower\_sync\_decode\_footprint\_inner<!-- {{#callable_declaration:fd_tower_sync_decode_footprint_inner}} -->
[View Source →](<../../../../../src/flamenco/types/fd_types_custom.h#L101>)

Decodes a footprint from a binary context and updates the total size.
- **Description**: Use this function to decode a footprint from a binary context and update the total size of the decoded data. It processes the binary data pointed to by the context, extracting relevant information and ensuring that the data does not exceed the bounds of the context. This function must be called with a valid decode context and a pointer to a size variable. It handles potential overflow errors and updates the total size with the footprint of the decoded data. Ensure that the context's data pointer is within the valid range before calling this function.
- **Inputs**:
    - `ctx`: A pointer to a `fd_bincode_decode_ctx_t` structure that contains the binary data to decode. The data pointer must be within the valid range of the context's dataend. The caller retains ownership and must ensure the context is valid.
    - `total_sz`: A pointer to an `ulong` that will be updated with the total size of the decoded footprint. The caller must provide a valid pointer, and the function will add the footprint size to the value pointed to by this parameter.
- **Output**: Returns an integer indicating success or an error code. A return value of 0 indicates success, while non-zero values indicate specific error conditions, such as overflow.
- **See Also**: [`fd_tower_sync_decode_footprint_inner`](<fd_types_custom.c.md#fd_tower_sync_decode_footprint_inner>)  (Implementation)


---
### fd\_tower\_sync\_decode\_inner<!-- {{#callable_declaration:fd_tower_sync_decode_inner}} -->
[View Source →](<../../../../../src/flamenco/types/fd_types_custom.h#L102>)

Decodes a tower sync structure from a binary context.
- **Description**: Use this function to decode a tower sync structure from a binary context into a provided memory structure. This function requires a valid memory location for the structure and an allocation memory pointer, which it may modify. The decoding process involves reading various fields from the context, including root, lockouts, hash, and block ID. Ensure that the context is correctly initialized and contains the expected data format before calling this function. The function modifies the provided structure memory to reflect the decoded data.
- **Inputs**:
    - `struct_mem`: A pointer to the memory location where the decoded tower sync structure will be stored. Must not be null.
    - `alloc_mem`: A pointer to a memory location that the function may modify during decoding. Must not be null.
    - `ctx`: A pointer to a `fd_bincode_decode_ctx_t` structure that contains the binary data to decode. Must be properly initialized and not null.
- **Output**: None
- **See Also**: [`fd_tower_sync_decode_inner`](<fd_types_custom.c.md#fd_tower_sync_decode_inner>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)