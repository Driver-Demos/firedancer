<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

High-level APIs for loading Solana programs from an account database, including ELF loading and sBPF version derivation.

# Purpose
The `fd_prog_load.h` file is a C header file that provides high-level APIs for loading Solana programs from an account database. It includes functions and structures to facilitate the retrieval and management of program data, specifically focusing on loading ELF binaries and deriving sBPF versions based on the current feature set. The function [`fd_prog_load_elf`](<#fd_prog_load_elf>) is used to load a reference to program data from a funk-backed account database, returning a pointer to the ELF binary and setting output parameters for the size and transaction ID of the program data account. The file also defines the [`fd_prog_versions`](<#fd_prog_versions>) structure to derive sBPF versions and the `fd_prog_load_env` structure to manage environment details such as the current slot and epoch. The header includes necessary dependencies and uses macros to manage function prototypes.
# Imports and Dependencies

---
- `../../funk/fd_funk_rec.h`
- `../fd_flamenco_base.h`


# Data Structures

---
### fd\_prog\_versions
- **Type**: ``struct``
- **Members**:
    - ``min_sbpf_version``: Minimum supported sBPF version.
    - ``max_sbpf_version``: Maximum supported sBPF version.
- **Description**: Defines the range of supported sBPF versions by specifying the minimum and maximum versions.


---
### fd\_prog\_versions\_t
- **Type**: ``struct``
- **Members**:
    - `min_sbpf_version`: Specifies the minimum sBPF version supported.
    - `max_sbpf_version`: Specifies the maximum sBPF version supported.
- **Description**: Defines the range of sBPF versions derived from the current feature set, with `min_sbpf_version` and `max_sbpf_version` indicating the minimum and maximum supported versions, respectively.


---
### fd\_prog\_load\_env\_t
- **Type**: ``struct``
- **Members**:
    - `features`: Pointer to a constant `fd_features_t` structure.
    - `slot`: Represents the current slot as an unsigned long integer.
    - `epoch`: Represents the current epoch as an unsigned long integer.
    - `epoch_slot0`: Represents the slot0 of the current epoch as an unsigned long integer.
- **Description**: Defines the environment for loading Solana programs, including the current slot, epoch, and the starting slot of the current epoch, with a reference to the feature set.


# Function Declarations (Public API)

---
### fd\_prog\_load\_elf<!-- {{#callable_declaration:fd_prog_load_elf}} -->
[View Source →](<../../../../../src/flamenco/progcache/fd_prog_load.h#L10>)

Loads a reference to program data from a funk-backed account database.
- **Description**: Use this function to obtain a pointer to the ELF binary of a Solana program from a funk-backed account database. The function requires the account address of the program account, not the program data account. It sets the size of the program data account and the transaction XID where the program data account was last written. Call this function when you need to access the program data for execution or analysis. The function returns NULL if the program account is not found, the program is not deployed, or the program data account is not found.
- **Inputs**:
    - `accdb`: A pointer to a constant `fd_funk_t` structure representing the account database. Must not be null.
    - `xid`: A pointer to a constant `fd_funk_txn_xid_t` structure representing the transaction ID. Must not be null.
    - `prog_addr`: A pointer to the address of the program account. Must not be null and should point to a valid address.
    - `out_sz`: A pointer to an `ulong` where the function will store the size of the program data account. Must not be null.
    - `out_xid`: A pointer to an `fd_funk_txn_xid_t` where the function will store the transaction XID of the program data account. Can be null, in which case an internal variable is used.
- **Output**: Returns a pointer to the first byte of the ELF binary on success, or NULL on failure.
- **See Also**: [`fd_prog_load_elf`](<fd_prog_load.c.md#fd_prog_load_elf>)  (Implementation)


---
### fd\_prog\_versions<!-- {{#callable_declaration:fd_prog_versions_t::fd_prog_versions}} -->
[View Source →](<../../../../../src/flamenco/progcache/fd_prog_load.h#L39>)

Derives sBPF versions from the current feature set.
- **Description**: Use this function to determine the minimum and maximum sBPF versions that are enabled based on the current feature set and slot. This function is useful when you need to know which sBPF versions are available for execution in a given context. Ensure that the `features` pointer is valid and points to a properly initialized `fd_features_t` structure. The `slot` parameter should correspond to the current slot for which you want to derive the sBPF versions.
- **Inputs**:
    - `features`: A pointer to a `fd_features_t` structure that contains the current feature set. Must not be null and should be properly initialized before calling this function.
    - `slot`: An unsigned long integer representing the current slot. This value is used to check which features are active and should be a valid slot number.
- **Output**: Returns a `fd_prog_versions_t` structure containing the minimum and maximum sBPF versions that are enabled based on the provided feature set and slot.
- **See Also**: [`fd_prog_versions_t::fd_prog_versions`](<fd_prog_load.c.md#fd_prog_versions_tfd_prog_versions>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)