<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines structures and functions for managing program cache administration, including transaction operations and cache maintenance.

# Purpose
The code is a C header file that defines the interface for managing a program cache using a structure named `fd_progcache_admin_t`. This file provides function prototypes for operations related to the administration of a program cache, which is part of a larger system that uses the `fd_funk` library. The primary components include constructors, transaction-level operations, and reset operations. The constructors allow for estimating cache parameters and joining or leaving a program cache instance. Transaction-level operations enable the management of cache transactions, such as attaching child nodes, advancing the root of a transaction graph, and canceling transactions. Reset operations provide functionality to flush or clear the cache and verify its integrity.

The header file defines a public API for interacting with the program cache, making it suitable for inclusion in other C source files that require cache management capabilities. The functions are designed to handle cache entries and transaction graphs, ensuring that the cache can be efficiently managed and verified. The file includes necessary dependencies and uses conditional compilation to prevent multiple inclusions. The use of `fd_funk_t` and related transaction identifiers indicates that the cache management is closely tied to the `fd_funk` library's transaction handling mechanisms.
# Imports and Dependencies

---
- `../../funk/fd_funk.h`


# Data Structures

---
### fd\_progcache\_admin
- **Type**: ``struct``
- **Members**:
    - ``funk``: An array of one `fd_funk_t` element.
- **Description**: The `fd_progcache_admin` structure contains a single member, `funk`, which is an array of one `fd_funk_t` element. This structure is used to manage program cache operations, including joining and leaving a cache, transaction-level operations, and reset operations. It provides a way to interact with a program cache funk instance, allowing for operations such as attaching child transactions, advancing the root of the transaction graph, and canceling transactions. Additionally, it supports operations to flush or clear the cache and verify the integrity of the data structure.


---
### fd\_progcache\_admin\_t
- **Type**: ``struct``
- **Members**:
    - ``funk``: An array of one `fd_funk_t` element.
- **Description**: The `fd_progcache_admin_t` structure contains a single member, `funk`, which is an array of one `fd_funk_t` element. This structure is used to manage program cache operations, including joining and leaving a cache, transaction-level operations, and reset operations. It provides a framework for handling program cache instances and their associated transactions.


# Function Declarations (Public API)

---
### fd\_progcache\_est\_rec\_max<!-- {{#callable_declaration:fd_progcache_est_rec_max}} -->
[View Source →](<../../../../../src/flamenco/progcache/fd_progcache_admin.h#L12>)

Estimates the maximum number of records for a program cache.
- **Description**: Use this function to estimate the maximum number of records (`rec_max`) that a program cache can handle based on the workspace footprint and the average size of cache entries. This function is useful for configuring cache parameters to optimize performance. Ensure that the estimated value does not exceed the maximum allowable limit; otherwise, an error is logged. The function returns a minimum of 2048 if the calculated estimate is lower.
- **Inputs**:
    - `wksp_footprint`: The total size of the workspace footprint in bytes. Must be a positive integer.
    - `mean_cache_entry_size`: The average size of a cache entry in bytes. Must be a positive integer.
- **Output**: Returns the estimated maximum number of records as an unsigned long integer, ensuring it is at least 2048.
- **See Also**: [`fd_progcache_est_rec_max`](<fd_progcache_admin.c.md#fd_progcache_est_rec_max>)  (Implementation)


---
### fd\_progcache\_admin\_join<!-- {{#callable_declaration:fd_progcache_admin_join}} -->
[View Source →](<../../../../../src/flamenco/progcache/fd_progcache_admin.h#L26>)

Joins a caller to a program cache funk instance.
- **Description**: Use this function to join a caller to a program cache funk instance. This function initializes the provided `fd_progcache_admin_t` structure and attempts to join it with the specified shared funk instance. It must be called with valid pointers for both parameters. If either parameter is null, the function logs a warning and returns null. Ensure that the `fd_progcache_admin_t` structure is properly allocated before calling this function.
- **Inputs**:
    - `ljoin`: A pointer to an `fd_progcache_admin_t` structure that will be initialized and joined to the funk instance. Must not be null. Caller retains ownership.
    - `shfunk`: A pointer to a shared funk instance to join. Must not be null. Caller retains ownership.
- **Output**: Returns a pointer to the initialized `fd_progcache_admin_t` structure if successful, or null if either input is invalid.
- **See Also**: [`fd_progcache_admin_join`](<fd_progcache_admin.c.md#fd_progcache_admin_join>)  (Implementation)


---
### fd\_progcache\_admin\_leave<!-- {{#callable_declaration:fd_progcache_admin_leave}} -->
[View Source →](<../../../../../src/flamenco/progcache/fd_progcache_admin.h#L32>)

Detaches from a program cache.
- **Description**: Use this function to detach from a program cache that was previously joined. It is important to ensure that the `ljoin` parameter is not null before calling this function, as a null value will result in a critical log error. This function also attempts to leave the associated funk instance, and if this operation fails, it will log a critical error. This function is typically called when the program cache is no longer needed, and resources should be released.
- **Inputs**:
    - `cache`: A pointer to an `fd_progcache_admin_t` structure representing the program cache to detach from. Must not be null.
    - `opt_shfunk`: An optional pointer to a location where the function can store a pointer to the shared funk instance. Can be null if this information is not needed by the caller.
- **Output**: Returns a pointer to the `fd_progcache_admin_t` structure that was detached from.
- **See Also**: [`fd_progcache_admin_leave`](<fd_progcache_admin.c.md#fd_progcache_admin_leave>)  (Implementation)


---
### fd\_progcache\_txn\_attach\_child<!-- {{#callable_declaration:fd_progcache_txn_attach_child}} -->
[View Source →](<../../../../../src/flamenco/progcache/fd_progcache_admin.h#L44>)

Creates a new program cache fork node with a specified parent.
- **Description**: Use this function to create a new transaction node in the program cache, linking it to an existing parent transaction. Ensure that the number of non-root transactions is less than the maximum allowed before calling this function. This operation is part of managing transaction-level operations within the program cache.
- **Inputs**:
    - `cache`: A pointer to an `fd_progcache_admin_t` structure representing the program cache. Must not be null.
    - `xid_parent`: A pointer to a `fd_funk_txn_xid_t` structure representing the parent transaction ID. Must not be null.
    - `xid_new`: A pointer to a `fd_funk_txn_xid_t` structure representing the new transaction ID to be created. Must not be null.
- **Output**: None
- **See Also**: [`fd_progcache_txn_attach_child`](<fd_progcache_admin.c.md#fd_progcache_txn_attach_child>)  (Implementation)


---
### fd\_progcache\_txn\_advance\_root<!-- {{#callable_declaration:fd_progcache_txn_advance_root}} -->
[View Source →](<../../../../../src/flamenco/progcache/fd_progcache_admin.h#L54>)

Advances the fork graph root to the specified transaction ID.
- **Description**: Use this function to update the root of the fork graph to a specific transaction ID, which is considered the last published transaction. This operation assumes that the specified transaction's parent is the current root of the fork graph. It is important to ensure that the transaction ID provided is valid and that its parent is indeed the root, as the function will log a critical error if these conditions are not met. This function modifies the transaction graph by reassigning child transactions to the root.
- **Inputs**:
    - `cache`: A pointer to an `fd_progcache_admin_t` structure representing the program cache. Must not be null. The caller retains ownership.
    - `xid`: A pointer to a `fd_funk_txn_xid_t` structure representing the transaction ID to advance to. Must not be null. The transaction ID must exist and its parent must be the current root of the fork graph.
- **Output**: None
- **See Also**: [`fd_progcache_txn_advance_root`](<fd_progcache_admin.c.md#fd_progcache_txn_advance_root>)  (Implementation)


---
### fd\_progcache\_txn\_cancel<!-- {{#callable_declaration:fd_progcache_txn_cancel}} -->
[View Source →](<../../../../../src/flamenco/progcache/fd_progcache_admin.h#L61>)

Removes a transaction and its descendants from the cache.
- **Description**: Use this function to remove a transaction identified by its XID and all its descendant transactions from the program cache. This operation is recursive and will affect the entire subtree of transactions under the specified XID. Ensure that the transaction with the given XID exists in the cache before calling this function, as it will log a critical error if the transaction is not found. This function is typically used to manage and clean up the transaction graph within the cache.
- **Inputs**:
    - `cache`: A pointer to an `fd_progcache_admin_t` structure representing the program cache. Must not be null. The caller retains ownership.
    - `xid`: A pointer to a `fd_funk_txn_xid_t` structure that identifies the transaction to cancel. Must not be null. The function logs a critical error if the transaction with this XID is not found.
- **Output**: None
- **See Also**: [`fd_progcache_txn_cancel`](<fd_progcache_admin.c.md#fd_progcache_txn_cancel>)  (Implementation)


---
### fd\_progcache\_reset<!-- {{#callable_declaration:fd_progcache_reset}} -->
[View Source →](<../../../../../src/flamenco/progcache/fd_progcache_admin.h#L70>)

Resets the program cache to its initial state.
- **Description**: Use this function to reset the program cache to its initial state by clearing all transactions and records. This function is useful when you need to start fresh with a clean cache. It does not support concurrent usage, so ensure that no other operations are being performed on the cache when calling this function. The function must be called with a valid `fd_progcache_admin_t` pointer.
- **Inputs**:
    - `cache`: A pointer to an `fd_progcache_admin_t` structure representing the program cache to reset. Must not be null. The caller retains ownership of the memory.
- **Output**: None
- **See Also**: [`fd_progcache_reset`](<fd_progcache_admin.c.md#fd_progcache_reset>)  (Implementation)


---
### fd\_progcache\_clear<!-- {{#callable_declaration:fd_progcache_clear}} -->
[View Source →](<../../../../../src/flamenco/progcache/fd_progcache_admin.h#L76>)

Removes all cache entries and destroys the transaction graph.
- **Description**: Use this function to completely clear the program cache, including all cache entries and the transaction graph. This operation is not thread-safe and must not be used concurrently with other operations on the same cache. It is suitable for scenarios where a full reset of the cache state is required.
- **Inputs**:
    - `cache`: A pointer to an `fd_progcache_admin_t` structure representing the program cache to clear. Must not be null. The caller retains ownership of the memory.
- **Output**: None
- **See Also**: [`fd_progcache_clear`](<fd_progcache_admin.c.md#fd_progcache_clear>)  (Implementation)


---
### fd\_progcache\_verify<!-- {{#callable_declaration:fd_progcache_verify}} -->
[View Source →](<../../../../../src/flamenco/progcache/fd_progcache_admin.h#L83>)

Performs integrity checks on the program cache.
- **Description**: Use this function to verify the integrity of the program cache data structures. It performs comprehensive checks to ensure data consistency and correctness. This function should be called when no other operations are being performed on the program cache, as it assumes exclusive access. It is useful for debugging and maintenance purposes to ensure the cache is in a valid state.
- **Inputs**:
    - `cache`: A pointer to an `fd_progcache_admin_t` structure representing the program cache to verify. Must not be null. The caller retains ownership of the cache.
- **Output**: None
- **See Also**: [`fd_progcache_verify`](<fd_progcache_admin.c.md#fd_progcache_verify>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)