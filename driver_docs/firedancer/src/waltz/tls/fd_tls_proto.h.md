<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Declares TLS v1.3 data structures and APIs for encoding/decoding them to/from wire format.

# Purpose
The `fd_tls_proto.h` file is a C header file that defines data structures and functions for handling the Transport Layer Security (TLS) version 1.3 protocol. It provides internal APIs to encode and decode various TLS v1.3 data structures from and to their wire formats. The file includes definitions for both dynamically and statically laid out data structures, which are essential for representing the protocol's variable-length lists and unions. For static data structures, it provides packed C structs and functions for endianness conversion.

The file declares several TLS-related structures, such as `fd_tls_client_hello_t`, `fd_tls_server_hello_t`, and `fd_tls_enc_ext_t`, which correspond to different TLS messages and extensions. It also defines macros and functions for encoding and decoding these structures, ensuring they match the wire representation required by the protocol. Additionally, the file includes definitions for various TLS constants, such as version numbers, cipher suite IDs, and alert codes, which are used throughout the TLS protocol. The header is intended to be included in other C files that implement or interact with the TLS protocol, providing a comprehensive set of tools for managing TLS v1.3 communications.
# Imports and Dependencies

---
- `../fd_waltz_base.h`
- `stddef.h`


# Global Variables

---
### fd\_tls\_finished\_bswap
- **Type**: `function`
- **Description**: Performs a byte swap operation on the `fd_tls_finished_t` structure, which is used to match the wire representation of the Finished message in TLS v1.3. The function is defined as an inline function and does not perform any operations in its current implementation.
- **Use**: Used to ensure the correct endianness of the `fd_tls_finished_t` structure when encoding or decoding TLS messages.


# Data Structures

---
### fd\_tls\_ext\_hdr
- **Type**: ``struct``
- **Members**:
    - ``type``: A 16-bit unsigned short integer representing the type of the TLS extension.
    - ``sz``: A 16-bit unsigned short integer representing the size of the TLS extension data.
- **Description**: Defines a packed structure for a TLS extension header, containing fields for the extension type and size, which are both 16-bit unsigned integers. This structure is used to represent the static layout of TLS extension headers in the TLS v1.3 protocol.


---
### fd\_tls\_ext\_hdr\_t
- **Type**: ``struct``
- **Members**:
    - ``type``: A 16-bit unsigned short integer that specifies the type of the TLS extension.
    - ``sz``: A 16-bit unsigned short integer that specifies the size of the TLS extension data.
- **Description**: `fd_tls_ext_hdr_t` is a packed structure that represents the header of a TLS extension in the TLS v1.3 protocol. It contains two fields: `type`, which indicates the type of the extension, and `sz`, which indicates the size of the extension data. This structure is used in the encoding and decoding of TLS extensions to and from their wire format.


---
### fd\_tls\_ext\_supported\_versions
- **Type**: ``struct``
- **Members**:
    - `tls13`: Indicates support for TLS 1.3 with a 1-bit flag.
- **Description**: Defines a structure to represent the supported versions of TLS, specifically indicating whether TLS 1.3 is supported using a single bit field.


---
### fd\_tls\_ext\_supported\_versions\_t
- **Type**: ``struct``
- **Members**:
    - `tls13`: Indicates support for TLS 1.3 with a 1-bit flag.
- **Description**: Represents the supported versions extension in TLS, specifically indicating whether TLS 1.3 is supported using a single bit flag. This structure is part of the TLS protocol extensions and is used to communicate supported protocol versions between a client and server.


---
### fd\_tls\_ext\_server\_name
- **Type**: ``struct``
- **Members**:
    - ``host_name_len``: Length of the host name string, excluding the null terminator.
    - ``host_name``: Character array to store the host name string.
- **Description**: Defines a structure for the Server Name Indication (SNI) extension in TLS, which includes the length of the host name and the host name itself, allowing a client to specify the server name it is trying to connect to.


---
### fd\_tls\_ext\_server\_name\_t
- **Type**: ``struct``
- **Members**:
    - ``host_name_len``: Length of the hostname string, excluding the null terminator.
    - ``host_name``: Character array to store the hostname, with a maximum length of 254 characters.
- **Description**: Represents the Server Name Indication (SNI) extension in TLS, which allows a client to specify the hostname it is trying to connect to during the TLS handshake. This structure contains the length of the hostname and the hostname itself, facilitating the identification of the server by name rather than by IP address.


---
### fd\_tls\_ext\_supported\_groups
- **Type**: ``struct``
- **Members**:
    - `x25519`: Indicates support for the x25519 elliptic curve group with a 1-bit flag.
- **Description**: Defines a structure to represent supported elliptic curve groups in TLS, specifically indicating support for the x25519 group using a single bit field.


---
### fd\_tls\_ext\_supported\_groups\_t
- **Type**: ``struct``
- **Members**:
    - `x25519`: Indicates support for the x25519 ECDHE group with a 1-bit flag.
- **Description**: The `fd_tls_ext_supported_groups_t` structure represents the supported Elliptic Curve Diffie-Hellman Ephemeral (ECDHE) groups for a TLS connection, specifically indicating support for the x25519 group. This structure is used in the context of TLS extensions to specify which ECDHE groups are supported by the client or server, facilitating secure key exchange during the TLS handshake process.


---
### fd\_tls\_ext\_signature\_algorithms
- **Type**: ``struct``
- **Members**:
    - ``ed25519``: Indicates support for the Ed25519 signature algorithm with a 1-bit flag.
- **Description**: Defines a structure to represent supported signature algorithms in TLS, specifically indicating whether the Ed25519 algorithm is supported using a 1-bit field.


---
### fd\_tls\_ext\_signature\_algorithms\_t
- **Type**: ``struct``
- **Members**:
    - `ed25519`: Indicates support for the Ed25519 signature algorithm with a 1-bit flag.
- **Description**: Defines the supported signature algorithms for TLS, specifically indicating support for the Ed25519 algorithm using a 1-bit flag. This structure is part of the TLS extension mechanism to specify which signature algorithms are supported by the client or server during the TLS handshake process.


---
### fd\_tls\_key\_share
- **Type**: ``struct``
- **Members**:
    - ``has_x25519``: Indicates if the `x25519` key is present using a 1-bit flag.
    - ``x25519``: Stores a 32-byte `x25519` key.
- **Description**: Represents a key share structure in TLS, specifically for the `x25519` elliptic curve Diffie-Hellman key exchange, with a flag to indicate the presence of the key and an array to store the key itself.


---
### fd\_tls\_key\_share\_t
- **Type**: ``struct``
- **Members**:
    - `has_x25519`: Indicates if the `x25519` key is present.
    - `x25519`: Holds a 32-byte `x25519` key.
- **Description**: The `fd_tls_key_share_t` structure is used in the context of TLS (Transport Layer Security) to represent a key share, specifically for the `x25519` elliptic curve Diffie-Hellman key exchange. It contains a flag `has_x25519` to indicate the presence of the `x25519` key and an array `x25519` to store the 32-byte key itself. This structure is part of the TLS protocol's key exchange mechanism, which is crucial for establishing secure communication channels.


---
### fd\_tls\_ext\_cert\_type\_list
- **Type**: `union`
- **Members**:
    - `present`: Indicates if the extension is present (1) or missing (0).
    - `x509`: Indicates if the X.509 certificate type is supported.
    - `raw_pubkey`: Indicates if the raw public key certificate type is supported.
    - `uc`: Represents the union as a single unsigned character.
- **Description**: The `fd_tls_ext_cert_type_list` union is a data structure used to represent a list of certificate types in a TLS extension. It contains a bitfield structure with flags for the presence of the extension, support for X.509 certificates, and support for raw public key certificates. The union can also be accessed as a single unsigned character, allowing for compact storage and manipulation of the certificate type information.


---
### fd\_tls\_ext\_cert\_type\_list\_t
- **Type**: ``union``
- **Members**:
    - ``present``: Indicates if the extension is present (1) or missing (0).
    - ``x509``: Indicates if the X.509 certificate type is supported (1) or not (0).
    - ``raw_pubkey``: Indicates if the raw public key certificate type is supported (1) or not (0).
    - ``uc``: Represents the union as a single unsigned character.
- **Description**: The `fd_tls_ext_cert_type_list_t` union represents a list of certificate types in a TLS extension, allowing for dynamic selection between X.509 and raw public key formats. It uses bit fields to indicate the presence of the extension and the support for each certificate type, providing a compact representation that can be accessed as individual fields or as a single unsigned character.


---
### fd\_tls\_ext\_cert\_type
- **Type**: `struct`
- **Members**:
    - `cert_type`: Holds the certificate type as an unsigned character.
- **Description**: Represents a TLS extension for certificate type, containing a single field `cert_type` that specifies the type of certificate used in the TLS handshake.


---
### fd\_tls\_ext\_cert\_type\_t
- **Type**: ``struct``
- **Members**:
    - ``cert_type``: Holds the certificate type as an unsigned character.
- **Description**: Represents a TLS extension certificate type, which is used to specify the type of certificate being used in a TLS handshake. The `cert_type` field indicates the specific certificate type, such as X.509 or raw public key, in the context of TLS extensions.


---
### fd\_tls\_ext\_opaque
- **Type**: ``struct``
- **Members**:
    - ``buf``: Pointer to a buffer containing opaque serialized extension data.
    - ``bufsz``: Size of the buffer pointed to by `buf`.
- **Description**: Holds a pointer to opaque serialized extension data and its size. The structure can represent three states: an extension is present with non-zero size, an extension is present with zero size, or an extension is absent. The presence of the extension is determined by the values of `buf` and `bufsz`.


---
### fd\_tls\_ext\_opaque\_t
- **Type**: ``struct``
- **Members**:
    - `buf`: Pointer to opaque serialized extension data.
    - `bufsz`: Size of the buffer pointed to by `buf`.
- **Description**: Holds a pointer to opaque serialized extension data, where the lifetime of `buf` depends on the context. The structure can represent three states: extension present with non-zero size, extension present with zero size, or extension absent. The presence of the extension is indicated by the state of `buf` and `bufsz`.


---
### fd\_tls\_ext\_quic\_tp\_t
- **Type**: `typedef`
- **Members**:
    - `buf`: Pointer to opaque serialized extension data.
    - `bufsz`: Size of the buffer pointed to by `buf`.
- **Description**: Represents a structure that holds a pointer to serialized extension data and its size, used in the context of TLS extensions. The presence and size of the extension are indicated by the values of `buf` and `bufsz`, where a non-null `buf` with a non-zero `bufsz` indicates a present extension with data, a non-null `buf` with a zero `bufsz` indicates a present extension with no data, and a null `buf` with a zero `bufsz` indicates an absent extension.


---
### fd\_tls\_ext\_alpn\_t
- **Type**: `typedef struct`
- **Members**:
    - `buf`: Pointer to opaque serialized extension data.
    - `bufsz`: Size of the buffer pointed to by `buf`.
- **Description**: `fd_tls_ext_alpn_t` is a typedef for `fd_tls_ext_opaque`, which holds a pointer to opaque serialized extension data and its size. The structure can represent three states: extension present with non-zero size, extension present with zero size, or extension absent. The lifetime of the buffer depends on the context in which it is used.


---
### fd\_tls\_u24
- **Type**: ``struct``
- **Members**:
    - ``v``: An array of 3 `uchar` elements representing a 24-bit integer.
- **Description**: Represents a 24-bit (3-byte) big-endian integer used in TLS v1.3 to match the wire representation of certain data fields.


---
### fd\_tls\_u24\_t
- **Type**: ``struct``
- **Members**:
    - `v`: An array of 3 unsigned characters representing a 24-bit integer in big-endian format.
- **Description**: Represents a 24-bit integer stored in a 3-byte array in big-endian order, matching its wire representation in TLS v1.3.


---
### fd\_tls\_msg\_hdr
- **Type**: ``struct``
- **Members**:
    - ``type``: An unsigned character representing the message type, defined by `FD_TLS_MSG_{...}`.
    - ``sz``: A 24-bit unsigned integer (`fd_tls_u24_t`) representing the byte size of fields following this header.
- **Description**: Defines a packed structure for a TLS message header, containing a type identifier and the size of the subsequent message fields.


---
### fd\_tls\_msg\_hdr\_t
- **Type**: ``struct``
- **Members**:
    - ``type``: Specifies the type of the TLS message using a single byte.
    - ``sz``: Represents the size of the fields following the header as a 24-bit big-endian integer.
- **Description**: Defines the common header structure for all TLS message types, containing a message type identifier and the size of the subsequent message content.


---
### fd\_tls\_client\_hello
- **Type**: ``struct``
- **Members**:
    - ``random``: An array of 32 unsigned characters used for random data in the TLS handshake.
    - ``cipher_suites``: A bit field structure indicating supported cipher suites, starting with `aes_128_gcm_sha256`.
    - ``session_id``: An opaque structure holding the session ID for the TLS session.
    - ``supported_versions``: A structure indicating supported TLS versions.
    - ``server_name``: A structure containing the server name for the TLS session.
    - ``supported_groups``: A structure indicating supported ECDHE groups.
    - ``signature_algorithms``: A structure indicating supported signature algorithms.
    - ``key_share``: A structure containing key share information for the TLS handshake.
    - ``server_cert_types``: A union indicating supported server certificate types.
    - ``client_cert_types``: A union indicating supported client certificate types.
    - ``quic_tp``: An opaque structure for QUIC transport parameters.
    - ``alpn``: An opaque structure for Application-Layer Protocol Negotiation (ALPN) data.
- **Description**: Describes a TLS v1.3 ClientHello message, which is part of the TLS handshake process. It includes fields for random data, supported cipher suites, session ID, supported TLS versions, server name, supported groups, signature algorithms, key share information, server and client certificate types, QUIC transport parameters, and ALPN data. This structure is used to initiate a secure connection by specifying the client's capabilities and preferences.


---
### fd\_tls\_client\_hello\_t
- **Type**: ``struct``
- **Members**:
    - `random`: An array of 32 bytes used for the random field in the ClientHello message.
    - `cipher_suites`: A bit field structure indicating supported cipher suites, such as `aes_128_gcm_sha256`.
    - `session_id`: An `fd_tls_ext_opaque_t` structure holding the session ID.
    - `supported_versions`: An `fd_tls_ext_supported_versions_t` structure indicating supported TLS versions.
    - `server_name`: An `fd_tls_ext_server_name_t` structure containing the server name indication.
    - `supported_groups`: An `fd_tls_ext_supported_groups_t` structure listing supported ECDHE groups.
    - `signature_algorithms`: An `fd_tls_ext_signature_algorithms_t` structure listing supported signature algorithms.
    - `key_share`: An `fd_tls_key_share_t` structure containing key share information.
    - `server_cert_types`: An `fd_tls_ext_cert_type_list_t` union indicating server certificate types.
    - `client_cert_types`: An `fd_tls_ext_cert_type_list_t` union indicating client certificate types.
    - `quic_tp`: An `fd_tls_ext_quic_tp_t` structure for QUIC transport parameters.
    - `alpn`: An `fd_tls_ext_alpn_t` structure for Application-Layer Protocol Negotiation.
- **Description**: Describes a TLS v1.3 ClientHello message as per RFC 8446, Section 4.1.2, containing fields for random data, cipher suites, session ID, supported versions, server name, supported groups, signature algorithms, key share, certificate types, QUIC transport parameters, and ALPN.


---
### fd\_tls\_server\_hello
- **Type**: ``struct``
- **Members**:
    - ``random``: An array of 32 unsigned characters used for random data in the handshake.
    - ``cipher_suite``: A 16-bit unsigned integer representing the cipher suite used.
    - ``session_id``: An opaque structure holding the session ID data.
    - ``key_share``: A structure containing key share information for the handshake.
- **Description**: Describes a TLS v1.3 ServerHello message, which is part of the TLS handshake process. It includes random data, the selected cipher suite, session ID, and key share information to establish a secure connection between a client and a server.


---
### fd\_tls\_server\_hello\_t
- **Type**: ``struct``
- **Members**:
    - ``random``: An array of 32 unsigned characters representing the server's random value.
    - ``cipher_suite``: An unsigned short indicating the cipher suite selected by the server.
    - ``session_id``: A `fd_tls_ext_opaque_t` structure holding the session ID.
    - ``key_share``: A `fd_tls_key_share_t` structure containing key share information.
- **Description**: Describes a TLS v1.3 ServerHello message as specified in RFC 8446, Section 4.1.3. It includes a random value, the selected cipher suite, a session ID, and key share information, which are essential for establishing a secure connection between a client and a server.


---
### fd\_tls\_enc\_ext
- **Type**: ``struct``
- **Members**:
    - `server_cert`: Holds the server certificate type.
    - `client_cert`: Holds the client certificate type.
    - `quic_tp`: Contains QUIC transport parameters.
    - `alpn`: Contains Application-Layer Protocol Negotiation (ALPN) data.
- **Description**: Defines a structure for the TLS v1.3 EncryptedExtensions message, which includes fields for server and client certificate types, QUIC transport parameters, and ALPN data. This structure is used to manage and encode/decode the extensions in a TLS handshake.


---
### fd\_tls\_enc\_ext\_t
- **Type**: ``struct``
- **Members**:
    - `server_cert`: Holds the server certificate type information.
    - `client_cert`: Holds the client certificate type information.
    - `quic_tp`: Contains opaque serialized data for QUIC transport parameters.
    - `alpn`: Contains opaque serialized data for Application-Layer Protocol Negotiation (ALPN).
- **Description**: Describes a TLS v1.3 EncryptedExtensions message, which is part of the TLS handshake process. It includes fields for server and client certificate types, as well as opaque data for QUIC transport parameters and ALPN, allowing for the negotiation of additional protocol extensions.


---
### fd\_tls\_cert\_verify
- **Type**: ``struct``
- **Members**:
    - `sig_alg`: A 16-bit unsigned short representing the signature algorithm used.
    - `sig`: A 64-byte array holding the signature.
- **Description**: Describes a CertificateVerify message in TLS v1.3, specifically supporting signature algorithms with a 64-byte signature size, such as Ed25519.


---
### fd\_tls\_cert\_verify\_t
- **Type**: ``struct``
- **Members**:
    - `sig_alg`: Holds the signature algorithm identifier.
    - `sig`: Contains the 64-byte signature.
- **Description**: Describes a `CertificateVerify` message in TLS v1.3, specifically supporting signature algorithms with a 64-byte signature size, such as Ed25519.


---
### fd\_tls\_finished
- **Type**: ``struct``
- **Members**:
    - `verify`: An array of 32 unsigned characters used for verification purposes.
- **Description**: Represents a packed data structure that matches the wire representation of a TLS v1.3 Finished message, as specified in RFC 8446, Section 4.4.4. It supports only TLS cipher suites with a 32-byte hash output size.


---
### fd\_tls\_finished\_t
- **Type**: ``struct``
- **Members**:
    - `verify`: An array of 32 `uchar` elements used to store the verification data for the TLS Finished message.
- **Description**: Matches the wire representation of the TLS Finished message as defined in RFC 8446, Section 4.4.4, and supports only TLS cipher suites with a 32-byte hash output size.


---
### fd\_tls\_extract\_cert\_pubkey\_res
- **Type**: ``struct``
- **Members**:
    - ``pubkey``: Pointer to the extracted public key from a TLS certificate.
    - ``alert``: Unsigned integer indicating a TLS alert code.
    - ``reason``: Unsigned short indicating the reason for the alert.
- **Description**: Holds the result of extracting a public key from a TLS certificate, including the public key itself, an alert code, and a reason code for the alert.


---
### fd\_tls\_extract\_cert\_pubkey\_res\_t
- **Type**: ``struct``
- **Members**:
    - ``pubkey``: Pointer to the public key extracted from a TLS certificate.
    - ``alert``: Unsigned integer indicating a TLS alert code.
    - ``reason``: Unsigned short indicating the reason for the alert.
- **Description**: Holds the result of extracting a public key from a TLS certificate, including the public key itself, a TLS alert code, and a reason code for the alert.


# Functions

---
### fd\_tls\_u24\_bswap<!-- {{#callable:fd_tls_u24_bswap}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L360>)

Reverses the byte order of a 24-bit big-endian integer.
- **Inputs**:
    - `x`: A `fd_tls_u24_t` structure representing a 24-bit big-endian integer.
- **Logic and Control Flow**:
    - Create a new `fd_tls_u24_t` structure `ret` with the byte order of `x` reversed.
    - Return the `ret` structure.
- **Output**: A `fd_tls_u24_t` structure with the byte order of the input reversed.


---
### fd\_tls\_u24\_to\_uint<!-- {{#callable:fd_tls_u24_to_uint}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L366>)

Converts a 24-bit big-endian integer to a 32-bit unsigned integer.
- **Inputs**:
    - ``x``: A `fd_tls_u24_t` structure containing a 24-bit big-endian integer.
- **Logic and Control Flow**:
    - Calls the function `fd_uint_load_3` with the 3-byte array `x.v` as an argument.
    - Returns the result of `fd_uint_load_3`, which converts the 3-byte array to a 32-bit unsigned integer.
- **Output**: A 32-bit unsigned integer representing the value of the 24-bit big-endian integer.


---
### fd\_uint\_to\_tls\_u24<!-- {{#callable:fd_uint_to_tls_u24}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L371>)

Converts a 32-bit unsigned integer to a 24-bit TLS big-endian format.
- **Inputs**:
    - `x`: A 32-bit unsigned integer to convert.
- **Logic and Control Flow**:
    - Create a `fd_tls_u24_t` structure named `ret` with three bytes initialized from the input `x`.
    - Assign the least significant byte of `x` to `ret.v[0]`.
    - Assign the second least significant byte of `x` to `ret.v[1]`.
    - Assign the third least significant byte of `x` to `ret.v[2]`.
    - Return the `ret` structure.
- **Output**: A `fd_tls_u24_t` structure representing the 24-bit big-endian equivalent of the input integer.


---
### fd\_tls\_ext\_hdr\_bswap<!-- {{#callable:fd_tls_ext_hdr_bswap}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L381>)

Converts the endianness of the `type` and `sz` fields in a `fd_tls_ext_hdr_t` structure.
- **Inputs**:
    - `x`: A pointer to a `fd_tls_ext_hdr_t` structure whose `type` and `sz` fields need endianness conversion.
- **Logic and Control Flow**:
    - Call `fd_ushort_bswap` on `x->type` to swap its byte order.
    - Assign the result of the swap back to `x->type`.
    - Call `fd_ushort_bswap` on `x->sz` to swap its byte order.
    - Assign the result of the swap back to `x->sz`.
- **Output**: No return value; the function modifies the `fd_tls_ext_hdr_t` structure in place.


---
### fd\_tls\_msg\_hdr\_bswap<!-- {{#callable:fd_tls_msg_hdr_bswap}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L391>)

Swaps the byte order of the `sz` field in a `fd_tls_msg_hdr_t` structure.
- **Inputs**:
    - `x`: A pointer to a `fd_tls_msg_hdr_t` structure whose `sz` field will have its byte order swapped.
- **Logic and Control Flow**:
    - Calls the function [`fd_tls_u24_bswap`](<#fd_tls_u24_bswap>) with `x->sz` as an argument to swap the byte order of the `sz` field.
    - Assigns the result of [`fd_tls_u24_bswap`](<#fd_tls_u24_bswap>) back to `x->sz`.
- **Output**: No return value; the function modifies the `sz` field of the input structure in place.
- **Functions Called**:
    - [`fd_tls_u24_bswap`](<#fd_tls_u24_bswap>)


---
### fd\_tls\_cert\_verify\_bswap<!-- {{#callable:fd_tls_cert_verify_bswap}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L463>)

Performs a byte swap on the `sig_alg` field of a `fd_tls_cert_verify_t` structure to convert its endianness.
- **Inputs**:
    - `x`: A pointer to a `fd_tls_cert_verify_t` structure whose `sig_alg` field will be byte-swapped.
- **Logic and Control Flow**:
    - Calls the `fd_ushort_bswap` function on the `sig_alg` field of the `fd_tls_cert_verify_t` structure pointed to by `x`.
    - Assigns the result of the byte swap back to the `sig_alg` field of the structure.
- **Output**: No return value; the function modifies the `sig_alg` field of the input structure in place.


---
### fd\_tls\_decode\_ext\_quic\_tp<!-- {{#callable:fd_tls_decode_ext_quic_tp}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L528>)

Decodes a QUIC transport parameters extension from a wire format into a structured format.
- **Inputs**:
    - ``out``: A pointer to an `fd_tls_ext_quic_tp_t` structure where the decoded data will be stored.
    - ``wire``: A pointer to the input buffer containing the encoded QUIC transport parameters.
    - ``wire_sz``: The size of the input buffer in bytes.
- **Logic and Control Flow**:
    - Calls the [`fd_tls_decode_ext_opaque`](<fd_tls_proto.c.md#fd_tls_decode_ext_opaque>) function with the provided `out`, `wire`, and `wire_sz` arguments.
    - Returns the result of the [`fd_tls_decode_ext_opaque`](<fd_tls_proto.c.md#fd_tls_decode_ext_opaque>) function call.
- **Output**: Returns the number of bytes read from the `wire` on success, or a negated TLS error code on failure.
- **Functions Called**:
    - [`fd_tls_decode_ext_opaque`](<fd_tls_proto.c.md#fd_tls_decode_ext_opaque>)


# Function Declarations (Public API)

---
### fd\_tls\_decode\_client\_hello<!-- {{#callable_declaration:fd_tls_decode_client_hello}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L406>)

Decodes a TLS ClientHello message from wire format.
- **Description**: Use this function to decode a TLS v1.3 ClientHello message from its wire format into a structured format. This function requires a buffer containing the wire format data and the size of this buffer. The output structure must be zero-initialized before calling this function. The function returns the number of bytes read from the wire buffer on success. If the function encounters an error, it returns a negative TLS alert code. Ensure that the input buffer is not reused for decoding after this function call, as it may be altered during processing.
- **Inputs**:
    - `out`: A pointer to a `fd_tls_client_hello_t` structure that will be populated with the decoded data. Must be zero-initialized before calling. Caller retains ownership.
    - `wire`: A pointer to the buffer containing the wire format of the ClientHello message. Must not be null. The buffer may be altered during decoding.
    - `wire_sz`: The size of the `wire` buffer in bytes. Must be sufficient to contain a valid ClientHello message.
- **Output**: Returns the number of bytes read from the `wire` buffer on success. On failure, returns a negative TLS alert code.
- **See Also**: [`fd_tls_decode_client_hello`](<fd_tls_proto.c.md#fd_tls_decode_client_hello>)  (Implementation)


---
### fd\_tls\_encode\_client\_hello<!-- {{#callable_declaration:fd_tls_encode_client_hello}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L411>)

Encodes a TLS ClientHello message into a wire format.
- **Description**: Use this function to serialize a TLS v1.3 ClientHello message into a wire format suitable for transmission. This function requires a properly initialized `fd_tls_client_hello_t` structure as input. The output buffer must be large enough to hold the encoded message, and its size is specified by `wire_sz`. The function returns the number of bytes written to the buffer or a negative error code if encoding fails. Ensure that the input structure is correctly populated with all necessary fields before calling this function.
- **Inputs**:
    - `in`: A pointer to a `fd_tls_client_hello_t` structure containing the ClientHello data to encode. Must not be null and must be properly initialized with valid data.
    - `wire`: A pointer to a buffer where the encoded message will be written. Must not be null and should have enough space to accommodate the encoded data.
    - `wire_sz`: The size of the `wire` buffer in bytes. Must be large enough to hold the entire encoded message; otherwise, the function will return an error.
- **Output**: Returns the number of bytes written to the `wire` buffer on success, or a negative error code on failure.
- **See Also**: [`fd_tls_encode_client_hello`](<fd_tls_proto.c.md#fd_tls_encode_client_hello>)  (Implementation)


---
### fd\_tls\_decode\_server\_hello<!-- {{#callable_declaration:fd_tls_decode_server_hello}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L416>)

Decodes a TLS ServerHello message from wire format.
- **Description**: Use this function to decode a TLS v1.3 ServerHello message from its wire format into a structured format. This function requires the output structure to be zero-initialized before calling. It processes the static and dynamic parts of the ServerHello message, including extensions. The function checks for specific protocol constraints, such as supported versions and cipher suites, and rejects unsupported or unexpected extensions. It returns the number of bytes read on success or a negative TLS alert code on failure. Ensure the input buffer is not reused for decoding after this function call.
- **Inputs**:
    - `out`: A pointer to a `fd_tls_server_hello_t` structure where the decoded ServerHello message will be stored. Must be zero-initialized before calling. Caller retains ownership.
    - `wire`: A pointer to the buffer containing the wire format of the ServerHello message. Must not be null.
    - `wire_sz`: The size of the buffer pointed to by `wire`. Must be sufficient to contain a valid ServerHello message.
- **Output**: Returns the number of bytes read from `wire` on success. On failure, returns a negative TLS alert code indicating the type of error.
- **See Also**: [`fd_tls_decode_server_hello`](<fd_tls_proto.c.md#fd_tls_decode_server_hello>)  (Implementation)


---
### fd\_tls\_encode\_server\_hello<!-- {{#callable_declaration:fd_tls_encode_server_hello}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L421>)

Encodes a TLS ServerHello message into a wire format.
- **Description**: Use this function to serialize a TLS v1.3 ServerHello message into a wire format suitable for transmission. Ensure that the input structure is correctly populated with the necessary fields before calling this function. The function writes the encoded message to the provided buffer, which must be large enough to hold the entire message. If the buffer is too small, the function returns a negative error code. The function returns the number of bytes written on success.
- **Inputs**:
    - `in`: A pointer to a `fd_tls_server_hello_t` structure containing the ServerHello data to encode. The structure must be fully initialized and valid.
    - `wire`: A pointer to a buffer where the encoded message will be written. The buffer must be large enough to hold the encoded data.
    - `wire_sz`: The size of the buffer pointed to by `wire`. It must be sufficient to store the entire encoded message.
- **Output**: Returns the number of bytes written to the buffer on success. On failure, returns a negative error code indicating the type of error.
- **See Also**: [`fd_tls_encode_server_hello`](<fd_tls_proto.c.md#fd_tls_encode_server_hello>)  (Implementation)


---
### fd\_tls\_encode\_hello\_retry\_request<!-- {{#callable_declaration:fd_tls_encode_hello_retry_request}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L426>)

Encodes a HelloRetryRequest message into a buffer.
- **Description**: Use this function to serialize a TLS v1.3 HelloRetryRequest message into a wire format. This function requires a valid `fd_tls_server_hello_t` structure as input, which contains the necessary data for encoding. The function writes the encoded message to the provided buffer, `wire`, which must have sufficient space as specified by `wire_sz`. Ensure that the buffer size is adequate to avoid encoding errors. The function returns the number of bytes written to the buffer or a negative error code if encoding fails.
- **Inputs**:
    - `in`: A pointer to a `fd_tls_server_hello_t` structure containing the data to encode. The structure must be properly initialized and valid.
    - `wire`: A pointer to a buffer where the encoded message will be written. The buffer must not be null and should have enough space as indicated by `wire_sz`.
    - `wire_sz`: The size of the `wire` buffer in bytes. It must be large enough to hold the encoded message; otherwise, the function will return an error.
- **Output**: Returns the number of bytes written to the `wire` buffer on success, or a negative error code if encoding fails.
- **See Also**: [`fd_tls_encode_hello_retry_request`](<fd_tls_proto.c.md#fd_tls_encode_hello_retry_request>)  (Implementation)


---
### fd\_tls\_decode\_enc\_ext<!-- {{#callable_declaration:fd_tls_decode_enc_ext}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L431>)

Decodes a TLS EncryptedExtensions message from wire format.
- **Description**: Use this function to decode a TLS EncryptedExtensions message from its wire format into a structured format. This function processes the input wire data and populates the provided `fd_tls_enc_ext_t` structure with the decoded information. It handles specific TLS extensions such as ALPN, QUIC transport parameters, and certificate types. Ensure that the `out` parameter is zero-initialized before calling this function. The function returns the number of bytes read from the wire on success, or a negative TLS error code on failure. It is important to note that the input wire data may be modified during the decoding process, so it should not be reused after the call.
- **Inputs**:
    - `out`: A pointer to an `fd_tls_enc_ext_t` structure that will be populated with the decoded data. Must be zero-initialized before calling. Caller retains ownership.
    - `wire`: A pointer to the wire format data to decode. Must not be null. The data may be modified during decoding.
    - `wire_sz`: The size of the wire data in bytes. Must be sufficient to contain a valid EncryptedExtensions message.
- **Output**: Returns the number of bytes read from the wire on success, or a negative TLS error code on failure.
- **See Also**: [`fd_tls_decode_enc_ext`](<fd_tls_proto.c.md#fd_tls_decode_enc_ext>)  (Implementation)


---
### fd\_tls\_encode\_enc\_ext<!-- {{#callable_declaration:fd_tls_encode_enc_ext}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L436>)

Encodes TLS EncryptedExtensions into a wire format.
- **Description**: Use this function to serialize a TLS EncryptedExtensions message into a wire format buffer. This function processes various TLS extensions such as ALPN, QUIC transport parameters, and certificate types, and writes them into the provided buffer. Ensure that the buffer is large enough to hold the encoded data. The function returns the number of bytes written to the buffer. If the buffer is too small, the function will not write any data and will return a negative error code.
- **Inputs**:
    - `in`: A pointer to a `fd_tls_enc_ext_t` structure containing the TLS EncryptedExtensions data to encode. The structure must be properly initialized and populated with the relevant extension data.
    - `wire`: A pointer to a buffer where the encoded data will be written. The buffer must be large enough to hold the encoded data. The caller retains ownership of the buffer.
    - `wire_sz`: The size of the buffer pointed to by `wire`. It must be sufficient to store the encoded data. If the buffer is too small, the function will return a negative error code.
- **Output**: Returns the number of bytes written to the buffer on success. On failure, returns a negative error code indicating the buffer was too small.
- **See Also**: [`fd_tls_encode_enc_ext`](<fd_tls_proto.c.md#fd_tls_encode_enc_ext>)  (Implementation)


---
### fd\_tls\_encode\_cert\_x509<!-- {{#callable_declaration:fd_tls_encode_cert_x509}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L441>)

Encodes an X.509 certificate into a TLS wire format.
- **Description**: Use this function to encode an X.509 certificate into a TLS wire format suitable for transmission. Ensure that the `wire` buffer is large enough to hold the encoded data, which includes additional headers and context information. The function returns the number of bytes written to the `wire` buffer. If the buffer is too small, the function will not encode the certificate and will return a negative error code. This function is typically used in the context of preparing TLS messages for network transmission.
- **Inputs**:
    - `x509`: Pointer to the X.509 certificate data to encode. Must not be null and should point to a valid certificate.
    - `x509_sz`: Size of the X.509 certificate data in bytes. Must accurately reflect the size of the data pointed to by `x509`.
    - `wire`: Pointer to the buffer where the encoded TLS data will be written. Must not be null and should have sufficient space to hold the encoded data.
    - `wire_sz`: Size of the `wire` buffer in bytes. Must be large enough to accommodate the encoded certificate and additional headers.
- **Output**: Returns the number of bytes written to the `wire` buffer on success. Returns a negative error code if the buffer is too small.
- **See Also**: [`fd_tls_encode_cert_x509`](<fd_tls_proto.c.md#fd_tls_encode_cert_x509>)  (Implementation)


---
### fd\_tls\_encode\_raw\_public\_key<!-- {{#callable_declaration:fd_tls_encode_raw_public_key}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L448>)

Encodes a raw public key into a TLS wire format.
- **Description**: Use this function to encode a raw Ed25519 public key into a TLS wire format suitable for transmission. Ensure that the `wire` buffer is large enough to hold the encoded data, which includes the TLS record header and certificate message header. The function returns the number of bytes written to the `wire` buffer. If the buffer is too small, the function will not encode the data correctly.
- **Inputs**:
    - `key`: A pointer to a 32-byte Ed25519 public key. The caller must ensure this pointer is valid and points to a properly formatted key.
    - `wire`: A pointer to a buffer where the encoded data will be written. The buffer must be large enough to hold the encoded data.
    - `wire_sz`: The size of the `wire` buffer in bytes. It must be sufficient to hold the encoded data, otherwise the function will not perform the encoding correctly.
- **Output**: Returns the number of bytes written to the `wire` buffer.
- **See Also**: [`fd_tls_encode_raw_public_key`](<fd_tls_proto.c.md#fd_tls_encode_raw_public_key>)  (Implementation)


---
### fd\_tls\_decode\_cert\_verify<!-- {{#callable_declaration:fd_tls_decode_cert_verify}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L453>)

Decodes a CertificateVerify message from wire format.
- **Description**: Use this function to decode a TLS CertificateVerify message from its wire format into a structured format. This function expects the input buffer to contain a valid CertificateVerify message encoded according to TLS v1.3 specifications. The output structure must be zero-initialized before calling this function. The function checks that the signature algorithm is Ed25519 and that the signature size is 64 bytes. If these conditions are not met, the function returns a negative TLS alert code indicating an illegal parameter. This function modifies the input buffer for endianness conversion, so do not reuse the buffer for further decoding.
- **Inputs**:
    - `out`: A pointer to a `fd_tls_cert_verify_t` structure where the decoded data will be stored. Must be zero-initialized before calling. Caller retains ownership.
    - `wire`: A pointer to the buffer containing the wire-encoded CertificateVerify message. Must not be null. The buffer is modified for endianness conversion.
    - `wire_sz`: The size of the `wire` buffer in bytes. Must be sufficient to contain a valid CertificateVerify message.
- **Output**: Returns the number of bytes read from `wire` on success. On failure, returns a negative TLS alert code indicating an illegal parameter.
- **See Also**: [`fd_tls_decode_cert_verify`](<fd_tls_proto.c.md#fd_tls_decode_cert_verify>)  (Implementation)


---
### fd\_tls\_encode\_cert\_verify<!-- {{#callable_declaration:fd_tls_encode_cert_verify}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L458>)

Encodes a CertificateVerify structure into a wire format.
- **Description**: Use this function to serialize a `fd_tls_cert_verify_t` structure into a wire format suitable for transmission over a network. Ensure that the `wire` buffer is large enough to hold the encoded data, which is at least 66 bytes. This function does not handle cases where the buffer is too small, and it will return a negative error code in such situations. Call this function when you need to send a CertificateVerify message as part of a TLS handshake.
- **Inputs**:
    - `in`: A pointer to a `fd_tls_cert_verify_t` structure containing the CertificateVerify data to encode. The structure must be fully initialized and valid.
    - `wire`: A pointer to a buffer where the encoded data will be written. The buffer must be at least 66 bytes in size to accommodate the encoded data.
    - `wire_sz`: The size of the `wire` buffer in bytes. Must be at least 66 to ensure the buffer can hold the encoded data.
- **Output**: Returns the number of bytes written to the `wire` buffer on success. Returns a negative TLS error code if the buffer is too small.
- **See Also**: [`fd_tls_encode_cert_verify`](<fd_tls_proto.c.md#fd_tls_encode_cert_verify>)  (Implementation)


---
### fd\_tls\_decode\_ext\_server\_name<!-- {{#callable_declaration:fd_tls_decode_ext_server_name}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L468>)

Decodes a TLS server name extension from wire format.
- **Description**: Use this function to decode a TLS server name extension from its wire format into a structured format. This function is typically used when processing TLS handshake messages that include server name indications. The output structure must be zero-initialized before calling this function. The function reads from the provided wire buffer and populates the output structure with the decoded server name. It returns the number of bytes read from the wire buffer on success. If the function encounters an error, such as an invalid format or buffer overflow, it returns a negative TLS error code.
- **Inputs**:
    - `out`: A pointer to a `fd_tls_ext_server_name_t` structure where the decoded server name will be stored. The structure must be zero-initialized before calling this function. The caller retains ownership.
    - `wire`: A pointer to the buffer containing the wire format of the server name extension. This buffer must not be null and should contain at least `wire_sz` bytes.
    - `wire_sz`: The size of the `wire` buffer in bytes. It must be large enough to contain the server name extension data.
- **Output**: Returns the number of bytes read from the `wire` buffer on success. On failure, returns a negative TLS error code indicating the type of error encountered.
- **See Also**: [`fd_tls_decode_ext_server_name`](<fd_tls_proto.c.md#fd_tls_decode_ext_server_name>)  (Implementation)


---
### fd\_tls\_decode\_ext\_supported\_groups<!-- {{#callable_declaration:fd_tls_decode_ext_supported_groups}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L473>)

Decodes supported ECDHE groups from a wire format.
- **Description**: Use this function to decode a list of supported ECDHE groups from a wire format into a structured format. This function is useful when processing TLS extensions related to supported groups. Ensure that the `out` parameter is zero-initialized before calling this function. The function reads from the `wire` buffer and updates the `out` structure to indicate support for specific groups, such as X25519. It returns the number of bytes read from the `wire` buffer. If the input is invalid or unsupported, the function may ignore certain groups without error.
- **Inputs**:
    - `out`: A pointer to an `fd_tls_ext_supported_groups_t` structure that will be populated with the decoded group information. Must be zero-initialized before calling.
    - `wire`: A pointer to a buffer containing the wire format data to decode. Must not be null.
    - `wire_sz`: The size of the `wire` buffer in bytes. Must be large enough to contain the encoded data.
- **Output**: Returns the number of bytes read from the `wire` buffer. If decoding fails, it may return a negated TLS error code.
- **See Also**: [`fd_tls_decode_ext_supported_groups`](<fd_tls_proto.c.md#fd_tls_decode_ext_supported_groups>)  (Implementation)


---
### fd\_tls\_decode\_ext\_supported\_versions<!-- {{#callable_declaration:fd_tls_decode_ext_supported_versions}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L478>)

Decodes supported TLS versions from wire format.
- **Description**: Use this function to decode a list of supported TLS versions from a wire format into a structured format. This function is useful when processing TLS handshake messages that include the supported versions extension. The function updates the `out` structure to indicate support for TLS 1.3 if present in the wire data. Ensure that `out` is a valid pointer and that `wire` points to a buffer containing the encoded data. The function reads from the `wire` buffer and returns the number of bytes consumed. It is important to note that the function does not handle unsupported TLS versions, which are ignored.
- **Inputs**:
    - `out`: A pointer to an `fd_tls_ext_supported_versions_t` structure that will be populated with the decoded information. Must not be null.
    - `wire`: A pointer to a buffer containing the wire-encoded data. Must not be null.
    - `wire_sz`: The size of the `wire` buffer in bytes. Must be large enough to contain the encoded data.
- **Output**: Returns the number of bytes read from `wire`. If the function encounters an error, it returns a negated TLS error code.
- **See Also**: [`fd_tls_decode_ext_supported_versions`](<fd_tls_proto.c.md#fd_tls_decode_ext_supported_versions>)  (Implementation)


---
### fd\_tls\_decode\_ext\_signature\_algorithms<!-- {{#callable_declaration:fd_tls_decode_ext_signature_algorithms}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L483>)

Decodes a TLS signature algorithms extension from wire format.
- **Description**: Use this function to decode a TLS signature algorithms extension from its wire format into a structured format. This function is useful when processing TLS handshake messages that include signature algorithms. The output structure must be zero-initialized before calling this function. The function reads from the provided wire buffer and updates the output structure to indicate the presence of supported signature algorithms, specifically setting the `ed25519` field if the Ed25519 algorithm is supported. The function returns the number of bytes read from the wire buffer. If the input does not contain a supported signature algorithm, the function will ignore it without error.
- **Inputs**:
    - `out`: A pointer to a `fd_tls_ext_signature_algorithms_t` structure that will be populated with the decoded data. Must be zero-initialized before calling. The caller retains ownership.
    - `wire`: A pointer to the buffer containing the wire format data. Must not be null. The buffer should contain the encoded signature algorithms extension.
    - `wire_sz`: The size of the wire buffer in bytes. Must be large enough to contain the encoded data.
- **Output**: Returns the number of bytes read from the wire buffer. If no supported signature algorithms are found, the function will still return the number of bytes read without error.
- **See Also**: [`fd_tls_decode_ext_signature_algorithms`](<fd_tls_proto.c.md#fd_tls_decode_ext_signature_algorithms>)  (Implementation)


---
### fd\_tls\_decode\_key\_share<!-- {{#callable_declaration:fd_tls_decode_key_share}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L488>)

Decodes a TLS key share from wire format.
- **Description**: Use this function to decode a TLS key share from a wire format into a `fd_tls_key_share_t` structure. This function reads the type and length of the key share from the wire data and checks if the key exchange data size is valid. It supports the X25519 group and will set the `has_x25519` flag and copy the key exchange data if the group is supported. If the key exchange data size exceeds the available wire size or if the group is unsupported, the function returns a negative TLS alert code. Ensure that the `out` parameter is zero-initialized before calling this function.
- **Inputs**:
    - `out`: A pointer to a `fd_tls_key_share_t` structure where the decoded key share will be stored. Must be zero-initialized before calling. Caller retains ownership.
    - `wire`: A pointer to the wire format data to decode. Must not be null. The data is read but not modified.
    - `wire_sz`: The size of the wire data in bytes. Must be large enough to contain the key share data; otherwise, a decode error is returned.
- **Output**: Returns the number of bytes read from the wire on success. On failure, returns a negative TLS alert code indicating a decode error.
- **See Also**: [`fd_tls_decode_key_share`](<fd_tls_proto.c.md#fd_tls_decode_key_share>)  (Implementation)


---
### fd\_tls\_decode\_key\_share\_list<!-- {{#callable_declaration:fd_tls_decode_key_share_list}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L493>)

Decodes a list of key shares from a wire format.
- **Description**: Use this function to decode a list of key shares from a wire format into a structured format. This function is typically used in the context of processing TLS key share extensions. The output structure must be zero-initialized before calling this function. The function reads from the provided wire buffer and populates the `fd_tls_key_share_t` structure. It returns the number of bytes read from the wire buffer. If the function encounters an error during decoding, it returns a negative TLS error code. Ensure that the wire buffer is not reused for decoding after this function call, as it may be altered for endianness conversion.
- **Inputs**:
    - `out`: A pointer to an `fd_tls_key_share_t` structure where the decoded key shares will be stored. Must be zero-initialized before calling this function. The caller retains ownership.
    - `wire`: A pointer to a buffer containing the wire format data to decode. Must not be null. The buffer may be altered during the decoding process.
    - `wire_sz`: The size of the wire buffer in bytes. Must be sufficient to contain the encoded key share list.
- **Output**: Returns the number of bytes read from the wire buffer on success. On failure, returns a negative TLS error code.
- **See Also**: [`fd_tls_decode_key_share_list`](<fd_tls_proto.c.md#fd_tls_decode_key_share_list>)  (Implementation)


---
### fd\_tls\_decode\_ext\_cert\_type\_list<!-- {{#callable_declaration:fd_tls_decode_ext_cert_type_list}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L498>)

Decodes a certificate type list from a wire format.
- **Description**: Use this function to decode a list of certificate types from a wire format into a structured format. This function is typically used in the context of processing TLS extensions where certificate types are specified. The function expects the output structure to be zero-initialized before calling. It marks the presence of the extension and sets flags for recognized certificate types. Unsupported certificate types are ignored. The function returns the number of bytes read from the wire format.
- **Inputs**:
    - `out`: A pointer to a `fd_tls_ext_cert_type_list_t` structure where the decoded certificate types will be stored. Must be zero-initialized before calling. Caller retains ownership.
    - `wire`: A pointer to the input buffer containing the wire format data. Must not be null.
    - `wire_sz`: The size of the input buffer in bytes. Must be sufficient to contain the encoded data.
- **Output**: Returns the number of bytes read from the wire format on success. If an error occurs, a negative TLS error code is returned.
- **See Also**: [`fd_tls_decode_ext_cert_type_list`](<fd_tls_proto.c.md#fd_tls_decode_ext_cert_type_list>)  (Implementation)


---
### fd\_tls\_encode\_ext\_cert\_type\_list<!-- {{#callable_declaration:fd_tls_encode_ext_cert_type_list}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L503>)

Encodes a certificate type list into a wire format.
- **Description**: Use this function to serialize a certificate type list into a wire format buffer. This is typically used in the context of TLS extensions where a list of supported certificate types needs to be communicated. Ensure that the buffer provided is large enough to hold the encoded data. The function returns the number of bytes written to the buffer, which can be zero if no certificate types are present. Callers must ensure that the `wire` pointer is valid and that `wire_sz` accurately reflects the buffer size to avoid buffer overflows.
- **Inputs**:
    - `in`: A `fd_tls_ext_cert_type_list_t` structure representing the certificate types to encode. The structure uses bit fields to indicate the presence of each certificate type.
    - `wire`: A pointer to a buffer where the encoded data will be written. Must not be null and should point to a valid memory region.
    - `wire_sz`: The size of the buffer pointed to by `wire`. Must be large enough to hold the encoded data.
- **Output**: Returns the number of bytes written to the buffer as a `long`. If no certificate types are present, the function returns zero.
- **See Also**: [`fd_tls_encode_ext_cert_type_list`](<fd_tls_proto.c.md#fd_tls_encode_ext_cert_type_list>)  (Implementation)


---
### fd\_tls\_decode\_ext\_cert\_type<!-- {{#callable_declaration:fd_tls_decode_ext_cert_type}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L509>)

Decodes a TLS certificate type extension from wire format.
- **Description**: Use this function to decode a TLS certificate type extension from its wire format representation into a structured format. This function is useful when processing TLS handshake messages that include certificate type extensions. Ensure that the `out` parameter is a valid pointer to a `fd_tls_ext_cert_type_t` structure and that the `wire` parameter points to a valid buffer containing the encoded data. The function reads from the `wire` buffer and updates the `out` structure with the decoded certificate type. The function returns the number of bytes read from the `wire` buffer on success, or a negative TLS error code on failure.
- **Inputs**:
    - `out`: A pointer to a `fd_tls_ext_cert_type_t` structure where the decoded certificate type will be stored. Must not be null.
    - `wire`: A pointer to a buffer containing the encoded certificate type data. Must not be null.
    - `wire_sz`: The size of the `wire` buffer in bytes. Must be large enough to contain the encoded data.
- **Output**: Returns the number of bytes read from the `wire` buffer on success, or a negative TLS error code on failure.
- **See Also**: [`fd_tls_decode_ext_cert_type`](<fd_tls_proto.c.md#fd_tls_decode_ext_cert_type>)  (Implementation)


---
### fd\_tls\_encode\_ext\_cert\_type<!-- {{#callable_declaration:fd_tls_encode_ext_cert_type}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L514>)

Encodes a certificate type extension into a wire format.
- **Description**: Use this function to serialize a `fd_tls_ext_cert_type_t` structure into a wire format suitable for transmission. Ensure that the `wire` buffer is large enough to hold the encoded data, as specified by `wire_sz`. The function returns the number of bytes written to the buffer. If the buffer is too small, the function returns a negative TLS error code, indicating a failure to encode.
- **Inputs**:
    - `in`: A `fd_tls_ext_cert_type_t` structure containing the certificate type to encode. The caller retains ownership of this structure.
    - `wire`: A pointer to the buffer where the encoded data will be written. This buffer must be large enough to hold the encoded data. The caller retains ownership of this buffer.
    - `wire_sz`: The size of the `wire` buffer in bytes. Must be sufficient to hold the encoded data; otherwise, the function will return an error.
- **Output**: Returns the number of bytes written to the `wire` buffer on success. On failure, returns a negative TLS error code.
- **See Also**: [`fd_tls_encode_ext_cert_type`](<fd_tls_proto.c.md#fd_tls_encode_ext_cert_type>)  (Implementation)


---
### fd\_tls\_decode\_ext\_opaque<!-- {{#callable_declaration:fd_tls_decode_ext_opaque}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L523>)

Assigns wire data to an opaque extension structure.
- **Description**: Use this function to set the buffer and size of an opaque extension structure to the provided wire data and its size. This function is useful when you need to handle opaque serialized extension data in a TLS context. Ensure that the `out` parameter is a valid pointer to an `fd_tls_ext_opaque_t` structure. The function does not perform any validation on the wire data itself, so the caller must ensure that the wire data is valid and that its lifetime exceeds that of the `out` structure.
- **Inputs**:
    - `out`: A pointer to an `fd_tls_ext_opaque_t` structure where the function will store the wire data and its size. Must not be null.
    - `wire`: A pointer to the wire data to be assigned to the `out` structure. The caller retains ownership and must ensure the data remains valid for the duration of its use.
    - `wire_sz`: The size of the wire data in bytes. Must be a valid size for the data pointed to by `wire`.
- **Output**: Returns the size of the wire data as a long integer.
- **See Also**: [`fd_tls_decode_ext_opaque`](<fd_tls_proto.c.md#fd_tls_decode_ext_opaque>)  (Implementation)


---
### fd\_tls\_decode\_ext\_alpn<!-- {{#callable_declaration:fd_tls_decode_ext_alpn}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L535>)

Decodes an ALPN extension from wire format.
- **Description**: Use this function to decode an Application-Layer Protocol Negotiation (ALPN) extension from its wire format into a structured format. This function is typically used in the context of processing TLS handshake messages where ALPN extensions are present. Ensure that the `out` parameter is properly initialized before calling this function. The function expects the `wire` buffer to contain the ALPN extension data and `wire_sz` to specify its size. If the size of the ALPN data does not match `wire_sz`, the function returns a negative error code indicating a decode error.
- **Inputs**:
    - `out`: A pointer to an `fd_tls_ext_alpn_t` structure where the decoded ALPN extension will be stored. Must not be null and should be initialized before use.
    - `wire`: A pointer to a buffer containing the ALPN extension data in wire format. Must not be null.
    - `wire_sz`: The size of the `wire` buffer in bytes. Must match the size of the ALPN data in the buffer.
- **Output**: Returns the number of bytes read from `wire` on success. On failure, returns a negative TLS error code, typically indicating a decode error.
- **See Also**: [`fd_tls_decode_ext_alpn`](<fd_tls_proto.c.md#fd_tls_decode_ext_alpn>)  (Implementation)


---
### fd\_tls\_encode\_ext\_alpn<!-- {{#callable_declaration:fd_tls_encode_ext_alpn}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L540>)

Encodes an ALPN extension into a wire format.
- **Description**: Use this function to serialize an ALPN extension into a wire format buffer. Ensure that the buffer is large enough to hold the encoded data, which includes a 2-byte length field followed by the ALPN data. If the buffer is too small, the function returns a negative error code. This function is typically used in the context of preparing TLS handshake messages.
- **Inputs**:
    - `in`: A pointer to a `fd_tls_ext_alpn_t` structure containing the ALPN data to encode. The `buf` field must not be null, and `bufsz` must accurately reflect the size of the data.
    - `wire`: A pointer to a buffer where the encoded ALPN data will be written. The buffer must be large enough to hold the encoded data, which is 2 bytes plus the size of the ALPN data.
    - `wire_sz`: The size of the `wire` buffer in bytes. Must be at least 2 bytes plus the size of the ALPN data to avoid an error.
- **Output**: Returns the number of bytes written to the `wire` buffer on success. Returns a negative TLS error code if the buffer is too small.
- **See Also**: [`fd_tls_encode_ext_alpn`](<fd_tls_proto.c.md#fd_tls_encode_ext_alpn>)  (Implementation)


---
### fd\_tls\_extract\_cert\_pubkey<!-- {{#callable_declaration:fd_tls_extract_cert_pubkey}} -->
[View Source →](<../../../../../src/waltz/tls/fd_tls_proto.h#L556>)

Extracts the public key from a TLS certificate message.
- **Description**: Use this function to obtain the public key from a TLS certificate message. It is important to provide a valid certificate chain and specify the correct certificate type. The function returns a structure containing the public key and any relevant alert or reason codes. Ensure that the certificate chain is correctly formatted and that the size is accurately specified to avoid errors.
- **Inputs**:
    - `cert_chain`: A pointer to the certificate chain data. Must not be null and should point to a valid, properly formatted certificate chain.
    - `cert_chain_sz`: The size of the certificate chain in bytes. Must accurately reflect the size of the data pointed to by `cert_chain`.
    - `cert_type`: An unsigned integer specifying the type of certificate. Must be a valid certificate type as expected by the function.
- **Output**: Returns a `fd_tls_extract_cert_pubkey_res_t` structure containing the extracted public key, an alert code, and a reason code.
- **See Also**: [`fd_tls_extract_cert_pubkey`](<fd_tls_proto.c.md#fd_tls_extract_cert_pubkey>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)