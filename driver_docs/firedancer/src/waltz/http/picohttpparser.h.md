<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

HTTP parser functions and data structures for parsing requests, responses, and chunked data.

# Purpose
The code is a C header file that defines the interface for a lightweight HTTP parser, known as `picohttpparser`. It provides functions to parse HTTP requests, responses, and headers, as well as to decode chunked transfer encoding. The file includes definitions for data structures and function prototypes that are used to interpret HTTP protocol data. The `phr_header` structure is used to store HTTP header name-value pairs, while the `phr_chunked_decoder` structure is used to manage the state of chunked data decoding.

The primary functions include [`phr_parse_request`](<#phr_parse_request>), [`phr_parse_response`](<#phr_parse_response>), and [`phr_parse_headers`](<#phr_parse_headers>), which are responsible for parsing HTTP requests, responses, and headers, respectively. These functions return the number of bytes consumed if successful, or error codes if parsing fails or is incomplete. The [`phr_decode_chunked`](<#phr_decode_chunked>) function is used to process data encoded with chunked transfer encoding, updating the buffer to remove encoding headers and returning the number of undecoded octets. The file also includes compatibility definitions for different compilers and ensures C++ compatibility with `extern "C"`.
# Imports and Dependencies

---
- `sys/types.h`


# Data Structures

---
### phr\_header
- **Type**: ``struct``
- **Members**:
    - `name`: A pointer to a constant character string that represents the name of the header.
    - `name_len`: The length of the header name.
    - `value`: A pointer to a constant character string that represents the value of the header.
    - `value_len`: The length of the header value.
- **Description**: Represents an HTTP header with its name and value, where both the name and value are stored as constant character strings along with their respective lengths. This structure is used to parse and handle HTTP headers, with the `name` being `NULL` if the header is a continuation of a multiline header.


---
### phr\_chunked\_decoder
- **Type**: ``struct``
- **Members**:
    - `bytes_left_in_chunk`: Number of bytes left in the current chunk.
    - `consume_trailer`: Indicates if trailing headers should be consumed.
    - `_hex_count`: Internal counter for hexadecimal digits.
    - `_state`: Internal state of the decoder.
- **Description**: Manages the state and processing of chunked transfer encoding in HTTP, tracking the number of bytes left in the current chunk, whether to consume trailing headers, and internal decoding state.


# Function Declarations (Public API)

---
### phr\_parse\_request<!-- {{#callable_declaration:phr_parse_request}} -->
[View Source →](<../../../../../src/waltz/http/picohttpparser.h#L51>)

Parses an HTTP request from a buffer.
- **Description**: Use this function to parse an HTTP request from a buffer containing the request data. It extracts the HTTP method, path, minor version, and headers from the request. The function must be called with a buffer that contains the request data and its length. It returns the number of bytes consumed if successful, -2 if the request is incomplete, or -1 if parsing fails. Ensure that the `headers` array is large enough to hold all headers, as specified by `num_headers`. If `last_len` is non-zero, the function checks if the request is complete to prevent slowloris attacks.
- **Inputs**:
    - `buf`: Pointer to the start of the buffer containing the HTTP request data. Must not be null.
    - `len`: Length of the buffer in bytes. Must be greater than zero.
    - `method`: Pointer to a location where the function will store the pointer to the HTTP method string. Must not be null.
    - `method_len`: Pointer to a location where the function will store the length of the HTTP method string. Must not be null.
    - `path`: Pointer to a location where the function will store the pointer to the HTTP path string. Must not be null.
    - `path_len`: Pointer to a location where the function will store the length of the HTTP path string. Must not be null.
    - `minor_version`: Pointer to an integer where the function will store the HTTP minor version number. Must not be null.
    - `headers`: Array of `struct phr_header` where the function will store the parsed headers. Must not be null and should be large enough to hold all headers.
    - `num_headers`: Pointer to a size_t that specifies the number of headers the `headers` array can hold. The function updates this value to the number of headers parsed. Must not be null.
    - `last_len`: Length of the previously parsed data if the request is split across multiple buffers. Set to zero if not applicable.
- **Output**: Returns the number of bytes consumed if successful, -2 if the request is incomplete, or -1 if parsing fails.
- **See Also**: [`phr_parse_request`](<picohttpparser.c.md#phr_parse_request>)  (Implementation)


---
### phr\_parse\_response<!-- {{#callable_declaration:phr_parse_response}} -->
[View Source →](<../../../../../src/waltz/http/picohttpparser.h#L55>)

Parses an HTTP response from a buffer.
- **Description**: Use this function to parse an HTTP response from a buffer containing the response data. It extracts the HTTP version, status code, message, and headers. Ensure the buffer contains a complete or partial HTTP response. The function initializes output parameters to default values before parsing. If the response is incomplete, it returns a specific code indicating this. Call this function when you need to process HTTP response data received over a network.
- **Inputs**:
    - `_buf`: Pointer to the start of the buffer containing the HTTP response data. Must not be null.
    - `len`: Length of the buffer in bytes. Must be greater than zero.
    - `minor_version`: Pointer to an integer where the function stores the HTTP minor version. Must not be null.
    - `status`: Pointer to an integer where the function stores the HTTP status code. Must not be null.
    - `msg`: Pointer to a string where the function stores the HTTP status message. Must not be null.
    - `msg_len`: Pointer to a size_t where the function stores the length of the status message. Must not be null.
    - `headers`: Pointer to an array of `phr_header` structures where the function stores the parsed headers. Must not be null.
    - `num_headers`: Pointer to a size_t that specifies the maximum number of headers to parse. The function updates it with the actual number of headers parsed. Must not be null.
    - `last_len`: Size of the previously parsed data if the response is split across multiple buffers. Use zero if parsing a new response.
- **Output**: Returns the number of bytes consumed if successful, -2 if the response is partial, or -1 if parsing fails.
- **See Also**: [`phr_parse_response`](<picohttpparser.c.md#phr_parse_response>)  (Implementation)


---
### phr\_parse\_headers<!-- {{#callable_declaration:phr_parse_headers}} -->
[View Source →](<../../../../../src/waltz/http/picohttpparser.h#L59>)

Parses HTTP headers from a buffer.
- **Description**: Use this function to parse HTTP headers from a given buffer. It processes the buffer to extract headers and stores them in the provided `headers` array. The function must be called with a buffer containing HTTP headers and a pre-allocated array of `phr_header` structures. The `num_headers` parameter should initially contain the maximum number of headers that can be stored in the array, and it will be updated to reflect the actual number of headers parsed. If `last_len` is non-zero, the function checks if the response is complete to prevent slowloris attacks. The function returns the number of bytes consumed if successful, -2 if the request is partial, or -1 if parsing fails.
- **Inputs**:
    - `buf`: Pointer to the start of the buffer containing HTTP headers. Must not be null.
    - `len`: Size of the buffer in bytes. Must be greater than zero.
    - `headers`: Pointer to an array of `phr_header` structures where parsed headers will be stored. Must not be null.
    - `num_headers`: Pointer to a size_t variable that initially contains the maximum number of headers that can be stored in `headers`. It will be updated to the actual number of headers parsed. Must not be null.
    - `last_len`: Size of the previously processed data. If non-zero, the function checks for response completeness to prevent slowloris attacks.
- **Output**: Returns the number of bytes consumed if successful, -2 if the request is partial, or -1 if parsing fails.
- **See Also**: [`phr_parse_headers`](<picohttpparser.c.md#phr_parse_headers>)  (Implementation)


---
### phr\_decode\_chunked<!-- {{#callable_declaration:phr_decode_chunked}} -->
[View Source →](<../../../../../src/waltz/http/picohttpparser.h#L78>)

Decodes HTTP chunked transfer encoding from a buffer.
- **Description**: Use this function to decode data that uses HTTP chunked transfer encoding. It removes the chunked encoding headers from the buffer and updates the buffer size to reflect the length of the decoded data. Call this function repeatedly with new data until it returns a non-negative number, indicating the number of undecoded octets remaining. A return value of -2 indicates that the data is incomplete, and -1 indicates an error. Ensure the `decoder` is zero-filled before the first call.
- **Inputs**:
    - `decoder`: A pointer to a `phr_chunked_decoder` structure that maintains the state of the decoding process. Must be zero-filled before the first use.
    - `buf`: A pointer to a buffer containing the chunked-encoded data. The function modifies this buffer to remove chunked encoding headers.
    - `_bufsz`: A pointer to a size_t variable that initially contains the size of the buffer. The function updates this value to the length of the decoded data available.
- **Output**: Returns the number of undecoded octets if successful, -2 if the data is incomplete, or -1 if an error occurs. The buffer is modified to contain the decoded data, and `_bufsz` is updated to reflect the new size.
- **See Also**: [`phr_decode_chunked`](<picohttpparser.c.md#phr_decode_chunked>)  (Implementation)


---
### phr\_decode\_chunked\_is\_in\_data<!-- {{#callable_declaration:phr_decode_chunked_is_in_data}} -->
[View Source →](<../../../../../src/waltz/http/picohttpparser.h#L81>)

Checks if the chunked decoder is processing chunk data.
- **Description**: Use this function to determine if the chunked decoder is currently in the process of decoding chunk data. This function is useful when you need to check the state of the decoder to decide on further processing steps. It must be called with a valid `phr_chunked_decoder` structure that has been properly initialized. The function does not modify the decoder or any other data.
- **Inputs**:
    - `decoder`: A pointer to a `phr_chunked_decoder` structure. This must not be null and should be properly initialized before calling this function. The function does not handle null pointers and expects the caller to ensure the validity of the input.
- **Output**: Returns a non-zero value if the decoder is in the middle of processing chunk data, otherwise returns zero.
- **See Also**: [`phr_decode_chunked_is_in_data`](<picohttpparser.c.md#phr_decode_chunked_is_in_data>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)