<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

APIs for importing IPv4 neighbors from Linux netlink, assuming 6-byte link-layer addresses.

# Purpose
The `fd_neigh4_netlink.h` file is a C header file that provides APIs for managing IPv4 neighbor information using Linux netlink. It includes functions to request a dump of the IPv4 neighbor table for a specified network interface and to process netlink messages related to IPv4 neighbors. The [`fd_neigh4_netlink_request_dump`](<#fd_neigh4_netlink_request_dump>) function sends a request to the kernel to obtain the neighbor table, while the [`fd_neigh4_netlink_ingest_message`](<#fd_neigh4_netlink_ingest_message>) function processes incoming netlink messages to update the neighbor table, handling only IPv4 entries and ignoring IPv6 entries. The header assumes that link-layer addresses are 6 bytes long and is intended for use on Linux systems, as indicated by the conditional compilation directive.
# Imports and Dependencies

---
- `fd_neigh4_map.h`
- `../ip/fd_netlink1.h`


# Function Declarations (Public API)

---
### fd\_neigh4\_netlink\_request\_dump<!-- {{#callable_declaration:fd_neigh4_netlink_request_dump}} -->
[View Source →](<../../../../../src/waltz/neigh/fd_neigh4_netlink.h#L16>)

Requests a dump of the IPv4 neighbor table for a specified interface index.
- **Description**: Use this function to request the IPv4 neighbor table from the kernel for a specific network interface. This function sends a netlink request to the kernel, which typically responds with multi-part messages containing the neighbor table data. It is important to ensure that the `netlink` parameter is properly initialized and that the interface index `if_idx` corresponds to a valid network interface. The function returns 0 on success, indicating that the request was sent successfully, or an error code if the request fails.
- **Inputs**:
    - `netlink`: A pointer to an `fd_netlink_t` structure. This must be initialized before calling the function. The caller retains ownership.
    - `if_idx`: An unsigned integer representing the interface index for which the neighbor table is requested. Must correspond to a valid network interface.
- **Output**: Returns 0 on success. On failure, returns an error code indicating the type of error encountered.
- **See Also**: [`fd_neigh4_netlink_request_dump`](<fd_neigh4_netlink.c.md#fd_neigh4_netlink_request_dump>)  (Implementation)


---
### fd\_neigh4\_netlink\_ingest\_message<!-- {{#callable_declaration:fd_neigh4_netlink_ingest_message}} -->
[View Source →](<../../../../../src/waltz/neigh/fd_neigh4_netlink.h#L35>)

Imports an RTM_NEWNEIGH or RTM_DELNEIGH message into the neighbor table.
- **Description**: Use this function to process netlink messages related to IPv4 neighbor entries for a specific interface. It logs a warning if the message type is not RTM_NEWNEIGH or RTM_DELNEIGH, or if the link-layer address is not 6 bytes long. The function ignores messages for interfaces other than the specified one and only processes IPv4 entries, ignoring IPv6 entries. It updates the neighbor table by inserting, updating, or removing entries based on the message content.
- **Inputs**:
    - `map`: A pointer to an `fd_neigh4_hmap_t` structure representing the neighbor table. The caller retains ownership and must ensure it is valid.
    - `msg`: A pointer to a `struct nlmsghdr` containing the netlink message. Must not be null. The function logs a warning if the message type is not RTM_NEWNEIGH or RTM_DELNEIGH.
    - `if_idx`: An unsigned integer representing the interface index. The function ignores messages with an interface index other than this value.
- **Output**: None
- **See Also**: [`fd_neigh4_netlink_ingest_message`](<fd_neigh4_netlink.c.md#fd_neigh4_netlink_ingest_message>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)