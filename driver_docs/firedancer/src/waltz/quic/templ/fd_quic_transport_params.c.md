<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Functions and macros for encoding, decoding, and dumping QUIC transport parameters.

# Purpose
The code provides functionality for handling QUIC (Quick UDP Internet Connections) transport parameters. It includes functions to decode, encode, and dump transport parameters, which are essential for establishing and managing QUIC connections. The code defines several macros to handle different types of transport parameters, such as `VARINT`, `CONN_ID`, `ZERO_LENGTH`, `TOKEN`, and `PREFERRED_ADDRESS`. These macros are used to parse, encode, and calculate the footprint of transport parameters, ensuring that the parameters are correctly processed according to their types.

The file includes functions like [`fd_quic_decode_transport_params`](<#fd_quic_decode_transport_params>), which decodes transport parameters from a buffer, and [`fd_quic_encode_transport_params`](<#fd_quic_encode_transport_params>), which encodes transport parameters into a buffer. The [`fd_quic_dump_transport_params`](<#fd_quic_dump_transport_params>) function outputs the transport parameters to a specified file stream, providing a human-readable description of the parameters. The code relies on external definitions and functions, such as `FD_QUIC_TRANSPORT_PARAMS`, which are likely defined in the included headers. This code is part of a larger system that manages QUIC connections, focusing on the transport parameters aspect.
# Imports and Dependencies

---
- `../fd_quic_common.h`
- `fd_quic_transport_params.h`
- `fd_quic_parse_util.h`
- `stdio.h`


# Functions

---
### fd\_quic\_dump\_transport\_param\_desc<!-- {{#callable:fd_quic_dump_transport_param_desc}} -->
[View Source →](<../../../../../../src/waltz/quic/templ/fd_quic_transport_params.c#L8>)

Outputs descriptions of QUIC transport parameters to a specified file stream.
- **Inputs**:
    - `out`: A pointer to a `FILE` object where the function writes the transport parameter descriptions.
- **Logic and Control Flow**:
    - Writes a header line 'Transport parameter descriptions:' to the output file.
    - Defines a macro `__` that formats and writes each transport parameter's ID, type, and name followed by its description to the output file.
    - Invokes the `FD_QUIC_TRANSPORT_PARAMS` macro with the defined `__` macro to iterate over and output all transport parameters.
    - Undefines the `__` macro after use.
- **Output**: No return value; writes formatted transport parameter descriptions to the specified file stream.


---
### fd\_quic\_decode\_transport\_param<!-- {{#callable:fd_quic_decode_transport_param}} -->
[View Source →](<../../../../../../src/waltz/quic/templ/fd_quic_transport_params.c#L61>)

Decodes a QUIC transport parameter based on its ID and updates the provided parameters structure.
- **Inputs**:
    - `params`: A pointer to `fd_quic_transport_params_t` structure where the decoded transport parameter will be stored.
    - `id`: An unsigned long integer representing the ID of the transport parameter to decode.
    - `buf`: A pointer to an array of unsigned characters containing the encoded transport parameter data.
    - `sz`: An unsigned long integer representing the size of the buffer `buf`.
- **Logic and Control Flow**:
    - Uses a switch statement to handle different transport parameter IDs, which compiles into a jump table for efficiency.
    - For each case in the switch, calls a macro `FD_QUIC_PARSE_TP_##TYPE(NAME)` to parse the transport parameter based on its type.
    - Returns 0 after successfully parsing a known transport parameter.
    - Returns 0 if the ID is unknown, effectively ignoring unknown IDs.
- **Output**: Returns 0 to indicate successful parsing or ignoring of unknown IDs.


---
### fd\_quic\_decode\_transport\_params<!-- {{#callable:fd_quic_decode_transport_params}} -->
[View Source →](<../../../../../../src/waltz/quic/templ/fd_quic_transport_params.c#L82>)

Decodes QUIC transport parameters from a buffer and updates the buffer position.
- **Inputs**:
    - `params`: A pointer to `fd_quic_transport_params_t` where decoded transport parameters will be stored.
    - `buf`: A pointer to the buffer containing encoded transport parameters.
    - `buf_sz`: The size of the buffer in bytes.
- **Logic and Control Flow**:
    - While `buf_sz` is greater than 0, continue processing the buffer.
    - Parse a variable-length integer from the buffer to get `param_id`.
    - Parse another variable-length integer from the buffer to get `param_sz`.
    - If `param_sz` is greater than `buf_sz`, return -1 indicating an out-of-bounds error.
    - Call [`fd_quic_decode_transport_param`](<#fd_quic_decode_transport_param>) to decode the parameter identified by `param_id` and store it in `params`.
    - If [`fd_quic_decode_transport_param`](<#fd_quic_decode_transport_param>) returns an error, return -1 indicating a parse failure.
    - Update `buf` and `buf_sz` by advancing them by `param_sz` bytes.
- **Output**: Returns 0 on success, or -1 if there is an error in parsing or if a parameter size is out of bounds.
- **Functions Called**:
    - [`fd_quic_tp_parse_varint`](<fd_quic_transport_params.h.md#fd_quic_tp_parse_varint>)
    - [`fd_quic_decode_transport_param`](<#fd_quic_decode_transport_param>)


---
### fd\_quic\_dump\_transport\_params<!-- {{#callable:fd_quic_dump_transport_params}} -->
[View Source →](<../../../../../../src/waltz/quic/templ/fd_quic_transport_params.c#L118>)

Outputs the transport parameters to a specified file stream.
- **Inputs**:
    - `params`: A pointer to a constant `fd_quic_transport_params_t` structure containing the transport parameters to be dumped.
    - `out`: A pointer to a `FILE` stream where the transport parameters will be printed.
- **Logic and Control Flow**:
    - Prints the header 'Transport params:' to the output file stream.
    - Iterates over each transport parameter defined by the `FD_QUIC_TRANSPORT_PARAMS` macro.
    - For each parameter, prints its name and ID, followed by an asterisk if the parameter is present, or a space if not.
    - Uses the appropriate `FD_QUIC_DUMP_TP_*` macro to print the parameter's value based on its type.
    - Prints a newline character after each parameter.
- **Output**: No return value; the function writes formatted transport parameters to the specified file stream.


---
### fd\_quic\_encode\_transport\_params<!-- {{#callable:fd_quic_encode_transport_params}} -->
[View Source →](<../../../../../../src/waltz/quic/templ/fd_quic_transport_params.c#L209>)

Encodes QUIC transport parameters into a buffer and returns the number of bytes written.
- **Inputs**:
    - ``buf``: A pointer to the buffer where the encoded transport parameters will be stored.
    - ``buf_sz``: The size of the buffer in bytes.
    - ``params``: A pointer to a `fd_quic_transport_params_t` structure containing the transport parameters to encode.
- **Logic and Control Flow**:
    - Store the original buffer size in `orig_buf_sz`.
    - Iterate over each transport parameter defined in `FD_QUIC_TRANSPORT_PARAMS`.
    - For each parameter, check if it is present in `params`.
    - If present, encode the parameter using the appropriate `FD_QUIC_ENCODE_TP_<TYPE>` macro.
    - Return the difference between the original buffer size and the remaining buffer size, which represents the number of bytes written.
- **Output**: Returns the number of bytes written to the buffer, which is the difference between the original buffer size and the remaining buffer size.



---
Made with ❤️ by [Driver](https://www.driver.ai/)