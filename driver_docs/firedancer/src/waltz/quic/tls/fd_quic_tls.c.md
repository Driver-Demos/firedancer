<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Implements QUIC TLS functionality, including message sending, secret handling, and transport parameter management.

# Purpose
The code is a C module that provides functionality for integrating QUIC (Quick UDP Internet Connections) with TLS (Transport Layer Security) in a network communication context. It defines a set of functions and data structures that facilitate the management of TLS operations within a QUIC protocol implementation. The module includes functions for sending and receiving cryptographic messages ([`fd_quic_tls_sendmsg`](<#fd_quic_tls_sendmsg>)), handling encryption secrets ([`fd_quic_tls_secrets`](<#fd_quic_tls_secrets>)), and managing random number generation ([`fd_quic_tls_rand`](<#fd_quic_tls_rand>)). It also provides lifecycle management functions for initializing and deleting QUIC-TLS contexts ([`fd_quic_tls_new`](<#fd_quic_tls_new>), [`fd_quic_tls_delete`](<#fd_quic_tls_delete>)) and handling QUIC transport parameters ([`fd_quic_tls_tp_self`](<#fd_quic_tls_tp_self>), [`fd_quic_tls_tp_peer`](<#fd_quic_tls_tp_peer>)).

The module is structured to support the handshake process between QUIC peers, with specific functions to initialize handshake data ([`fd_quic_tls_hs_new`](<#fd_quic_tls_hs_new>)), process handshake messages ([`fd_quic_tls_process`](<#fd_quic_tls_process>)), and manage handshake data buffers. It uses callbacks to notify about handshake completion and to handle peer transport parameters. The code also includes mechanisms for generating and managing cryptographic keys and certificates, such as X25519 and Ed25519 keys, and mock X.509 certificates. The module is intended to be part of a larger system where it interacts with other components through defined interfaces and callbacks, providing a specialized role in the secure communication setup of a QUIC protocol implementation.
# Imports and Dependencies

---
- `fd_quic_tls.h`
- `../../../ballet/ed25519/fd_x25519.h`
- `../../../ballet/x509/fd_x509_mock.h`
- `errno.h`
- `stdlib.h`
- `string.h`
- `sys/uio.h`


# Functions

---
### fd\_quic\_tls\_new<!-- {{#callable:fd_quic_tls_new}} -->
[View Source →](<../../../../../../src/waltz/quic/tls/fd_quic_tls.c#L67>)

Initializes a `fd_quic_tls_t` structure with configuration and callback functions.
- **Inputs**:
    - ``self``: A pointer to a `fd_quic_tls_t` structure to initialize.
    - ``cfg``: A pointer to a `fd_quic_tls_cfg_t` structure containing configuration and callback functions.
- **Logic and Control Flow**:
    - Check if `self` is NULL; if true, log a warning and return NULL.
    - Check if `cfg` is NULL; if true, log a warning and return NULL.
    - Check if any callback in `cfg` is missing; if true, log a warning and return NULL.
    - Assign callback functions from `cfg` to `self`.
    - Call [`fd_quic_tls_init`](<#fd_quic_tls_init>) to initialize the `tls` member of `self` with the signer and certificate public key from `cfg`.
    - Return the initialized `self` pointer.
- **Output**: Returns a pointer to the initialized `fd_quic_tls_t` structure, or NULL if initialization fails.
- **Functions Called**:
    - [`fd_quic_tls_init`](<#fd_quic_tls_init>)


---
### fd\_quic\_tls\_init<!-- {{#callable:fd_quic_tls_init}} -->
[View Source →](<../../../../../../src/waltz/quic/tls/fd_quic_tls.c#L99>)

Initializes a QUIC TLS context with specific cryptographic and protocol parameters.
- **Inputs**:
    - ``tls``: A pointer to an `fd_tls_t` structure that will be initialized.
    - ``signer``: An `fd_tls_sign_t` value representing the signing function to use.
    - ``cert_public_key``: A constant array of 32 unsigned characters representing the certificate's public key.
- **Logic and Control Flow**:
    - Calls `fd_tls_new` to allocate and initialize a new `fd_tls_t` structure.
    - Sets various fields in the `tls` structure, including QUIC-specific parameters and function pointers for random number generation, signing, secrets handling, and message sending.
    - Generates an X25519 key pair using `fd_rng_secure` for the private key and `fd_x25519_public` for the public key.
    - Copies the provided `cert_public_key` into the `tls` structure's `cert_public_key` field.
    - Generates a mock X.509 certificate using `fd_x509_mock_cert` and sets its size.
    - Sets the ALPN protocol ID to "solana-tpu" with a length prefix.
- **Output**: The function does not return a value; it initializes the `tls` structure in place.


---
### fd\_quic\_tls\_delete<!-- {{#callable:fd_quic_tls_delete}} -->
[View Source →](<../../../../../../src/waltz/quic/tls/fd_quic_tls.c#L138>)

Checks if the input pointer is NULL and returns it if not.
- **Inputs**:
    - ``self``: A pointer to an `fd_quic_tls_t` structure that the function will check and return.
- **Logic and Control Flow**:
    - Check if `self` is NULL using `FD_UNLIKELY`.
    - If `self` is NULL, log a warning message 'NULL self' and return NULL.
    - If `self` is not NULL, return `self`.
- **Output**: Returns the input pointer `self` if it is not NULL; otherwise, returns NULL.


---
### fd\_quic\_tls\_hs\_new<!-- {{#callable:fd_quic_tls_hs_new}} -->
[View Source →](<../../../../../../src/waltz/quic/tls/fd_quic_tls.c#L147>)

Initializes a new QUIC TLS handshake structure with specified parameters and starts the handshake process.
- **Inputs**:
    - ``self``: A pointer to an `fd_quic_tls_hs_t` structure to initialize.
    - ``quic_tls``: A pointer to an `fd_quic_tls_t` structure representing the QUIC TLS context.
    - ``context``: A pointer to a user-defined context for the handshake.
    - ``is_server``: An integer indicating if the handshake is for a server (non-zero) or a client (zero).
    - ``self_transport_params``: A pointer to a constant `fd_quic_transport_params_t` structure containing the transport parameters for the handshake.
    - ``now``: A long integer representing the current time to set the birthtime of the handshake.
- **Logic and Control Flow**:
    - Clears the memory of the `self` structure using `fd_memset` to reset all fields.
    - Sets the `quic_tls`, `is_server`, and `context` fields of `self` to the provided arguments.
    - Initializes the handshake data free list by setting up the `hs_data` array with indices pointing to the next element.
    - Sets all pending data indices (`hs_data_pend_idx` and `hs_data_pend_end_idx`) to `FD_QUIC_TLS_HS_DATA_UNUSED`.
    - Resets the `hs_data_buf_ptr` to zero and clears the `hs_data_offset` array.
    - Copies the `self_transport_params` into the `self` structure.
    - If `is_server` is true, initializes the server-side TLS estate using `fd_tls_estate_srv_new`.
    - If `is_server` is false, initializes the client-side TLS estate using `fd_tls_estate_cli_new` and starts the client handshake with `fd_tls_client_handshake`.
    - If the client handshake fails, sets the `alert` field to the negative result of the handshake.
    - Sets the `birthtime` of the handshake to the current time `now`.
    - Returns the initialized `self` structure.
- **Output**: A pointer to the initialized `fd_quic_tls_hs_t` structure.


---
### fd\_quic\_tls\_hs\_delete<!-- {{#callable:fd_quic_tls_hs_delete}} -->
[View Source →](<../../../../../../src/waltz/quic/tls/fd_quic_tls.c#L204>)

Deletes a QUIC TLS handshake state object based on its server or client role.
- **Inputs**:
    - ``self``: A pointer to the `fd_quic_tls_hs_t` structure representing the QUIC TLS handshake state to delete.
- **Logic and Control Flow**:
    - Check if `self` is NULL; if so, return immediately.
    - Check if `self->is_server` is true; if so, call `fd_tls_estate_srv_delete` to delete the server state.
    - If `self->is_server` is false, call `fd_tls_estate_cli_delete` to delete the client state.
- **Output**: No return value.


---
### fd\_quic\_tls\_process<!-- {{#callable:fd_quic_tls_process}} -->
[View Source →](<../../../../../../src/waltz/quic/tls/fd_quic_tls.c#L214>)

Processes QUIC TLS handshake messages and updates the handshake state.
- **Inputs**:
    - `self`: A pointer to an `fd_quic_tls_hs_t` structure representing the current handshake state and context.
- **Logic and Control Flow**:
    - Check if the handshake state is `FD_TLS_HS_FAIL`; if true, return `FD_QUIC_FAILED`.
    - Check if the handshake state is `FD_TLS_HS_CONNECTED`; if true, return `FD_QUIC_SUCCESS`.
    - Enter a loop to process received handshake messages.
    - Calculate available data size and check if it is less than 4 bytes; if true, break the loop.
    - Extract the message size from the buffer and check if available data is less than the message size plus 4 bytes; if true, break the loop.
    - Call `fd_tls_handshake` to process the message; if the result is negative, set the alert and return `FD_QUIC_FAILED`.
    - If the result is zero, log a warning and return `FD_QUIC_FAILED`.
    - Update the offset in `self` by the result of `fd_tls_handshake`.
    - After processing messages, check the handshake state: if `FD_TLS_HS_CONNECTED`, call the handshake complete callback and return `FD_QUIC_SUCCESS`; if `FD_TLS_HS_FAIL`, return `FD_QUIC_FAILED`; otherwise, return `FD_QUIC_SUCCESS`.
- **Output**: An integer indicating the result of the handshake processing: `FD_QUIC_SUCCESS` if successful, `FD_QUIC_FAILED` if failed.


---
### fd\_quic\_tls\_sendmsg<!-- {{#callable:fd_quic_tls_sendmsg}} -->
[View Source →](<../../../../../../src/waltz/quic/tls/fd_quic_tls.c#L265>)

Adds handshake data to a buffer for retrieval by the user, ensuring space allocation and updating metadata.
- **Inputs**:
    - ``handshake``: A pointer to the handshake state, which is cast to `fd_quic_tls_hs_t`.
    - ``data``: A pointer to the data to be sent.
    - ``data_sz``: The size of the data to be sent.
    - ``enc_level``: The encryption level for the data.
    - ``flush``: An unused parameter in this function.
- **Logic and Control Flow**:
    - Check if `data_sz` exceeds `FD_QUIC_TLS_HS_DATA_SZ`; if so, return 0.
    - Cast `handshake` to `fd_quic_tls_hs_t` and find a free handshake data index.
    - If no free structures are left, return 0.
    - Calculate aligned data size and check if there is enough space in the buffer; if not, return 0.
    - Allocate space in the buffer and update the free list and buffer pointer.
    - Copy the data into the buffer and update metadata in `hs_data`.
    - Adjust the offset for more data and add the data to the end of the pending list.
    - Return 1 to indicate success.
- **Output**: Returns 1 on success, or 0 if there is an error such as insufficient space or no free structures.


---
### fd\_quic\_tls\_secrets<!-- {{#callable:fd_quic_tls_secrets}} -->
[View Source →](<../../../../../../src/waltz/quic/tls/fd_quic_tls.c#L334>)

Handles the setup of new encryption keys for a QUIC connection during the handshake process.
- **Inputs**:
    - ``handshake``: A pointer to the handshake state, specifically a `fd_quic_tls_hs_t` structure.
    - ``recv_secret``: A pointer to the received secret key, expected to be 32 bytes in size.
    - ``send_secret``: A pointer to the send secret key, expected to be 32 bytes in size.
    - ``enc_level``: An unsigned integer representing the encryption level.
- **Logic and Control Flow**:
    - Cast the `handshake` pointer to a `fd_quic_tls_hs_t` type.
    - Initialize a `fd_quic_tls_secret_t` structure with the given `enc_level`.
    - Copy the `recv_secret` into the `read_secret` field of the `secret` structure.
    - Copy the `send_secret` into the `write_secret` field of the `secret` structure.
    - Invoke the `secret_cb` callback function from the `quic_tls` field of the `handshake` structure, passing the `handshake`, `context`, and `secret` as arguments.
- **Output**: No return value; the function operates through side effects, specifically by invoking a callback with the new secrets.


---
### fd\_quic\_tls\_get\_hs\_data<!-- {{#callable:fd_quic_tls_get_hs_data}} -->
[View Source →](<../../../../../../src/waltz/quic/tls/fd_quic_tls.c#L349>)

Retrieves the pending handshake data for a given encryption level from a QUIC TLS handshake structure.
- **Inputs**:
    - `self`: A pointer to an `fd_quic_tls_hs_t` structure representing the QUIC TLS handshake state.
    - `enc_level`: An unsigned integer representing the encryption level for which to retrieve the handshake data.
- **Logic and Control Flow**:
    - Check if `self` is NULL; if so, return NULL.
    - Retrieve the index of the pending handshake data for the specified `enc_level` from `self->hs_data_pend_idx`.
    - Check if the index is `FD_QUIC_TLS_HS_DATA_UNUSED`; if so, return NULL.
    - Return a pointer to the handshake data at the retrieved index in `self->hs_data`.
- **Output**: A pointer to an `fd_quic_tls_hs_data_t` structure containing the pending handshake data, or NULL if no data is pending or if `self` is NULL.


---
### fd\_quic\_tls\_get\_next\_hs\_data<!-- {{#callable:fd_quic_tls_get_next_hs_data}} -->
[View Source →](<../../../../../../src/waltz/quic/tls/fd_quic_tls.c#L360>)

Retrieves the next handshake data structure from a linked list of handshake data.
- **Inputs**:
    - ``self``: A pointer to the `fd_quic_tls_hs_t` structure, which contains the handshake data list.
    - ``hs``: A pointer to the current `fd_quic_tls_hs_data_t` structure from which to retrieve the next handshake data.
- **Logic and Control Flow**:
    - Retrieve the `next_idx` from the `hs` structure.
    - Check if `next_idx` is equal to `(ushort)(~0u)`, which indicates the end of the list; if so, return `NULL`.
    - Otherwise, return the pointer to the next handshake data structure by adding `next_idx` to the `hs_data` array in the `self` structure.
- **Output**: A pointer to the next `fd_quic_tls_hs_data_t` structure, or `NULL` if there is no next data.


---
### fd\_quic\_tls\_pop\_hs\_data<!-- {{#callable:fd_quic_tls_pop_hs_data}} -->
[View Source →](<../../../../../../src/waltz/quic/tls/fd_quic_tls.c#L367>)

Removes the first handshake data entry from the pending list for a given encryption level.
- **Inputs**:
    - `self`: A pointer to the `fd_quic_tls_hs_t` structure that contains handshake data.
    - `enc_level`: The encryption level for which to pop the handshake data.
- **Logic and Control Flow**:
    - Retrieve the index of the first pending handshake data entry for the specified encryption level from `self->hs_data_pend_idx[enc_level]`.
    - If the index is `FD_QUIC_TLS_HS_DATA_UNUSED`, return immediately as there is no data to pop.
    - Get a pointer to the handshake data entry using the retrieved index.
    - Update `self->hs_data_pend_idx[enc_level]` to point to the next handshake data entry in the list.
    - If the popped entry was the last in the list (i.e., `hs_data->next_idx` is `FD_QUIC_TLS_HS_DATA_UNUSED`), update `self->hs_data_pend_end_idx[enc_level]` to `FD_QUIC_TLS_HS_DATA_UNUSED`.
- **Output**: No return value; the function modifies the `self` structure to update the pending handshake data list.


---
### fd\_quic\_tls\_clear\_hs\_data<!-- {{#callable:fd_quic_tls_clear_hs_data}} -->
[View Source →](<../../../../../../src/waltz/quic/tls/fd_quic_tls.c#L383>)

Clears pending handshake data indices for a specified encryption level.
- **Inputs**:
    - ``self``: A pointer to an `fd_quic_tls_hs_t` structure representing the current handshake state.
    - ``enc_level``: An unsigned integer representing the encryption level for which to clear handshake data.
- **Logic and Control Flow**:
    - Set `self->hs_data_pend_idx[enc_level]` to `FD_QUIC_TLS_HS_DATA_UNUSED` to indicate no pending handshake data at this encryption level.
    - Set `self->hs_data_pend_end_idx[enc_level]` to `FD_QUIC_TLS_HS_DATA_UNUSED` to indicate no end index for pending handshake data at this encryption level.
- **Output**: No return value; the function modifies the `self` structure in place.


---
### fd\_quic\_tls\_rand<!-- {{#callable:fd_quic_tls_rand}} -->
[View Source →](<../../../../../../src/waltz/quic/tls/fd_quic_tls.c#L389>)

Generates cryptographically secure random data and stores it in the provided buffer.
- **Inputs**:
    - `ctx`: A context pointer, which is not used in this function.
    - `buf`: A pointer to the buffer where the random data will be stored.
    - `bufsz`: The size of the buffer in bytes, indicating how much random data to generate.
- **Logic and Control Flow**:
    - Ignores the `ctx` parameter as it is not used.
    - Calls `fd_rng_secure` to fill the `buf` with `bufsz` bytes of cryptographically secure random data.
    - Uses `FD_TEST` to ensure that `fd_rng_secure` successfully fills the buffer.
    - Returns the `buf` pointer.
- **Output**: Returns the pointer to the buffer `buf` containing the generated random data.


---
### fd\_quic\_tls\_tp\_self<!-- {{#callable:fd_quic_tls_tp_self}} -->
[View Source →](<../../../../../../src/waltz/quic/tls/fd_quic_tls.c#L398>)

Encodes and returns the size of QUIC transport parameters for the local endpoint.
- **Inputs**:
    - `handshake`: A pointer to a `fd_quic_tls_hs_t` structure representing the current handshake state.
    - `quic_tp`: A pointer to a buffer where the encoded QUIC transport parameters will be stored.
    - `quic_tp_bufsz`: The size of the buffer `quic_tp` in bytes.
- **Logic and Control Flow**:
    - Cast the `handshake` pointer to a `fd_quic_tls_hs_t` pointer and store it in `hs`.
    - Call `fd_quic_encode_transport_params` with `quic_tp`, `quic_tp_bufsz`, and `hs->self_transport_params` to encode the transport parameters.
    - Check if the encoding failed by comparing `encoded_sz` to `FD_QUIC_ENCODE_FAIL`.
    - If encoding failed, log a warning and return 0.
    - If encoding succeeded, return the size of the encoded transport parameters.
- **Output**: Returns the size of the encoded QUIC transport parameters, or 0 if encoding fails.


---
### fd\_quic\_tls\_tp\_peer<!-- {{#callable:fd_quic_tls_tp_peer}} -->
[View Source →](<../../../../../../src/waltz/quic/tls/fd_quic_tls.c#L413>)

Bubbles up a callback to inform `fd_quic_tls` of the peer's QUIC transport parameters.
- **Inputs**:
    - `handshake`: A pointer to the handshake object, which is cast to `fd_quic_tls_hs_t`.
    - `quic_tp`: A pointer to the peer's QUIC transport parameters.
    - `quic_tp_sz`: The size of the QUIC transport parameters.
- **Logic and Control Flow**:
    - Cast the `handshake` pointer to `fd_quic_tls_hs_t` type and store it in `hs`.
    - Retrieve the `fd_quic_tls_t` object from `hs` and store it in `quic_tls`.
    - Call the `peer_params_cb` callback function of `quic_tls` with `hs->context`, `quic_tp`, and `quic_tp_sz` as arguments.
- **Output**: No return value; the function is of type `void`.


# Function Declarations (Public API)

---
### fd\_quic\_tls\_sendmsg<!-- {{#callable_declaration:fd_quic_tls_sendmsg}} -->
[View Source →](<../../../../../../src/waltz/quic/tls/fd_quic_tls.c#L16>)

Sends a CRYPTO frame to the peer in a QUIC connection.
- **Description**: Use this function to send a CRYPTO frame during a QUIC connection handshake. It adds the provided data to the handshake structure for later retrieval. Ensure that the data size does not exceed the buffer size limit. The function must be called with a valid handshake object and appropriate encryption level. It returns a success or failure status based on the availability of resources and buffer space.
- **Inputs**:
    - `handshake`: A pointer to the handshake object. Must not be null. The caller retains ownership.
    - `record`: A pointer to the data to send. Must not be null. The caller retains ownership.
    - `record_sz`: The size of the data to send. Must be less than or equal to the buffer size limit.
    - `encryption_level`: The encryption level for the data. Must be a valid encryption level.
    - `flush`: Unused parameter. Can be any integer value.
- **Output**: Returns 1 on success, indicating the data was successfully added to the handshake structure. Returns 0 on failure, indicating insufficient resources or buffer space.
- **See Also**: [`fd_quic_tls_sendmsg`](<#fd_quic_tls_sendmsg>)  (Implementation)


---
### fd\_quic\_tls\_secrets<!-- {{#callable_declaration:fd_quic_tls_secrets}} -->
[View Source →](<../../../../../../src/waltz/quic/tls/fd_quic_tls.c#L28>)

Notifies when new encryption keys are available.
- **Description**: Use this function to notify the system when new encryption keys become available during a QUIC connection. It is called at most twice per connection: once for the handshake secrets and once for the initial application-level secrets. This function requires valid pointers to the handshake context and the encryption secrets. It is important to ensure that the `handshake` parameter is a valid pointer to a `fd_quic_tls_hs_t` structure, and that the `recv_secret` and `send_secret` parameters point to valid 32-byte buffers containing the respective secrets.
- **Inputs**:
    - `handshake`: A pointer to a `fd_quic_tls_hs_t` structure representing the handshake context. Must not be null.
    - `recv_secret`: A pointer to a 32-byte buffer containing the receive secret. Must not be null.
    - `send_secret`: A pointer to a 32-byte buffer containing the send secret. Must not be null.
    - `enc_level`: An unsigned integer representing the encryption level. Valid values depend on the QUIC protocol's encryption levels.
- **Output**: None
- **See Also**: [`fd_quic_tls_secrets`](<#fd_quic_tls_secrets>)  (Implementation)


---
### fd\_quic\_tls\_rand<!-- {{#callable_declaration:fd_quic_tls_rand}} -->
[View Source →](<../../../../../../src/waltz/quic/tls/fd_quic_tls.c#L39>)

Generates cryptographically secure random data.
- **Description**: Use this function to fill a buffer with cryptographically secure random data. It is suitable for use in security-sensitive applications where high-quality randomness is required. The function does not use the `ctx` parameter, so it can be set to any value. Ensure that the `buf` parameter is a valid pointer to a memory area of at least `bufsz` bytes. The function will return the same pointer as `buf` if successful.
- **Inputs**:
    - `ctx`: Unused parameter. Can be set to any value.
    - `buf`: Pointer to a buffer where random data will be written. Must not be null and must point to a memory area of at least `bufsz` bytes.
    - `bufsz`: Number of bytes of random data to generate. Must be a positive integer.
- **Output**: Returns the same pointer as `buf` if the operation is successful.
- **See Also**: [`fd_quic_tls_rand`](<#fd_quic_tls_rand>)  (Implementation)


---
### fd\_quic\_tls\_tp\_self<!-- {{#callable_declaration:fd_quic_tls_tp_self}} -->
[View Source →](<../../../../../../src/waltz/quic/tls/fd_quic_tls.c#L47>)

Retrieves and encodes QUIC transport parameters.
- **Description**: Use this function to obtain the encoded QUIC transport parameters for the local endpoint. It is typically called during the TLS handshake process to provide the necessary transport parameters to the peer. Ensure that the `handshake` parameter is a valid pointer to a handshake structure, and that `quic_tp` points to a buffer with sufficient size as specified by `quic_tp_bufsz`. If the encoding fails, the function returns 0, indicating an error.
- **Inputs**:
    - `handshake`: A pointer to a handshake structure. Must not be null. The caller retains ownership.
    - `quic_tp`: A pointer to a buffer where the encoded transport parameters will be stored. Must not be null and should have enough space as specified by `quic_tp_bufsz`.
    - `quic_tp_bufsz`: The size of the buffer pointed to by `quic_tp`. Must be a positive value.
- **Output**: Returns the size of the encoded transport parameters on success, or 0 if encoding fails.
- **See Also**: [`fd_quic_tls_tp_self`](<#fd_quic_tls_tp_self>)  (Implementation)


---
### fd\_quic\_tls\_tp\_peer<!-- {{#callable_declaration:fd_quic_tls_tp_peer}} -->
[View Source →](<../../../../../../src/waltz/quic/tls/fd_quic_tls.c#L55>)

Notifies about the peer's QUIC transport parameters.
- **Description**: Use this function to inform the QUIC layer about the peer's QUIC transport parameters during a TLS handshake. This function is typically called as a callback from the TLS layer to pass the received transport parameters to the QUIC layer. It is important to ensure that the `handshake` parameter is valid and properly initialized before calling this function.
- **Inputs**:
    - `handshake`: A pointer to a handshake context. Must not be null and should be a valid and initialized context for the current TLS handshake.
    - `quic_tp`: A pointer to a buffer containing the peer's QUIC transport parameters. Must not be null and should point to a valid buffer of transport parameters.
    - `quic_tp_sz`: The size of the `quic_tp` buffer in bytes. Should accurately represent the size of the transport parameters buffer.
- **Output**: None
- **See Also**: [`fd_quic_tls_tp_peer`](<#fd_quic_tls_tp_peer>)  (Implementation)


---
### fd\_quic\_tls\_init<!-- {{#callable_declaration:fd_quic_tls_init}} -->
[View Source →](<../../../../../../src/waltz/quic/tls/fd_quic_tls.c#L62>)

Initializes a QUIC TLS context.
- **Description**: Use this function to set up a QUIC TLS context with the necessary cryptographic parameters and callbacks. This function must be called as part of the QUIC TLS lifecycle initialization process. It prepares the TLS context for secure communication by setting up key exchange, signing, and transport parameters. Ensure that the `tls` parameter is a valid pointer to a `fd_tls_t` structure, and that the `cert_public_key` is a valid 32-byte public key. This function does not return a value and does not handle invalid input parameters.
- **Inputs**:
    - `tls`: Pointer to a `fd_tls_t` structure that will be initialized. Must not be null.
    - `signer`: A `fd_tls_sign_t` value that specifies the signing method. Must be a valid signer.
    - `cert_public_key`: A 32-byte array containing the public key for the certificate. Must not be null and must be exactly 32 bytes.
- **Output**: None
- **See Also**: [`fd_quic_tls_init`](<#fd_quic_tls_init>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)