<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Constants, data structures, and functions for HTTP/2 frame and setting encoding and identification.

# Purpose
The `fd_h2_proto.h` file is a C header file that defines constants, data structures, and functions related to the HTTP/2 protocol. It includes definitions for various HTTP/2 frame types, such as `FD_H2_FRAME_TYPE_DATA`, `FD_H2_FRAME_TYPE_HEADERS`, and others, which are used to identify different types of frames in HTTP/2 communication. The file also provides inline functions for packing and unpacking frame headers, such as [`fd_h2_frame_type`](<#fd_h2_frame_type>), [`fd_h2_frame_length`](<#fd_h2_frame_length>), and [`fd_h2_frame_typlen`](<#fd_h2_frame_typlen>), which handle the encoding and decoding of frame type and length fields.

Additionally, the file defines several data structures that match the encoding of specific HTTP/2 frames, including `fd_h2_frame_hdr_t`, `fd_h2_priority_t`, `fd_h2_setting_t`, `fd_h2_ping_t`, `fd_h2_goaway_t`, `fd_h2_window_update_t`, and `fd_h2_rst_stream_t`. These structures are used to represent the headers and payloads of different frame types. The file also includes function prototypes for [`fd_h2_frame_name`](<#fd_h2_frame_name>) and [`fd_h2_setting_name`](<#fd_h2_setting_name>), which return the names of HTTP/2 frames and settings, respectively. This header file is intended to be included in other C source files that implement or interact with the HTTP/2 protocol, providing a standardized interface for handling HTTP/2 frames and settings.
# Imports and Dependencies

---
- `fd_h2_base.h`


# Data Structures

---
### fd\_h2\_frame\_hdr
- **Type**: ``struct``
- **Members**:
    - `typlen`: Stores the type and length of the HTTP/2 frame in a packed format.
    - `flags`: Holds the flags associated with the HTTP/2 frame.
    - `r_stream_id`: Contains the stream identifier for the HTTP/2 frame.
- **Description**: Encodes the header of an HTTP/2 frame, including the type, length, flags, and stream identifier, in a compact format for efficient transmission and processing.


---
### fd\_h2\_frame\_hdr\_t
- **Type**: ``struct``
- **Members**:
    - ``typlen``: Contains the packed type and length of the HTTP/2 frame.
    - ``flags``: Stores the flags associated with the HTTP/2 frame.
    - ``r_stream_id``: Holds the stream identifier for the HTTP/2 frame.
- **Description**: Matches the encoding of a HTTP/2 frame header, as specified in the HTTP/2 protocol, and is used to represent the header of a frame with fields for type, length, flags, and stream ID.


---
### fd\_h2\_priority
- **Type**: ``struct``
- **Members**:
    - `hdr`: Contains the HTTP/2 frame header information.
    - `r_stream_dep`: Specifies the stream dependency as an unsigned integer.
    - `weight`: Indicates the weight of the stream as an unsigned character.
- **Description**: Encodes a PRIORITY frame in HTTP/2, which is used to specify the priority of a stream in relation to other streams.


---
### fd\_h2\_priority\_t
- **Type**: ``struct``
- **Members**:
    - ``hdr``: Contains the HTTP/2 frame header information.
    - ``r_stream_dep``: Specifies the stream dependency.
    - ``weight``: Indicates the weight of the stream.
- **Description**: Encodes a PRIORITY frame in HTTP/2, which is used to specify the priority of a stream in relation to other streams.


---
### fd\_h2\_setting
- **Type**: ``struct``
- **Members**:
    - ``id``: A 16-bit unsigned short integer that identifies the setting.
    - ``value``: A 32-bit unsigned integer that specifies the value of the setting.
- **Description**: Defines a structure for representing a single HTTP/2 setting, consisting of an identifier and its corresponding value, used within a SETTINGS frame.


---
### fd\_h2\_setting\_t
- **Type**: ``struct``
- **Members**:
    - ``id``: A 16-bit unsigned integer that identifies the setting.
    - ``value``: A 32-bit unsigned integer that specifies the value of the setting.
- **Description**: Defines a setting in an HTTP/2 SETTINGS frame, consisting of an identifier and a value, both of which are used to configure various parameters of the HTTP/2 connection.


---
### fd\_h2\_ping
- **Type**: ``struct``
- **Members**:
    - `hdr`: Contains the HTTP/2 frame header information.
    - `payload`: Holds the payload data for the PING frame.
- **Description**: Encodes a PING frame in the HTTP/2 protocol, consisting of a frame header and a payload, used to measure round-trip time and check the connection status.


---
### fd\_h2\_ping\_t
- **Type**: ``struct``
- **Members**:
    - ``hdr``: Contains the HTTP/2 frame header information.
    - ``payload``: Stores the payload data for the PING frame.
- **Description**: Matches the encoding of a PING frame in the HTTP/2 protocol, consisting of a frame header and a payload, and is used to measure round-trip time or check the connection status.


---
### fd\_h2\_goaway
- **Type**: ``struct fd_h2_goaway``
- **Members**:
    - ``hdr``: Contains the HTTP/2 frame header information.
    - ``last_stream_id``: Indicates the last stream identifier processed by the sender.
    - ``error_code``: Specifies the error code associated with the GOAWAY frame.
- **Description**: Represents the encoding of a GOAWAY frame in HTTP/2, which is used to initiate the shutdown of a connection or to signal an error condition. The structure includes a frame header, the last stream ID processed, and an error code, with optional variable-length debug data following these fields.


---
### fd\_h2\_goaway\_t
- **Type**: ``struct``
- **Members**:
    - ``hdr``: Contains the HTTP/2 frame header information.
    - ``last_stream_id``: Indicates the last stream identifier processed by the sender.
    - ``error_code``: Specifies the error code for the GOAWAY frame.
- **Description**: Encodes a GOAWAY frame in HTTP/2, which is used to initiate shutdown of a connection or to signal serious error conditions. The structure includes a frame header, the last stream ID that was processed, an error code, and may include additional debug data.


---
### fd\_h2\_window\_update
- **Type**: ``struct``
- **Members**:
    - `hdr`: Contains the HTTP/2 frame header information.
    - `increment`: Specifies the value to increase the window size by.
- **Description**: Encodes a WINDOW_UPDATE frame in HTTP/2, which is used to inform the peer to increase the size of the window by a specified increment, allowing more data to be sent.


---
### fd\_h2\_window\_update\_t
- **Type**: ``struct``
- **Members**:
    - `hdr`: Contains the HTTP/2 frame header information.
    - `increment`: Specifies the value to increase the flow control window size.
- **Description**: Matches the encoding of a WINDOW_UPDATE frame in HTTP/2, which is used to manage flow control by increasing the size of the window that the sender can use to send data.


---
### fd\_h2\_rst\_stream
- **Type**: ``struct``
- **Members**:
    - `hdr`: Contains the HTTP/2 frame header information.
    - `error_code`: Stores the error code associated with the RST_STREAM frame.
- **Description**: Encodes a RST_STREAM frame in HTTP/2, which is used to abruptly terminate a stream and communicate an error code.


---
### fd\_h2\_rst\_stream\_t
- **Type**: ``struct``
- **Members**:
    - `hdr`: Contains the HTTP/2 frame header information.
    - `error_code`: Stores the error code associated with the RST_STREAM frame.
- **Description**: Matches the encoding of a RST_STREAM frame in HTTP/2, which is used to close a stream and indicate an error condition.


# Functions

---
### fd\_h2\_frame\_type<!-- {{#callable:fd_h2_frame_type}} -->
[View Source →](<../../../../../src/waltz/h2/fd_h2_proto.h#L29>)

Extracts the frame type from the `typlen` field of an HTTP/2 frame header.
- **Inputs**:
    - `typlen`: A 32-bit unsigned integer representing the combined type and length field of an HTTP/2 frame header.
- **Logic and Control Flow**:
    - Right shifts the `typlen` value by 24 bits to isolate the frame type.
    - Casts the result to an `uchar` to ensure it is within the range [0, 256).
- **Output**: Returns the frame type as an `uchar`.


---
### fd\_h2\_frame\_length<!-- {{#callable:fd_h2_frame_length}} -->
[View Source →](<../../../../../src/waltz/h2/fd_h2_proto.h#L34>)

Calculates the length of an HTTP/2 frame from a given `typlen` value.
- **Inputs**:
    - `typlen`: An unsigned integer representing the type and length field of an HTTP/2 frame header.
- **Logic and Control Flow**:
    - Shift `typlen` left by 8 bits to align the length portion.
    - Call `fd_uint_bswap` to swap the byte order of the shifted value.
    - Apply a bitwise AND operation with `0xFFFFFF` to extract the 24 least significant bits, representing the frame length.
- **Output**: Returns an unsigned integer representing the length of the HTTP/2 frame, constrained to the range [0, 2^24).


---
### fd\_h2\_frame\_typlen<!-- {{#callable:fd_h2_frame_typlen}} -->
[View Source →](<../../../../../src/waltz/h2/fd_h2_proto.h#L41>)

Packs the `type` and `length` into a single `typlen` field for an HTTP/2 frame header.
- **Inputs**:
    - `type`: An unsigned long integer representing the frame type, expected to be in the range [0, 256).
    - `length`: An unsigned long integer representing the frame length, expected to be in the range [0, 16777216).
- **Logic and Control Flow**:
    - Convert `length` to a 32-bit unsigned integer and byte-swap it using `fd_uint_bswap`.
    - Shift the byte-swapped `length` 8 bits to the right.
    - Convert `type` to a 32-bit unsigned integer and shift it 24 bits to the left.
    - Combine the shifted `length` and `type` using a bitwise OR operation to form the `typlen`.
- **Output**: Returns a 32-bit unsigned integer representing the packed `typlen` field.


---
### fd\_h2\_frame\_stream\_id<!-- {{#callable:fd_h2_frame_stream_id}} -->
[View Source →](<../../../../../src/waltz/h2/fd_h2_proto.h#L47>)

Converts a stream identifier from network byte order to host byte order and masks it to 31 bits.
- **Inputs**:
    - ``r_stream_id``: The stream identifier in network byte order to be converted and masked.
- **Logic and Control Flow**:
    - Calls `fd_uint_bswap` to swap the byte order of `r_stream_id`.
    - Applies a bitwise AND operation with `0x7fffffffu` to mask the result to 31 bits.
- **Output**: Returns the converted and masked stream identifier as an unsigned integer.


# Function Declarations (Public API)

---
### fd\_h2\_frame\_name<!-- {{#callable_declaration:fd_h2_frame_name}} -->
[View Source →](<../../../../../src/waltz/h2/fd_h2_proto.h#L153>)

Returns the name of a HTTP/2 frame type.
- **Description**: Use this function to get a human-readable name for a given HTTP/2 frame type identifier. It is useful for logging or debugging purposes when you need to display the type of frame being processed. The function returns a string with the frame name corresponding to the provided frame ID. If the frame ID is not recognized, it returns "unknown". The returned string is a static constant and should not be modified or freed by the caller.
- **Inputs**:
    - `frame_id`: An unsigned integer representing the HTTP/2 frame type identifier. Valid values are defined by the `FD_H2_FRAME_TYPE_*` constants. If the value does not match any known frame type, the function returns "unknown".
- **Output**: A constant string representing the name of the HTTP/2 frame type. The string has a static lifetime and must not be modified or freed by the caller.
- **See Also**: [`fd_h2_frame_name`](<fd_h2_proto.c.md#fd_h2_frame_name>)  (Implementation)


---
### fd\_h2\_setting\_name<!-- {{#callable_declaration:fd_h2_setting_name}} -->
[View Source →](<../../../../../src/waltz/h2/fd_h2_proto.h#L164>)

Returns the name of a HTTP/2 setting.
- **Description**: Use this function to get a human-readable name for a given HTTP/2 setting identifier. This is useful for debugging or logging purposes when you need to translate setting IDs into their corresponding names. The function returns a string with a static lifetime, so you do not need to manage memory for the returned value. If the `setting_id` does not match any known setting, the function returns "unknown".
- **Inputs**:
    - `setting_id`: An unsigned integer representing the HTTP/2 setting ID. Valid values are specific constants defined for HTTP/2 settings, such as `FD_H2_SETTINGS_HEADER_TABLE_SIZE`. If the value does not correspond to a known setting, the function returns "unknown".
- **Output**: A constant character pointer to a static string representing the name of the HTTP/2 setting. The string is in uppercase and has a static lifetime.
- **See Also**: [`fd_h2_setting_name`](<fd_h2_proto.c.md#fd_h2_setting_name>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)