<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines structures and functions for flow-controlled transmission operations in HTTP/2.

# Purpose
The `fd_h2_tx.h` file is a C header file that facilitates flow-controlled transmission (TX) operations in an HTTP/2 context. It includes the `fd_h2_proto.h` header and defines a structure `fd_h2_tx_op` to represent a transmission operation, which includes a data chunk, its size, and a flag indicating the end of a stream. The file provides a static inline function `fd_h2_tx_op_init` to initialize a transmission operation, setting up the data chunk and handling the end-of-stream flag. Additionally, it declares the function [`fd_h2_tx_op_copy`](<#fd_h2_tx_op_copy>), which manages the copying of enqueued transmission data to a buffer, adjusting the operation's state based on buffer capacity and transmission quotas. The file is structured to allow for potential future enhancements, such as a sendmsg-gather API for efficient transmission of multiple frames.
# Imports and Dependencies

---
- `fd_h2_proto.h`


# Data Structures

---
### fd\_h2\_tx\_op
- **Type**: ``struct``
- **Members**:
    - `chunk`: A pointer to the buffer that contains the data to send.
    - `chunk_sz`: The size of the data chunk in bytes.
    - `fin`: A flag that indicates if the stream should close after sending the data.
- **Description**: Manages the transmission of a data chunk in a flow-controlled environment, with the ability to signal the end of a stream.


---
### fd\_h2\_tx\_op\_t
- **Type**: ``struct``
- **Members**:
    - ``chunk``: A pointer to the buffer that contains the data to send.
    - ``chunk_sz``: The size of the data chunk in bytes.
    - ``fin``: A flag indicating if the stream should close after sending the data.
- **Description**: Facilitates flow-controlled transmission operations by holding information about a data chunk to send, its size, and a flag to indicate if the stream should close after transmission.


# Function Declarations (Public API)

---
### fd\_h2\_tx\_op\_copy<!-- {{#callable_declaration:fd_h2_tx_op_copy}} -->
[View Source →](<../../../../../src/waltz/h2/fd_h2_tx.h#L42>)

Copies enqueued transmission data to the transmission buffer.
- **Description**: Use this function to transfer as much data as possible from the enqueued transmission operation to the transmission buffer, while respecting flow control limits. It advances the data pointer and reduces the remaining data size in the transmission operation. The function stops copying when the transmission buffer is full, or when the connection or stream transmission quotas are exhausted, or when there is no more data to send. Ensure the stream is in an open or closing state before calling this function.
- **Inputs**:
    - `conn`: A pointer to an `fd_h2_conn_t` structure representing the connection. Must not be null. The function uses this to check and update the connection's transmission window.
    - `stream`: A pointer to an `fd_h2_stream_t` structure representing the stream. Must not be null. The stream must be in an open or closing state; otherwise, the function returns without copying data.
    - `rbuf_tx`: A pointer to an `fd_h2_rbuf_t` structure representing the transmission buffer. Must not be null. The function writes data to this buffer.
    - `tx_op`: A pointer to an `fd_h2_tx_op_t` structure representing the transmission operation. Must not be null. The function advances the data pointer and reduces the remaining data size in this structure.
- **Output**: None
- **See Also**: [`fd_h2_tx_op_copy`](<fd_h2_tx.c.md#fd_h2_tx_op_copy>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)