<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Tests the functionality of network device management using netlink in the Firedancer codebase.

# Purpose
This code is an executable C program that initializes and manages a network device table using shared memory. It begins by setting up the environment and parsing command-line arguments to configure parameters such as page size, page count, NUMA index, device count, and bond count. The program uses these parameters to create a shared memory workspace and allocate memory for a network device table. It then initializes the table and a netlink interface to load network device information.

The program checks for errors at various stages, such as unsupported page sizes or invalid device counts, and logs messages accordingly. After successfully loading the network device information into the table, it outputs the interface table to standard error. Finally, the program cleans up by finalizing the netlink interface, deallocating the network device table, and deleting the shared memory workspace before exiting. This code is intended to be run as a standalone application and does not define public APIs or external interfaces for use by other programs.
# Imports and Dependencies

---
- `stdio.h`
- `fd_netdev_netlink.h`
- `../../util/fd_util.h`


# Functions

---
### main<!-- {{#callable:main}} -->
[View Source →](<../../../../../src/waltz/mib/test_netdev_netlink.c#L5>)

Initializes the environment, processes command-line arguments, creates a workspace, manages network device tables, and cleans up resources before exiting.
- **Inputs**:
    - `argc`: The number of command-line arguments.
    - `argv`: An array of strings representing the command-line arguments.
- **Logic and Control Flow**:
    - Calls `fd_boot` to initialize the environment with command-line arguments.
    - Determines the CPU index using `fd_tile_cpu_id` and `fd_tile_idx`, and adjusts it if necessary.
    - Extracts command-line arguments for page size, page count, NUMA index, device count, and bond count using `fd_env_strip_cmdline_cstr` and `fd_env_strip_cmdline_ulong`.
    - Converts the page size string to an unsigned long using `fd_cstr_to_shmem_page_sz` and checks for validity.
    - Logs an error and exits if the page size, device count, or bond count is unsupported.
    - Logs the creation of a workspace and creates it using `fd_wksp_new_anonymous`.
    - Calculates the footprint of the network device table using [`fd_netdev_tbl_footprint`](<fd_netdev_tbl.c.md#fd_netdev_tbl_footprint>) and checks for validity.
    - Allocates memory for the network device table in the workspace using `fd_wksp_alloc_laddr`.
    - Creates and joins the network device table using [`fd_netdev_tbl_new`](<fd_netdev_tbl.c.md#fd_netdev_tbl_new>) and [`fd_netdev_tbl_join`](<fd_netdev_tbl.h.md#fd_netdev_tbl_join>).
    - Initializes a netlink object using `fd_netlink_init`.
    - Loads the network device table with interfaces using [`fd_netdev_netlink_load_table`](<fd_netdev_netlink.c.md#fd_netdev_netlink_load_table>) and logs a warning if it fails.
    - Logs the interface table using [`fd_netdev_tbl_fprintf`](<fd_netdev_tbl.c.md#fd_netdev_tbl_fprintf>) and flushes the log.
    - Finalizes the netlink object, leaves the network device table, frees allocated memory, and deletes the workspace.
    - Logs a notice of successful execution and calls `fd_halt` before returning 0.
- **Output**: Returns 0 to indicate successful execution.
- **Functions Called**:
    - [`fd_netdev_tbl_footprint`](<fd_netdev_tbl.c.md#fd_netdev_tbl_footprint>)
    - [`fd_netdev_tbl_align`](<fd_netdev_tbl.c.md#fd_netdev_tbl_align>)
    - [`fd_netdev_tbl_new`](<fd_netdev_tbl.c.md#fd_netdev_tbl_new>)
    - [`fd_netdev_tbl_join`](<fd_netdev_tbl.h.md#fd_netdev_tbl_join>)
    - [`fd_netdev_netlink_load_table`](<fd_netdev_netlink.c.md#fd_netdev_netlink_load_table>)
    - [`fd_netdev_tbl_fprintf`](<fd_netdev_tbl.c.md#fd_netdev_tbl_fprintf>)
    - [`fd_netdev_tbl_leave`](<fd_netdev_tbl.c.md#fd_netdev_tbl_leave>)
    - [`fd_netdev_tbl_delete`](<fd_netdev_tbl.c.md#fd_netdev_tbl_delete>)



---
Made with ❤️ by [Driver](https://www.driver.ai/)