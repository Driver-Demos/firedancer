<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines data structures and functions for network database operations, including address resolution.

# Purpose
This C header file defines structures, constants, and function prototypes for network database operations. It includes the `fd_addrinfo` structure, which holds information about network addresses, such as flags, family, protocol, address length, address, canonical name, and a pointer to the next address info. The file defines several constants for address info flags and error codes, such as `FD_AI_PASSIVE` and `FD_EAI_BADFLAGS`. It also declares the `fd_netdb_fds` structure to manage file descriptors for `/etc/hosts` and `/etc/resolv.conf`. The file provides prototypes for functions like `fd_netdb_open_fds`, which opens and registers these file descriptors, [`fd_getaddrinfo`](<#fd_getaddrinfo>), which resolves network addresses, and [`fd_gai_strerror`](<#fd_gai_strerror>), which returns error descriptions for [`fd_getaddrinfo`](<#fd_getaddrinfo>) return values.
# Imports and Dependencies

---
- `../../util/fd_util_base.h`


# Data Structures

---
### fd\_addrinfo\_t
- **Type**: ``struct``
- **Members**:
    - `ai_flags`: An integer that specifies options for the address lookup.
    - `ai_family`: An integer that specifies the address family.
    - `ai_protocol`: An integer that specifies the protocol for the socket.
    - `ai_addrlen`: An unsigned integer that specifies the length of the socket address.
    - `ai_addr`: A pointer to a `sockaddr` structure that contains the socket address.
    - `ai_canonname`: A pointer to a character string that contains the canonical name of the host.
    - `ai_next`: A pointer to the next `fd_addrinfo_t` structure in the list.
- **Description**: Defines a structure for storing address information used in network operations, including flags, address family, protocol, address length, socket address, canonical name, and a pointer to the next address info structure.


---
### fd\_addrinfo
- **Type**: ``struct``
- **Members**:
    - `ai_flags`: An integer that specifies options for the address lookup.
    - `ai_family`: An integer that specifies the address family (e.g., AF_INET).
    - `ai_protocol`: An integer that specifies the protocol for the socket.
    - `ai_addrlen`: An unsigned integer that specifies the length of the address.
    - `ai_addr`: A pointer to a `sockaddr` structure that contains the address.
    - `ai_canonname`: A pointer to a string that contains the canonical name of the host.
    - `ai_next`: A pointer to the next `fd_addrinfo` structure in the list.
- **Description**: Represents address information used for network communication, including flags, address family, protocol, address length, address, canonical name, and a pointer to the next address information structure in a linked list.


---
### fd\_netdb\_fds
- **Type**: ``struct``
- **Members**:
    - `etc_hosts`: Stores the file descriptor for the `/etc/hosts` file.
    - `etc_resolv_conf`: Stores the file descriptor for the `/etc/resolv.conf` file.
- **Description**: Holds file descriptors for the `/etc/hosts` and `/etc/resolv.conf` files, which are used to avoid repeated system calls when accessing these files.


---
### fd\_netdb\_fds\_t
- **Type**: ``struct``
- **Members**:
    - `etc_hosts`: File descriptor for the `/etc/hosts` file.
    - `etc_resolv_conf`: File descriptor for the `/etc/resolv.conf` file.
- **Description**: Holds file descriptors for the `/etc/hosts` and `/etc/resolv.conf` files, which are used to avoid repeated open system calls when performing network address resolution.


# Function Declarations (Public API)

---
### fd\_getaddrinfo<!-- {{#callable_declaration:fd_getaddrinfo}} -->
[View Source →](<../../../../../src/waltz/resolv/fd_netdb.h#L51>)

Resolves a host name to address information.
- **Description**: Use this function to obtain address information for a given host name, optionally using hints to specify desired address types and flags. It is important to ensure that the `host` parameter is not null, as this will result in an error. The function populates the `res` parameter with a linked list of address information structures. Ensure that the `out_mem` parameter points to a memory buffer that is large enough to hold the results, as specified by `out_max`. If the buffer is too small, the function will return an error. This function is thread-local and should be used after opening necessary file descriptors with `fd_netdb_open_fds`.
- **Inputs**:
    - `host`: A pointer to a null-terminated string containing the host name to resolve. Must not be null. If null, the function returns `FD_EAI_NONAME`.
    - `hint`: A pointer to a `fd_addrinfo_t` structure containing hints about the type of socket the caller supports. Can be null. If provided, the `ai_family` and `ai_flags` fields are used to filter results.
    - `res`: A pointer to a pointer that will be set to the head of a linked list of `fd_addrinfo_t` structures containing the address information. Must not be null.
    - `pout`: A pointer to a memory buffer pointer where the function will store the address information. Must not be null and must point to a buffer with at least `out_max` bytes available.
    - `out_max`: The maximum number of bytes available in the buffer pointed to by `pout`. Must be large enough to store the results, or the function will return `FD_EAI_MEMORY`.
- **Output**: Returns 0 on success. On failure, returns a negative error code such as `FD_EAI_NONAME`, `FD_EAI_BADFLAGS`, `FD_EAI_FAMILY`, or `FD_EAI_MEMORY`.
- **See Also**: [`fd_getaddrinfo`](<fd_getaddrinfo.c.md#fd_getaddrinfo>)  (Implementation)


---
### fd\_gai\_strerror<!-- {{#callable_declaration:fd_gai_strerror}} -->
[View Source →](<../../../../../src/waltz/resolv/fd_netdb.h#L61>)

Returns a string describing a `fd_getaddrinfo` error code.
- **Description**: Use this function to obtain a human-readable string that describes the error code returned by `fd_getaddrinfo`. This function is useful for logging or displaying error messages to users. It handles both standard error codes and system-specific errors. The function returns a static string, so there is no need to manage memory for the returned value.
- **Inputs**:
    - `gai`: An integer representing the error code from `fd_getaddrinfo`. Valid values include predefined error codes such as `FD_EAI_BADFLAGS`, `FD_EAI_NONAME`, `FD_EAI_AGAIN`, `FD_EAI_FAIL`, `FD_EAI_NODATA`, `FD_EAI_FAMILY`, `FD_EAI_MEMORY`, and system errors indicated by values less than or equal to `FD_EAI_SYSTEM`. If the value is not recognized, the function returns "unknown error".
- **Output**: A constant character pointer to a static string describing the error. The caller must not modify or free this string.
- **See Also**: [`fd_gai_strerror`](<fd_getaddrinfo.c.md#fd_gai_strerror>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)