<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Header file for managing RocksDB-based backtesting, including initialization and data retrieval functions.

# Purpose
This C header file defines the interface for managing a RocksDB-based backtesting system. It includes the necessary function prototypes and type definitions for operations related to the `fd_backtest_rocksdb_t` structure, which represents a private data structure for handling backtesting data. The file provides function declarations for memory alignment ([`fd_backtest_rocksdb_align`](<#fd_backtest_rocksdb_align>)), memory footprint calculation ([`fd_backtest_rocksdb_footprint`](<#fd_backtest_rocksdb_footprint>)), and creating a new backtesting instance ([`fd_backtest_rocksdb_new`](<#fd_backtest_rocksdb_new>)). It also includes functions for joining an existing database ([`fd_backtest_rocksdb_join`](<#fd_backtest_rocksdb_join>)), initializing the database ([`fd_backtest_rocksdb_init`](<#fd_backtest_rocksdb_init>)), retrieving the next root slot ([`fd_backtest_rocksdb_next_root_slot`](<#fd_backtest_rocksdb_next_root_slot>)), accessing shreds ([`fd_backtest_rocksdb_shred`](<#fd_backtest_rocksdb_shred>)), and obtaining bank hashes ([`fd_backtest_rocksdb_bank_hash`](<#fd_backtest_rocksdb_bank_hash>)). The header uses a magic number `FD_BACKTEST_ROCKSDB_MAGIC` to identify the version of the backtesting system.
# Imports and Dependencies

---
- `../../util/fd_util_base.h`


# Data Structures

---
### fd\_backtest\_rocksdb\_t
- **Type**: ``struct``
- **Members**:
    - ``fd_backtest_rocksdb_private``: A forward declaration for a private structure used internally.
- **Description**: The `fd_backtest_rocksdb_t` is a typedef for a private structure `fd_backtest_rocksdb_private`, which is used in the context of backtesting with RocksDB. The structure is part of a header file that provides function prototypes for operations such as alignment, footprint calculation, initialization, and data retrieval related to RocksDB in a backtesting environment.


# Function Declarations (Public API)

---
### fd\_backtest\_rocksdb\_align<!-- {{#callable_declaration:fd_backtest_rocksdb_align}} -->
[View Source →](<../../../../../src/discof/backtest/fd_backtest_rocksdb.h#L11>)

Returns the alignment requirement for `fd_backtest_rocksdb_t`.
- **Description**: Use this function to obtain the alignment requirement for the `fd_backtest_rocksdb_t` type. This is useful when allocating memory for instances of this type to ensure proper alignment. The function does not require any parameters and can be called at any time.
- **Inputs**: None
- **Output**: The function returns an `ulong` representing the alignment requirement for `fd_backtest_rocksdb_t`.
- **See Also**: [`fd_backtest_rocksdb_align`](<fd_backtest_rocksdb.c.md#fd_backtest_rocksdb_align>)  (Implementation)


---
### fd\_backtest\_rocksdb\_footprint<!-- {{#callable_declaration:fd_backtest_rocksdb_footprint}} -->
[View Source →](<../../../../../src/discof/backtest/fd_backtest_rocksdb.h#L16>)

Returns the memory footprint of the RocksDB backtest structure.
- **Description**: Use this function to determine the size, in bytes, of the `fd_backtest_rocksdb_t` structure. This information is useful for memory allocation purposes when working with the RocksDB backtest component. The function does not require any parameters and can be called at any time to retrieve the constant size of the structure.
- **Inputs**: None
- **Output**: The function returns an `ulong` representing the size of the `fd_backtest_rocksdb_t` structure in bytes.
- **See Also**: [`fd_backtest_rocksdb_footprint`](<fd_backtest_rocksdb.c.md#fd_backtest_rocksdb_footprint>)  (Implementation)


---
### fd\_backtest\_rocksdb\_new<!-- {{#callable_declaration:fd_backtest_rocksdb_new}} -->
[View Source →](<../../../../../src/discof/backtest/fd_backtest_rocksdb.h#L19>)

Creates a new read-only RocksDB instance in shared memory.
- **Description**: Use this function to initialize a new read-only RocksDB instance in a specified shared memory region. The shared memory must be properly aligned according to the alignment requirements of the database. This function sets up the database with predefined column families and read options. It is important to ensure that the `shmem` parameter is not null and is correctly aligned before calling this function. If the initialization fails due to a null or misaligned `shmem`, or if the database cannot be opened, the function returns null.
- **Inputs**:
    - `shmem`: A pointer to the shared memory region where the RocksDB instance will be created. Must not be null and must be aligned according to `fd_backtest_rocksdb_align()`. If null or misaligned, the function returns null.
    - `path`: A constant character pointer to the file system path where the RocksDB database is located. This path is used to open the database in read-only mode.
- **Output**: Returns a pointer to the initialized RocksDB instance on success, or null if an error occurs.
- **See Also**: [`fd_backtest_rocksdb_new`](<fd_backtest_rocksdb.c.md#fd_backtest_rocksdb_new>)  (Implementation)


---
### fd\_backtest\_rocksdb\_join<!-- {{#callable_declaration:fd_backtest_rocksdb_join}} -->
[View Source →](<../../../../../src/discof/backtest/fd_backtest_rocksdb.h#L23>)

Joins a shared memory region as a RocksDB instance.
- **Description**: Use this function to join a shared memory region that represents a RocksDB instance. The function checks if the provided pointer is non-null, properly aligned, and has the correct magic number. If any of these checks fail, it logs a warning and returns null. This function is typically called after creating or initializing a shared memory region with RocksDB data.
- **Inputs**:
    - `shdb`: A pointer to the shared memory region to join. Must not be null, must be aligned according to `fd_backtest_rocksdb_align()`, and must have the correct magic number `FD_BACKTEST_ROCKSDB_MAGIC`. If these conditions are not met, the function logs a warning and returns null.
- **Output**: Returns a pointer to `fd_backtest_rocksdb_t` if successful, or null if the input is invalid.
- **See Also**: [`fd_backtest_rocksdb_join`](<fd_backtest_rocksdb.c.md#fd_backtest_rocksdb_join>)  (Implementation)


---
### fd\_backtest\_rocksdb\_init<!-- {{#callable_declaration:fd_backtest_rocksdb_init}} -->
[View Source →](<../../../../../src/discof/backtest/fd_backtest_rocksdb.h#L26>)

Initializes the RocksDB iterator to a specific root slot.
- **Description**: Use this function to set the position of the RocksDB iterator to the specified root slot. This function must be called before any operations that depend on the iterator's position. It ensures that the iterator is valid after seeking to the given root slot. Call this function when you need to start processing from a specific root slot in the database.
- **Inputs**:
    - `db`: A pointer to an `fd_backtest_rocksdb_t` structure. This must not be null and must point to a valid RocksDB instance.
    - `root_slot`: An unsigned long integer representing the root slot to which the iterator should be set. The function will handle the necessary byte swapping for this value.
- **Output**: None
- **See Also**: [`fd_backtest_rocksdb_init`](<fd_backtest_rocksdb.c.md#fd_backtest_rocksdb_init>)  (Implementation)


---
### fd\_backtest\_rocksdb\_next\_root\_slot<!-- {{#callable_declaration:fd_backtest_rocksdb_next_root_slot}} -->
[View Source →](<../../../../../src/discof/backtest/fd_backtest_rocksdb.h#L30>)

Retrieve the next root slot and shred count from the RocksDB iterator.
- **Description**: Use this function to get the next root slot and its associated shred count from a RocksDB database iterator. It must be called with a valid `fd_backtest_rocksdb_t` object that has been properly initialized. The function advances the iterator and retrieves the data for the next root slot. If the iterator is not valid, the function returns 0, indicating no more data is available. Ensure that `root_slot` and `shred_cnt` are valid pointers to store the retrieved values.
- **Inputs**:
    - `db`: A pointer to an `fd_backtest_rocksdb_t` object. Must not be null and must be initialized before use.
    - `root_slot`: A pointer to an `ulong` where the function will store the next root slot value. Must not be null.
    - `shred_cnt`: A pointer to an `ulong` where the function will store the shred count associated with the root slot. Must not be null.
- **Output**: Returns 1 if a root slot and shred count are successfully retrieved, or 0 if the iterator is not valid.
- **See Also**: [`fd_backtest_rocksdb_next_root_slot`](<fd_backtest_rocksdb.c.md#fd_backtest_rocksdb_next_root_slot>)  (Implementation)


---
### fd\_backtest\_rocksdb\_shred<!-- {{#callable_declaration:fd_backtest_rocksdb_shred}} -->
[View Source →](<../../../../../src/discof/backtest/fd_backtest_rocksdb.h#L35>)

Retrieves a shred from the RocksDB database.
- **Description**: Use this function to get a shred from the specified slot and shred index in the RocksDB database. The function requires a valid database handle and specific slot and shred index values. It returns a pointer to the shred data if successful. Ensure that the database is properly initialized and joined before calling this function. Handle any potential errors that may occur during the retrieval process.
- **Inputs**:
    - `db`: A pointer to an `fd_backtest_rocksdb_t` structure representing the database. Must not be null and should be initialized and joined before use.
    - `slot`: An unsigned long integer representing the slot number. Must be a valid slot in the database.
    - `shred_idx`: An unsigned long integer representing the shred index within the slot. Must be a valid index for the specified slot.
- **Output**: A pointer to the shred data if successful. The function logs an error and does not return if the retrieval fails.
- **See Also**: [`fd_backtest_rocksdb_shred`](<fd_backtest_rocksdb.c.md#fd_backtest_rocksdb_shred>)  (Implementation)


---
### fd\_backtest\_rocksdb\_bank\_hash<!-- {{#callable_declaration:fd_backtest_rocksdb_bank_hash}} -->
[View Source →](<../../../../../src/discof/backtest/fd_backtest_rocksdb.h#L40>)

Retrieves the bank hash for a given slot from the RocksDB database.
- **Description**: Use this function to obtain the bank hash associated with a specific slot from the RocksDB database. The function requires a valid database handle and a slot number as inputs. It retrieves the bank hash data and returns a pointer to the hash. Ensure that the database is properly initialized and joined before calling this function. Handle any potential errors that may arise from the database operations.
- **Inputs**:
    - `db`: A pointer to an `fd_backtest_rocksdb_t` structure representing the database. Must not be null and should be a valid, initialized database handle.
    - `slot`: An unsigned long integer representing the slot number for which the bank hash is requested. Must be a valid slot number within the database.
- **Output**: Returns a pointer to an unsigned char array containing the bank hash for the specified slot.
- **See Also**: [`fd_backtest_rocksdb_bank_hash`](<fd_backtest_rocksdb.c.md#fd_backtest_rocksdb_bank_hash>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)