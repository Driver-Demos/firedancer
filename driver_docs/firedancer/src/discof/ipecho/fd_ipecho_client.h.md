<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines the interface for an IP echo client, including initialization and polling functions.

# Purpose
This C header file defines the interface for an IP echo client within the Firedancer project. It includes necessary network headers and defines constants such as `FD_IPECHO_CLIENT_ALIGN` for memory alignment and `FD_IPECHO_CLIENT_MAGIC` as a unique identifier. The file declares a private structure `fd_ipecho_client_t` and provides function prototypes for managing the lifecycle and operations of an IP echo client. These functions include [`fd_ipecho_client_new`](<#fd_ipecho_client_new>) for creating a new client, [`fd_ipecho_client_join`](<#fd_ipecho_client_join>) for joining an existing client, [`fd_ipecho_client_init`](<#fd_ipecho_client_init>) for initializing the client with server information, and [`fd_ipecho_client_poll`](<#fd_ipecho_client_poll>) for polling the client. Additionally, it provides a function to retrieve poll file descriptors with [`fd_ipecho_client_get_pollfds`](<#fd_ipecho_client_get_pollfds>).
# Imports and Dependencies

---
- `../../util/net/fd_net_headers.h`


# Data Structures

---
### fd\_ipecho\_client\_t
- **Type**: ``struct``
- **Members**:
    - ``fd_ipecho_client_private``: A forward declaration for a private structure used internally by the `fd_ipecho_client_t` type.
- **Description**: The `fd_ipecho_client_t` is a typedef for a forward-declared private structure `fd_ipecho_client_private`, which is used in the context of the Firedancer IPECHO client. This structure is part of a network utility that likely involves operations related to IP echo services, as suggested by the function declarations that manage memory alignment, footprint, initialization, and polling of the client.


# Function Declarations (Public API)

---
### fd\_ipecho\_client\_align<!-- {{#callable_declaration:fd_ipecho_client_align}} -->
[View Source →](<../../../../../src/discof/ipecho/fd_ipecho_client.h#L13>)

Returns the alignment requirement for the `fd_ipecho_client_t` type.
- **Description**: Use this function to obtain the alignment requirement for the `fd_ipecho_client_t` type. This is necessary when allocating memory for instances of this type to ensure proper alignment. The function does not require any parameters and can be called at any time.
- **Inputs**: None
- **Output**: The function returns an `ulong` representing the alignment requirement for the `fd_ipecho_client_t` type.
- **See Also**: [`fd_ipecho_client_align`](<fd_ipecho_client.c.md#fd_ipecho_client_align>)  (Implementation)


---
### fd\_ipecho\_client\_footprint<!-- {{#callable_declaration:fd_ipecho_client_footprint}} -->
[View Source →](<../../../../../src/discof/ipecho/fd_ipecho_client.h#L16>)

Returns the memory footprint of the client structure.
- **Description**: Use this function to determine the size of memory required to store an `fd_ipecho_client_t` structure. This is useful when allocating memory for the client structure. The function does not require any parameters and can be called at any time.
- **Inputs**: None
- **Output**: Returns the size in bytes of the `fd_ipecho_client_t` structure as an unsigned long integer.
- **See Also**: [`fd_ipecho_client_footprint`](<fd_ipecho_client.c.md#fd_ipecho_client_footprint>)  (Implementation)


---
### fd\_ipecho\_client\_new<!-- {{#callable_declaration:fd_ipecho_client_new}} -->
[View Source →](<../../../../../src/discof/ipecho/fd_ipecho_client.h#L19>)

Creates a new IP echo client in shared memory.
- **Description**: Use this function to initialize a new IP echo client in a provided shared memory region. The shared memory must be correctly aligned and non-null. This function sets up the client by writing a magic number to the memory, which identifies it as an IP echo client. Call this function before any other operations on the client. If the shared memory is null or misaligned, the function logs a warning and returns null.
- **Inputs**:
    - `shmem`: A pointer to a shared memory region where the IP echo client will be created. Must not be null and must be aligned to the value returned by `fd_ipecho_client_align()`. The caller retains ownership of the memory.
- **Output**: Returns a pointer to the initialized IP echo client on success, or null if the input is invalid.
- **See Also**: [`fd_ipecho_client_new`](<fd_ipecho_client.c.md#fd_ipecho_client_new>)  (Implementation)


---
### fd\_ipecho\_client\_join<!-- {{#callable_declaration:fd_ipecho_client_join}} -->
[View Source →](<../../../../../src/discof/ipecho/fd_ipecho_client.h#L22>)

Joins a shared memory region as an IP echo client.
- **Description**: Use this function to join a shared memory region that represents an IP echo client. The shared memory pointer must be non-null, aligned to the required boundary, and initialized with the correct magic number. This function is typically called after the shared memory has been set up and initialized. If the input does not meet these conditions, the function logs a warning and returns NULL.
- **Inputs**:
    - `shipe`: A pointer to the shared memory region to join. Must not be null, must be aligned to `fd_ipecho_client_align()`, and must have been initialized with the magic number `FD_IPECHO_CLIENT_MAGIC`. If these conditions are not met, the function returns NULL.
- **Output**: Returns a pointer to `fd_ipecho_client_t` if successful, or NULL if the input is invalid.
- **See Also**: [`fd_ipecho_client_join`](<fd_ipecho_client.c.md#fd_ipecho_client_join>)  (Implementation)


---
### fd\_ipecho\_client\_init<!-- {{#callable_declaration:fd_ipecho_client_init}} -->
[View Source →](<../../../../../src/discof/ipecho/fd_ipecho_client.h#L25>)

Initializes a client for connecting to multiple servers.
- **Description**: Use this function to set up a client structure to connect to a list of servers. The function attempts to establish non-blocking connections to each server in the provided list. It initializes the client's internal state to track these connections. The function must be called before using the client for any operations. Ensure that the `client` parameter points to a valid, allocated structure and that `servers` is a valid array of server addresses and ports. The function handles up to 16 servers, and any additional servers in the list are ignored. Connections that cannot be established immediately are retried later.
- **Inputs**:
    - `client`: A pointer to a `fd_ipecho_client_t` structure. Must not be null and must point to a valid, allocated structure. The function initializes this structure.
    - `servers`: A pointer to an array of `fd_ip4_port_t` structures, each representing a server's IP address and port. Must not be null.
    - `servers_len`: The number of servers in the `servers` array. Must be a non-negative integer. Only the first 16 servers are considered.
- **Output**: None
- **See Also**: [`fd_ipecho_client_init`](<fd_ipecho_client.c.md#fd_ipecho_client_init>)  (Implementation)


---
### fd\_ipecho\_client\_poll<!-- {{#callable_declaration:fd_ipecho_client_poll}} -->
[View Source →](<../../../../../src/discof/ipecho/fd_ipecho_client.h#L30>)

Polls the client for network events and processes them.
- **Description**: Use this function to poll a client for network events and process any available data. It must be called after the client is initialized and joined. The function checks for available network events and processes them accordingly. If no events are available, or if an interrupt occurs, it returns a specific value. The function also updates the `charge_busy` flag to indicate activity. If the client has no remaining peers or if a timeout occurs, it returns an error.
- **Inputs**:
    - `client`: A pointer to an `fd_ipecho_client_t` structure. Must not be null and must point to a valid, initialized client object.
    - `shred_version`: A pointer to a `ushort` where the function stores the shred version if a read event occurs. Must not be null.
    - `charge_busy`: A pointer to an `int` that the function sets to 1 if any network activity is detected. Must not be null.
- **Output**: Returns 1 if network events are processed or if interrupted, 0 if a read event completes successfully, and -1 if an error occurs or if there are no remaining peers.
- **See Also**: [`fd_ipecho_client_poll`](<fd_ipecho_client.c.md#fd_ipecho_client_poll>)  (Implementation)


---
### fd\_ipecho\_client\_get\_pollfds<!-- {{#callable_declaration:fd_ipecho_client_get_pollfds}} -->
[View Source →](<../../../../../src/discof/ipecho/fd_ipecho_client.h#L35>)

Retrieves the poll file descriptors for the client.
- **Description**: Use this function to obtain a constant pointer to the array of poll file descriptors associated with the specified client. This is useful for monitoring multiple file descriptors to see if I/O is possible on any of them. Ensure that the client is properly initialized before calling this function. The returned pointer should not be modified, and the caller must not free it.
- **Inputs**:
    - `client`: A pointer to an `fd_ipecho_client_t` structure. This must be a valid, non-null pointer to a client that has been initialized. Passing a null or uninitialized pointer results in undefined behavior.
- **Output**: A constant pointer to an array of `struct pollfd` associated with the client. The caller must not modify or free this pointer.
- **See Also**: [`fd_ipecho_client_get_pollfds`](<fd_ipecho_client.c.md#fd_ipecho_client_get_pollfds>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)