<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Implements functions for managing and manipulating a reassembly data structure, including memory alignment, initialization, and tree operations.

# Purpose
The code is a C source file that implements a reassembly module for handling Forward Error Correction (FEC) data structures. It provides functions to manage and manipulate a reassembly object, which is used to reconstruct data from FEC packets. The module includes functions to create, join, leave, and delete reassembly objects, as well as to insert, query, and publish FEC data. The code defines several key functions such as [`fd_reasm_new`](<#fd_reasm_new>), [`fd_reasm_join`](<#fd_reasm_join>), [`fd_reasm_insert`](<#fd_reasm_insert>), and [`fd_reasm_publish`](<#fd_reasm_publish>), which are responsible for initializing, managing, and updating the state of the reassembly process.

The module uses various data structures and helper functions to manage the relationships between FEC packets, such as ancestry, frontier, orphaned, and subtrees. It also includes mechanisms to handle cases where the chained merkle root metadata might be incorrect, ensuring the integrity of the reassembly process. The code is designed to be part of a larger system, as indicated by the inclusion of headers like `fd_reasm.h` and `fd_reasm_private.h`, and it provides a public API for interacting with the reassembly functionality. The module also includes logging and debugging features to assist in monitoring and troubleshooting the reassembly process.
# Imports and Dependencies

---
- `fd_reasm.h`
- `fd_reasm_private.h`
- `stdio.h`


# Functions

---
### fd\_reasm\_align<!-- {{#callable:fd_reasm_align}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L6>)

Returns the alignment requirement of the `fd_reasm_t` type.
- **Inputs**: None
- **Logic and Control Flow**:
    - Calls the `alignof` operator on `fd_reasm_t` to determine its alignment requirement.
    - Returns the result of the `alignof` operator.
- **Output**: The alignment requirement of the `fd_reasm_t` type as an `ulong`.


---
### fd\_reasm\_footprint<!-- {{#callable:fd_reasm_footprint}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L11>)

Calculates the memory footprint required for a reassembly structure based on the maximum number of FEC (Forward Error Correction) blocks.
- **Inputs**:
    - `fec_max`: The maximum number of FEC blocks for which the footprint is calculated.
- **Logic and Control Flow**:
    - Calculate `lgf_max` as the most significant bit of the smallest power of two greater than or equal to `fec_max`.
    - Initialize the layout with `FD_LAYOUT_INIT`.
    - Append the alignment and size of `fd_reasm_t` to the layout.
    - Append the alignment and footprint of various components (pool, ancestry, frontier, orphaned, subtrees, bfs, out, slot_mr) to the layout, using `fec_max` or `lgf_max` as needed.
    - Finalize the layout with `fd_reasm_align()`.
- **Output**: Returns the total memory footprint as an unsigned long integer.
- **Functions Called**:
    - [`fd_reasm_align`](<#fd_reasm_align>)


---
### fd\_reasm\_new<!-- {{#callable:fd_reasm_new}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L37>)

Initializes a new reassembly structure in shared memory with specified parameters.
- **Inputs**:
    - `shmem`: Pointer to shared memory where the reassembly structure will be initialized.
    - `fec_max`: Maximum number of Forward Error Correction (FEC) elements.
    - `seed`: Seed value for initializing certain components of the reassembly structure.
- **Logic and Control Flow**:
    - Check if `shmem` is NULL; if so, log a warning and return NULL.
    - Check if `shmem` is aligned according to [`fd_reasm_align`](<#fd_reasm_align>); if not, log a warning and return NULL.
    - Calculate the memory footprint required using [`fd_reasm_footprint`](<#fd_reasm_footprint>) with `fec_max`; if zero, log a warning and return NULL.
    - Verify that `shmem` is part of a workspace using `fd_wksp_containing`; if not, log a warning and return NULL.
    - Clear the memory at `shmem` with the calculated footprint using `fd_memset`.
    - Calculate `lgf_max` as the most significant bit of the next power of two of `fec_max`.
    - Initialize various components of the reassembly structure using `FD_SCRATCH_ALLOC_APPEND` for memory allocation.
    - Set initial values for the reassembly structure fields, including `slot0`, `root`, and others using helper functions like `pool_new`, `ancestry_new`, etc.
    - Return the pointer to `shmem` after successful initialization.
- **Output**: Returns a pointer to the initialized shared memory (`shmem`) or NULL if initialization fails.
- **Functions Called**:
    - [`fd_reasm_align`](<#fd_reasm_align>)
    - [`fd_reasm_footprint`](<#fd_reasm_footprint>)


---
### fd\_reasm\_join<!-- {{#callable:fd_reasm_join}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L94>)

Joins various components of a `fd_reasm_t` structure by invoking specific join functions for each component.
- **Inputs**:
    - `shreasm`: A pointer to a shared memory region that is cast to a `fd_reasm_t` structure.
- **Logic and Control Flow**:
    - Cast `shreasm` to a `fd_reasm_t` pointer named `reasm`.
    - Check if `reasm` is NULL; if so, log a warning and return NULL.
    - Call `pool_join` on `reasm->pool` and update `reasm->pool`.
    - Call `ancestry_join` on `reasm->ancestry` and update `reasm->ancestry`.
    - Call `frontier_join` on `reasm->frontier` and update `reasm->frontier`.
    - Call `orphaned_join` on `reasm->orphaned` and update `reasm->orphaned`.
    - Call `subtrees_join` on `reasm->subtrees` and update `reasm->subtrees`.
    - Call `subtreel_join` on `reasm->_subtrlf` and update `reasm->subtreel`.
    - Call `bfs_join` on `reasm->bfs` and update `reasm->bfs`.
    - Call `out_join` on `reasm->out` and update `reasm->out`.
    - Call `slot_mr_join` on `reasm->slot_mr` and update `reasm->slot_mr`.
    - Return the updated `reasm` pointer.
- **Output**: A pointer to the updated `fd_reasm_t` structure, or NULL if the input was invalid.


---
### fd\_reasm\_leave<!-- {{#callable:fd_reasm_leave}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L116>)

Returns the input `fd_reasm_t` pointer if it is not NULL, otherwise logs a warning and returns NULL.
- **Inputs**:
    - `reasm`: A pointer to an `fd_reasm_t` structure, which represents a reassembly context.
- **Logic and Control Flow**:
    - Checks if the `reasm` pointer is NULL using `FD_UNLIKELY`.
    - If `reasm` is NULL, logs a warning message 'NULL reasm' and returns NULL.
    - If `reasm` is not NULL, casts it to a `void *` and returns it.
- **Output**: A `void *` pointer to the `fd_reasm_t` structure if it is not NULL, otherwise NULL.


---
### fd\_reasm\_delete<!-- {{#callable:fd_reasm_delete}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L127>)

Validates and returns a pointer to a reassembly object if it is non-null and properly aligned.
- **Inputs**:
    - `shreasm`: A pointer to a shared reassembly object (`fd_reasm_t`).
- **Logic and Control Flow**:
    - Cast `shreasm` to a `fd_reasm_t` pointer named `reasm`.
    - Check if `reasm` is NULL; if so, log a warning and return NULL.
    - Check if `reasm` is aligned according to `fd_reasm_align()`; if not, log a warning and return NULL.
    - Return the `reasm` pointer.
- **Output**: Returns the `fd_reasm_t` pointer if it is valid and aligned, otherwise returns NULL.
- **Functions Called**:
    - [`fd_reasm_align`](<#fd_reasm_align>)


---
### fd\_reasm\_root<!-- {{#callable:fd_reasm_root}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L144>)

Retrieves the root element from the pool in a reassembly context.
- **Inputs**:
    - `reasm`: A pointer to a `fd_reasm_t` structure, which contains the pool and root information.
- **Logic and Control Flow**:
    - Accesses the `pool` and `root` members of the `reasm` structure.
    - Calls the `pool_ele` function with `reasm->pool` and `reasm->root` as arguments to retrieve the root element.
- **Output**: Returns a pointer to the `fd_reasm_fec_t` structure representing the root element in the pool.


---
### fd\_reasm\_root\_const<!-- {{#callable:fd_reasm_root_const}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L145>)

Returns a constant pointer to the root element of the reassembly pool.
- **Inputs**:
    - ``reasm``: A constant pointer to an `fd_reasm_t` structure, which contains the reassembly pool and root information.
- **Logic and Control Flow**:
    - Calls the `pool_ele_const` function with `reasm->pool` and `reasm->root` as arguments.
    - Returns the result of the `pool_ele_const` function call.
- **Output**: A constant pointer to an `fd_reasm_fec_t` structure representing the root element of the reassembly pool.


---
### fd\_reasm\_parent<!-- {{#callable:fd_reasm_parent}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L146>)

Retrieves the parent element of a given child element from a pool within a reassembly structure.
- **Inputs**:
    - `reasm`: A pointer to an `fd_reasm_t` structure, which contains the pool from which to retrieve the parent element.
    - `child`: A pointer to an `fd_reasm_fec_t` structure, representing the child element whose parent is to be retrieved.
- **Logic and Control Flow**:
    - Calls the `pool_ele` function with `reasm->pool` and `child->parent` as arguments.
    - Returns the result of the `pool_ele` function call, which is the parent element of the given child.
- **Output**: A pointer to an `fd_reasm_fec_t` structure representing the parent of the given child element.


---
### fd\_reasm\_parent\_const<!-- {{#callable:fd_reasm_parent_const}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L147>)

Retrieves the parent element of a given child element from a pool in a reassembly structure.
- **Inputs**:
    - ``reasm``: A pointer to a constant `fd_reasm_t` structure, representing the reassembly context.
    - ``child``: A pointer to a constant `fd_reasm_fec_t` structure, representing the child element whose parent is to be retrieved.
- **Logic and Control Flow**:
    - Calls the `pool_ele_const` function with the pool from the `reasm` structure and the parent index from the `child` structure.
    - Returns the result of the `pool_ele_const` function call.
- **Output**: A constant pointer to an `fd_reasm_fec_t` structure representing the parent of the given child element.


---
### fd\_reasm\_child<!-- {{#callable:fd_reasm_child}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L148>)

Retrieves the child element of a given parent element from a pool in a reassembly structure.
- **Inputs**:
    - `reasm`: A pointer to an `fd_reasm_t` structure, which contains the pool from which elements are retrieved.
    - `parent`: A pointer to an `fd_reasm_fec_t` structure, representing the parent element whose child is to be retrieved.
- **Logic and Control Flow**:
    - Accesses the `child` field of the `parent` structure to get the index of the child element.
    - Uses the `pool_ele` function to retrieve the child element from the pool using the index obtained from the `parent` structure.
- **Output**: Returns a pointer to the `fd_reasm_fec_t` structure representing the child element of the given parent.


---
### fd\_reasm\_child\_const<!-- {{#callable:fd_reasm_child_const}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L149>)

Retrieves a constant pointer to the child element of a given parent element in a reassembly pool.
- **Inputs**:
    - `reasm`: A constant pointer to an `fd_reasm_t` structure representing the reassembly context.
    - `parent`: A constant pointer to an `fd_reasm_fec_t` structure representing the parent element whose child is to be retrieved.
- **Logic and Control Flow**:
    - Calls the `pool_ele_const` function with the reassembly pool and the child's index from the parent element.
    - Returns the result of the `pool_ele_const` function call.
- **Output**: A constant pointer to an `fd_reasm_fec_t` structure representing the child element of the given parent.


---
### fd\_reasm\_sibling<!-- {{#callable:fd_reasm_sibling}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L150>)

Retrieves the sibling element of a given `fd_reasm_fec_t` element from a pool within a `fd_reasm_t` structure.
- **Inputs**:
    - `reasm`: A pointer to an `fd_reasm_t` structure that contains the pool from which to retrieve the sibling element.
    - `sibling`: A pointer to an `fd_reasm_fec_t` structure representing the element whose sibling is to be retrieved.
- **Logic and Control Flow**:
    - Calls the `pool_ele` function with `reasm->pool` and `sibling->sibling` as arguments.
    - Returns the result of the `pool_ele` function call.
- **Output**: A pointer to an `fd_reasm_fec_t` structure representing the sibling of the given element.


---
### fd\_reasm\_sibling\_const<!-- {{#callable:fd_reasm_sibling_const}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L151>)

Retrieves a constant pointer to the sibling element of a given `fd_reasm_fec_t` structure from a pool.
- **Inputs**:
    - ``reasm``: A constant pointer to an `fd_reasm_t` structure, which contains the pool from which to retrieve the sibling element.
    - ``sibling``: A constant pointer to an `fd_reasm_fec_t` structure, representing the element whose sibling is to be retrieved.
- **Logic and Control Flow**:
    - Calls the `pool_ele_const` function with the pool from `reasm` and the sibling index from `sibling`.
- **Output**: A constant pointer to an `fd_reasm_fec_t` structure representing the sibling of the given element.


---
### fd\_reasm\_slot0<!-- {{#callable:fd_reasm_slot0}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L153>)

Returns the value of the `slot0` field from a `fd_reasm_t` structure.
- **Inputs**:
    - `reasm`: A pointer to a `fd_reasm_t` structure from which the `slot0` value is retrieved.
- **Logic and Control Flow**:
    - Accesses the `slot0` field of the `fd_reasm_t` structure pointed to by `reasm`.
    - Returns the value of the `slot0` field.
- **Output**: The function returns an `ulong` representing the value of the `slot0` field in the `fd_reasm_t` structure.


---
### fd\_reasm\_free<!-- {{#callable:fd_reasm_free}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L158>)

Releases the memory pool associated with a reassembly object and returns the number of free elements in the pool.
- **Inputs**:
    - ``reasm``: A pointer to an `fd_reasm_t` structure, which contains the reassembly object whose pool is to be freed.
- **Logic and Control Flow**:
    - Calls the `pool_free` function with the `pool` member of the `reasm` structure as an argument.
    - Returns the result of the `pool_free` function call.
- **Output**: Returns an `unsigned long` representing the number of free elements in the pool after the operation.


---
### fd\_reasm\_peek<!-- {{#callable:fd_reasm_peek}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L163>)

Retrieves the first element from the output queue of a reassembly structure without removing it.
- **Inputs**:
    - ``reasm``: A pointer to an `fd_reasm_t` structure, which represents the reassembly context.
- **Logic and Control Flow**:
    - Checks if the output queue (`reasm->out`) is empty using `out_empty`; if it is empty, returns `NULL`.
    - If the output queue is not empty, retrieves the index of the first element in the output queue using `out_peek_head`.
    - Uses `pool_ele` to get the element from the pool at the retrieved index and returns it.
- **Output**: Returns a pointer to an `fd_reasm_fec_t` structure representing the first element in the output queue, or `NULL` if the queue is empty.


---
### fd\_reasm\_out<!-- {{#callable:fd_reasm_out}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L169>)

Retrieves and removes the first element from the output queue of a reassembly structure if it is not empty.
- **Inputs**:
    - ``reasm``: A pointer to an `fd_reasm_t` structure, which contains the reassembly state and data.
- **Logic and Control Flow**:
    - Check if the output queue (`reasm->out`) is empty using `out_empty`.
    - If the output queue is empty, return `NULL`.
    - If the output queue is not empty, remove the first element from the output queue using `out_pop_head`.
    - Retrieve the element from the pool using `pool_ele` with the index obtained from `out_pop_head`.
    - Return the retrieved element.
- **Output**: A pointer to an `fd_reasm_fec_t` structure representing the first element from the output queue, or `NULL` if the queue is empty.


---
### fd\_reasm\_query<!-- {{#callable:fd_reasm_query}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L175>)

Queries various data structures in a reassembly context to find a `fd_reasm_fec_t` element matching a given Merkle root.
- **Inputs**:
    - ``reasm``: A pointer to a constant `fd_reasm_t` structure, representing the reassembly context.
    - ``merkle_root``: A pointer to a constant `fd_hash_t` structure, representing the Merkle root to query.
- **Logic and Control Flow**:
    - Initialize `fec` to `NULL`.
    - Query the `ancestry` structure of `reasm` using `merkle_root`; assign the result to `fec`.
    - If `fec` is `NULL`, query the `frontier` structure of `reasm` using `merkle_root`; assign the result to `fec`.
    - If `fec` is still `NULL`, query the `orphaned` structure of `reasm` using `merkle_root`; assign the result to `fec`.
    - If `fec` is still `NULL`, query the `subtrees` structure of `reasm` using `merkle_root`; assign the result to `fec`.
    - Return `fec`.
- **Output**: A pointer to a `fd_reasm_fec_t` structure if found, otherwise `NULL`.


---
### overwrite\_invalid\_cmr<!-- {{#callable:overwrite_invalid_cmr}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L186>)

Overwrites an invalid chained Merkle root (CMR) in a child FEC structure with the parent's Merkle root if certain conditions are met.
- **Inputs**:
    - ``reasm``: A pointer to an `fd_reasm_t` structure, which represents the reassembly context.
    - ``child``: A pointer to an `fd_reasm_fec_t` structure, which represents the child FEC (Forward Error Correction) structure whose CMR may be overwritten.
- **Logic and Control Flow**:
    - Checks if `child->fec_set_idx` is 0 and if [`fd_reasm_query`](<#fd_reasm_query>) returns false for `child->cmr`.
    - Queries the parent slot Merkle root using `slot_mr_query` with the adjusted slot value.
    - If a valid parent slot Merkle root is found, queries the parent FEC structure using [`fd_reasm_query`](<#fd_reasm_query>).
    - If a valid parent FEC structure is found, logs the overwrite action and sets `child->cmr` to the parent's Merkle root.
- **Output**: No return value; the function modifies the `child` structure in place.
- **Functions Called**:
    - [`fd_reasm_query`](<#fd_reasm_query>)


---
### link<!-- {{#callable:link}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L200>)

Links a child node to a parent node in a reassembly tree structure, updating sibling and child relationships as necessary.
- **Inputs**:
    - ``reasm``: A pointer to the `fd_reasm_t` structure, which contains the pool and other reassembly-related data.
    - ``parent``: A pointer to the `fd_reasm_fec_t` structure representing the parent node in the reassembly tree.
    - ``child``: A pointer to the `fd_reasm_fec_t` structure representing the child node to be linked to the parent.
- **Logic and Control Flow**:
    - Set the `parent` field of `child` to the index of `parent` in the pool using `pool_idx` function.
    - Check if `parent` has no child by comparing `parent->child` with `pool_idx_null`.
    - If `parent` has no child, set `parent->child` to the index of `child` in the pool, making `child` the left-child.
    - If `parent` already has a child, traverse the siblings of the first child until the last sibling is found.
    - Set the `sibling` field of the last sibling to the index of `child`, making `child` the right-sibling.
    - If `parent->slot_complete` is false, set `child->eqvoc` to 1, indicating the child is equivocating.
- **Output**: No return value; the function modifies the `parent` and `child` structures in place.


---
### fd\_reasm\_insert<!-- {{#callable:fd_reasm_insert}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L215>)

Inserts a Forward Error Correction (FEC) element into a reassembly structure, linking it with its parent and children based on Merkle root metadata.
- **Inputs**:
    - ``reasm``: A pointer to the reassembly structure where the FEC element will be inserted.
    - ``merkle_root``: A pointer to the Merkle root hash of the FEC element to be inserted.
    - ``chained_merkle_root``: A pointer to the chained Merkle root hash, or `NULL` if initializing the reassembly with the root.
    - ``slot``: The slot number associated with the FEC element.
    - ``fec_set_idx``: The index of the FEC set.
    - ``parent_off``: The offset of the parent in the slot.
    - ``data_cnt``: The count of data elements in the FEC.
    - ``data_complete``: An integer indicating if the data is complete (non-zero) or not (zero).
    - ``slot_complete``: An integer indicating if the slot is complete (non-zero) or not (zero).
    - ``leader``: An integer indicating if the FEC element is a leader (non-zero) or not (zero).
- **Logic and Control Flow**:
    - Acquire a new FEC element from the pool and initialize its fields with the provided parameters.
    - If `chained_merkle_root` is `NULL`, initialize the reassembly with the root and insert the FEC into the frontier.
    - If `slot_complete` is true, check for slot Merkle root equivocation and update the slot Merkle root if necessary.
    - Overwrite invalid chained Merkle roots if the parent is received before the child.
    - Search for the parent of the new FEC in ancestry, frontier, orphaned, and subtrees, and link the FEC to its parent if found.
    - If the parent is not found, insert the FEC into the appropriate orphaned or subtree structure.
    - Search for children of the new FEC in orphaned subtrees and link them to the FEC, coalescing connected orphans into the same tree.
    - Advance the frontier from the new FEC if it is connected, using a breadth-first search to reach the leaves.
- **Output**: Returns a pointer to the newly inserted `fd_reasm_fec_t` element.
- **Functions Called**:
    - [`fd_reasm_query`](<#fd_reasm_query>)
    - [`overwrite_invalid_cmr`](<#overwrite_invalid_cmr>)
    - [`link`](<#link>)


---
### publish\_remove<!-- {{#callable:publish_remove}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L389>)

Removes an element from either the ancestry or frontier of a reassembly structure based on a given Merkle root.
- **Inputs**:
    - ``reasm``: A pointer to the `fd_reasm_t` structure, which contains the ancestry and frontier from which elements may be removed.
    - ``merkle_root``: A constant pointer to an `fd_hash_t` structure representing the Merkle root of the element to be removed.
- **Logic and Control Flow**:
    - Call `ancestry_ele_remove` to attempt to remove the element with the given `merkle_root` from the `ancestry` of `reasm`.
    - If the element is not found in the `ancestry`, call `frontier_ele_remove` to attempt to remove the element from the `frontier` of `reasm`.
    - Return the removed element, or `NULL` if the element is not found in either the `ancestry` or `frontier`.
- **Output**: A pointer to the `fd_reasm_fec_t` structure that was removed, or `NULL` if no element was removed.


---
### fd\_reasm\_publish<!-- {{#callable:fd_reasm_publish}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L397>)

Replaces the current root of a reassembly tree with a new root identified by a given Merkle root, pruning the tree as necessary.
- **Inputs**:
    - ``reasm``: A pointer to the `fd_reasm_t` structure representing the reassembly context.
    - ``merkle_root``: A constant pointer to the `fd_hash_t` structure representing the Merkle root of the new root node.
- **Logic and Control Flow**:
    - If handholding is enabled, check if the current root exists and if the new root can be queried; log warnings and return `NULL` if checks fail.
    - Retrieve the pool from the reassembly context and initialize variables for the null index, old root, and new root.
    - Remove the old root and initialize a BFS queue with it, setting the `next` pointer to null.
    - Perform a BFS traversal to prune the tree, removing ancestors of the old root and their descendants, except for the new root.
    - For each node in the BFS queue, check its children and add them to the queue if they are not the new root, clearing the `next` pointer after adding.
    - Remove any slot metadata associated with the node if it exists.
    - Release the node from the pool and advance to the next node in the queue.
    - Set the parent of the new root to null and update the reassembly context's root to the new root's index.
    - Return the new root.
- **Output**: Returns a pointer to the `fd_reasm_fec_t` structure representing the new root node.
- **Functions Called**:
    - [`fd_reasm_query`](<#fd_reasm_query>)
    - [`publish_remove`](<#publish_remove>)


---
### print<!-- {{#callable:print}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L443>)

Prints a hierarchical representation of a `fd_reasm_fec_t` tree structure with a specified prefix and indentation.
- **Inputs**:
    - ``reasm``: A pointer to a constant `fd_reasm_t` structure, representing the reassembly context.
    - ``fec``: A pointer to a constant `fd_reasm_fec_t` structure, representing the current node in the tree to print.
    - ``space``: An integer representing the number of spaces to indent the current line.
    - ``prefix``: A constant character pointer representing the prefix to print before the node's key.
- **Logic and Control Flow**:
    - Check if `fec` is `NULL`; if so, return immediately.
    - If `space` is greater than 0, print a newline character.
    - Print `space` number of spaces for indentation.
    - Print the `prefix` followed by the Base58 encoded key of the `fec` node.
    - Initialize `curr` to the first child of `fec` using `pool_ele_const`.
    - Iterate over the siblings of `curr` using a while loop.
    - For each sibling, determine if it has further siblings to decide the branch prefix (`├──` or `└──`).
    - Recursively call `print` for each child with updated `space` and `prefix`.
- **Output**: No return value; the function outputs directly to the standard output.


---
### fd\_reasm\_print<!-- {{#callable:fd_reasm_print}} -->
[View Source →](<../../../../../src/discof/reasm/fd_reasm.c#L467>)

Prints the current state of the reassembly process, including the frontier and subtrees.
- **Inputs**:
    - ``reasm``: A pointer to a constant `fd_reasm_t` structure representing the reassembly context.
- **Logic and Control Flow**:
    - Logs a notice indicating the start of the reassembly print process.
    - Initializes a pointer to the `pool` from the `reasm` structure.
    - Prints the header '[Frontier]' to indicate the start of frontier data output.
    - Iterates over the `frontier` using `frontier_iter_init`, `frontier_iter_done`, and `frontier_iter_next` functions.
    - For each element in the frontier, retrieves the `fd_reasm_fec_t` structure using `pool_ele_const` and prints its `slot`, `fec_set_idx`, and `key` in Base58 encoding.
    - Prints the header '[Subtrees]' to indicate the start of subtree data output.
    - Iterates over the `subtrees` using `subtrees_iter_init`, `subtrees_iter_done`, and `subtrees_iter_next` functions.
    - For each element in the subtrees, retrieves the `fd_reasm_fec_t` structure using `pool_ele_const` and prints its `slot`, `fec_set_idx`, and `key` in Base58 encoding.
    - Ends with a newline for formatting.
- **Output**: No return value; outputs are printed to the console.



---
Made with ❤️ by [Driver](https://www.driver.ai/)