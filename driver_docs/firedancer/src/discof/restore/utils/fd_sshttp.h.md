<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines structures and functions for managing HTTP snapshots in shared memory.

# Purpose
This C header file defines the interface for handling HTTP operations within a specific context, likely related to snapshot management. It declares a private structure `fd_sshttp_private` and a corresponding typedef `fd_sshttp_t` for managing HTTP sessions. The file includes function prototypes for aligning memory ([`fd_sshttp_align`](<#fd_sshttp_align>)), calculating memory footprint ([`fd_sshttp_footprint`](<#fd_sshttp_footprint>)), and managing the lifecycle of HTTP sessions with functions like [`fd_sshttp_new`](<#fd_sshttp_new>), [`fd_sshttp_join`](<#fd_sshttp_join>), [`fd_sshttp_init`](<#fd_sshttp_init>), and [`fd_sshttp_cancel`](<#fd_sshttp_cancel>). It also provides functionality to retrieve snapshot names and content length, and to advance the state of an HTTP session with [`fd_sshttp_advance`](<#fd_sshttp_advance>), which returns status codes indicating the result of the operation. Constants such as `FD_SSHTTP_ALIGN` and `FD_SSHTTP_MAGIC` are defined for alignment and identification purposes.
# Imports and Dependencies

---
- `../../../util/net/fd_net_headers.h`


# Data Structures

---
### fd\_sshttp\_t
- **Type**: ``struct``
- **Members**:
    - ``fd_sshttp_private``: A forward declaration of a private structure used internally.
- **Description**: `fd_sshttp_t` is a typedef for a forward-declared private structure `fd_sshttp_private`, which is used in the context of HTTP operations within the code. The structure is part of a module that provides functions for aligning, initializing, joining, and managing HTTP-related data, including handling snapshot names and content length. The specific details of the structure's members are not visible in the provided code, as it is only forward-declared here.


# Function Declarations (Public API)

---
### fd\_sshttp\_align<!-- {{#callable_declaration:fd_sshttp_align}} -->
[View Source →](<../../../../../../src/discof/restore/utils/fd_sshttp.h#L13>)

Returns the alignment requirement for HTTP structures.
- **Description**: Use this function to obtain the alignment requirement for structures related to HTTP operations. This is necessary when allocating memory for these structures to ensure proper alignment. The function does not require any parameters and can be called at any time.
- **Inputs**: None
- **Output**: The function returns an unsigned long integer representing the alignment requirement, which is 8 bytes.
- **See Also**: [`fd_sshttp_align`](<fd_sshttp.c.md#fd_sshttp_align>)  (Implementation)


---
### fd\_sshttp\_footprint<!-- {{#callable_declaration:fd_sshttp_footprint}} -->
[View Source →](<../../../../../../src/discof/restore/utils/fd_sshttp.h#L18>)

Calculates the memory footprint for an HTTP server instance.
- **Description**: Use this function to determine the memory size required to store an instance of the HTTP server structure. This is useful when allocating memory for the server instance. The function does not require any parameters and can be called at any time to get the size information. It is a constant function, meaning it does not depend on any external state and will always return the same result.
- **Inputs**: None
- **Output**: Returns the size in bytes as an unsigned long integer, representing the memory footprint needed for an HTTP server instance.
- **See Also**: [`fd_sshttp_footprint`](<fd_sshttp.c.md#fd_sshttp_footprint>)  (Implementation)


---
### fd\_sshttp\_new<!-- {{#callable_declaration:fd_sshttp_new}} -->
[View Source →](<../../../../../../src/discof/restore/utils/fd_sshttp.h#L21>)

Creates a new HTTP state object in shared memory.
- **Description**: Use this function to initialize a new HTTP state object in a provided shared memory region. The shared memory pointer must be non-null and aligned to the alignment requirement specified by `fd_sshttp_align()`. This function returns a pointer to the newly created HTTP state object if successful, or NULL if the input is invalid. Ensure that the shared memory is correctly aligned and initialized before calling this function.
- **Inputs**:
    - `shmem`: Pointer to a shared memory region where the HTTP state object will be created. Must not be null and must be aligned to `fd_sshttp_align()`. If these conditions are not met, the function returns NULL.
- **Output**: Returns a pointer to the newly created HTTP state object, or NULL if the input is invalid.
- **See Also**: [`fd_sshttp_new`](<fd_sshttp.c.md#fd_sshttp_new>)  (Implementation)


---
### fd\_sshttp\_join<!-- {{#callable_declaration:fd_sshttp_join}} -->
[View Source →](<../../../../../../src/discof/restore/utils/fd_sshttp.h#L24>)

Joins a shared HTTP object.
- **Description**: Use this function to obtain a pointer to a `fd_sshttp_t` object from a shared memory region. The shared memory pointer must be non-null, aligned to the required boundary, and must have been initialized with the correct magic number. This function is typically called after creating or initializing a shared HTTP object to access its functionality. If the input does not meet these conditions, the function returns `NULL` and logs a warning.
- **Inputs**:
    - `shhttp`: A pointer to a shared memory region that represents a `fd_sshttp_t` object. Must not be null, must be aligned to `fd_sshttp_align()`, and must have the correct magic number (`FD_SSHTTP_MAGIC`). If these conditions are not met, the function returns `NULL`.
- **Output**: A pointer to a `fd_sshttp_t` object if successful, or `NULL` if the input is invalid.
- **See Also**: [`fd_sshttp_join`](<fd_sshttp.c.md#fd_sshttp_join>)  (Implementation)


---
### fd\_sshttp\_snapshot\_names<!-- {{#callable_declaration:fd_sshttp_snapshot_names}} -->
[View Source →](<../../../../../../src/discof/restore/utils/fd_sshttp.h#L27>)

Retrieve snapshot names from an HTTP object.
- **Description**: Use this function to obtain the full and incremental snapshot names from a given HTTP object. It is necessary to provide valid pointers for both `full_snapshot_name` and `incremental_snapshot_name` to store the retrieved names. The function does not perform any validation on the input pointers, so ensure they are not null before calling this function. This function does not modify the HTTP object or the snapshot names.
- **Inputs**:
    - `http`: A pointer to a constant `fd_sshttp_t` structure. This must not be null and should point to a valid HTTP object from which to retrieve snapshot names.
    - `full_snapshot_name`: A pointer to a `char` pointer where the function will store the address of the full snapshot name. This must not be null.
    - `incremental_snapshot_name`: A pointer to a `char` pointer where the function will store the address of the incremental snapshot name. This must not be null.
- **Output**: None
- **See Also**: [`fd_sshttp_snapshot_names`](<fd_sshttp.c.md#fd_sshttp_snapshot_names>)  (Implementation)


---
### fd\_sshttp\_content\_len<!-- {{#callable_declaration:fd_sshttp_content_len}} -->
[View Source →](<../../../../../../src/discof/restore/utils/fd_sshttp.h#L32>)

Returns the content length of the HTTP object.
- **Description**: Use this function to get the content length of an HTTP object represented by `fd_sshttp_t`. This function is useful when you need to know the size of the content associated with the HTTP object. Ensure that the `http` parameter is a valid pointer to an `fd_sshttp_t` object before calling this function.
- **Inputs**:
    - `http`: A pointer to a constant `fd_sshttp_t` object. Must not be null. The function does not modify the object.
- **Output**: The function returns an unsigned long integer representing the content length of the HTTP object.
- **See Also**: [`fd_sshttp_content_len`](<fd_sshttp.c.md#fd_sshttp_content_len>)  (Implementation)


---
### fd\_sshttp\_init<!-- {{#callable_declaration:fd_sshttp_init}} -->
[View Source →](<../../../../../../src/discof/restore/utils/fd_sshttp.h#L35>)

Initialize an HTTP connection structure.
- **Description**: Use this function to set up an HTTP connection structure for sending a request to a specified IP address and port. This function prepares the HTTP request and attempts to establish a connection. It must be called when the `http` structure is in the `FD_SSHTTP_STATE_INIT` state. The function sets a timeout for receiving data and handles connection errors by closing the socket if necessary. Ensure that the `http` structure is properly allocated and initialized before calling this function.
- **Inputs**:
    - `http`: A pointer to an `fd_sshttp_t` structure. Must not be null and must be in the `FD_SSHTTP_STATE_INIT` state before calling.
    - `addr`: An `fd_ip4_port_t` structure specifying the IP address and port to connect to. Must be a valid address and port.
    - `path`: A pointer to a constant character string representing the path for the HTTP request. Must not be null.
    - `path_len`: The length of the `path` string. Must be a valid length that does not exceed the buffer size for the request.
    - `now`: A long integer representing the current time. Used to set a deadline for the connection.
- **Output**: None
- **See Also**: [`fd_sshttp_init`](<fd_sshttp.c.md#fd_sshttp_init>)  (Implementation)


---
### fd\_sshttp\_cancel<!-- {{#callable_declaration:fd_sshttp_cancel}} -->
[View Source →](<../../../../../../src/discof/restore/utils/fd_sshttp.h#L42>)

Cancels an ongoing HTTP operation.
- **Description**: Use this function to cancel an ongoing HTTP operation associated with the given `fd_sshttp_t` object. This function resets the state of the HTTP object to its initial state and closes any open socket associated with it. It is important to ensure that the `fd_sshttp_t` object is in a valid state before calling this function. This function does not return any value and does not provide feedback on the success of the cancellation beyond resetting the state.
- **Inputs**:
    - `http`: A pointer to an `fd_sshttp_t` object representing the HTTP operation to cancel. The pointer must not be null, and the object must be in a valid state. The function will reset the state of this object to its initial state.
- **Output**: None
- **See Also**: [`fd_sshttp_cancel`](<fd_sshttp.c.md#fd_sshttp_cancel>)  (Implementation)


---
### fd\_sshttp\_advance<!-- {{#callable_declaration:fd_sshttp_advance}} -->
[View Source →](<../../../../../../src/discof/restore/utils/fd_sshttp.h#L50>)

Advances the HTTP state machine to process requests and responses.
- **Description**: Use this function to progress the state of an HTTP transaction managed by `fd_sshttp_t`. It handles different states such as initialization, request sending, response reading, and body downloading. Call this function repeatedly to drive the state machine forward. Ensure that the `http` object is properly initialized before calling. The function returns different status codes to indicate the current state or any errors encountered.
- **Inputs**:
    - `http`: A pointer to an `fd_sshttp_t` object representing the HTTP state machine. Must not be null and must be initialized before use.
    - `data_len`: A pointer to an `ulong` where the function will store the length of data processed. Must not be null.
    - `data`: A pointer to a buffer where the function will store any data read. Must not be null.
    - `now`: A `long` integer representing the current time, used for time-dependent operations.
- **Output**: Returns an integer status code: `FD_SSHTTP_ADVANCE_AGAIN` (0) if the state machine should be called again, `FD_SSHTTP_ADVANCE_DATA` (1) if data is available, `FD_SSHTTP_ADVANCE_DONE` (2) if the operation is complete, or `FD_SSHTTP_ADVANCE_ERROR` (-1) if an error occurred.
- **See Also**: [`fd_sshttp_advance`](<fd_sshttp.c.md#fd_sshttp_advance>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)