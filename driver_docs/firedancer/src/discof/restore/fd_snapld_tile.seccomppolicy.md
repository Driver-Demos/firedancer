<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines seccomp policy rules for logging, snapshot management, and network operations.

# Purpose
This configuration file defines rules for handling file descriptors in a system that manages logging and snapshot operations. It specifies conditions under which certain operations, such as `write`, `fsync`, `read`, `lseek`, `socket`, `connect`, `close`, `sendto`, `recvfrom`, `setsockopt`, and `exit`, can be performed based on the file descriptor provided as an argument. The file distinguishes between descriptors used for logging, such as `logfile_fd` and `STDERR`, and those used for snapshot operations, like `in_full_fd` and `in_incr_fd`. It ensures that logging messages are written to the appropriate destinations and that snapshot operations are conducted with the correct file descriptors, while restricting certain network operations to prevent misuse of logging and snapshot descriptors. This file is crucial for maintaining the integrity and proper functioning of logging and snapshot processes within the application.
# Content Summary
This configuration file defines rules for handling file descriptors in a software system, focusing on logging and snapshot management. The file uses logical expressions to specify conditions under which certain operations can be performed on file descriptors.

1. **Logging Operations**:
   - Log messages are written to a file and/or a pipe. Messages with a severity of 'WARNING' or higher are directed to the STDERR pipe (file descriptor 2), while all messages are written to a log file.
   - The `write` operation allows writing to STDERR or the log file.
   - The `fsync` operation ensures that 'WARNING' and above messages are immediately synchronized to disk, specifically for the log file.

2. **Snapshot Management**:
   - The `read` operation allows reading from file descriptors associated with full and incremental snapshots (`in_full_fd` and `in_incr_fd`).
   - The `lseek` operation resets the position in the input file for snapshots using `SEEK_SET`.
   - The `socket` operation establishes connections for downloading snapshots, using the `AF_INET` address family and `SOCK_STREAM` type.
   - The `connect`, `close`, `sendto`, `recvfrom`, and `setsockopt` operations manage network connections for snapshot downloads and slot resolution. These operations are restricted from being used on STDERR, the log file, and snapshot file descriptors. The `setsockopt` operation specifically configures socket options like `SO_RCVTIMEO`.

3. **Shutdown Operation**:
   - The `exit` operation is used to terminate the process, with an argument of 0 indicating a normal shutdown.

This file ensures that operations are performed on the correct file descriptors, maintaining the integrity of logging and snapshot processes.

---
Made with ❤️ by [Driver](https://www.driver.ai/)