<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Implements a dispatcher for managing transaction blocks with staging lanes, pools, and maps.

# Purpose
The code defines a set of data structures and functions for managing a dispatch system, which appears to handle transactions (`fd_rdisp_txn_t`) and blocks (`fd_rdisp_blockinfo_t`) in a staged manner. The primary data structure is `fd_rdisp_t`, which encapsulates pools and lists for managing transactions and blocks. The code includes functionality for creating, joining, and managing these structures, as well as operations for adding, removing, promoting, and demoting blocks within the dispatch system.

The code uses several macros to include template-based implementations for pools, singly linked lists, and map chains, which are used to manage collections of transactions and blocks. The functions provided allow for the initialization and manipulation of these collections, including adding transactions to blocks, suggesting staging lanes for blocks, and handling the lifecycle of blocks and transactions within the dispatch system. The code is structured to support operations such as adding new blocks, promoting blocks to a staged state, and managing the dispatch of transactions, with mechanisms to ensure that resources are properly allocated and released.
# Imports and Dependencies

---
- `fd_rdisp.h`
- `../../util/tmpl/fd_pool.c`
- `../../util/tmpl/fd_slist.c`
- `../../util/tmpl/fd_map_chain.c`


# Data Structures

---
### fd\_rdisp\_txn
- **Type**: ``struct``
- **Members**:
    - ``index``: An unsigned integer that is technically not needed.
    - ``staged``: A 1-bit field indicating if the transaction is staged.
    - ``staging_lane``: A 2-bit field indicating the staging lane, ignored if `staged` is 0.
    - ``dispatched``: A 1-bit field indicating if the transaction is dispatched.
    - ``flags``: An integer that can represent the union of the bit fields.
    - ``next``: An unsigned integer for the next transaction index.
- **Description**: Defines a transaction structure with fields for managing the state of a transaction, including whether it is staged, the staging lane, and if it has been dispatched. It uses a union to allow access to individual bit fields or as a single integer `flags`. The `next` field is used to link to the next transaction.


---
### fd\_rdisp\_txn\_t
- **Type**: ``struct``
- **Members**:
    - ``index``: An unsigned integer that is technically not needed.
    - ``staged``: A 1-bit unsigned integer indicating if the transaction is staged.
    - ``staging_lane``: A 2-bit unsigned integer indicating the staging lane, ignored if `staged` is 0.
    - ``dispatched``: A 1-bit unsigned integer indicating if the transaction is dispatched.
    - ``flags``: An integer used to access the union of flags.
    - ``next``: An unsigned integer for the next transaction index.
- **Description**: Defines a transaction structure with fields for managing transaction states, including staging and dispatching, using bit fields for efficient storage.


---
### fd\_rdisp\_blockinfo
- **Type**: ``struct``
- **Members**:
    - ``block``: Holds a block tag of type `FD_RDISP_BLOCK_TAG_T`.
    - ``insert_ready``: Indicates if the block is ready for insertion with a 1-bit unsigned integer.
    - ``schedule_ready``: Indicates if the block is ready for scheduling with a 1-bit unsigned integer.
    - ``staged``: Indicates if the block is staged with a 1-bit unsigned integer.
    - ``staging_lane``: Specifies the staging lane with a 2-bit unsigned integer, ignored if `staged` is 0.
    - ``inserted_cnt``: Counts the number of insertions with an unsigned integer.
    - ``map_chain_next``: Holds the index of the next element in the map chain with an unsigned integer.
    - ``ll_next``: Holds the index of the next element in the linked list with an unsigned integer.
    - ``ll``: Contains an array of `txn_ll_t` with a single element.
- **Description**: Manages block information for a dispatch system, including readiness for insertion and scheduling, staging status, and linked list management.


---
### fd\_rdisp\_blockinfo\_t
- **Type**: ``struct``
- **Members**:
    - ``block``: Holds the block tag of type `FD_RDISP_BLOCK_TAG_T`.
    - ``insert_ready``: Indicates if the block is ready for insertion with a 1-bit flag.
    - ``schedule_ready``: Indicates if the block is ready for scheduling with a 1-bit flag.
    - ``staged``: Indicates if the block is staged with a 1-bit flag.
    - ``staging_lane``: Specifies the staging lane with a 2-bit value, ignored if `staged` is 0.
    - ``inserted_cnt``: Counts the number of inserted transactions as an unsigned integer.
    - ``map_chain_next``: Holds the index of the next block in the map chain.
    - ``ll_next``: Holds the index of the next block in the linked list.
    - ``ll``: Contains an array of `txn_ll_t` with a single element.
- **Description**: Manages block information for a dispatch system, including block tags, readiness flags, staging details, and linked list management for transactions.


---
### fd\_rdisp\_unstaged
- **Type**: ``struct``
- **Members**:
    - ``block``: Holds a block tag of type `FD_RDISP_BLOCK_TAG_T`.
- **Description**: Represents an unstaged block with a single member `block` that stores a block tag. This structure is used in the context of dispatching operations where blocks are not yet staged.


---
### fd\_rdisp\_unstaged\_t
- **Type**: ``struct``
- **Members**:
    - ``block``: Holds a block tag of type `FD_RDISP_BLOCK_TAG_T`.
- **Description**: Represents an unstaged block in the dispatch system, containing only a block tag to identify the block.


---
### fd\_rdisp
- **Type**: ``struct``
- **Members**:
    - ``depth``: Stores the depth of the transaction pool.
    - ``block_depth``: Stores the depth of the block pool.
    - ``pool``: Pointer to a pool of `fd_rdisp_txn_t` structures.
    - ``unstaged``: Pointer to an array of `fd_rdisp_unstaged_t` structures, parallel to `pool`.
    - ``free_lanes``: Bitmask indicating free lanes for staging.
    - ``blockmap``: Pointer to a map chain of blocks.
    - ``lanes``: Array of `block_slist_t` representing staging lanes.
    - ``block_pool``: Pointer to a pool of `fd_rdisp_blockinfo_t` structures.
- **Description**: Manages a dispatch system with transaction and block pools, supporting operations like adding, removing, and promoting blocks, as well as managing transaction staging and dispatching.


---
### fd\_rdisp\_t
- **Type**: ``struct``
- **Members**:
    - `depth`: Stores the depth of the transaction pool.
    - `block_depth`: Stores the depth of the block pool.
    - `pool`: Pointer to a pool of `fd_rdisp_txn_t` structures.
    - `unstaged`: Pointer to an array of `fd_rdisp_unstaged_t` structures, parallel to the pool.
    - `free_lanes`: Bitmask indicating free lanes for staging.
    - `blockmap`: Pointer to a map chain of `fd_rdisp_blockinfo_t` structures.
    - `lanes`: Array of four `block_slist_t` structures representing staging lanes.
    - `block_pool`: Pointer to a pool of `fd_rdisp_blockinfo_t` structures.
- **Description**: Manages a dispatch system with a pool of transactions and blocks, supporting operations like adding, removing, and promoting blocks, as well as managing transaction staging and dispatching. It uses a combination of pools, maps, and singly linked lists to organize and track the state of transactions and blocks within the system.


# Functions

---
### fd\_rdisp\_align<!-- {{#callable:fd_rdisp_align}} -->
[View Source →](<../../../../../src/discof/replay/fd_rdisp_simple.c#L85>)

Returns the alignment requirement of the `fd_rdisp_t` structure.
- **Inputs**: None
- **Logic and Control Flow**:
    - Calls the `alignof` operator on the `fd_rdisp_t` type to determine its alignment requirement.
    - Returns the result of the `alignof` operator.
- **Output**: The function returns an `ulong` representing the alignment requirement of the `fd_rdisp_t` structure.


---
### fd\_rdisp\_footprint<!-- {{#callable:fd_rdisp_footprint}} -->
[View Source →](<../../../../../src/discof/replay/fd_rdisp_simple.c#L87>)

Calculates the memory footprint required for a `fd_rdisp_t` structure and its associated components based on given depths.
- **Inputs**:
    - `depth`: The depth of the transaction pool, representing the number of transactions that can be staged.
    - `block_depth`: The depth of the block pool, representing the number of blocks that can be managed.
- **Logic and Control Flow**:
    - Calculate `chain_cnt` using `block_map_chain_cnt_est` with `block_depth` as input.
    - Initialize `l` with `FD_LAYOUT_INIT`.
    - Append the size of `fd_rdisp_t` to `l` using `FD_LAYOUT_APPEND` with alignment from [`fd_rdisp_align`](<#fd_rdisp_align>).
    - Append the footprint of the transaction pool to `l` using `FD_LAYOUT_APPEND` with alignment from `pool_align` and size from `pool_footprint` with `depth+1UL`.
    - Append the footprint of the unstaged transactions to `l` using `FD_LAYOUT_APPEND` with alignment from `alignof(fd_rdisp_unstaged_t)` and size calculated as `sizeof(fd_rdisp_unstaged_t)*(depth+1UL)`.
    - Append the footprint of the block map to `l` using `FD_LAYOUT_APPEND` with alignment from `block_map_align` and size from `block_map_footprint` with `chain_cnt`.
    - Append the footprint of the block pool to `l` using `FD_LAYOUT_APPEND` with alignment from `block_pool_align` and size from `block_pool_footprint` with `block_depth+1UL`.
    - Finalize the layout `l` using `FD_LAYOUT_FINI` with alignment from [`fd_rdisp_align`](<#fd_rdisp_align>) and return the result.
- **Output**: Returns the total memory footprint as an unsigned long integer.
- **Functions Called**:
    - [`fd_rdisp_align`](<#fd_rdisp_align>)


---
### fd\_rdisp\_new<!-- {{#callable:fd_rdisp_new}} -->
[View Source →](<../../../../../src/discof/replay/fd_rdisp_simple.c#L101>)

Initializes a new `fd_rdisp_t` structure with specified depth and block depth, allocating necessary memory and setting up internal structures.
- **Inputs**:
    - `mem`: A pointer to the memory location where the `fd_rdisp_t` structure and its associated data will be allocated.
    - `depth`: The depth of the transaction pool, determining the number of transactions that can be handled.
    - `block_depth`: The depth of the block pool, determining the number of blocks that can be managed.
- **Logic and Control Flow**:
    - Calculate the estimated chain count using `block_map_chain_cnt_est` with `block_depth`.
    - Initialize scratch memory allocation with `FD_SCRATCH_ALLOC_INIT`.
    - Allocate memory for `fd_rdisp_t`, transaction pool, unstaged transactions, block map, and block pool using `FD_SCRATCH_ALLOC_APPEND`.
    - Finalize memory allocation with `FD_SCRATCH_ALLOC_FINI`.
    - Set the `depth` and `block_depth` fields of the `fd_rdisp_t` structure.
    - Initialize the transaction pool with `pool_new`.
    - Clear the unstaged transaction memory with `memset`.
    - Set `free_lanes` to 0xF, indicating all lanes are free.
    - Initialize the block map with `block_map_new`.
    - Initialize each of the four lanes with `block_slist_new`.
    - Initialize the block pool with `block_pool_new`.
    - Join the transaction pool and set the index for each transaction.
    - Leave the transaction pool and return the pointer to the initialized `fd_rdisp_t` structure.
- **Output**: Returns a pointer to the newly initialized `fd_rdisp_t` structure.
- **Functions Called**:
    - [`fd_rdisp_align`](<#fd_rdisp_align>)


---
### fd\_rdisp\_join<!-- {{#callable:fd_rdisp_join}} -->
[View Source →](<../../../../../src/discof/replay/fd_rdisp_simple.c#L133>)

Initializes and joins various components of a `fd_rdisp_t` structure using a given memory block.
- **Inputs**:
    - `mem`: A pointer to a memory block that contains a `fd_rdisp_t` structure to be initialized and joined.
- **Logic and Control Flow**:
    - Cast the `mem` pointer to a `fd_rdisp_t` pointer named `disp`.
    - Retrieve `depth` and `block_depth` from the `disp` structure.
    - Estimate `chain_cnt` using `block_map_chain_cnt_est` with `block_depth`.
    - Initialize scratch memory allocation with `FD_SCRATCH_ALLOC_INIT`.
    - Append memory allocations for `fd_rdisp_t`, pool, unstaged, block map, and block pool using `FD_SCRATCH_ALLOC_APPEND`.
    - Finalize the scratch memory allocation with `FD_SCRATCH_ALLOC_FINI`.
    - Join the pool, unstaged, block map, and block pool components using their respective join functions.
    - Iterate over `disp->lanes` and join each lane using `block_slist_join`.
    - Return the initialized `disp` structure.
- **Output**: A pointer to the initialized and joined `fd_rdisp_t` structure.
- **Functions Called**:
    - [`fd_rdisp_align`](<#fd_rdisp_align>)


---
### fd\_rdisp\_suggest\_staging\_lane<!-- {{#callable:fd_rdisp_suggest_staging_lane}} -->
[View Source →](<../../../../../src/discof/replay/fd_rdisp_simple.c#L158>)

Suggests a staging lane for a block based on its status and available resources.
- **Inputs**:
    - ``disp``: A pointer to a `fd_rdisp_t` structure that contains the dispatcher state and resources.
    - ``parent_block``: A `FD_RDISP_BLOCK_TAG_T` type representing the parent block for which a staging lane is suggested.
    - ``duplicate``: An integer flag indicating if the block is a duplicate.
- **Logic and Control Flow**:
    - Check if `duplicate` is true; if so, return `FD_RDISP_UNSTAGED`.
    - Query the block map for `parent_block` and check if the block is ready for insertion and staged; if so, return the block's `staging_lane`.
    - Check if there are any free lanes available; if so, return the least significant bit of `free_lanes` as a free lane.
    - If no conditions are met, return `FD_RDISP_UNSTAGED`.
- **Output**: Returns an `ulong` representing the suggested staging lane or `FD_RDISP_UNSTAGED` if no suitable lane is found.


---
### fd\_rdisp\_add\_block<!-- {{#callable:fd_rdisp_add_block}} -->
[View Source →](<../../../../../src/discof/replay/fd_rdisp_simple.c#L179>)

Adds a new block to the dispatcher, setting its properties and inserting it into the appropriate staging lane or marking it as unstaged.
- **Inputs**:
    - ``disp``: A pointer to the `fd_rdisp_t` structure representing the dispatcher.
    - ``new_block``: The tag of the new block to add, of type `FD_RDISP_BLOCK_TAG_T`.
    - ``staging_lane``: An unsigned long indicating the staging lane to use, or `FD_RDISP_UNSTAGED` if the block should not be staged.
- **Logic and Control Flow**:
    - Check if there is a free block in the block pool; if not, return -1.
    - Check if the block already exists in the block map; if it does, return -1.
    - Acquire a new block from the block pool and set its tag to `new_block`.
    - Insert the block into the block map.
    - Initialize the block's properties: `inserted_cnt` to 0, `insert_ready` to 1, `staged` based on `staging_lane`, and `staging_lane` to the lower 2 bits of `staging_lane`.
    - Join a new transaction linked list for the block.
    - If `staging_lane` is `FD_RDISP_UNSTAGED`, set `schedule_ready` to 1.
    - Otherwise, update the block's `schedule_ready` based on the free lanes bitmask, clear the corresponding bit in `free_lanes`, and insert the block into the appropriate staging lane list.
    - Return 0 to indicate success.
- **Output**: Returns 0 on success, or -1 if there is no free block in the pool or if the block already exists in the map.


---
### fd\_rdisp\_remove\_block<!-- {{#callable:fd_rdisp_remove_block}} -->
[View Source →](<../../../../../src/discof/replay/fd_rdisp_simple.c#L209>)

Removes a block from the dispatcher system, ensuring it is ready for removal and updating the staging lanes and block pool accordingly.
- **Inputs**:
    - ``disp``: A pointer to the `fd_rdisp_t` dispatcher structure, which contains the block pool, block map, and other related data.
    - ``block_tag``: The tag identifying the block to be removed from the dispatcher.
- **Logic and Control Flow**:
    - Retrieve the block information from the block map using the `block_tag` and check if it exists; return -1 if not found.
    - Verify that the block is ready for scheduling and that its transaction list is empty.
    - If the block is staged, update the staging lane by removing the block from the head of the lane's list and adjust the `schedule_ready` status of the next block in the lane or mark the lane as free if it becomes empty.
    - Delete the transaction list associated with the block and release the block index from the block pool.
    - Remove the block from the block map.
- **Output**: Returns 0 on successful removal of the block, or -1 if the block is not found or not ready for removal.


---
### fd\_rdisp\_abandon\_block<!-- {{#callable:fd_rdisp_abandon_block}} -->
[View Source →](<../../../../../src/discof/replay/fd_rdisp_simple.c#L236>)

Releases all transactions in a specified block and updates the block's status in the dispatcher.
- **Inputs**:
    - ``disp``: A pointer to the dispatcher (`fd_rdisp_t`) that manages the blocks and transactions.
    - ``block_tag``: The tag (`FD_RDISP_BLOCK_TAG_T`) identifying the block to abandon.
- **Logic and Control Flow**:
    - Retrieve the block information from the block map using `block_tag`.
    - If the block is not found, return -1 indicating failure.
    - Ensure the block is ready for scheduling using `FD_TEST`.
    - While the transaction list (`ll`) of the block is not empty, release each transaction index back to the pool.
    - If the block is staged, determine the staging lane and update the block list for that lane.
    - Remove the block from the head of the staging lane list and update the schedule readiness of the next block if present, or mark the lane as free if empty.
    - Delete the transaction list and release the block index from the block pool.
    - Return 0 indicating success.
- **Output**: Returns 0 on success, or -1 if the block is not found.


---
### fd\_rdisp\_promote\_block<!-- {{#callable:fd_rdisp_promote_block}} -->
[View Source →](<../../../../../src/discof/replay/fd_rdisp_simple.c#L264>)

Promotes a block to a staged state in a specified staging lane, updating its status and associated transactions.
- **Inputs**:
    - ``disp``: A pointer to the `fd_rdisp_t` structure representing the dispatcher.
    - ``block_tag``: The tag identifying the block to promote.
    - ``staging_lane``: The index of the staging lane where the block will be promoted.
- **Logic and Control Flow**:
    - Retrieve the block from the block map using `block_tag` and `block_pool`.
    - If the block is not found or is already staged, return -1.
    - Set the block's `staged` status to 1 and update its `staging_lane`, `insert_ready`, and `schedule_ready` fields.
    - Clear the bit corresponding to `staging_lane` in `disp->free_lanes`.
    - If the staging lane is not empty, set the `insert_ready` of the last block in the lane to 0.
    - Push the block to the tail of the staging lane's list.
    - Iterate over transactions in the block, marking them as staged and updating their `staging_lane`.
    - If any transaction is already dispatched, log an error.
    - Return 0 to indicate success.
- **Output**: Returns 0 on success, or -1 if the block is not found or already staged.


---
### fd\_rdisp\_demote\_block<!-- {{#callable:fd_rdisp_demote_block}} -->
[View Source →](<../../../../../src/discof/replay/fd_rdisp_simple.c#L298>)

Demotes a block from the staging lane in a dispatcher if it meets certain conditions.
- **Inputs**:
    - ``disp``: A pointer to the dispatcher (`fd_rdisp_t`) that manages the block.
    - ``block_tag``: The tag (`FD_RDISP_BLOCK_TAG_T`) that identifies the block to be demoted.
- **Logic and Control Flow**:
    - Retrieve the block information from the block map using `block_tag`.
    - Check if the block is NULL, not staged, or not schedule ready; return -1 if any condition is true.
    - Check if the block's transaction list is not empty; log an error if it is not empty.
    - Retrieve the staging lane of the block and set the block's `staged` flag to 0.
    - Verify that the block is the head of its staging lane and remove it from the head of the staging lane.
    - If the staging lane is not empty after removal, set the new head's `schedule_ready` flag to 1; otherwise, mark the lane as free in the dispatcher's `free_lanes` bitmask.
    - Return 0 to indicate successful demotion.
- **Output**: Returns 0 on successful demotion, or -1 if the block cannot be demoted due to failing preconditions.


---
### fd\_rdisp\_rekey\_block<!-- {{#callable:fd_rdisp_rekey_block}} -->
[View Source →](<../../../../../src/discof/replay/fd_rdisp_simple.c#L322>)

Rekeys a block in the dispatcher by replacing its old tag with a new tag.
- **Inputs**:
    - ``disp``: A pointer to the `fd_rdisp_t` structure representing the dispatcher.
    - ``new_tag``: The new tag to assign to the block.
    - ``old_tag``: The current tag of the block to be rekeyed.
- **Logic and Control Flow**:
    - Retrieve the block pool from the dispatcher `disp`.
    - Check if a block with `new_tag` already exists in the block map; if it does, return -1.
    - Query the block map for a block with `old_tag`; if not found, return -1.
    - Update the block's tag to `new_tag`.
    - Insert the updated block back into the block map.
    - Return 0 to indicate success.
- **Output**: Returns 0 on success, or -1 if a block with `new_tag` already exists or if `old_tag` is not found.


---
### fd\_rdisp\_add\_txn<!-- {{#callable:fd_rdisp_add_txn}} -->
[View Source →](<../../../../../src/discof/replay/fd_rdisp_simple.c#L337>)

Adds a transaction to a dispatcher if the block is ready and there is space in the pool.
- **Inputs**:
    - ``disp``: A pointer to the dispatcher (`fd_rdisp_t`) where the transaction will be added.
    - ``insert_block``: The block tag (`FD_RDISP_BLOCK_TAG_T`) where the transaction should be inserted.
    - ``txn``: A pointer to the transaction (`fd_txn_t`) to be added (unused in this version).
    - ``payload``: A pointer to the payload data (unused in this version).
    - ``alts``: A pointer to alternative account addresses (unused in this version).
    - ``serializing``: An integer indicating if the transaction is serializing (unused in this version).
- **Logic and Control Flow**:
    - Query the block map for the block associated with `insert_block` and check if it is ready for insertion.
    - Check if there is space available in the transaction pool; if not, return 0.
    - Increment the `inserted_cnt` of the block.
    - Acquire an index from the pool and get a pointer to the transaction slot in the pool.
    - Initialize the transaction's flags, staged status, and staging lane based on the block's properties.
    - If the block is not staged, update the `unstaged` array with the block information.
    - Add the transaction to the tail of the block's linked list of transactions.
    - Return the index of the transaction in the pool.
- **Output**: Returns the index of the transaction in the pool if successful, or 0 if the block is not ready or the pool is full.


---
### fd\_rdisp\_get\_next\_ready<!-- {{#callable:fd_rdisp_get_next_ready}} -->
[View Source →](<../../../../../src/discof/replay/fd_rdisp_simple.c#L368>)

Retrieves the index of the next ready transaction in a specified block if it is ready and not yet dispatched.
- **Inputs**:
    - ``disp``: A pointer to an `fd_rdisp_t` structure representing the dispatcher.
    - ``schedule_block``: A `FD_RDISP_BLOCK_TAG_T` value representing the block to check for the next ready transaction.
- **Logic and Control Flow**:
    - Query the block information from `disp->blockmap` using `schedule_block` as the key.
    - If the block is not found or is not ready for scheduling (`!block->schedule_ready`), return 0.
    - Check if the transaction linked list (`block->ll`) is empty; if so, return 0.
    - Peek the index of the head transaction in the linked list.
    - Retrieve the transaction from `disp->pool` using the index.
    - If the transaction is already dispatched, return 0.
    - Mark the transaction as dispatched by setting `rtxn->dispatched` to 1.
    - Return the index of the transaction.
- **Output**: Returns the index of the next ready transaction as an `ulong`, or 0 if no transaction is ready or available.


---
### fd\_rdisp\_complete\_txn<!-- {{#callable:fd_rdisp_complete_txn}} -->
[View Source →](<../../../../../src/discof/replay/fd_rdisp_simple.c#L383>)

Completes a transaction by verifying its dispatch status and removing it from the transaction list of its associated block.
- **Inputs**:
    - ``disp``: A pointer to the `fd_rdisp_t` structure, which contains the transaction pool and block information.
    - ``txn_idx``: An unsigned long integer representing the index of the transaction to complete.
- **Logic and Control Flow**:
    - Retrieve the transaction from the pool using `txn_idx`.
    - Verify that the transaction has been dispatched using `FD_TEST`.
    - Determine the block associated with the transaction: if the transaction is staged, get the block from the head of the staging lane; otherwise, query the block map using the unstaged block information.
    - Verify that the transaction is the head of the transaction list in the block using `FD_TEST`.
    - Remove the transaction from the head of the transaction list in the block.
- **Output**: No return value; the function operates by modifying the state of the transaction and block structures.


---
### fd\_rdisp\_staging\_lane\_info<!-- {{#callable:fd_rdisp_staging_lane_info}} -->
[View Source →](<../../../../../src/discof/replay/fd_rdisp_simple.c#L399>)

Calculates and returns a bitmask representing the occupied staging lanes in a dispatcher.
- **Inputs**:
    - ``disp``: A pointer to a constant `fd_rdisp_t` structure representing the dispatcher.
    - ``out_sched``: An array of `fd_rdisp_staging_lane_info_t` with a static size of 4, intended to be populated with scheduling information (currently unused).
- **Logic and Control Flow**:
    - The function takes a dispatcher object `disp` and an array `out_sched` as inputs.
    - The `out_sched` array is not used in the current implementation (indicated by the comment `TODO: populate`).
    - The function calculates a bitmask by negating the `free_lanes` bitmask from the `disp` object and applying a bitwise AND with `0xFUL`.
    - The result represents the occupied lanes in the dispatcher.
- **Output**: Returns an `ulong` bitmask indicating the occupied staging lanes.


---
### fd\_rdisp\_leave<!-- {{#callable:fd_rdisp_leave}} -->
[View Source →](<../../../../../src/discof/replay/fd_rdisp_simple.c#L406>)

Returns the input `fd_rdisp_t` pointer without modification.
- **Inputs**:
    - `disp`: A pointer to an `fd_rdisp_t` structure.
- **Logic and Control Flow**:
    - Return the input `disp` pointer.
- **Output**: The same `fd_rdisp_t` pointer that was passed as input.


---
### fd\_rdisp\_delete<!-- {{#callable:fd_rdisp_delete}} -->
[View Source →](<../../../../../src/discof/replay/fd_rdisp_simple.c#L407>)

Returns the input memory pointer without modification.
- **Inputs**:
    - `mem`: A pointer to the memory that is to be returned.
- **Logic and Control Flow**:
    - The function takes a single input parameter `mem`.
    - It returns the `mem` pointer without any changes.
- **Output**: The same memory pointer that was passed as input.



---
Made with ❤️ by [Driver](https://www.driver.ai/)