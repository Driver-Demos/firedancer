<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines data structures and validation functions for shredcap slice and bank hash capture formats.

# Purpose
The code defines data structures and validation functions for capturing and validating data related to "shredcap" operations. It includes two main formats: the shredcap slice capture format and the shredcap bank hash capture format. The shredcap slice capture format is used to capture slices of data shreds as they are prepared for replay, consisting of a header, multiple data shreds, and a trailer. The shredcap bank hash capture format is used to capture bank hashes calculated by the network, with each message containing a magic number, version, slot, and bank hash.

The code provides validation functions for each format to ensure data integrity. These functions check the magic numbers and version numbers of the headers, trailers, and bank hash messages. If any of these values are incorrect, the program logs a critical error and terminates. The code is structured as a C header file, intended to be included in other parts of a program, and it defines public interfaces for the validation of shredcap data structures.
# Imports and Dependencies

---
- `../flamenco/types/fd_types_custom.h`
- `../flamenco/runtime/fd_runtime.h`


# Data Structures

---
### fd\_shredcap\_slice\_header\_msg\_v1
- **Type**: ``struct``
- **Members**:
    - `magic`: Stores a unique identifier for the message format.
    - `version`: Indicates the version of the message format.
    - `payload_sz`: Specifies the size of the payload in the message.
- **Description**: Defines a packed structure used as a header in the shredcap slice capture format, containing fields for a magic number, version, and payload size to ensure data integrity and compatibility.


---
### fd\_shredcap\_slice\_header\_msg\_t
- **Type**: ``struct``
- **Members**:
    - `magic`: Stores a unique identifier for the header message.
    - `version`: Indicates the version of the header message format.
    - `payload_sz`: Specifies the size of the payload in the header message.
- **Description**: Defines the structure of a header message used in the shredcap slice capture format, which includes fields for a magic number, version, and payload size to ensure data integrity and compatibility.


---
### fd\_shredcap\_slice\_trailer\_msg\_v1
- **Type**: ``struct``
- **Members**:
    - `magic`: Stores a unique identifier for the trailer message.
    - `version`: Indicates the version of the trailer message format.
- **Description**: Defines a packed structure used as a trailer in the shredcap slice capture format, containing fields for a magic number and version to ensure data integrity and compatibility.


---
### fd\_shredcap\_slice\_trailer\_msg\_t
- **Type**: ``struct``
- **Members**:
    - `magic`: Stores a unique identifier for the trailer message format.
    - `version`: Indicates the version of the trailer message format.
- **Description**: Defines the trailer message for a shredcap slice, which includes a magic number and version to ensure data integrity and compatibility in the capture format of slices of shreds.


---
### fd\_shredcap\_bank\_hash\_msg\_v1
- **Type**: `struct`
- **Members**:
    - `magic`: Stores a unique identifier for the message format.
    - `version`: Indicates the version of the message format.
    - `slot`: Represents the slot number associated with the bank hash.
    - `bank_hash`: Holds the hash value of the bank, defined by `fd_hash_t`.
- **Description**: Enables the capture of bank hashes calculated by the network in the replay tile, with each instance containing a unique identifier, version, slot number, and the bank hash itself.


---
### fd\_shredcap\_bank\_hash\_msg\_t
- **Type**: ``struct``
- **Members**:
    - `magic`: Stores a unique identifier for the message format.
    - `version`: Indicates the version of the message format.
    - `slot`: Represents the slot number associated with the bank hash.
    - `bank_hash`: Holds the hash value of the bank, defined as `fd_hash_t`.
- **Description**: Captures bank hashes calculated by the network in the replay tile, with each instance containing a unique identifier, version, slot number, and the bank hash itself. The bank hashes are recorded in the order that slots finish executing, but not necessarily in a strict order.


# Functions

---
### fd\_shredcap\_slice\_header\_validate<!-- {{#callable:fd_shredcap_slice_header_validate}} -->
[View Source →](<../../../../src/discof/fd_discof.h#L56>)

Validates the integrity of a shredcap slice header by checking its magic number and version.
- **Inputs**:
    - `header`: A pointer to a `fd_shredcap_slice_header_msg_t` structure that contains the header information to validate.
- **Logic and Control Flow**:
    - Check if the `magic` field of the `header` does not match `FD_SHREDCAP_SLICE_HEADER_MAGIC`.
    - If the `magic` field is invalid, log a critical error with the message 'Invalid magic number in shredcap slice header' and the invalid magic number.
    - Check if the `version` field of the `header` does not match `FD_SHREDCAP_SLICE_HEADER_V1`.
    - If the `version` field is invalid, log a critical error with the message 'Invalid version in shredcap slice header' and the invalid version number.
- **Output**: No return value; logs critical errors if validation fails.


---
### fd\_shredcap\_slice\_trailer\_validate<!-- {{#callable:fd_shredcap_slice_trailer_validate}} -->
[View Source →](<../../../../src/discof/fd_discof.h#L68>)

Validates the magic number and version of a shredcap slice trailer message.
- **Inputs**:
    - `trailer`: A pointer to a `fd_shredcap_slice_trailer_msg_t` structure that contains the magic number and version to validate.
- **Logic and Control Flow**:
    - Check if the `magic` field of `trailer` is not equal to `FD_SHREDCAP_SLICE_TRAILER_MAGIC` using `FD_UNLIKELY` macro.
    - If the `magic` field is invalid, log a critical error with the invalid magic number using `FD_LOG_CRIT`.
    - Check if the `version` field of `trailer` is not equal to `FD_SHREDCAP_SLICE_TRAILER_V1` using `FD_UNLIKELY` macro.
    - If the `version` field is invalid, log a critical error with the invalid version using `FD_LOG_CRIT`.
- **Output**: No return value; logs critical errors if validation fails.


---
### fd\_shredcap\_bank\_hash\_msg\_validate<!-- {{#callable:fd_shredcap_bank_hash_msg_validate}} -->
[View Source →](<../../../../src/discof/fd_discof.h#L109>)

Validates a `fd_shredcap_bank_hash_msg_t` message by checking its magic number and version.
- **Inputs**:
    - `msg`: A pointer to a `fd_shredcap_bank_hash_msg_t` structure that contains the message to validate.
- **Logic and Control Flow**:
    - Check if `msg->magic` is not equal to `FD_SHREDCAP_BANK_HASH_MAGIC` and log a critical error if true.
    - Check if `msg->version` is not equal to `FD_SHREDCAP_BANK_HASH_V1` and log a critical error if true.
- **Output**: No return value; logs a critical error if validation fails.



---
Made with ❤️ by [Driver](https://www.driver.ai/)