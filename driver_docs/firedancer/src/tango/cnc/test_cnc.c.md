<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Unit test for command and control (CNC) functionality, including signal handling and app thread management.

# Purpose
The code is a C program that functions as a unit test for a command and control (CNC) system. It verifies the behavior of CNC operations, including signal handling and memory alignment. The program uses static assertions to ensure that certain constants and alignments are correct, such as `FD_CNC_ALIGN` and `FD_CNC_FOOTPRINT`. It defines several signals like `FD_CNC_SIGNAL_RUN`, `FD_CNC_SIGNAL_BOOT`, and user-defined signals such as `USER_ACK` and `USER_GAME`. The main functionality is encapsulated in the [`app_main`](<#app_main>) function, which simulates a thread that transitions through different states (BOOT, RUN, HALT) and processes signals accordingly.

The [`main`](<#main>) function initializes the environment, sets up shared memory, and starts the application thread. It performs a series of tests to ensure that the CNC system behaves as expected, including signal queries, heartbeats, and error handling. The program uses the `fd_cnc` API to manage the lifecycle of the CNC session, including joining, signaling, and leaving the session. It also logs error messages and notices to provide feedback on the test results. If the required capabilities (`FD_HAS_HOSTED` and `FD_HAS_ATOMIC`) are not available, the program will skip the test and log a notice.
# Imports and Dependencies

---
- `../fd_tango.h`


# Global Variables

---
### shmem
- **Type**: `uchar array`
- **Description**: An array of unsigned characters (`uchar`) with a size determined by the macro `FD_CNC_FOOTPRINT(APP_MAX)`, which is aligned to `FD_CNC_ALIGN` bytes. The alignment ensures that the memory is accessed efficiently according to the specified alignment constraints.
- **Use**: Used as a shared memory buffer for command and control operations in the application.


# Functions

---
### app\_main<!-- {{#callable:app_main}} -->
[View Source →](<../../../../../src/tango/cnc/test_cnc.c#L32>)

Manages the lifecycle of an application thread, handling signals for booting, running, and halting states.
- **Inputs**:
    - `argc`: The number of command-line arguments passed to the program.
    - `argv`: An array of strings representing the command-line arguments.
- **Logic and Control Flow**:
    - Verify that `argc` is zero and join the command-and-control (CNC) session using `argv` as the shared memory address.
    - Check that the CNC signal is in the BOOT state and align the application memory address.
    - Signal the transition to the RUN state and enter an infinite loop to manage the application thread.
    - Periodically update the heartbeat and check for signals other than RUN.
    - If a HALT signal is received, break the loop to halt the application.
    - If a USER_ACK signal is received, clear it by signaling RUN.
    - If a USER_GAME signal is received, perform a sequence of operations to simulate a game, including serving a ball, waiting for a return, and verifying the game state.
    - Log an error if an unexpected signal is received.
    - Yield control periodically during the run loop and after halting.
    - Signal the transition back to the BOOT state and leave the CNC session, ensuring a clean halt.
- **Output**: Returns 0 to indicate successful execution.


---
### main<!-- {{#callable:main}} -->
[View Source →](<../../../../../src/tango/cnc/test_cnc.c#L219>)

Initializes the environment and logs a notice if certain capabilities are not available, then halts execution.
- **Inputs**:
    - `argc`: The number of command-line arguments.
    - `argv`: An array of strings representing the command-line arguments.
- **Logic and Control Flow**:
    - Calls `fd_boot` to initialize the environment with the command-line arguments.
    - Logs a notice indicating that the unit test requires `FD_HAS_HOSTED` and `FD_HAS_ATOMIC` capabilities.
    - Calls `fd_halt` to stop execution.
    - Returns 0 to indicate successful completion.
- **Output**: Returns 0, indicating successful execution.



---
Made with ❤️ by [Driver](https://www.driver.ai/)