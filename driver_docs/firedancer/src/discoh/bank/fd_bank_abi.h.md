<!--------------------------------------------------------------------------------->
<!-- IMPORTANT: This file is auto-generated by Driver (https://driver.ai). -------->
<!-- Manual edits may be overwritten on future commits. --------------------------->
<!--------------------------------------------------------------------------------->

Defines structures, constants, and functions for handling ABI-compatible transactions with sidecar data.

# Purpose
The code is a C header file that defines the application binary interface (ABI) for handling transactions in a banking system. It provides structures and functions to manage and process transactions, specifically focusing on the `SanitizedTransaction` type. The header includes definitions for transaction alignment and footprint, as well as macros to calculate the footprint of sidecar data associated with transactions. The sidecar data includes vectors of various types, such as `Vec<uchar>`, `Vec<CompiledInstruction>`, `Vec<MessageAddressTableLookup>`, and `Vec<Pubkey>`, which are used to store additional transaction-related information.

The file defines several error codes related to transaction initialization and provides function prototypes for initializing transactions and resolving address lookup tables. The [`fd_bank_abi_txn_init`](<#fd_bank_abi_txn_init>) function is responsible for constructing transactions, either as "legacy" or "v1" types, and requires a buffer for the transaction and its sidecar data. The [`fd_bank_abi_resolve_address_lookup_tables`](<#fd_bank_abi_resolve_address_lookup_tables>) function resolves address lookup tables for a transaction, while [`fd_bank_abi_get_lookup_addresses`](<#fd_bank_abi_get_lookup_addresses>) retrieves expanded address lookup tables. The header file ensures compatibility with a Rust representation of transactions, although it warns about the unsafe nature of using these structures in Rust due to memory ownership issues.
# Imports and Dependencies

---
- `../../disco/pack/fd_pack.h`
- `../../ballet/blake3/fd_blake3.h`


# Data Structures

---
### fd\_bank\_abi\_txn\_t
- **Type**: ``struct``
- **Description**: Represents a structure that is ABI compatible with `RuntimeTransaction<SanitizedTransaction>`. It is used to handle transactions in a way that is compatible with Rust's `RuntimeTransaction<SanitizedTransaction>`, but with specific considerations for memory management and performance. The structure does not own the internal `Vec<>` fields, which are instead managed through a sidecar buffer allocated by the caller. This design allows the structure to be passed to Rust code as a reference without modifying it, ensuring that the transaction and sidecar have the same lifetime.


# Function Declarations (Public API)

---
### fd\_bank\_abi\_resolve\_address\_lookup\_tables<!-- {{#callable_declaration:fd_bank_abi_resolve_address_lookup_tables}} -->
[View Source →](<../../../../../src/discoh/bank/fd_bank_abi.h#L89>)

Resolves address lookup tables for a transaction.
- **Description**: Use this function to resolve the address lookup tables for a given transaction and write the results to the specified output buffer. This function must be called with a valid transaction and payload, and it requires a specific slot to determine the state of the address lookup table. The function returns success or an error code based on the resolution process. Ensure that the output buffer is large enough to hold the resolved accounts.
- **Inputs**:
    - `bank`: Pointer to a constant bank object. The caller retains ownership and it must not be null.
    - `fixed_root`: Integer indicating whether a fixed root is used. Valid values are typically 0 or 1.
    - `slot`: Unsigned long representing the slot for which the address lookup table is retrieved. Must be a valid slot number.
    - `txn`: Pointer to a constant `fd_txn_t` structure representing the transaction. Must not be null and must be properly initialized.
    - `payload`: Pointer to a constant unsigned character array containing the transaction's raw wire payload. Must not be null.
    - `out_lut_accts`: Pointer to an `fd_acct_addr_t` array where the resolved lookup accounts will be written. Must be large enough to hold the results.
- **Output**: Returns an integer indicating success or an error code. On success, the resolved accounts are written to `out_lut_accts`.
- **See Also**: [`fd_bank_abi_resolve_address_lookup_tables`](<fd_bank_abi.c.md#fd_bank_abi_resolve_address_lookup_tables>)  (Implementation)


---
### fd\_bank\_abi\_txn\_init<!-- {{#callable_declaration:fd_bank_abi_txn_init}} -->
[View Source →](<../../../../../src/discoh/bank/fd_bank_abi.h#L124>)

Initializes a transaction structure with sidecar data.
- **Description**: Use this function to initialize a transaction structure and its associated sidecar data for a given bank and slot. This function prepares the transaction for further processing by setting up necessary fields and computing hashes. It must be called with valid memory buffers for the transaction and sidecar data, and the transaction must be parsed before calling this function. The function returns a success code or an error code if initialization fails.
- **Inputs**:
    - `out_txn`: Pointer to a buffer where the transaction structure will be constructed. Must be at least FD_BANK_ABI_TXN_FOOTPRINT bytes.
    - `out_sidecar`: Pointer to a buffer for sidecar data. Must be at least FD_BANK_ABI_TXN_FOOTPRINT_SIDECAR bytes.
    - `bank`: Pointer to a constant bank object for which the transaction is being loaded. Caller retains ownership.
    - `slot`: Slot number for which the transaction is being loaded. Must be a valid slot number.
    - `blake3`: Pointer to a Blake3 hash implementation used to compute the transaction's message hash. Must not be null.
    - `payload`: Pointer to the raw transaction payload. Must not be null and should contain the transaction data.
    - `payload_sz`: Size of the transaction payload in bytes. Must be greater than zero.
    - `txn`: Pointer to a parsed transaction representation. Must not be null and should be properly initialized.
    - `is_simple_vote`: Integer flag indicating if the transaction is a simple vote. Non-zero for true, zero for false.
- **Output**: Returns FD_BANK_ABI_TXN_INIT_SUCCESS on success or an error code on failure.
- **See Also**: [`fd_bank_abi_txn_init`](<fd_bank_abi.c.md#fd_bank_abi_txn_init>)  (Implementation)


---
### fd\_bank\_abi\_get\_lookup\_addresses<!-- {{#callable_declaration:fd_bank_abi_get_lookup_addresses}} -->
[View Source →](<../../../../../src/discoh/bank/fd_bank_abi.h#L143>)

Retrieves the expanded address lookup tables for a transaction.
- **Description**: Use this function to obtain a pointer to the expanded address lookup tables for a given transaction. This function should be called after initializing the transaction with `fd_bank_abi_txn_init`. If the transaction does not load any accounts from an address lookup table, the return value is undefined and may be NULL. The returned pointer points to a location within the sidecar region of the transaction, and its validity is tied to the lifetime of the sidecar memory region.
- **Inputs**:
    - `txn`: A pointer to a `fd_bank_abi_txn_t` structure, which must have been initialized by `fd_bank_abi_txn_init`. The pointer must not be null.
- **Output**: A pointer to the expanded address lookup tables, with writable accounts first. If no accounts are loaded from an address lookup table, the return value is undefined and may be NULL.
- **See Also**: [`fd_bank_abi_get_lookup_addresses`](<fd_bank_abi.c.md#fd_bank_abi_get_lookup_addresses>)  (Implementation)



---
Made with ❤️ by [Driver](https://www.driver.ai/)