# Purpose
This Python script is a specialized compiler that translates symbolic expressions into cBPF (classic Berkeley Packet Filter) code, specifically targeting C header files. The primary purpose of this script is to generate seccomp (secure computing mode) filters, which are used to restrict the system calls that a process can make, enhancing security by reducing the attack surface. The script reads a policy file, processes the symbolic expressions defined within, and outputs a C header file containing the corresponding BPF instructions. This header file can then be included in other C programs to enforce the specified seccomp policies.

The script is structured around several key components, including classes like `ReloCondJump`, `ReloJump`, and `CommentedLiteral`, which represent different types of BPF instructions with optional comments. The [`codegen`](#codegen) function is central to the script, orchestrating the conversion of policy lines into BPF code by appending prelude instructions, processing each policy line, and handling symbolic expressions. The script also includes functions for evaluating logical expressions ([`eval_`](#eval_), [`eval_equal`](#eval_equal), [`eval_less`](#eval_less), etc.) and generating comparison instructions ([`gen_cmp`](#gen_cmp)). The output is a C header file with a function that populates a BPF filter array, ready to be used in a seccomp context. The script ensures that the generated code is well-commented and structured, facilitating easier auditing and verification of the output.
# Imports and Dependencies

---
- `os`
- `sys`
- `edn_format`
- `collections.defaultdict`


# Global Variables

---
### relo\_label\_counter
- **Type**: `int`
- **Description**: The `relo_label_counter` is an integer variable initialized to zero. It is used to keep track of the number of relocation labels generated by the `new_relo_label` function.
- **Use**: This variable is incremented each time a new relocation label is created, ensuring that each label is unique.


---
### relo\_abs\_mapping
- **Type**: `dict`
- **Description**: The `relo_abs_mapping` is a global dictionary that is used to store mappings between labels and their corresponding instruction indices in the generated BPF code. It is initially defined as an empty dictionary and is populated during the code generation process.
- **Use**: This variable is used to keep track of the absolute positions of labels in the instruction list, which is crucial for correctly generating and relocating jump instructions in the BPF code.


# Classes

---
### ReloCondJump<!-- {{#class:firedancer/contrib/codegen/generate_filters.ReloCondJump}} -->
- **Members**:
    - `code`: Holds the code for the conditional jump instruction.
    - `t_label`: Represents the label for the true branch of the jump.
    - `f_label`: Represents the label for the false branch of the jump.
    - `pre_comment`: Optional comment to be placed before the jump instruction.
    - `post_comment`: Optional comment to be placed after the jump instruction.
- **Description**: The `ReloCondJump` class encapsulates a conditional jump instruction that is not yet realized, used in the context of generating cBPF code. It holds the jump code and labels for true and false branches, along with optional comments. The class provides functionality to convert the jump instruction to a string representation and to relocate the jump labels based on an instruction index, facilitating the generation of relocatable BPF code.
- **Methods**:
    - [`firedancer/contrib/codegen/generate_filters.ReloCondJump.__init__`](#ReloCondJump__init__)
    - [`firedancer/contrib/codegen/generate_filters.ReloCondJump.__str__`](#ReloCondJump__str__)
    - [`firedancer/contrib/codegen/generate_filters.ReloCondJump.relocate`](#ReloCondJumprelocate)
- **Inherits From**:
    - `object`

**Methods**

---
#### ReloCondJump\.\_\_init\_\_<!-- {{#callable:firedancer/contrib/codegen/generate_filters.ReloCondJump.__init__}} -->
The `__init__` method initializes an instance of the `ReloCondJump` class with specified code, true and false labels, and optional pre- and post-comments.
- **Inputs**:
    - `code`: The code for the conditional jump instruction.
    - `t_label`: The label to jump to if the condition is true.
    - `f_label`: The label to jump to if the condition is false.
    - `pre_comment`: An optional comment to be placed before the instruction.
    - `post_comment`: An optional comment to be placed after the instruction.
- **Control Flow**:
    - Assigns the `code` parameter to the instance variable `self.code`.
    - Assigns the `t_label` parameter to the instance variable `self.t_label`.
    - Assigns the `f_label` parameter to the instance variable `self.f_label`.
    - Assigns the `pre_comment` parameter to the instance variable `self.pre_comment`.
    - Assigns the `post_comment` parameter to the instance variable `self.post_comment`.
- **Output**: There is no return value as this is a constructor method for initializing an object.
- **See also**: [`firedancer/contrib/codegen/generate_filters.ReloCondJump`](#ReloCondJump)  (Base Class)


---
#### ReloCondJump\.\_\_str\_\_<!-- {{#callable:firedancer/contrib/codegen/generate_filters.ReloCondJump.__str__}} -->
The `__str__` method returns a formatted string representation of a `ReloCondJump` object, displaying its code, true label, and false label.
- **Inputs**: None
- **Control Flow**:
    - The method constructs a string using the format 'BPF_JUMP( %s, %s, %s )'.
    - It substitutes the placeholders with the object's `code`, `t_label`, and `f_label` attributes.
- **Output**: A string formatted as 'BPF_JUMP( code, t_label, f_label )', where `code`, `t_label`, and `f_label` are attributes of the `ReloCondJump` instance.
- **See also**: [`firedancer/contrib/codegen/generate_filters.ReloCondJump`](#ReloCondJump)  (Base Class)


---
#### ReloCondJump\.relocate<!-- {{#callable:firedancer/contrib/codegen/generate_filters.ReloCondJump.relocate}} -->
The `relocate` method updates the true and false labels of a `ReloCondJump` instance by replacing them with new labels based on a given instruction index.
- **Inputs**:
    - `instr_idx`: An integer representing the instruction index used to update the labels.
- **Control Flow**:
    - The method calls [`replace_label`](#replace_label) on `self.t_label` with `instr_idx` to update the true label.
    - The method calls [`replace_label`](#replace_label) on `self.f_label` with `instr_idx` to update the false label.
- **Output**: The method does not return any value; it modifies the instance's labels in place.
- **Functions called**:
    - [`firedancer/contrib/codegen/generate_filters.replace_label`](#replace_label)
- **See also**: [`firedancer/contrib/codegen/generate_filters.ReloCondJump`](#ReloCondJump)  (Base Class)



---
### ReloJump<!-- {{#class:firedancer/contrib/codegen/generate_filters.ReloJump}} -->
- **Members**:
    - `label`: Stores the label for the jump instruction.
    - `pre_comment`: Holds an optional comment to be placed before the instruction.
    - `post_comment`: Holds an optional comment to be placed after the instruction.
- **Description**: The `ReloJump` class represents an unconditional jump instruction that is not yet realized, with the ability to relocate its label based on an instruction index. It includes optional comments that can be attached before and after the instruction for documentation purposes. The class provides a string representation of the jump instruction and a method to update the label to reflect its relative position in the instruction sequence.
- **Methods**:
    - [`firedancer/contrib/codegen/generate_filters.ReloJump.__init__`](#ReloJump__init__)
    - [`firedancer/contrib/codegen/generate_filters.ReloJump.__str__`](#ReloJump__str__)
    - [`firedancer/contrib/codegen/generate_filters.ReloJump.relocate`](#ReloJumprelocate)
- **Inherits From**:
    - `object`

**Methods**

---
#### ReloJump\.\_\_init\_\_<!-- {{#callable:firedancer/contrib/codegen/generate_filters.ReloJump.__init__}} -->
The `__init__` method initializes an instance of the `ReloJump` class with a label and optional pre- and post-comments.
- **Inputs**:
    - `label`: A string representing the label for the jump instruction.
    - `pre_comment`: An optional string for a comment to be placed before the instruction.
    - `post_comment`: An optional string for a comment to be placed after the instruction.
- **Control Flow**:
    - Assigns the `label` parameter to the instance variable `self.label`.
    - Assigns the `pre_comment` parameter to the instance variable `self.pre_comment`.
    - Assigns the `post_comment` parameter to the instance variable `self.post_comment`.
- **Output**: This method does not return any value; it initializes the instance variables of the `ReloJump` object.
- **See also**: [`firedancer/contrib/codegen/generate_filters.ReloJump`](#ReloJump)  (Base Class)


---
#### ReloJump\.\_\_str\_\_<!-- {{#callable:firedancer/contrib/codegen/generate_filters.ReloJump.__str__}} -->
The `__str__` method returns a string representation of a `ReloJump` object formatted as a BPF jump instruction with the object's label.
- **Inputs**: None
- **Control Flow**:
    - The method constructs a string using a specific format for a BPF jump instruction.
    - It inserts the `label` attribute of the `ReloJump` instance into the formatted string.
- **Output**: A string representing the BPF jump instruction with the label of the `ReloJump` object.
- **See also**: [`firedancer/contrib/codegen/generate_filters.ReloJump`](#ReloJump)  (Base Class)


---
#### ReloJump\.relocate<!-- {{#callable:firedancer/contrib/codegen/generate_filters.ReloJump.relocate}} -->
The `relocate` method updates the label of a jump instruction to reflect its new position in the instruction sequence.
- **Inputs**:
    - `instr_idx`: An integer representing the index of the instruction in the sequence where the label should be relocated.
- **Control Flow**:
    - The method calls the [`replace_label`](#replace_label) function with the current label and the provided `instr_idx` as arguments.
    - The result of [`replace_label`](#replace_label) is assigned back to `self.label`, updating the label to reflect its new position.
- **Output**: The method does not return any value; it updates the `label` attribute of the object in place.
- **Functions called**:
    - [`firedancer/contrib/codegen/generate_filters.replace_label`](#replace_label)
- **See also**: [`firedancer/contrib/codegen/generate_filters.ReloJump`](#ReloJump)  (Base Class)



---
### CommentedLiteral<!-- {{#class:firedancer/contrib/codegen/generate_filters.CommentedLiteral}} -->
- **Members**:
    - `lit`: Stores the literal value of the instruction.
    - `pre_comment`: Holds an optional comment that appears before the literal.
    - `post_comment`: Holds an optional comment that appears after the literal.
- **Description**: The `CommentedLiteral` class represents an instruction with an optional pre and post comment. It is designed to encapsulate a literal value, typically a string, that can be associated with comments for documentation or clarification purposes. This class is useful in contexts where code generation or transformation is involved, and comments are needed to annotate the generated code for better understanding or auditing.
- **Methods**:
    - [`firedancer/contrib/codegen/generate_filters.CommentedLiteral.__init__`](#CommentedLiteral__init__)
    - [`firedancer/contrib/codegen/generate_filters.CommentedLiteral.__str__`](#CommentedLiteral__str__)
- **Inherits From**:
    - `object`

**Methods**

---
#### CommentedLiteral\.\_\_init\_\_<!-- {{#callable:firedancer/contrib/codegen/generate_filters.CommentedLiteral.__init__}} -->
The `__init__` method initializes a `CommentedLiteral` object with a literal value and optional pre- and post-comments.
- **Inputs**:
    - `lit`: The literal value to be stored in the `CommentedLiteral` object.
    - `pre_comment`: An optional comment to be associated with the literal, placed before it.
    - `post_comment`: An optional comment to be associated with the literal, placed after it.
- **Control Flow**:
    - Assigns the provided `lit` argument to the `lit` attribute of the object.
    - Assigns the provided `pre_comment` argument to the `pre_comment` attribute of the object.
    - Assigns the provided `post_comment` argument to the `post_comment` attribute of the object.
- **Output**: This method does not return any value; it initializes the object's attributes.
- **See also**: [`firedancer/contrib/codegen/generate_filters.CommentedLiteral`](#CommentedLiteral)  (Base Class)


---
#### CommentedLiteral\.\_\_str\_\_<!-- {{#callable:firedancer/contrib/codegen/generate_filters.CommentedLiteral.__str__}} -->
The `__str__` method returns the literal value stored in the `CommentedLiteral` object.
- **Inputs**: None
- **Control Flow**:
    - The method directly returns the `lit` attribute of the `CommentedLiteral` instance.
- **Output**: The output is a string representation of the `lit` attribute of the `CommentedLiteral` object.
- **See also**: [`firedancer/contrib/codegen/generate_filters.CommentedLiteral`](#CommentedLiteral)  (Base Class)



# Functions

---
### new\_relo\_label<!-- {{#callable:firedancer/contrib/codegen/generate_filters.new_relo_label}} -->
The `new_relo_label` function generates a unique relocation label each time it is called by incrementing a global counter.
- **Inputs**: None
- **Control Flow**:
    - Accesses the global variable `relo_label_counter`.
    - Increments the `relo_label_counter` by 1.
    - Returns a string formatted as 'lbl_' followed by the current value of `relo_label_counter`.
- **Output**: A string representing a unique label, formatted as 'lbl_' followed by the current value of the global counter `relo_label_counter`.


---
### reverse\_multi\_mapping<!-- {{#callable:firedancer/contrib/codegen/generate_filters.reverse_multi_mapping}} -->
The `reverse_multi_mapping` function reverses a dictionary mapping from keys to values into a dictionary mapping from values to lists of keys.
- **Inputs**:
    - `mapping`: A dictionary where each key is mapped to a value.
- **Control Flow**:
    - Initialize a defaultdict `res` with list as the default factory.
    - Iterate over each key-value pair in the input `mapping`.
    - For each pair, append the key to the list associated with the value in `res`.
    - Return the `res` dictionary.
- **Output**: A defaultdict where each key is a value from the input mapping, and each value is a list of keys from the input mapping that were associated with that value.


---
### replace\_label<!-- {{#callable:firedancer/contrib/codegen/generate_filters.replace_label}} -->
The `replace_label` function replaces a label with a relative distance comment if a relocation mapping exists, otherwise it returns the label unchanged.
- **Inputs**:
    - `label`: The label to be replaced or returned.
    - `instr_idx`: The index of the instruction, used to calculate the relative distance if a relocation mapping exists.
- **Control Flow**:
    - Retrieve the relocation mapping for the given label using `relo_abs_mapping.get(label)`.
    - Check if the retrieved relocation mapping (`maybe_relo`) is not `None`.
    - If `maybe_relo` is not `None`, calculate the relative distance as `maybe_relo - instr_idx - 1` and return it as a formatted string with the label as a comment.
    - If `maybe_relo` is `None`, return the original label.
- **Output**: Returns a string representing the relative distance with a comment if a relocation mapping exists, otherwise returns the original label.


---
### append\_prelude<!-- {{#callable:firedancer/contrib/codegen/generate_filters.append_prelude}} -->
The `append_prelude` function appends a series of BPF instructions to a filter list to set up initial checks for architecture and syscall number in a seccomp filter.
- **Inputs**:
    - `filter`: A list to which BPF instructions are appended, representing a seccomp filter.
- **Control Flow**:
    - Append a [`CommentedLiteral`](#CommentedLiteral) to the filter to load the architecture field from `seccomp_data` and add a pre-comment explaining the check for architecture mismatch.
    - Append a [`ReloCondJump`](#ReloCondJump) to the filter to conditionally jump to `RET_KILL_PROCESS` if the architecture does not match, using a conditional jump instruction.
    - Append another [`CommentedLiteral`](#CommentedLiteral) to the filter to load the syscall number from `seccomp_data` and add a pre-comment explaining the loading of the syscall number into the accumulator.
- **Output**: The function modifies the input `filter` list by appending BPF instructions to it.
- **Functions called**:
    - [`firedancer/contrib/codegen/generate_filters.CommentedLiteral`](#CommentedLiteral)
    - [`firedancer/contrib/codegen/generate_filters.ReloCondJump`](#ReloCondJump)


---
### codegen<!-- {{#callable:firedancer/contrib/codegen/generate_filters.codegen}} -->
The `codegen` function generates BPF code for a given set of policy lines and appends it to a filter list.
- **Inputs**:
    - `policy_lines`: A list of strings, each representing a line of policy that specifies syscall rules and optional expressions.
    - `filt`: A list that will be populated with BPF instructions based on the policy lines.
- **Control Flow**:
    - The function starts by appending a prelude to the filter using `append_prelude(filt)`.
    - It initializes an empty dictionary `syscall_to_expression` to track syscalls with associated expressions.
    - Iterates over each line in `policy_lines`, splitting each line into parts based on the ':' delimiter.
    - For lines with a single part, it appends a [`ReloCondJump`](#ReloCondJump) to `filt` to allow the syscall unconditionally.
    - For lines with two parts, it appends a [`ReloCondJump`](#ReloCondJump) to `filt` to allow the syscall conditionally and stores the expression in `syscall_to_expression`.
    - If a line is malformed (more than two parts), it prints an error message and exits the program.
    - Appends a [`ReloJump`](#ReloJump) to `filt` to handle unmatched syscalls by killing the process.
    - Iterates over `syscall_to_expression` to append expression checks to `filt` using the [`expression`](#expression) function.
    - Registers the `RET_KILL_PROCESS` and `RET_ALLOW` labels in `relo_abs_mapping` and appends corresponding [`CommentedLiteral`](#CommentedLiteral) instructions to `filt`.
    - Finally, iterates over `filt` to relocate any [`ReloCondJump`](#ReloCondJump) or [`ReloJump`](#ReloJump) instructions based on their index.
- **Output**: The function modifies the `filt` list in place, appending BPF instructions that represent the compiled policy.
- **Functions called**:
    - [`firedancer/contrib/codegen/generate_filters.append_prelude`](#append_prelude)
    - [`firedancer/contrib/codegen/generate_filters.ReloCondJump`](#ReloCondJump)
    - [`firedancer/contrib/codegen/generate_filters.ReloJump`](#ReloJump)
    - [`firedancer/contrib/codegen/generate_filters.expression`](#expression)
    - [`firedancer/contrib/codegen/generate_filters.CommentedLiteral`](#CommentedLiteral)
    - [`firedancer/contrib/codegen/generate_filters.ReloCondJump.relocate`](#ReloCondJumprelocate)


---
### expression<!-- {{#callable:firedancer/contrib/codegen/generate_filters.expression}} -->
The `expression` function processes a symbolic expression associated with a syscall name and appends the appropriate BPF instructions to a filter list.
- **Inputs**:
    - `name`: The name of the syscall for which the expression is being processed.
    - `expr`: A symbolic expression in EDN format that defines conditions or actions related to the syscall.
    - `filt`: A list that accumulates BPF instructions, representing the filter being constructed.
- **Control Flow**:
    - The function starts by mapping the 'check' label for the given syscall name to the current length of the filter list.
    - The symbolic expression `expr` is parsed using `edn_format.loads`.
    - If the parsed expression is a tuple, it indicates a complex condition, and the function calls [`eval_`](#eval_) to generate BPF instructions for evaluating the expression, allowing the syscall if the expression evaluates to true.
    - If the parsed expression is an `edn_format.Symbol`, it is treated as a direct condition, and a [`ReloCondJump`](#ReloCondJump) instruction is appended to the filter list to check the syscall against the symbol.
- **Output**: The function does not return a value; it modifies the `filt` list in place by appending BPF instructions based on the provided expression.
- **Functions called**:
    - [`firedancer/contrib/codegen/generate_filters.eval_`](#eval_)
    - [`firedancer/contrib/codegen/generate_filters.ReloCondJump`](#ReloCondJump)


---
### eval\_<!-- {{#callable:firedancer/contrib/codegen/generate_filters.eval_}} -->
The `eval_` function recursively evaluates symbolic expressions and generates corresponding cBPF code instructions for a filter.
- **Inputs**:
    - `expr`: A symbolic expression, typically a tuple, representing a logical or arithmetic operation to be evaluated.
    - `filt`: A list that accumulates the generated cBPF code instructions based on the evaluation of the expression.
    - `label_t`: A label indicating the jump target if the expression evaluates to true.
    - `label_f`: A label indicating the jump target if the expression evaluates to false.
- **Control Flow**:
    - Check if the expression is a tuple and extract the first element as a string to determine the operation type.
    - For 'not' operations, ensure there is exactly one argument, then recursively evaluate the argument with flipped true and false labels.
    - For 'and' operations, ensure there are at least two arguments, then evaluate each argument in sequence, creating new labels for intermediate results.
    - For 'or' operations, ensure there are at least two arguments, then evaluate each argument, creating new labels for intermediate results.
    - For 'arg' operations, validate the argument number and append a BPF statement to load the syscall argument into the accumulator.
    - For comparison operations ('eq', '<', '<=', '>', '>='), call specific helper functions to generate the appropriate comparison instructions.
    - Raise an error if the operation type is unknown.
- **Output**: The function does not return a value; instead, it appends generated cBPF code instructions to the `filt` list based on the evaluation of the expression.
- **Functions called**:
    - [`firedancer/contrib/codegen/generate_filters.new_relo_label`](#new_relo_label)
    - [`firedancer/contrib/codegen/generate_filters.CommentedLiteral`](#CommentedLiteral)
    - [`firedancer/contrib/codegen/generate_filters.eval_equal`](#eval_equal)
    - [`firedancer/contrib/codegen/generate_filters.eval_less`](#eval_less)
    - [`firedancer/contrib/codegen/generate_filters.eval_less_or_equal`](#eval_less_or_equal)
    - [`firedancer/contrib/codegen/generate_filters.eval_greater`](#eval_greater)
    - [`firedancer/contrib/codegen/generate_filters.eval_greater_or_equal`](#eval_greater_or_equal)


---
### gen\_cmp<!-- {{#callable:firedancer/contrib/codegen/generate_filters.gen_cmp}} -->
The `gen_cmp` function generates a conditional jump instruction for comparing two operands in a filter, handling different operand types and raising exceptions for unsupported cases.
- **Inputs**:
    - `filt`: A list to which the generated conditional jump instruction will be appended.
    - `op1`: The first operand to be compared, which can be a tuple or an immediate value.
    - `op2`: The second operand to be compared, which can be a tuple or an immediate value.
    - `label_t`: The label to jump to if the comparison is true.
    - `label_f`: The label to jump to if the comparison is false.
    - `cmp_instr`: The comparison instruction to be used in the conditional jump, such as 'BPF_JEQ' for equality.
- **Control Flow**:
    - Determine the types of op1 and op2.
    - If both op1 and op2 are of type edn_format.Symbol, raise an exception as comparing two immediate values is unsupported.
    - If op1 is a tuple and op2 is not, evaluate op1, append a conditional jump instruction comparing the result with op2 to the filter.
    - If op2 is a tuple and op1 is not, evaluate op2, append a conditional jump instruction comparing the result with op1 to the filter.
    - If neither of the above conditions are met, raise an exception as the case is unsupported.
- **Output**: The function does not return a value; it modifies the 'filt' list by appending a ReloCondJump object representing the conditional jump instruction.
- **Functions called**:
    - [`firedancer/contrib/codegen/generate_filters.eval_`](#eval_)
    - [`firedancer/contrib/codegen/generate_filters.ReloCondJump`](#ReloCondJump)


---
### eval\_equal<!-- {{#callable:firedancer/contrib/codegen/generate_filters.eval_equal}} -->
The `eval_equal` function generates a comparison operation for equality between two operands and appends the corresponding BPF jump instruction to a filter list.
- **Inputs**:
    - `filt`: A list to which the generated BPF instruction will be appended.
    - `op1`: The first operand to be compared.
    - `op2`: The second operand to be compared.
    - `label_t`: The label to jump to if the comparison is true.
    - `label_f`: The label to jump to if the comparison is false.
- **Control Flow**:
    - The function calls [`gen_cmp`](#gen_cmp) with the provided operands, labels, and the comparison instruction 'BPF_JEQ'.
- **Output**: The function does not return a value; it modifies the `filt` list by appending a BPF jump instruction for equality comparison.
- **Functions called**:
    - [`firedancer/contrib/codegen/generate_filters.gen_cmp`](#gen_cmp)


---
### eval\_less<!-- {{#callable:firedancer/contrib/codegen/generate_filters.eval_less}} -->
The `eval_less` function generates a comparison instruction for evaluating if one operand is less than another in a BPF filter.
- **Inputs**:
    - `filt`: A list that represents the BPF filter to which the generated comparison instruction will be appended.
    - `op1`: The first operand in the comparison, which can be a symbolic expression or an immediate value.
    - `op2`: The second operand in the comparison, which can be a symbolic expression or an immediate value.
    - `label_t`: The label to jump to if the comparison evaluates to true.
    - `label_f`: The label to jump to if the comparison evaluates to false.
- **Control Flow**:
    - The function calls [`gen_cmp`](#gen_cmp) with the provided operands, labels, and the comparison instruction `BPF_JGE`.
- **Output**: The function does not return a value; it modifies the `filt` list by appending a conditional jump instruction based on the comparison.
- **Functions called**:
    - [`firedancer/contrib/codegen/generate_filters.gen_cmp`](#gen_cmp)


---
### eval\_less\_or\_equal<!-- {{#callable:firedancer/contrib/codegen/generate_filters.eval_less_or_equal}} -->
The `eval_less_or_equal` function generates a comparison operation for checking if one operand is less than or equal to another using BPF instructions.
- **Inputs**:
    - `filt`: A list that stores the generated BPF instructions.
    - `op1`: The first operand in the comparison, which can be a tuple or a non-tuple value.
    - `op2`: The second operand in the comparison, which can be a tuple or a non-tuple value.
    - `label_t`: The label to jump to if the comparison evaluates to true.
    - `label_f`: The label to jump to if the comparison evaluates to false.
- **Control Flow**:
    - Calls the [`gen_cmp`](#gen_cmp) function with the provided operands, labels, and the comparison instruction `BPF_JGT` to generate the necessary BPF instructions for the less than or equal comparison.
- **Output**: The function does not return a value; it modifies the `filt` list by appending the generated BPF instructions.
- **Functions called**:
    - [`firedancer/contrib/codegen/generate_filters.gen_cmp`](#gen_cmp)


---
### eval\_greater<!-- {{#callable:firedancer/contrib/codegen/generate_filters.eval_greater}} -->
The `eval_greater` function generates a comparison operation for greater-than logic in a filter using the BPF_JGT instruction.
- **Inputs**:
    - `filt`: A list that represents the filter to which the generated BPF code will be appended.
    - `op1`: The first operand in the comparison, which can be a tuple or a non-tuple value.
    - `op2`: The second operand in the comparison, which can be a tuple or a non-tuple value.
    - `label_t`: The label to jump to if the comparison evaluates to true.
    - `label_f`: The label to jump to if the comparison evaluates to false.
- **Control Flow**:
    - The function calls [`gen_cmp`](#gen_cmp) with the provided operands, labels, and the comparison instruction 'BPF_JGT'.
- **Output**: The function does not return a value; it modifies the `filt` list by appending the necessary BPF instructions for the greater-than comparison.
- **Functions called**:
    - [`firedancer/contrib/codegen/generate_filters.gen_cmp`](#gen_cmp)


---
### eval\_greater\_or\_equal<!-- {{#callable:firedancer/contrib/codegen/generate_filters.eval_greater_or_equal}} -->
The `eval_greater_or_equal` function generates a BPF comparison instruction for checking if one operand is greater than or equal to another.
- **Inputs**:
    - `filt`: A list to which the generated BPF instruction will be appended.
    - `op1`: The first operand in the comparison, which can be a tuple or a non-tuple value.
    - `op2`: The second operand in the comparison, which can be a tuple or a non-tuple value.
    - `label_t`: The label to jump to if the comparison evaluates to true.
    - `label_f`: The label to jump to if the comparison evaluates to false.
- **Control Flow**:
    - The function calls [`gen_cmp`](#gen_cmp) with the provided operands, labels, and the comparison instruction 'BPF_JGE'.
- **Output**: The function does not return a value; it modifies the `filt` list by appending a BPF instruction.
- **Functions called**:
    - [`firedancer/contrib/codegen/generate_filters.gen_cmp`](#gen_cmp)


---
### resplit\_lines<!-- {{#callable:firedancer/contrib/codegen/generate_filters.resplit_lines}} -->
The `resplit_lines` function merges lines in a list that start with a space into the previous line, effectively removing the indented lines.
- **Inputs**:
    - `lines`: A list of strings, where each string represents a line that may need to be merged with the previous line if it starts with a space.
- **Control Flow**:
    - Initialize an index `i` to 0 to iterate over the list `lines`.
    - Enter a while loop that continues as long as `i` is less than the length of `lines`.
    - Check if the current line `lines[i]` starts with a space.
    - If it does, append the current line to the previous line `lines[i-1]` and remove the current line from the list using `pop(i)`.
    - If it does not start with a space, increment the index `i` to move to the next line.
    - Continue the loop until all lines have been processed.
    - Return the modified list `lines`.
- **Output**: The function returns the modified list of strings where lines starting with a space have been merged into the previous line.


