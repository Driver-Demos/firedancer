
## Files
- **[AccountDerefBeforeModify.ql](nightly/AccountDerefBeforeModify.ql.driver.md)**: The `AccountDerefBeforeModify.ql` file in the `firedancer` codebase defines a CodeQL query to identify instances where a borrowed account's metadata is dereferenced before modification, which is not allowed, and issues a warning for such occurrences.
- **[AccountVTableMismatch.ql](nightly/AccountVTableMismatch.ql.driver.md)**: The `AccountVTableMismatch.ql` file in the `firedancer` codebase is a CodeQL query that detects mismatches between the account used to dereference a v-table and the account passed as an argument, issuing a warning when they do not match.
- **[ArrayArgSizeMismatch.ql](nightly/ArrayArgSizeMismatch.ql.driver.md)**: The `ArrayArgSizeMismatch.ql` file in the `firedancer` codebase identifies function calls in C++ where an array argument is smaller than the expected parameter size, potentially leading to out-of-bounds memory access.
- **[AssignWhereCompareMeant.ql](nightly/AssignWhereCompareMeant.ql.driver.md)**: The `AssignWhereCompareMeant.ql` file in the `firedancer` codebase defines a CodeQL query to detect instances in C++ code where the assignment operator '=' may have been mistakenly used instead of the comparison operator '==', potentially leading to reliability and correctness issues.
- **[BadAdditionOverflowCheck.ql](nightly/BadAdditionOverflowCheck.ql.driver.md)**: The `BadAdditionOverflowCheck.ql` file in the `firedancer` codebase identifies problematic checks for integer addition overflow that fail when the result is promoted to a larger type, highlighting it as a high-severity security issue.
- **[BadAdditionOverflowCheck.qll](nightly/BadAdditionOverflowCheck.ql.driver.mdl)**: The `BadAdditionOverflowCheck.qll` file implements a query to detect potentially faulty overflow checks in addition operations within C++ code, ensuring that the checks are not invalidated by automatic type promotions.
- **[BincodeCrdsValue.ql](nightly/BincodeCrdsValue.ql.driver.md)**: The `BincodeCrdsValue.ql` file in the `firedancer` codebase defines a CodeQL query to ensure that the `fd_value_elem->data` is only initialized using `fd_crds_value_encode`, highlighting a past bug and tagging it as a security concern.
- **[BitwiseSignCheck.ql](nightly/BitwiseSignCheck.ql.driver.md)**: The `BitwiseSignCheck.ql` file in the `firedancer` codebase defines a CodeQL query to identify potentially unsafe sign checks of bitwise operations in C++ code, flagging them as warnings for reliability and correctness.
- **[BoundedPrintfLogging.ql](nightly/BoundedPrintfLogging.ql.driver.md)**: The `BoundedPrintfLogging.ql` file in the `firedancer` codebase defines a CodeQL query to check that custom runtime logging format strings do not exceed their fixed size target buffers, issuing warnings when potential buffer overflows are detected.
- **[BuiltinExpectScopeTooNarrow.ql](nightly/BuiltinExpectScopeTooNarrow.ql.driver.md)**: The `BuiltinExpectScopeTooNarrow.ql` file identifies and warns about the use of `__builtin_expect()` in non-conditional contexts within the `firedancer` codebase.
- **[codeql-pack.lock.yml](nightly/codeql-pack.lock.yml.driver.md)**: The `codeql-pack.lock.yml` file in the `firedancer` codebase specifies the lock version and indicates that there are no dependencies and the code is not compiled.
- **[ConstPureViolation.ql](nightly/ConstPureViolation.ql.driver.md)**: The `ConstPureViolation.ql` file in the `firedancer` codebase defines a CodeQL query to identify functions attributed with `const` or `pure` that illegally access pointers, issuing a warning for such violations.
- **[DoubleDelete.ql](nightly/DoubleDelete.ql.driver.md)**: The `DoubleDelete.ql` file in the `firedancer` codebase is a CodeQL query that identifies potential double delete issues in C++ code, warning about non-idempotent delete functions to ensure correctness and maintainability.
- **[DoubleLeave.ql](nightly/DoubleLeave.ql.driver.md)**: The `DoubleLeave.ql` file in the `firedancer` codebase defines a CodeQL query to detect instances where an object is operated on without being properly joined, highlighting potential correctness and maintainability issues.
- **[DubiousNullCheck.ql](nightly/DubiousNullCheck.ql.driver.md)**: The `DubiousNullCheck.ql` file in the `firedancer` codebase defines a CodeQL query to identify misleading NULL checks on non-first fields of a structure, which are flagged as a reliability and readability issue with a warning severity.
- **[filter.qll](nightly/filter.qll.driver.md)**: The `filter.qll` file defines a predicate to exclude certain code, specifically agave code, from analysis in the `firedancer` codebase.
- **[FootprintBound.ql](nightly/FootprintBound.ql.driver.md)**: The `FootprintBound.ql` file in the `firedancer` codebase defines a CodeQL query to identify structs that do not fit within their specified footprint macros, issuing a warning when such a mismatch is detected.
- **[GenericDoubleFree.qll](nightly/GenericDoubleFree.qll.driver.md)**: The `GenericDoubleFree.qll` file in the `firedancer` codebase defines a CodeQL module for detecting double free vulnerabilities by configuring data flow analysis to identify sources, barriers, and sinks related to potential double free operations.
- **[IncorrectPointerScalingCommon.qll](nightly/IncorrectPointerScalingCommon.qll.driver.md)**: The `IncorrectPointerScalingCommon.qll` file provides shared utilities for CWE-468 queries, focusing on analyzing and handling pointer arithmetic and type expressions in C++ code.
- **[LossyPointerCast.ql](nightly/LossyPointerCast.ql.driver.md)**: The `LossyPointerCast.ql` file in the `firedancer` codebase defines a query to detect instances where a pointer type is converted to a smaller integer type, potentially leading to information loss and non-portability issues, and flags these occurrences with a warning.
- **[MemsetMayBeDeleted.ql](nightly/MemsetMayBeDeleted.ql.driver.md)**: The `MemsetMayBeDeleted.ql` file in the `firedancer` codebase defines a CodeQL query to identify calls to `memset` that may be removed by the compiler, potentially leading to information-leak vulnerabilities.
- **[MismatchedMemset.ql](nightly/MismatchedMemset.ql.driver.md)**: The `MismatchedMemset.ql` file in the `firedancer` codebase detects potential issues where the `memset` function is called with a size that does not match the type of the first argument, issuing a warning when a mismatch is found.
- **[MmapRetvalCmp.ql](nightly/MmapRetvalCmp.ql.driver.md)**: The `MmapRetvalCmp.ql` file in the `firedancer` codebase defines a CodeQL query to identify instances where the return value of a call to `mmap` is not properly checked for failure, issuing a warning when such cases are found.
- **[NoDupMagic.ql](nightly/NoDupMagic.ql.driver.md)**: The `NoDupMagic.ql` file in the `firedancer` codebase defines a CodeQL query to identify and warn about duplicate magic constants in C++ code to prevent type confusions.
- **[NoMagicCheck.ql](nightly/NoMagicCheck.ql.driver.md)**: The `NoMagicCheck.ql` file defines a CodeQL query to identify functions that have a magic field but do not check or reset it, as a defense against memory corruption.
- **[NonAnnotatedFormatFunction.ql](nightly/NonAnnotatedFormatFunction.ql.driver.md)**: The `NonAnnotatedFormatFunction.ql` file in the `firedancer` codebase identifies calls to functions that likely expect a format string but are not annotated as such, issuing a warning for potential issues.
- **[NoNullShorcircuit.ql](nightly/NoNullShorcircuit.ql.driver.md)**: The `NoNullShorcircuit.ql` file in the `firedancer` codebase defines a CodeQL query to identify instances where a potential null pointer is checked and then accessed without short-circuiting, issuing a warning for such cases.
- **[PointerOverflow.ql](nightly/PointerOverflow.ql.driver.md)**: The `PointerOverflow.ql` file in the `firedancer` codebase defines a query to detect pointer overflow checks in C++ code, which can lead to undefined behavior and potential memory corruption.
- **[qlpack.yml](nightly/qlpack.yml.driver.md)**: The `qlpack.yml` file specifies the configuration for a CodeQL query pack named `asymmetric-research/fd-dev-queries`, including its version, extractor type, and dependencies.
- **[RedundantNullCheck.ql](nightly/RedundantNullCheck.ql.driver.md)**: The `RedundantNullCheck.ql` file in the `firedancer` codebase defines a CodeQL query to identify and report errors where a null check is performed on a pointer after it has already been dereferenced, which is redundant and potentially incorrect.
- **[ReturnStackAllocatedMemory.ql](nightly/ReturnStackAllocatedMemory.ql.driver.md)**: The `ReturnStackAllocatedMemory.ql` file in the `firedancer` codebase defines a CodeQL query to detect functions that return pointers to stack-allocated memory, which can lead to dereferencing dangling pointers, and it includes configurations for identifying such problematic flows with high precision and security severity.
- **[SeqCmp.ql](nightly/SeqCmp.ql.driver.md)**: The `SeqCmp.ql` file in the `firedancer` codebase identifies relational comparisons of sequence numbers that do not utilize the `fd_seq_*` functions, issuing a warning to use appropriate sequence comparison functions instead.
- **[SurelyWrongConstPure.ql](nightly/SurelyWrongConstPure.ql.driver.md)**: The `SurelyWrongConstPure.ql` file in the `firedancer` codebase defines a query to detect calls to known non-const/non-pure functions from functions marked as const or pure, issuing a warning for such occurrences.
- **[SuspiciousAddWithSizeof.ql](nightly/SuspiciousAddWithSizeof.ql.driver.md)**: The `SuspiciousAddWithSizeof.ql` file in the `firedancer` codebase defines a CodeQL query to identify potentially dangerous pointer arithmetic expressions that could lead to buffer overflow conditions due to incorrect scaling, specifically when the pointer type is not `char*` or `void*`.
- **[SwappedParameters.ql](nightly/SwappedParameters.ql.driver.md)**: The `SwappedParameters.ql` file in the `firedancer` codebase detects cases where function parameters are swapped between the definition and implementation, potentially leading to bugs if the parameters are of the same type.
- **[TrivialMemcpy.ql](nightly/TrivialMemcpy.ql.driver.md)**: The `TrivialMemcpy.ql` file in the `firedancer` codebase defines a CodeQL query to identify instances where a `memcpy` call could be replaced with a simple assignment for improved maintainability and readability.
- **[TrivialMemcpyWrong.ql](nightly/TrivialMemcpyWrong.ql.driver.md)**: The `TrivialMemcpyWrong.ql` file in the `firedancer` codebase defines a CodeQL query to identify potential errors in `memcpy` calls where the size argument may not match the sizes of the source and destination types, suggesting the use of an assignment expression instead.
- **[UnclearOperatorPrecedence.ql](nightly/UnclearOperatorPrecedence.ql.driver.md)**: The `UnclearOperatorPrecedence.ql` file in the `firedancer` codebase identifies binary bitwise operations that are not parenthesized and have a comparison operation as the other operand, issuing a warning for potential precedence issues.
- **[UnsignedGEZero.ql](nightly/UnsignedGEZero.ql.driver.md)**: The `UnsignedGEZero.ql` file in the `firedancer` codebase defines a CodeQL query that identifies redundant comparisons of unsigned values to zero, which may indicate a potential bug, and flags them with a warning for maintainability and readability.
- **[UnsignedGEZero.qll](nightly/UnsignedGEZero.ql.driver.mdl)**: The `UnsignedGEZero.qll` file defines classes and predicates for implementing the UnsignedGEZero query, which identifies pointless comparisons of unsigned values to zero, and is also utilized by the more general PointlessComparison query to prevent duplicate reporting.
- **[UseInOwnInitializer.ql](nightly/UseInOwnInitializer.ql.driver.md)**: The `UseInOwnInitializer.ql` file in the `firedancer` codebase defines a CodeQL query to identify instances where a variable is used in its own initializer, which can lead to undefined behavior, and flags these occurrences with a warning for maintainability and correctness.
- **[WrongUnused.ql](nightly/WrongUnused.ql.driver.md)**: The `WrongUnused.ql` file in the `firedancer` codebase defines a CodeQL query to identify parameters that are incorrectly marked as unused despite being used in the code.
